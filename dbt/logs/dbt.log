[0m16:01:53.665280 [debug] [Thread-2 (]: Using postgres connection "model.elementary.dbt_seeds"
[0m16:01:53.668948 [debug] [Thread-1 (]: Using postgres connection "model.elementary.dbt_source_freshness_results"
[0m16:01:53.669345 [debug] [Thread-3 (]: On model.elementary.dbt_sources: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_sources"} */

    
  
    

  create temporary table "dbt_sources__dbt_tmp160153659799"
  
  
    as
  
  (
    

select * from (
            select
            
                
        cast('dummy_string' as varchar(4096)) as unique_id

,
                
        cast('dummy_string' as varchar(4096)) as database_name

,
                
        cast('dummy_string' as varchar(4096)) as schema_name

,
                
        cast('dummy_string' as varchar(4096)) as source_name

,
                
        cast('dummy_string' as varchar(4096)) as name

,
                
        cast('dummy_string' as varchar(4096)) as identifier

,
                
        cast('dummy_string' as varchar(4096)) as loaded_at_field

,
                
        cast('dummy_string' as varchar(4096)) as freshness_warn_after

,
                
        cast('dummy_string' as varchar(4096)) as freshness_error_after

,
                
        cast('this_is_just_a_long_dummy_string' as text) as freshness_filter

,
                
        cast('this_is_just_a_long_dummy_string' as text) as freshness_description

,
                
        cast('dummy_string' as varchar(4096)) as relation_name

,
                
        cast('this_is_just_a_long_dummy_string' as text) as tags

,
                
        cast('this_is_just_a_long_dummy_string' as text) as meta

,
                
        cast('dummy_string' as varchar(4096)) as owner

,
                
        cast('dummy_string' as varchar(4096)) as package_name

,
                
        cast('this_is_just_a_long_dummy_string' as text) as original_path

,
                
        cast('dummy_string' as varchar(4096)) as path

,
                
        cast('this_is_just_a_long_dummy_string' as text) as source_description

,
                
        cast('this_is_just_a_long_dummy_string' as text) as description

,
                
        cast('dummy_string' as varchar(4096)) as generated_at

,
                
        cast('dummy_string' as varchar(4096)) as metadata_hash


        ) as empty_table
        where 1 = 0
  );
  
  
[0m16:01:53.669777 [debug] [Thread-4 (]: On model.elementary.dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_snapshots"} */

    
  
    

  create temporary table "dbt_snapshots__dbt_tmp160153663729"
  
  
    as
  
  (
    

select * from (
            select
            
                
        cast('dummy_string' as varchar(4096)) as unique_id

,
                
        cast('dummy_string' as varchar(4096)) as alias

,
                
        cast('dummy_string' as varchar(4096)) as checksum

,
                
        cast('dummy_string' as varchar(4096)) as materialization

,
                
        cast('this_is_just_a_long_dummy_string' as text) as tags

,
                
        cast('this_is_just_a_long_dummy_string' as text) as meta

,
                
        cast('dummy_string' as varchar(4096)) as owner

,
                
        cast('dummy_string' as varchar(4096)) as database_name

,
                
        cast('dummy_string' as varchar(4096)) as schema_name

,
                
        cast('this_is_just_a_long_dummy_string' as text) as depends_on_macros

,
                
        cast('this_is_just_a_long_dummy_string' as text) as depends_on_nodes

,
                
        cast('this_is_just_a_long_dummy_string' as text) as description

,
                
        cast('dummy_string' as varchar(4096)) as name

,
                
        cast('dummy_string' as varchar(4096)) as package_name

,
                
        cast('this_is_just_a_long_dummy_string' as text) as original_path

,
                
        cast('dummy_string' as varchar(4096)) as path

,
                
        cast('dummy_string' as varchar(4096)) as patch_path

,
                
        cast('dummy_string' as varchar(4096)) as generated_at

,
                
        cast('dummy_string' as varchar(4096)) as metadata_hash

,
                
        cast('dummy_string' as varchar(4096)) as unique_key

,
                
        cast('dummy_string' as varchar(4096)) as incremental_strategy


        ) as empty_table
        where 1 = 0
  );
  
  
[0m16:01:53.670397 [debug] [Thread-2 (]: On model.elementary.dbt_seeds: COMMIT
[0m16:01:53.670746 [debug] [Thread-1 (]: On model.elementary.dbt_source_freshness_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_source_freshness_results"} */

    
  
    

  create temporary table "dbt_source_freshness_results__dbt_tmp160153667757"
  
  
    as
  
  (
    


    select * from (
            select
            
                
        cast('dummy_string' as varchar(4096)) as source_freshness_execution_id

,
                
        cast('dummy_string' as varchar(4096)) as unique_id

,
                
        cast('dummy_string' as varchar(4096)) as max_loaded_at

,
                
        cast('dummy_string' as varchar(4096)) as snapshotted_at

,
                
        cast('dummy_string' as varchar(4096)) as generated_at

,
                cast('2091-02-17' as timestamp) as created_at

,
                
        cast(123456789.99 as float) as max_loaded_at_time_ago_in_s

,
                
        cast('dummy_string' as varchar(4096)) as status

,
                
        cast('dummy_string' as varchar(4096)) as error

,
                
        cast('dummy_string' as varchar(4096)) as compile_started_at

,
                
        cast('dummy_string' as varchar(4096)) as compile_completed_at

,
                
        cast('dummy_string' as varchar(4096)) as execute_started_at

,
                
        cast('dummy_string' as varchar(4096)) as execute_completed_at

,
                
        cast('dummy_string' as varchar(4096)) as invocation_id

,
                
        cast('dummy_string' as varchar(4096)) as warn_after

,
                
        cast('dummy_string' as varchar(4096)) as error_after

,
                
        cast('this_is_just_a_long_dummy_string' as text) as filter


        ) as empty_table
        where 1 = 0

  );
  
  
[0m16:01:53.671041 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:53.671270 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:53.671528 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:53.675587 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m16:01:53.676219 [debug] [Thread-2 (]: On model.elementary.dbt_seeds: Close
[0m16:01:53.676574 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060824d0>]}
[0m16:01:53.676942 [info ] [Thread-2 (]: 8 of 39 OK created sql incremental model public_public.dbt_seeds ............... [[32mINSERT 0 0[0m in 0.26s]
[0m16:01:53.677245 [debug] [Thread-2 (]: Finished running node model.elementary.dbt_seeds
[0m16:01:53.677462 [debug] [Thread-2 (]: Began running node model.elementary.dbt_tests
[0m16:01:53.677911 [info ] [Thread-2 (]: 12 of 39 START sql incremental model public_public.dbt_tests ................... [RUN]
[0m16:01:53.678272 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.elementary.dbt_seeds, now model.elementary.dbt_tests)
[0m16:01:53.678497 [debug] [Thread-2 (]: Began compiling node model.elementary.dbt_tests
[0m16:01:53.689560 [debug] [Thread-2 (]: Writing injected SQL for node "model.elementary.dbt_tests"
[0m16:01:53.690105 [debug] [Thread-2 (]: Began executing node model.elementary.dbt_tests
[0m16:01:53.695275 [debug] [Thread-2 (]: Using postgres connection "model.elementary.dbt_tests"
[0m16:01:53.695694 [debug] [Thread-2 (]: On model.elementary.dbt_tests: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_tests"} */

    
  
    

  create temporary table "dbt_tests__dbt_tmp160153692913"
  
  
    as
  
  (
    

select * from (
            select
            
                
        cast('dummy_string' as varchar(4096)) as unique_id

,
                
        cast('dummy_string' as varchar(4096)) as database_name

,
                
        cast('dummy_string' as varchar(4096)) as schema_name

,
                
        cast('dummy_string' as varchar(4096)) as name

,
                
        cast('dummy_string' as varchar(4096)) as short_name

,
                
        cast('dummy_string' as varchar(4096)) as alias

,
                
        cast('dummy_string' as varchar(4096)) as test_column_name

,
                
        cast('dummy_string' as varchar(4096)) as severity

,
                
        cast('dummy_string' as varchar(4096)) as warn_if

,
                
        cast('dummy_string' as varchar(4096)) as error_if

,
                
        cast('this_is_just_a_long_dummy_string' as text) as test_params

,
                
        cast('dummy_string' as varchar(4096)) as test_namespace

,
                
        cast('dummy_string' as varchar(4096)) as test_original_name

,
                
        cast('this_is_just_a_long_dummy_string' as text) as tags

,
                
        cast('this_is_just_a_long_dummy_string' as text) as model_tags

,
                
        cast('this_is_just_a_long_dummy_string' as text) as model_owners

,
                
        cast('this_is_just_a_long_dummy_string' as text) as meta

,
                
        cast('this_is_just_a_long_dummy_string' as text) as depends_on_macros

,
                
        cast('this_is_just_a_long_dummy_string' as text) as depends_on_nodes

,
                
        cast('dummy_string' as varchar(4096)) as parent_model_unique_id

,
                
        cast('this_is_just_a_long_dummy_string' as text) as description

,
                
        cast('dummy_string' as varchar(4096)) as package_name

,
                
        cast('dummy_string' as varchar(4096)) as type

,
                
        cast('this_is_just_a_long_dummy_string' as text) as original_path

,
                
        cast('dummy_string' as varchar(4096)) as path

,
                
        cast('dummy_string' as varchar(4096)) as generated_at

,
                
        cast('dummy_string' as varchar(4096)) as metadata_hash

,
                
        cast('dummy_string' as varchar(4096)) as quality_dimension


        ) as empty_table
        where 1 = 0
  );
  
  
[0m16:01:53.695985 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:53.702766 [debug] [Thread-3 (]: SQL status: SELECT 0 in 0.032 seconds
[0m16:01:53.707627 [debug] [Thread-3 (]: Using postgres connection "model.elementary.dbt_sources"
[0m16:01:53.708001 [debug] [Thread-3 (]: On model.elementary.dbt_sources: BEGIN
[0m16:01:53.708578 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.037 seconds
[0m16:01:53.711311 [debug] [Thread-4 (]: Using postgres connection "model.elementary.dbt_snapshots"
[0m16:01:53.711633 [debug] [Thread-4 (]: On model.elementary.dbt_snapshots: BEGIN
[0m16:01:53.712013 [debug] [Thread-3 (]: SQL status: BEGIN in 0.004 seconds
[0m16:01:53.712368 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.041 seconds
[0m16:01:53.712672 [debug] [Thread-3 (]: Using postgres connection "model.elementary.dbt_sources"
[0m16:01:53.715401 [debug] [Thread-1 (]: Using postgres connection "model.elementary.dbt_source_freshness_results"
[0m16:01:53.715750 [debug] [Thread-4 (]: SQL status: BEGIN in 0.003 seconds
[0m16:01:53.716147 [debug] [Thread-3 (]: On model.elementary.dbt_sources: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_sources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_sources__dbt_tmp160153659799'
        
      order by ordinal_position

  
[0m16:01:53.716406 [debug] [Thread-2 (]: SQL status: SELECT 0 in 0.020 seconds
[0m16:01:53.716680 [debug] [Thread-1 (]: On model.elementary.dbt_source_freshness_results: BEGIN
[0m16:01:53.716969 [debug] [Thread-4 (]: Using postgres connection "model.elementary.dbt_snapshots"
[0m16:01:53.719965 [debug] [Thread-2 (]: Using postgres connection "model.elementary.dbt_tests"
[0m16:01:53.720351 [debug] [Thread-4 (]: On model.elementary.dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_snapshots"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_snapshots__dbt_tmp160153663729'
        
      order by ordinal_position

  
[0m16:01:53.720693 [debug] [Thread-2 (]: On model.elementary.dbt_tests: BEGIN
[0m16:01:53.721063 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m16:01:53.721445 [debug] [Thread-1 (]: Using postgres connection "model.elementary.dbt_source_freshness_results"
[0m16:01:53.721694 [debug] [Thread-1 (]: On model.elementary.dbt_source_freshness_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_source_freshness_results"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_source_freshness_results__dbt_tmp160153667757'
        
      order by ordinal_position

  
[0m16:01:53.722295 [debug] [Thread-2 (]: SQL status: BEGIN in 0.001 seconds
[0m16:01:53.722512 [debug] [Thread-2 (]: Using postgres connection "model.elementary.dbt_tests"
[0m16:01:53.722774 [debug] [Thread-3 (]: SQL status: SELECT 22 in 0.006 seconds
[0m16:01:53.723156 [debug] [Thread-2 (]: On model.elementary.dbt_tests: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_tests"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_tests__dbt_tmp160153692913'
        
      order by ordinal_position

  
[0m16:01:53.726714 [debug] [Thread-3 (]: Using postgres connection "model.elementary.dbt_sources"
[0m16:01:53.727290 [debug] [Thread-3 (]: On model.elementary.dbt_sources: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_sources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_sources'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:53.727710 [debug] [Thread-4 (]: SQL status: SELECT 21 in 0.007 seconds
[0m16:01:53.728063 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.006 seconds
[0m16:01:53.731121 [debug] [Thread-4 (]: Using postgres connection "model.elementary.dbt_snapshots"
[0m16:01:53.731420 [debug] [Thread-3 (]: SQL status: SELECT 22 in 0.004 seconds
[0m16:01:53.777636 [debug] [Thread-2 (]: SQL status: SELECT 28 in 0.050 seconds
[0m16:01:53.778125 [debug] [Thread-1 (]: Using postgres connection "model.elementary.dbt_source_freshness_results"
[0m16:01:53.778413 [debug] [Thread-4 (]: On model.elementary.dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_snapshots"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_snapshots'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:53.781268 [debug] [Thread-3 (]: Using postgres connection "model.elementary.dbt_sources"
[0m16:01:53.783804 [debug] [Thread-2 (]: Using postgres connection "model.elementary.dbt_tests"
[0m16:01:53.784063 [debug] [Thread-1 (]: On model.elementary.dbt_source_freshness_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_source_freshness_results"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_source_freshness_results'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:53.784372 [debug] [Thread-3 (]: On model.elementary.dbt_sources: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_sources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_sources__dbt_tmp160153659799'
        
      order by ordinal_position

  
[0m16:01:53.784824 [debug] [Thread-2 (]: On model.elementary.dbt_tests: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_tests"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_tests'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:53.787301 [debug] [Thread-4 (]: SQL status: SELECT 21 in 0.003 seconds
[0m16:01:53.787658 [debug] [Thread-3 (]: SQL status: SELECT 22 in 0.002 seconds
[0m16:01:53.791004 [debug] [Thread-4 (]: Using postgres connection "model.elementary.dbt_snapshots"
[0m16:01:53.791258 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.006 seconds
[0m16:01:53.791451 [debug] [Thread-2 (]: SQL status: SELECT 28 in 0.006 seconds
[0m16:01:53.794001 [debug] [Thread-3 (]: Using postgres connection "model.elementary.dbt_sources"
[0m16:01:53.794260 [debug] [Thread-4 (]: On model.elementary.dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_snapshots"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_snapshots__dbt_tmp160153663729'
        
      order by ordinal_position

  
[0m16:01:53.796856 [debug] [Thread-1 (]: Using postgres connection "model.elementary.dbt_source_freshness_results"
[0m16:01:53.799844 [debug] [Thread-2 (]: Using postgres connection "model.elementary.dbt_tests"
[0m16:01:53.800100 [debug] [Thread-3 (]: On model.elementary.dbt_sources: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_sources"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_sources'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:53.800397 [debug] [Thread-1 (]: On model.elementary.dbt_source_freshness_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_source_freshness_results"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_source_freshness_results__dbt_tmp160153667757'
        
      order by ordinal_position

  
[0m16:01:53.800716 [debug] [Thread-2 (]: On model.elementary.dbt_tests: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_tests"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_tests__dbt_tmp160153692913'
        
      order by ordinal_position

  
[0m16:01:53.802529 [debug] [Thread-4 (]: SQL status: SELECT 21 in 0.002 seconds
[0m16:01:53.805477 [debug] [Thread-4 (]: Using postgres connection "model.elementary.dbt_snapshots"
[0m16:01:53.805815 [debug] [Thread-3 (]: SQL status: SELECT 22 in 0.005 seconds
[0m16:01:53.806094 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.005 seconds
[0m16:01:53.806365 [debug] [Thread-4 (]: On model.elementary.dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_snapshots"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_snapshots'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:53.806588 [debug] [Thread-2 (]: SQL status: SELECT 28 in 0.006 seconds
[0m16:01:53.808982 [debug] [Thread-3 (]: 
    In "podcast_analytics"."public_public"."dbt_sources":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:01:53.811653 [debug] [Thread-1 (]: Using postgres connection "model.elementary.dbt_source_freshness_results"
[0m16:01:53.815054 [debug] [Thread-2 (]: Using postgres connection "model.elementary.dbt_tests"
[0m16:01:53.815348 [debug] [Thread-4 (]: SQL status: SELECT 21 in 0.003 seconds
[0m16:01:53.816148 [debug] [Thread-3 (]: Writing runtime sql for node "model.elementary.dbt_sources"
[0m16:01:53.816413 [debug] [Thread-1 (]: On model.elementary.dbt_source_freshness_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_source_freshness_results"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_source_freshness_results'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:53.816637 [debug] [Thread-2 (]: On model.elementary.dbt_tests: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_tests"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_tests'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:53.818707 [debug] [Thread-4 (]: 
    In "podcast_analytics"."public_public"."dbt_snapshots":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:01:53.819775 [debug] [Thread-4 (]: Writing runtime sql for node "model.elementary.dbt_snapshots"
[0m16:01:53.820229 [debug] [Thread-3 (]: Using postgres connection "model.elementary.dbt_sources"
[0m16:01:53.820532 [debug] [Thread-3 (]: On model.elementary.dbt_sources: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_sources"} */

      
        
        
        delete from "podcast_analytics"."public_public"."dbt_sources" as DBT_INTERNAL_DEST
        where (unique_id) in (
            select distinct unique_id
            from "dbt_sources__dbt_tmp160153659799" as DBT_INTERNAL_SOURCE
        );

    

    insert into "podcast_analytics"."public_public"."dbt_sources" ("unique_id", "database_name", "schema_name", "source_name", "name", "identifier", "loaded_at_field", "freshness_warn_after", "freshness_error_after", "freshness_filter", "freshness_description", "relation_name", "tags", "meta", "owner", "package_name", "original_path", "path", "source_description", "description", "generated_at", "metadata_hash")
    (
        select "unique_id", "database_name", "schema_name", "source_name", "name", "identifier", "loaded_at_field", "freshness_warn_after", "freshness_error_after", "freshness_filter", "freshness_description", "relation_name", "tags", "meta", "owner", "package_name", "original_path", "path", "source_description", "description", "generated_at", "metadata_hash"
        from "dbt_sources__dbt_tmp160153659799"
    )
  
[0m16:01:53.820805 [debug] [Thread-4 (]: Using postgres connection "model.elementary.dbt_snapshots"
[0m16:01:53.821095 [debug] [Thread-4 (]: On model.elementary.dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_snapshots"} */

      
        
        
        delete from "podcast_analytics"."public_public"."dbt_snapshots" as DBT_INTERNAL_DEST
        where (unique_id) in (
            select distinct unique_id
            from "dbt_snapshots__dbt_tmp160153663729" as DBT_INTERNAL_SOURCE
        );

    

    insert into "podcast_analytics"."public_public"."dbt_snapshots" ("unique_id", "alias", "checksum", "materialization", "tags", "meta", "owner", "database_name", "schema_name", "depends_on_macros", "depends_on_nodes", "description", "name", "package_name", "original_path", "path", "patch_path", "generated_at", "metadata_hash", "unique_key", "incremental_strategy")
    (
        select "unique_id", "alias", "checksum", "materialization", "tags", "meta", "owner", "database_name", "schema_name", "depends_on_macros", "depends_on_nodes", "description", "name", "package_name", "original_path", "path", "patch_path", "generated_at", "metadata_hash", "unique_key", "incremental_strategy"
        from "dbt_snapshots__dbt_tmp160153663729"
    )
  
[0m16:01:53.821436 [debug] [Thread-2 (]: SQL status: SELECT 28 in 0.002 seconds
[0m16:01:53.821762 [debug] [Thread-1 (]: SQL status: SELECT 17 in 0.003 seconds
[0m16:01:53.824744 [debug] [Thread-2 (]: 
    In "podcast_analytics"."public_public"."dbt_tests":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:01:53.826405 [debug] [Thread-1 (]: 
    In "podcast_analytics"."public_public"."dbt_source_freshness_results":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:01:53.826617 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.005 seconds
[0m16:01:53.827427 [debug] [Thread-2 (]: Writing runtime sql for node "model.elementary.dbt_tests"
[0m16:01:53.827610 [debug] [Thread-3 (]: SQL status: INSERT 0 0 in 0.007 seconds
[0m16:01:53.828296 [debug] [Thread-1 (]: Writing runtime sql for node "model.elementary.dbt_source_freshness_results"
[0m16:01:53.831159 [debug] [Thread-4 (]: Elementary: [dbt_snapshots] Flattening the artifacts.
[0m16:01:53.834211 [debug] [Thread-3 (]: Elementary: [dbt_sources] Flattening the artifacts.
[0m16:01:53.835443 [debug] [Thread-4 (]: Elementary: [dbt_snapshots] Flattened 0 artifacts.
[0m16:01:53.835737 [debug] [Thread-2 (]: Using postgres connection "model.elementary.dbt_tests"
[0m16:01:53.845195 [debug] [Thread-3 (]: Elementary: [dbt_sources] Flattened 3 artifacts.
[0m16:01:53.846306 [debug] [Thread-4 (]: Using postgres connection "model.elementary.dbt_snapshots"
[0m16:01:53.846540 [debug] [Thread-1 (]: Using postgres connection "model.elementary.dbt_source_freshness_results"
[0m16:01:53.846805 [debug] [Thread-2 (]: On model.elementary.dbt_tests: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_tests"} */

      
        
        
        delete from "podcast_analytics"."public_public"."dbt_tests" as DBT_INTERNAL_DEST
        where (unique_id) in (
            select distinct unique_id
            from "dbt_tests__dbt_tmp160153692913" as DBT_INTERNAL_SOURCE
        );

    

    insert into "podcast_analytics"."public_public"."dbt_tests" ("unique_id", "database_name", "schema_name", "name", "short_name", "alias", "test_column_name", "severity", "warn_if", "error_if", "test_params", "test_namespace", "test_original_name", "tags", "model_tags", "model_owners", "meta", "depends_on_macros", "depends_on_nodes", "parent_model_unique_id", "description", "package_name", "type", "original_path", "path", "generated_at", "metadata_hash", "quality_dimension")
    (
        select "unique_id", "database_name", "schema_name", "name", "short_name", "alias", "test_column_name", "severity", "warn_if", "error_if", "test_params", "test_namespace", "test_original_name", "tags", "model_tags", "model_owners", "meta", "depends_on_macros", "depends_on_nodes", "parent_model_unique_id", "description", "package_name", "type", "original_path", "path", "generated_at", "metadata_hash", "quality_dimension"
        from "dbt_tests__dbt_tmp160153692913"
    )
  
[0m16:01:53.847640 [debug] [Thread-3 (]: Using postgres connection "model.elementary.dbt_sources"
[0m16:01:53.847843 [debug] [Thread-4 (]: On model.elementary.dbt_snapshots: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_snapshots"} */

    
    select metadata_hash 
    from "podcast_analytics"."public_public"."dbt_snapshots"
    order by metadata_hash
    
  
[0m16:01:53.848148 [debug] [Thread-1 (]: On model.elementary.dbt_source_freshness_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_source_freshness_results"} */

      
        
        
        delete from "podcast_analytics"."public_public"."dbt_source_freshness_results" as DBT_INTERNAL_DEST
        where (source_freshness_execution_id) in (
            select distinct source_freshness_execution_id
            from "dbt_source_freshness_results__dbt_tmp160153667757" as DBT_INTERNAL_SOURCE
        );

    

    insert into "podcast_analytics"."public_public"."dbt_source_freshness_results" ("source_freshness_execution_id", "unique_id", "max_loaded_at", "snapshotted_at", "generated_at", "created_at", "max_loaded_at_time_ago_in_s", "status", "error", "compile_started_at", "compile_completed_at", "execute_started_at", "execute_completed_at", "invocation_id", "warn_after", "error_after", "filter")
    (
        select "source_freshness_execution_id", "unique_id", "max_loaded_at", "snapshotted_at", "generated_at", "created_at", "max_loaded_at_time_ago_in_s", "status", "error", "compile_started_at", "compile_completed_at", "execute_started_at", "execute_completed_at", "invocation_id", "warn_after", "error_after", "filter"
        from "dbt_source_freshness_results__dbt_tmp160153667757"
    )
  
[0m16:01:53.848518 [debug] [Thread-3 (]: On model.elementary.dbt_sources: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_sources"} */

    
    select metadata_hash 
    from "podcast_analytics"."public_public"."dbt_sources"
    order by metadata_hash
    
  
[0m16:01:53.849491 [debug] [Thread-3 (]: SQL status: SELECT 3 in 0.001 seconds
[0m16:01:53.849750 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.001 seconds
[0m16:01:53.850026 [debug] [Thread-2 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m16:01:53.850293 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m16:01:53.851121 [debug] [Thread-3 (]: Elementary: [dbt_sources] Comparing the artifacts state.
[0m16:01:53.851902 [debug] [Thread-4 (]: Elementary: [dbt_snapshots] Comparing the artifacts state.
[0m16:01:53.854963 [debug] [Thread-2 (]: Elementary: [dbt_tests] Flattening the artifacts.
[0m16:01:53.855792 [debug] [Thread-1 (]: On model.elementary.dbt_source_freshness_results: COMMIT
[0m16:01:53.856252 [debug] [Thread-3 (]: Elementary: [dbt_sources] Artifacts did not change.
[0m16:01:53.856718 [debug] [Thread-4 (]: Elementary: [dbt_snapshots] Artifacts did not change.
[0m16:01:53.868284 [debug] [Thread-1 (]: Using postgres connection "model.elementary.dbt_source_freshness_results"
[0m16:01:53.881311 [debug] [Thread-3 (]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:
[0m16:01:53.906347 [debug] [Thread-4 (]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:
[0m16:01:53.918494 [debug] [Thread-1 (]: On model.elementary.dbt_source_freshness_results: COMMIT
[0m16:01:53.934752 [debug] [Thread-2 (]: Elementary: [dbt_tests] Flattened 23 artifacts.
[0m16:01:53.935265 [debug] [Thread-3 (]: Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.008763 (1 runs)
[0m16:01:53.935712 [debug] [Thread-4 (]: Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00.000337 (1 runs)
[0m16:01:53.936709 [debug] [Thread-2 (]: Using postgres connection "model.elementary.dbt_tests"
[0m16:01:53.937152 [debug] [Thread-3 (]: Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.047056 (1 runs)
[0m16:01:53.937553 [debug] [Thread-4 (]: Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.075118 (1 runs)
[0m16:01:53.937764 [debug] [Thread-2 (]: On model.elementary.dbt_tests: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_tests"} */

    
    select metadata_hash 
    from "podcast_analytics"."public_public"."dbt_tests"
    order by metadata_hash
    
  
[0m16:01:53.938170 [debug] [Thread-3 (]: On model.elementary.dbt_sources: COMMIT
[0m16:01:53.938559 [debug] [Thread-4 (]: On model.elementary.dbt_snapshots: COMMIT
[0m16:01:53.938793 [debug] [Thread-3 (]: Using postgres connection "model.elementary.dbt_sources"
[0m16:01:53.938995 [debug] [Thread-4 (]: Using postgres connection "model.elementary.dbt_snapshots"
[0m16:01:53.939193 [debug] [Thread-3 (]: On model.elementary.dbt_sources: COMMIT
[0m16:01:53.939382 [debug] [Thread-4 (]: On model.elementary.dbt_snapshots: COMMIT
[0m16:01:53.939987 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m16:01:53.940409 [debug] [Thread-1 (]: On model.elementary.dbt_source_freshness_results: Close
[0m16:01:53.940623 [debug] [Thread-2 (]: SQL status: SELECT 23 in 0.002 seconds
[0m16:01:53.941392 [debug] [Thread-2 (]: Elementary: [dbt_tests] Comparing the artifacts state.
[0m16:01:53.941823 [debug] [Thread-2 (]: Elementary: [dbt_tests] Artifacts did not change.
[0m16:01:53.942397 [debug] [Thread-2 (]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:
[0m16:01:53.943000 [debug] [Thread-2 (]: Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00.077495 (1 runs)
[0m16:01:53.943338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c403e80>]}
[0m16:01:53.943721 [debug] [Thread-2 (]: Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.087423 (1 runs)
[0m16:01:53.943904 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m16:01:53.944271 [info ] [Thread-1 (]: 10 of 39 OK created sql incremental model public_public.dbt_source_freshness_results  [[32mINSERT 0 0[0m in 0.32s]
[0m16:01:53.944501 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m16:01:53.944914 [debug] [Thread-2 (]: On model.elementary.dbt_tests: COMMIT
[0m16:01:53.945282 [debug] [Thread-3 (]: On model.elementary.dbt_sources: Close
[0m16:01:53.945563 [debug] [Thread-1 (]: Finished running node model.elementary.dbt_source_freshness_results
[0m16:01:53.945920 [debug] [Thread-4 (]: On model.elementary.dbt_snapshots: Close
[0m16:01:53.946115 [debug] [Thread-2 (]: Using postgres connection "model.elementary.dbt_tests"
[0m16:01:53.946390 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6ebc0>]}
[0m16:01:53.946604 [debug] [Thread-1 (]: Began running node model.elementary.elementary_test_results
[0m16:01:53.946900 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd11e0>]}
[0m16:01:53.947112 [debug] [Thread-2 (]: On model.elementary.dbt_tests: COMMIT
[0m16:01:53.947425 [info ] [Thread-3 (]: 11 of 39 OK created sql incremental model public_public.dbt_sources ............ [[32mINSERT 0 0[0m in 0.32s]
[0m16:01:53.947706 [info ] [Thread-1 (]: 13 of 39 START sql incremental model public_public.elementary_test_results ..... [RUN]
[0m16:01:53.948020 [info ] [Thread-4 (]: 9 of 39 OK created sql incremental model public_public.dbt_snapshots ........... [[32mINSERT 0 0[0m in 0.32s]
[0m16:01:53.948463 [debug] [Thread-3 (]: Finished running node model.elementary.dbt_sources
[0m16:01:53.948754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elementary.dbt_source_freshness_results, now model.elementary.elementary_test_results)
[0m16:01:53.949052 [debug] [Thread-4 (]: Finished running node model.elementary.dbt_snapshots
[0m16:01:53.949286 [debug] [Thread-3 (]: Began running node model.elementary.metadata
[0m16:01:53.949562 [debug] [Thread-1 (]: Began compiling node model.elementary.elementary_test_results
[0m16:01:53.949869 [debug] [Thread-4 (]: Began running node model.elementary.schema_columns_snapshot
[0m16:01:53.950151 [info ] [Thread-3 (]: 14 of 39 START sql table model public_public.metadata .......................... [RUN]
[0m16:01:53.956160 [info ] [Thread-4 (]: 15 of 39 START sql incremental model public_public.schema_columns_snapshot ..... [RUN]
[0m16:01:53.960225 [debug] [Thread-1 (]: Writing injected SQL for node "model.elementary.elementary_test_results"
[0m16:01:53.960533 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.elementary.dbt_sources, now model.elementary.metadata)
[0m16:01:53.960747 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.elementary.dbt_snapshots, now model.elementary.schema_columns_snapshot)
[0m16:01:53.961158 [debug] [Thread-3 (]: Began compiling node model.elementary.metadata
[0m16:01:53.961475 [debug] [Thread-4 (]: Began compiling node model.elementary.schema_columns_snapshot
[0m16:01:53.965451 [debug] [Thread-3 (]: Writing injected SQL for node "model.elementary.metadata"
[0m16:01:53.965767 [debug] [Thread-2 (]: SQL status: COMMIT in 0.017 seconds
[0m16:01:53.966076 [debug] [Thread-1 (]: Began executing node model.elementary.elementary_test_results
[0m16:01:53.973069 [debug] [Thread-4 (]: Writing injected SQL for node "model.elementary.schema_columns_snapshot"
[0m16:01:53.973764 [debug] [Thread-2 (]: On model.elementary.dbt_tests: Close
[0m16:01:53.977749 [debug] [Thread-1 (]: Using postgres connection "model.elementary.elementary_test_results"
[0m16:01:53.978089 [debug] [Thread-3 (]: Began executing node model.elementary.metadata
[0m16:01:53.978572 [debug] [Thread-1 (]: On model.elementary.elementary_test_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.elementary_test_results"} */

    
  
    

  create temporary table "elementary_test_results__dbt_tmp160153976509"
  
  
    as
  
  (
    


    select * from (
            select
            
                
        cast('this_is_just_a_long_dummy_string' as text) as id

,
                
        cast('dummy_string' as varchar(4096)) as data_issue_id

,
                
        cast('this_is_just_a_long_dummy_string' as text) as test_execution_id

,
                
        cast('this_is_just_a_long_dummy_string' as text) as test_unique_id

,
                
        cast('this_is_just_a_long_dummy_string' as text) as model_unique_id

,
                
        cast('dummy_string' as varchar(4096)) as invocation_id

,
                cast('2091-02-17' as timestamp) as detected_at

,
                cast('2091-02-17' as timestamp) as created_at

,
                
        cast('dummy_string' as varchar(4096)) as database_name

,
                
        cast('dummy_string' as varchar(4096)) as schema_name

,
                
        cast('dummy_string' as varchar(4096)) as table_name

,
                
        cast('dummy_string' as varchar(4096)) as column_name

,
                
        cast('dummy_string' as varchar(4096)) as test_type

,
                
        cast('dummy_string' as varchar(4096)) as test_sub_type

,
                
        cast('this_is_just_a_long_dummy_string' as text) as test_results_description

,
                
        cast('dummy_string' as varchar(4096)) as owners

,
                
        cast('dummy_string' as varchar(4096)) as tags

,
                
        cast('this_is_just_a_long_dummy_string' as text) as test_results_query

,
                
        cast('dummy_string' as varchar(4096)) as other

,
                
        cast('this_is_just_a_long_dummy_string' as text) as test_name

,
                
        cast('this_is_just_a_long_dummy_string' as text) as test_params

,
                
        cast('dummy_string' as varchar(4096)) as severity

,
                
        cast('dummy_string' as varchar(4096)) as status

,
                
        cast(31474836478 as bigint) as failures

,
                
        cast('dummy_string' as varchar(4096)) as test_short_name

,
                
        cast('dummy_string' as varchar(4096)) as test_alias

,
                
        cast('this_is_just_a_long_dummy_string' as text) as result_rows

,
                
        cast(31474836478 as bigint) as failed_row_count


        ) as empty_table
        where 1 = 0

  );
  
  
[0m16:01:53.979023 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060824d0>]}
[0m16:01:53.988043 [debug] [Thread-3 (]: Writing runtime sql for node "model.elementary.metadata"
[0m16:01:53.988419 [debug] [Thread-4 (]: Began executing node model.elementary.schema_columns_snapshot
[0m16:01:53.988740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:53.989191 [info ] [Thread-2 (]: 12 of 39 OK created sql incremental model public_public.dbt_tests .............. [[32mINSERT 0 0[0m in 0.30s]
[0m16:01:53.993104 [debug] [Thread-4 (]: Using postgres connection "model.elementary.schema_columns_snapshot"
[0m16:01:53.993568 [debug] [Thread-2 (]: Finished running node model.elementary.dbt_tests
[0m16:01:53.993801 [debug] [Thread-3 (]: Using postgres connection "model.elementary.metadata"
[0m16:01:53.994059 [debug] [Thread-4 (]: On model.elementary.schema_columns_snapshot: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.schema_columns_snapshot"} */

    
  
    

  create temporary table "schema_columns_snapshot__dbt_tmp160153991826"
  
  
    as
  
  (
    


    select * from (
            select
            
                
        cast('dummy_string' as varchar(4096)) as column_state_id

,
                
        cast('dummy_string' as varchar(4096)) as full_column_name

,
                
        cast('dummy_string' as varchar(4096)) as full_table_name

,
                
        cast('dummy_string' as varchar(4096)) as column_name

,
                
        cast('dummy_string' as varchar(4096)) as data_type

,
                
        cast (True as boolean) as is_new

,
                cast('2091-02-17' as timestamp) as detected_at

,
                cast('2091-02-17' as timestamp) as created_at


        ) as empty_table
        where 1 = 0

  );
  
  
[0m16:01:53.994389 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_episodes
[0m16:01:53.994758 [debug] [Thread-3 (]: On model.elementary.metadata: BEGIN
[0m16:01:53.995090 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:53.995455 [info ] [Thread-2 (]: 16 of 39 START sql view model public.stg_episodes .............................. [RUN]
[0m16:01:53.995746 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:53.996137 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.elementary.dbt_tests, now model.podcast_analytics.stg_episodes)
[0m16:01:53.996479 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m16:01:53.999043 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m16:01:53.999926 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_episodes
[0m16:01:54.012423 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m16:01:54.013449 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m16:01:54.013775 [debug] [Thread-2 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m16:01:54.014017 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:54.014246 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m16:01:54.014521 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.019 seconds
[0m16:01:54.014933 [debug] [Thread-3 (]: Using postgres connection "model.elementary.metadata"
[0m16:01:54.017837 [debug] [Thread-4 (]: Using postgres connection "model.elementary.schema_columns_snapshot"
[0m16:01:54.018099 [debug] [Thread-1 (]: SQL status: SELECT 0 in 0.029 seconds
[0m16:01:54.018356 [debug] [Thread-3 (]: On model.elementary.metadata: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.metadata"} */

  
    

  create  table "podcast_analytics"."public_public"."metadata__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    '0.18.2' as dbt_pkg_version
  );
  
[0m16:01:54.018603 [debug] [Thread-4 (]: On model.elementary.schema_columns_snapshot: BEGIN
[0m16:01:54.021195 [debug] [Thread-1 (]: Using postgres connection "model.elementary.elementary_test_results"
[0m16:01:54.021625 [debug] [Thread-1 (]: On model.elementary.elementary_test_results: BEGIN
[0m16:01:54.023357 [debug] [Thread-1 (]: SQL status: BEGIN in 0.001 seconds
[0m16:01:54.023617 [debug] [Thread-4 (]: SQL status: BEGIN in 0.002 seconds
[0m16:01:54.023894 [debug] [Thread-1 (]: Using postgres connection "model.elementary.elementary_test_results"
[0m16:01:54.024183 [debug] [Thread-4 (]: Using postgres connection "model.elementary.schema_columns_snapshot"
[0m16:01:54.024465 [debug] [Thread-1 (]: On model.elementary.elementary_test_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.elementary_test_results"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'elementary_test_results__dbt_tmp160153976509'
        
      order by ordinal_position

  
[0m16:01:54.024739 [debug] [Thread-4 (]: On model.elementary.schema_columns_snapshot: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.schema_columns_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'schema_columns_snapshot__dbt_tmp160153991826'
        
      order by ordinal_position

  
[0m16:01:54.028678 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:01:54.073333 [debug] [Thread-2 (]: SQL status: BEGIN in 0.059 seconds
[0m16:01:54.073708 [debug] [Thread-1 (]: SQL status: SELECT 28 in 0.049 seconds
[0m16:01:54.077129 [debug] [Thread-3 (]: Using postgres connection "model.elementary.metadata"
[0m16:01:54.077382 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.052 seconds
[0m16:01:54.077630 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m16:01:54.080464 [debug] [Thread-1 (]: Using postgres connection "model.elementary.elementary_test_results"
[0m16:01:54.080700 [debug] [Thread-3 (]: On model.elementary.metadata: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.metadata"} */
alter table "podcast_analytics"."public_public"."metadata" rename to "metadata__dbt_backup"
[0m16:01:54.083124 [debug] [Thread-4 (]: Using postgres connection "model.elementary.schema_columns_snapshot"
[0m16:01:54.083361 [debug] [Thread-2 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m16:01:54.083591 [debug] [Thread-1 (]: On model.elementary.elementary_test_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.elementary_test_results"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'elementary_test_results'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:54.083869 [debug] [Thread-4 (]: On model.elementary.schema_columns_snapshot: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.schema_columns_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'schema_columns_snapshot'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:54.086150 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:01:54.089167 [debug] [Thread-3 (]: Using postgres connection "model.elementary.metadata"
[0m16:01:54.089424 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m16:01:54.089620 [debug] [Thread-1 (]: SQL status: SELECT 28 in 0.005 seconds
[0m16:01:54.089836 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.006 seconds
[0m16:01:54.090036 [debug] [Thread-3 (]: On model.elementary.metadata: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.metadata"} */
alter table "podcast_analytics"."public_public"."metadata__dbt_tmp" rename to "metadata"
[0m16:01:54.092560 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m16:01:54.095192 [debug] [Thread-1 (]: Using postgres connection "model.elementary.elementary_test_results"
[0m16:01:54.097948 [debug] [Thread-4 (]: Using postgres connection "model.elementary.schema_columns_snapshot"
[0m16:01:54.098249 [debug] [Thread-2 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m16:01:54.098480 [debug] [Thread-1 (]: On model.elementary.elementary_test_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.elementary_test_results"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'elementary_test_results__dbt_tmp160153976509'
        
      order by ordinal_position

  
[0m16:01:54.098705 [debug] [Thread-4 (]: On model.elementary.schema_columns_snapshot: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.schema_columns_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'schema_columns_snapshot__dbt_tmp160153991826'
        
      order by ordinal_position

  
[0m16:01:54.099000 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:54.101442 [debug] [Thread-3 (]: On model.elementary.metadata: COMMIT
[0m16:01:54.101715 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:01:54.101939 [debug] [Thread-1 (]: SQL status: SELECT 28 in 0.003 seconds
[0m16:01:54.102166 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.003 seconds
[0m16:01:54.102382 [debug] [Thread-3 (]: Using postgres connection "model.elementary.metadata"
[0m16:01:54.104871 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m16:01:54.107536 [debug] [Thread-1 (]: Using postgres connection "model.elementary.elementary_test_results"
[0m16:01:54.110458 [debug] [Thread-4 (]: Using postgres connection "model.elementary.schema_columns_snapshot"
[0m16:01:54.110729 [debug] [Thread-3 (]: On model.elementary.metadata: COMMIT
[0m16:01:54.110933 [debug] [Thread-2 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m16:01:54.111148 [debug] [Thread-1 (]: On model.elementary.elementary_test_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.elementary_test_results"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'elementary_test_results'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:54.111361 [debug] [Thread-4 (]: On model.elementary.schema_columns_snapshot: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.schema_columns_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'schema_columns_snapshot'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:54.112638 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:54.113745 [debug] [Thread-2 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m16:01:54.114075 [debug] [Thread-4 (]: SQL status: SELECT 8 in 0.002 seconds
[0m16:01:54.114278 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m16:01:54.114493 [debug] [Thread-1 (]: SQL status: SELECT 28 in 0.003 seconds
[0m16:01:54.114740 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m16:01:54.115873 [debug] [Thread-4 (]: 
    In "podcast_analytics"."public_public"."schema_columns_snapshot":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:01:54.120383 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public_public"."metadata__dbt_backup"
[0m16:01:54.123411 [debug] [Thread-1 (]: 
    In "podcast_analytics"."public_public"."elementary_test_results":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:01:54.123661 [debug] [Thread-2 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m16:01:54.124371 [debug] [Thread-4 (]: Writing runtime sql for node "model.elementary.schema_columns_snapshot"
[0m16:01:54.126662 [debug] [Thread-3 (]: Using postgres connection "model.elementary.metadata"
[0m16:01:54.127510 [debug] [Thread-1 (]: Writing runtime sql for node "model.elementary.elementary_test_results"
[0m16:01:54.127875 [debug] [Thread-3 (]: On model.elementary.metadata: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.metadata"} */
drop table if exists "podcast_analytics"."public_public"."metadata__dbt_backup" cascade
[0m16:01:54.128673 [debug] [Thread-1 (]: Using postgres connection "model.elementary.elementary_test_results"
[0m16:01:54.128984 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:01:54.129303 [debug] [Thread-4 (]: Using postgres connection "model.elementary.schema_columns_snapshot"
[0m16:01:54.129551 [debug] [Thread-1 (]: On model.elementary.elementary_test_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.elementary_test_results"} */

      
        
        
        delete from "podcast_analytics"."public_public"."elementary_test_results" as DBT_INTERNAL_DEST
        where (id) in (
            select distinct id
            from "elementary_test_results__dbt_tmp160153976509" as DBT_INTERNAL_SOURCE
        );

    

    insert into "podcast_analytics"."public_public"."elementary_test_results" ("id", "data_issue_id", "test_execution_id", "test_unique_id", "model_unique_id", "invocation_id", "detected_at", "created_at", "database_name", "schema_name", "table_name", "column_name", "test_type", "test_sub_type", "test_results_description", "owners", "tags", "test_results_query", "other", "test_name", "test_params", "severity", "status", "failures", "test_short_name", "test_alias", "result_rows", "failed_row_count")
    (
        select "id", "data_issue_id", "test_execution_id", "test_unique_id", "model_unique_id", "invocation_id", "detected_at", "created_at", "database_name", "schema_name", "table_name", "column_name", "test_type", "test_sub_type", "test_results_description", "owners", "tags", "test_results_query", "other", "test_name", "test_params", "severity", "status", "failures", "test_short_name", "test_alias", "result_rows", "failed_row_count"
        from "elementary_test_results__dbt_tmp160153976509"
    )
  
[0m16:01:54.132307 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m16:01:54.132545 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:01:54.132806 [debug] [Thread-4 (]: On model.elementary.schema_columns_snapshot: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.schema_columns_snapshot"} */

      
        
        
        delete from "podcast_analytics"."public_public"."schema_columns_snapshot" as DBT_INTERNAL_DEST
        where (column_state_id) in (
            select distinct column_state_id
            from "schema_columns_snapshot__dbt_tmp160153991826" as DBT_INTERNAL_SOURCE
        );

    

    insert into "podcast_analytics"."public_public"."schema_columns_snapshot" ("column_state_id", "full_column_name", "full_table_name", "column_name", "data_type", "is_new", "detected_at", "created_at")
    (
        select "column_state_id", "full_column_name", "full_table_name", "column_name", "data_type", "is_new", "detected_at", "created_at"
        from "schema_columns_snapshot__dbt_tmp160153991826"
    )
  
[0m16:01:54.134381 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m16:01:54.134644 [debug] [Thread-1 (]: SQL status: INSERT 0 0 in 0.002 seconds
[0m16:01:54.135352 [debug] [Thread-3 (]: On model.elementary.metadata: Close
[0m16:01:54.135603 [debug] [Thread-2 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m16:01:54.136539 [debug] [Thread-1 (]: On model.elementary.elementary_test_results: COMMIT
[0m16:01:54.136775 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m16:01:54.137182 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b6ebc0>]}
[0m16:01:54.137422 [debug] [Thread-1 (]: Using postgres connection "model.elementary.elementary_test_results"
[0m16:01:54.138305 [debug] [Thread-4 (]: On model.elementary.schema_columns_snapshot: COMMIT
[0m16:01:54.138558 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:01:54.138970 [info ] [Thread-3 (]: 14 of 39 OK created sql table model public_public.metadata ..................... [[32mSELECT 1[0m in 0.18s]
[0m16:01:54.139246 [debug] [Thread-1 (]: On model.elementary.elementary_test_results: COMMIT
[0m16:01:54.139518 [debug] [Thread-4 (]: Using postgres connection "model.elementary.schema_columns_snapshot"
[0m16:01:54.140280 [debug] [Thread-2 (]: On model.podcast_analytics.stg_episodes: Close
[0m16:01:54.140591 [debug] [Thread-3 (]: Finished running node model.elementary.metadata
[0m16:01:54.140847 [debug] [Thread-4 (]: On model.elementary.schema_columns_snapshot: COMMIT
[0m16:01:54.141211 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060824d0>]}
[0m16:01:54.141525 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events
[0m16:01:54.141922 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:01:54.142474 [info ] [Thread-2 (]: 16 of 39 OK created sql view model public.stg_episodes ......................... [[32mCREATE VIEW[0m in 0.15s]
[0m16:01:54.142785 [info ] [Thread-3 (]: 17 of 39 START sql view model public.stg_user_events ........................... [RUN]
[0m16:01:54.143441 [debug] [Thread-1 (]: On model.elementary.elementary_test_results: Close
[0m16:01:54.143694 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:01:54.144057 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_episodes
[0m16:01:54.144392 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.elementary.metadata, now model.podcast_analytics.stg_user_events)
[0m16:01:54.145064 [debug] [Thread-4 (]: On model.elementary.schema_columns_snapshot: Close
[0m16:01:54.145417 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df80a0>]}
[0m16:01:54.145757 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m16:01:54.146170 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m16:01:54.146641 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3d51b0>]}
[0m16:01:54.147044 [info ] [Thread-1 (]: 13 of 39 OK created sql incremental model public_public.elementary_test_results  [[32mINSERT 0 0[0m in 0.20s]
[0m16:01:54.147333 [info ] [Thread-2 (]: 18 of 39 START sql view model public.stg_user_events_invalid ................... [RUN]
[0m16:01:54.157720 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m16:01:54.158756 [debug] [Thread-1 (]: Finished running node model.elementary.elementary_test_results
[0m16:01:54.158395 [info ] [Thread-4 (]: 15 of 39 OK created sql incremental model public_public.schema_columns_snapshot  [[32mINSERT 0 0[0m in 0.19s]
[0m16:01:54.159141 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.stg_user_events_invalid)
[0m16:01:54.159556 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_users
[0m16:01:54.160031 [debug] [Thread-4 (]: Finished running node model.elementary.schema_columns_snapshot
[0m16:01:54.160266 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m16:01:54.160550 [info ] [Thread-1 (]: 19 of 39 START sql view model public.stg_users ................................. [RUN]
[0m16:01:54.160784 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events
[0m16:01:54.161016 [debug] [Thread-4 (]: Began running node model.elementary.job_run_results
[0m16:01:54.163564 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m16:01:54.163878 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elementary.elementary_test_results, now model.podcast_analytics.stg_users)
[0m16:01:54.168106 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m16:01:54.168496 [info ] [Thread-4 (]: 20 of 39 START sql view model public_public.job_run_results .................... [RUN]
[0m16:01:54.168841 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_users
[0m16:01:54.169274 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.elementary.schema_columns_snapshot, now model.elementary.job_run_results)
[0m16:01:54.169572 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m16:01:54.172133 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m16:01:54.172470 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m16:01:54.172773 [debug] [Thread-4 (]: Began compiling node model.elementary.job_run_results
[0m16:01:54.175879 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events_invalid"
[0m16:01:54.176364 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m16:01:54.188337 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_users
[0m16:01:54.191053 [debug] [Thread-4 (]: Writing injected SQL for node "model.elementary.job_run_results"
[0m16:01:54.191438 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:54.194572 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m16:01:54.194948 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m16:01:54.195479 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events_invalid: BEGIN
[0m16:01:54.195769 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:54.196196 [debug] [Thread-4 (]: Began executing node model.elementary.job_run_results
[0m16:01:54.200258 [debug] [Thread-4 (]: Writing runtime sql for node "model.elementary.job_run_results"
[0m16:01:54.200572 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m16:01:54.200955 [debug] [Thread-1 (]: On model.podcast_analytics.stg_users: BEGIN
[0m16:01:54.201201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:54.201592 [debug] [Thread-4 (]: Using postgres connection "model.elementary.job_run_results"
[0m16:01:54.201875 [debug] [Thread-4 (]: On model.elementary.job_run_results: BEGIN
[0m16:01:54.202163 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:54.210466 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m16:01:54.210851 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m16:01:54.211133 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
-- Note: Invalid events are captured in stg_user_events_invalid.sql for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

valid_events as (
    select * from source
    where data ->> 'event_type' is not null
      and data ->> 'event_type' in ('play', 'pause', 'seek', 'complete')
      and data ->> 'timestamp' is not null
      and data ->> 'timestamp' != ''
      and data ->> 'user_id' is not null
      and data ->> 'episode_id' is not null
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'timestamp' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'event_type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        case 
            when (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}' then (data ->> 'timestamp')::timestamp
            else null
        end as event_ts,
        data ->> 'event_type'         as event_type,
        (data ->> 'duration')::integer as duration
    from valid_events
    where (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}'
)
select * from typed
  );
[0m16:01:54.212800 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m16:01:54.213121 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m16:01:54.213391 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */

  create view "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp"
    
    
  as (
    -- stg_user_events_invalid.sql : capture invalid event records for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

invalid_events as (
    select 
        data,
        data ->> 'user_id' as user_id,
        data ->> 'episode_id' as episode_id,
        data ->> 'timestamp' as timestamp,
        data ->> 'event_type' as event_type,
        data ->> 'duration' as duration,
        case 
            when data ->> 'event_type' is null then 'missing_event_type'
            when data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete') then 'invalid_event_type'
            when data ->> 'timestamp' is null or data ->> 'timestamp' = '' then 'missing_timestamp'
            when not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}') then 'malformed_timestamp'
            when data ->> 'user_id' is null then 'missing_user_id'
            when data ->> 'episode_id' is null then 'missing_episode_id'
            else 'other_issue'
        end as issue_type
    from source
    where data ->> 'event_type' is null 
       or data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete')
       or data ->> 'timestamp' is null 
       or data ->> 'timestamp' = ''
       or not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}')
       or data ->> 'user_id' is null
       or data ->> 'episode_id' is null
)

select * from invalid_events
  );
[0m16:01:54.215260 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:01:54.218248 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m16:01:54.218544 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m16:01:54.218859 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m16:01:54.221561 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m16:01:54.221823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m16:01:54.222037 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m16:01:54.222297 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid" rename to "stg_user_events_invalid__dbt_backup"
[0m16:01:54.222512 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m16:01:54.222720 [debug] [Thread-4 (]: Using postgres connection "model.elementary.job_run_results"
[0m16:01:54.222973 [debug] [Thread-1 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m16:01:54.223193 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:54.223441 [debug] [Thread-4 (]: On model.elementary.job_run_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.job_run_results"} */

  create view "podcast_analytics"."public_public"."job_run_results__dbt_tmp"
    
    
  as (
    





with jobs as (
  select
    job_name,
    job_id,
    job_run_id,
    
min(cast(run_started_at as timestamp))
 as job_run_started_at,
    
max(cast(run_completed_at as timestamp))
 as job_run_completed_at,
    
    
        (
        (
        (
        ((
max(cast(run_completed_at as timestamp))
)::date - (
min(cast(run_started_at as timestamp))
)::date)
     * 24 + date_part('hour', (
max(cast(run_completed_at as timestamp))
)::timestamp) - date_part('hour', (
min(cast(run_started_at as timestamp))
)::timestamp))
     * 60 + date_part('minute', (
max(cast(run_completed_at as timestamp))
)::timestamp) - date_part('minute', (
min(cast(run_started_at as timestamp))
)::timestamp))
     * 60 + floor(date_part('second', (
max(cast(run_completed_at as timestamp))
)::timestamp)) - floor(date_part('second', (
min(cast(run_started_at as timestamp))
)::timestamp)))
    
 as job_run_execution_time
  from "podcast_analytics"."public_public"."dbt_invocations"
  where job_id is not null
  group by job_name, job_id, job_run_id
)

select
  job_name as name,
  job_id as id,
  job_run_id as run_id,
  job_run_started_at as run_started_at,
  job_run_completed_at as run_completed_at,
  job_run_execution_time as run_execution_time
from jobs
  );
[0m16:01:54.223668 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:54.226582 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m16:01:54.226835 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:01:54.229500 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m16:01:54.229755 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m16:01:54.232230 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m16:01:54.232535 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp" rename to "stg_user_events_invalid"
[0m16:01:54.232786 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m16:01:54.233055 [debug] [Thread-1 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m16:01:54.236431 [debug] [Thread-4 (]: Using postgres connection "model.elementary.job_run_results"
[0m16:01:54.236698 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:01:54.236960 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:01:54.237231 [debug] [Thread-4 (]: On model.elementary.job_run_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.job_run_results"} */
alter table "podcast_analytics"."public_public"."job_run_results" rename to "job_run_results__dbt_backup"
[0m16:01:54.238230 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m16:01:54.239045 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m16:01:54.239240 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:01:54.239515 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m16:01:54.239811 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m16:01:54.242322 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m16:01:54.242554 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:01:54.242795 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m16:01:54.243010 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m16:01:54.243212 [debug] [Thread-1 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m16:01:54.245754 [debug] [Thread-4 (]: Using postgres connection "model.elementary.job_run_results"
[0m16:01:54.246152 [debug] [Thread-4 (]: On model.elementary.job_run_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.job_run_results"} */
alter table "podcast_analytics"."public_public"."job_run_results__dbt_tmp" rename to "job_run_results"
[0m16:01:54.246650 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:54.247560 [debug] [Thread-1 (]: On model.podcast_analytics.stg_users: COMMIT
[0m16:01:54.247807 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:54.248052 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m16:01:54.248276 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m16:01:54.248478 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m16:01:54.249411 [debug] [Thread-4 (]: On model.elementary.job_run_results: COMMIT
[0m16:01:54.252108 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup"
[0m16:01:54.254206 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m16:01:54.254430 [debug] [Thread-1 (]: On model.podcast_analytics.stg_users: COMMIT
[0m16:01:54.254647 [debug] [Thread-4 (]: Using postgres connection "model.elementary.job_run_results"
[0m16:01:54.255087 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m16:01:54.255499 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m16:01:54.255742 [debug] [Thread-4 (]: On model.elementary.job_run_results: COMMIT
[0m16:01:54.255951 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
drop view if exists "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup" cascade
[0m16:01:54.256171 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m16:01:54.256482 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:01:54.258701 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m16:01:54.258969 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m16:01:54.259192 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:01:54.259435 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:01:54.259907 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m16:01:54.302644 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public_public"."job_run_results__dbt_backup"
[0m16:01:54.303524 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events_invalid: Close
[0m16:01:54.304160 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events: Close
[0m16:01:54.304372 [debug] [Thread-1 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m16:01:54.304802 [debug] [Thread-4 (]: Using postgres connection "model.elementary.job_run_results"
[0m16:01:54.305171 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0b9f30>]}
[0m16:01:54.305541 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c54a530>]}
[0m16:01:54.305852 [debug] [Thread-4 (]: On model.elementary.job_run_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.job_run_results"} */
drop view if exists "podcast_analytics"."public_public"."job_run_results__dbt_backup" cascade
[0m16:01:54.306301 [info ] [Thread-2 (]: 18 of 39 OK created sql view model public.stg_user_events_invalid .............. [[32mCREATE VIEW[0m in 0.15s]
[0m16:01:54.306685 [info ] [Thread-3 (]: 17 of 39 OK created sql view model public.stg_user_events ...................... [[32mCREATE VIEW[0m in 0.16s]
[0m16:01:54.307141 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m16:01:54.307492 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events
[0m16:01:54.307787 [debug] [Thread-2 (]: Began running node model.elementary.metrics_anomaly_score
[0m16:01:54.308022 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:01:54.308296 [debug] [Thread-3 (]: Began running node model.elementary.monitors_runs
[0m16:01:54.308565 [info ] [Thread-2 (]: 21 of 39 START sql view model public_public.metrics_anomaly_score .............. [RUN]
[0m16:01:54.309385 [debug] [Thread-1 (]: On model.podcast_analytics.stg_users: Close
[0m16:01:54.309968 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:01:54.309764 [info ] [Thread-3 (]: 22 of 39 START sql view model public_public.monitors_runs ...................... [RUN]
[0m16:01:54.310255 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now model.elementary.metrics_anomaly_score)
[0m16:01:54.310616 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c54a200>]}
[0m16:01:54.311495 [debug] [Thread-4 (]: On model.elementary.job_run_results: Close
[0m16:01:54.311805 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now model.elementary.monitors_runs)
[0m16:01:54.312099 [debug] [Thread-2 (]: Began compiling node model.elementary.metrics_anomaly_score
[0m16:01:54.312548 [info ] [Thread-1 (]: 19 of 39 OK created sql view model public.stg_users ............................ [[32mCREATE VIEW[0m in 0.15s]
[0m16:01:54.313042 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c54b6d0>]}
[0m16:01:54.313282 [debug] [Thread-3 (]: Began compiling node model.elementary.monitors_runs
[0m16:01:54.327724 [debug] [Thread-2 (]: Writing injected SQL for node "model.elementary.metrics_anomaly_score"
[0m16:01:54.328235 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_users
[0m16:01:54.328711 [info ] [Thread-4 (]: 20 of 39 OK created sql view model public_public.job_run_results ............... [[32mCREATE VIEW[0m in 0.14s]
[0m16:01:54.331622 [debug] [Thread-3 (]: Writing injected SQL for node "model.elementary.monitors_runs"
[0m16:01:54.332047 [debug] [Thread-1 (]: Began running node model.elementary.model_run_results
[0m16:01:54.332470 [debug] [Thread-4 (]: Finished running node model.elementary.job_run_results
[0m16:01:54.332801 [debug] [Thread-2 (]: Began executing node model.elementary.metrics_anomaly_score
[0m16:01:54.333093 [info ] [Thread-1 (]: 23 of 39 START sql view model public_public.model_run_results .................. [RUN]
[0m16:01:54.333388 [debug] [Thread-4 (]: Began running node model.elementary.seed_run_results
[0m16:01:54.333577 [debug] [Thread-3 (]: Began executing node model.elementary.monitors_runs
[0m16:01:54.338049 [debug] [Thread-2 (]: Writing runtime sql for node "model.elementary.metrics_anomaly_score"
[0m16:01:54.338440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_users, now model.elementary.model_run_results)
[0m16:01:54.342402 [debug] [Thread-3 (]: Writing runtime sql for node "model.elementary.monitors_runs"
[0m16:01:54.338816 [info ] [Thread-4 (]: 24 of 39 START sql view model public_public.seed_run_results ................... [RUN]
[0m16:01:54.342962 [debug] [Thread-1 (]: Began compiling node model.elementary.model_run_results
[0m16:01:54.343404 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.elementary.job_run_results, now model.elementary.seed_run_results)
[0m16:01:54.343705 [debug] [Thread-2 (]: Using postgres connection "model.elementary.metrics_anomaly_score"
[0m16:01:54.348863 [debug] [Thread-1 (]: Writing injected SQL for node "model.elementary.model_run_results"
[0m16:01:54.349208 [debug] [Thread-3 (]: Using postgres connection "model.elementary.monitors_runs"
[0m16:01:54.349494 [debug] [Thread-4 (]: Began compiling node model.elementary.seed_run_results
[0m16:01:54.349735 [debug] [Thread-2 (]: On model.elementary.metrics_anomaly_score: BEGIN
[0m16:01:54.349987 [debug] [Thread-3 (]: On model.elementary.monitors_runs: BEGIN
[0m16:01:54.353872 [debug] [Thread-4 (]: Writing injected SQL for node "model.elementary.seed_run_results"
[0m16:01:54.354214 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:54.354431 [debug] [Thread-1 (]: Began executing node model.elementary.model_run_results
[0m16:01:54.354630 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:54.358368 [debug] [Thread-1 (]: Writing runtime sql for node "model.elementary.model_run_results"
[0m16:01:54.359037 [debug] [Thread-4 (]: Began executing node model.elementary.seed_run_results
[0m16:01:54.363193 [debug] [Thread-4 (]: Writing runtime sql for node "model.elementary.seed_run_results"
[0m16:01:54.363696 [debug] [Thread-1 (]: Using postgres connection "model.elementary.model_run_results"
[0m16:01:54.364012 [debug] [Thread-1 (]: On model.elementary.model_run_results: BEGIN
[0m16:01:54.364266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:54.364529 [debug] [Thread-4 (]: Using postgres connection "model.elementary.seed_run_results"
[0m16:01:54.364820 [debug] [Thread-4 (]: On model.elementary.seed_run_results: BEGIN
[0m16:01:54.365008 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:54.367913 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m16:01:54.368214 [debug] [Thread-2 (]: Using postgres connection "model.elementary.metrics_anomaly_score"
[0m16:01:54.368523 [debug] [Thread-2 (]: On model.elementary.metrics_anomaly_score: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.metrics_anomaly_score"} */

  create view "podcast_analytics"."public_public"."metrics_anomaly_score__dbt_tmp"
    
    
  as (
    

with data_monitoring_metrics as (

    select * from "podcast_analytics"."public_public"."data_monitoring_metrics"

),

time_window_aggregation as (

    select
        id,
        full_table_name,
        column_name,
        dimension,
        dimension_value,
        metric_name,
        metric_value,
        source_value,
        bucket_start,
        bucket_end,
        bucket_duration_hours,
        updated_at,
        avg(metric_value) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) as training_avg,
        stddev(metric_value) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) as training_stddev,
        count(metric_value) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) as training_set_size,
        last_value(bucket_end) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) training_end,
        first_value(bucket_end) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) as training_start
    from data_monitoring_metrics
    group by 1,2,3,4,5,6,7,8,9,10,11,12
),

metrics_anomaly_score as (

    select
        id,
        full_table_name,
        column_name,
        dimension,
        dimension_value,
        metric_name,
        case
            when training_stddev is null then null
            when training_stddev = 0 then 0
            else (metric_value - training_avg) / (training_stddev)
        end as anomaly_score,
        metric_value as latest_metric_value,
        bucket_start,
        bucket_end,
        training_avg,
        training_stddev,
        training_start,
        training_end,
        training_set_size,
        max(updated_at) as updated_at
    from time_window_aggregation
        where
            metric_value is not null
            and training_avg is not null
            and bucket_end >= 
    cast(date_trunc('day', 
    current_timestamp::timestamp
) as timestamp) + cast(-7 as integer) * INTERVAL '1 day'

    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
    order by bucket_end desc


),

final as (

    select
        id,
        full_table_name,
        column_name,
        dimension,
        dimension_value,
        metric_name,
        anomaly_score,
        latest_metric_value,
        bucket_start,
        bucket_end,
        training_avg,
        training_stddev,
        training_start,
        training_end,
        training_set_size,
        updated_at,
        case
            when abs(anomaly_score) > 3 then true
            else false end
        as is_anomaly
    from metrics_anomaly_score
)

select * from final
  );
[0m16:01:54.370479 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m16:01:54.370763 [debug] [Thread-3 (]: Using postgres connection "model.elementary.monitors_runs"
[0m16:01:54.371011 [debug] [Thread-3 (]: On model.elementary.monitors_runs: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.monitors_runs"} */

  create view "podcast_analytics"."public_public"."monitors_runs__dbt_tmp"
    
    
  as (
    

with data_monitoring_metrics as (

    select * from "podcast_analytics"."public_public"."data_monitoring_metrics"

),

max_bucket_end as (

    select full_table_name,
           column_name,
           metric_name,
           metric_properties,
           max(bucket_end) as last_bucket_end,
           min(bucket_end) as first_bucket_end
    from data_monitoring_metrics
    group by 1,2,3,4

)

select * from max_bucket_end
  );
[0m16:01:54.374326 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m16:01:54.374610 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m16:01:54.377636 [debug] [Thread-3 (]: Using postgres connection "model.elementary.monitors_runs"
[0m16:01:54.380681 [debug] [Thread-2 (]: Using postgres connection "model.elementary.metrics_anomaly_score"
[0m16:01:54.381018 [debug] [Thread-3 (]: On model.elementary.monitors_runs: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.monitors_runs"} */
alter table "podcast_analytics"."public_public"."monitors_runs" rename to "monitors_runs__dbt_backup"
[0m16:01:54.381277 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m16:01:54.381498 [debug] [Thread-2 (]: On model.elementary.metrics_anomaly_score: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.metrics_anomaly_score"} */
alter table "podcast_analytics"."public_public"."metrics_anomaly_score" rename to "metrics_anomaly_score__dbt_backup"
[0m16:01:54.381955 [debug] [Thread-4 (]: Using postgres connection "model.elementary.seed_run_results"
[0m16:01:54.382290 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m16:01:54.382553 [debug] [Thread-4 (]: On model.elementary.seed_run_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.seed_run_results"} */

  create view "podcast_analytics"."public_public"."seed_run_results__dbt_tmp"
    
    
  as (
    

with dbt_run_results as (
    select * from "podcast_analytics"."public_public"."dbt_run_results"
),

dbt_seeds as (
    select * from "podcast_analytics"."public_public"."dbt_seeds"
)

SELECT
    run_results.model_execution_id,
    run_results.unique_id,
    run_results.invocation_id,
    run_results.query_id,
    run_results.name,
    run_results.generated_at,
    run_results.status,
    run_results.full_refresh,
    run_results.message,
    run_results.execution_time,
    run_results.execute_started_at,
    run_results.execute_completed_at,
    run_results.compile_started_at,
    run_results.compile_completed_at,
    run_results.compiled_code,
    run_results.adapter_response,
    run_results.thread_id,
    seeds.database_name,
    seeds.schema_name,
    run_results.materialization,
    seeds.tags,
    seeds.package_name,
    seeds.path,
    seeds.original_path,
    seeds.owner,
    seeds.alias
FROM dbt_run_results run_results
JOIN dbt_seeds seeds ON run_results.unique_id = seeds.unique_id
  );
[0m16:01:54.382811 [debug] [Thread-1 (]: Using postgres connection "model.elementary.model_run_results"
[0m16:01:54.383029 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:54.383278 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:54.383618 [debug] [Thread-1 (]: On model.elementary.model_run_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.model_run_results"} */

  create view "podcast_analytics"."public_public"."model_run_results__dbt_tmp"
    
    
  as (
    

with dbt_run_results as (
    select * from "podcast_analytics"."public_public"."dbt_run_results"
),

dbt_models as (
    select * from "podcast_analytics"."public_public"."dbt_models"
)

SELECT
    run_results.model_execution_id,
    run_results.unique_id,
    run_results.invocation_id,
    run_results.query_id,
    run_results.name,
    run_results.generated_at,
    run_results.status,
    run_results.full_refresh,
    run_results.message,
    run_results.execution_time,
    run_results.execute_started_at,
    run_results.execute_completed_at,
    run_results.compile_started_at,
    run_results.compile_completed_at,
    run_results.compiled_code,
    run_results.adapter_response,
    run_results.thread_id,
    models.database_name,
    models.schema_name,
    coalesce(run_results.materialization, models.materialization) as materialization,
    models.tags,
    models.package_name,
    models.path,
    models.original_path,
    models.owner,
    models.alias,
    ROW_NUMBER() OVER (PARTITION BY run_results.unique_id ORDER BY run_results.generated_at DESC) AS model_invocation_reverse_index,
    CASE WHEN FIRST_VALUE(invocation_id) OVER (PARTITION BY 
    date_trunc('day', cast(run_results.generated_at as timestamp))
 ORDER BY run_results.generated_at ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING ) = invocation_id
              THEN TRUE
              ELSE FALSE 
         END                                                               AS is_the_first_invocation_of_the_day,
    CASE WHEN LAST_VALUE(invocation_id) OVER (PARTITION BY 
    date_trunc('day', cast(run_results.generated_at as timestamp))
 ORDER BY run_results.generated_at ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING ) = invocation_id
              THEN TRUE
              ELSE FALSE 
         END                                                               AS is_the_last_invocation_of_the_day
    
FROM dbt_run_results run_results
JOIN dbt_models models ON run_results.unique_id = models.unique_id
  );
[0m16:01:54.386045 [debug] [Thread-3 (]: Using postgres connection "model.elementary.monitors_runs"
[0m16:01:54.388874 [debug] [Thread-2 (]: Using postgres connection "model.elementary.metrics_anomaly_score"
[0m16:01:54.389120 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m16:01:54.389490 [debug] [Thread-3 (]: On model.elementary.monitors_runs: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.monitors_runs"} */
alter table "podcast_analytics"."public_public"."monitors_runs__dbt_tmp" rename to "monitors_runs"
[0m16:01:54.389802 [debug] [Thread-2 (]: On model.elementary.metrics_anomaly_score: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.metrics_anomaly_score"} */
alter table "podcast_analytics"."public_public"."metrics_anomaly_score__dbt_tmp" rename to "metrics_anomaly_score"
[0m16:01:54.392377 [debug] [Thread-4 (]: Using postgres connection "model.elementary.seed_run_results"
[0m16:01:54.392706 [debug] [Thread-4 (]: On model.elementary.seed_run_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.seed_run_results"} */
alter table "podcast_analytics"."public_public"."seed_run_results" rename to "seed_run_results__dbt_backup"
[0m16:01:54.393447 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:01:54.393724 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:54.393952 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:54.397344 [debug] [Thread-1 (]: Using postgres connection "model.elementary.model_run_results"
[0m16:01:54.397564 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m16:01:54.398452 [debug] [Thread-3 (]: On model.elementary.monitors_runs: COMMIT
[0m16:01:54.399246 [debug] [Thread-2 (]: On model.elementary.metrics_anomaly_score: COMMIT
[0m16:01:54.399460 [debug] [Thread-1 (]: On model.elementary.model_run_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.model_run_results"} */
alter table "podcast_analytics"."public_public"."model_run_results" rename to "model_run_results__dbt_backup"
[0m16:01:54.401726 [debug] [Thread-4 (]: Using postgres connection "model.elementary.seed_run_results"
[0m16:01:54.401936 [debug] [Thread-3 (]: Using postgres connection "model.elementary.monitors_runs"
[0m16:01:54.402124 [debug] [Thread-2 (]: Using postgres connection "model.elementary.metrics_anomaly_score"
[0m16:01:54.402375 [debug] [Thread-4 (]: On model.elementary.seed_run_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.seed_run_results"} */
alter table "podcast_analytics"."public_public"."seed_run_results__dbt_tmp" rename to "seed_run_results"
[0m16:01:54.402686 [debug] [Thread-3 (]: On model.elementary.monitors_runs: COMMIT
[0m16:01:54.402955 [debug] [Thread-2 (]: On model.elementary.metrics_anomaly_score: COMMIT
[0m16:01:54.403561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:54.406048 [debug] [Thread-1 (]: Using postgres connection "model.elementary.model_run_results"
[0m16:01:54.406327 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:01:54.406573 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m16:01:54.406789 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m16:01:54.407011 [debug] [Thread-1 (]: On model.elementary.model_run_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.model_run_results"} */
alter table "podcast_analytics"."public_public"."model_run_results__dbt_tmp" rename to "model_run_results"
[0m16:01:54.407987 [debug] [Thread-4 (]: On model.elementary.seed_run_results: COMMIT
[0m16:01:54.410837 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public_public"."metrics_anomaly_score__dbt_backup"
[0m16:01:54.412856 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public_public"."monitors_runs__dbt_backup"
[0m16:01:54.413132 [debug] [Thread-4 (]: Using postgres connection "model.elementary.seed_run_results"
[0m16:01:54.413607 [debug] [Thread-2 (]: Using postgres connection "model.elementary.metrics_anomaly_score"
[0m16:01:54.414059 [debug] [Thread-3 (]: Using postgres connection "model.elementary.monitors_runs"
[0m16:01:54.414266 [debug] [Thread-4 (]: On model.elementary.seed_run_results: COMMIT
[0m16:01:54.414450 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:54.414649 [debug] [Thread-2 (]: On model.elementary.metrics_anomaly_score: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.metrics_anomaly_score"} */
drop view if exists "podcast_analytics"."public_public"."metrics_anomaly_score__dbt_backup" cascade
[0m16:01:54.414846 [debug] [Thread-3 (]: On model.elementary.monitors_runs: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.monitors_runs"} */
drop view if exists "podcast_analytics"."public_public"."monitors_runs__dbt_backup" cascade
[0m16:01:54.415864 [debug] [Thread-1 (]: On model.elementary.model_run_results: COMMIT
[0m16:01:54.416112 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:01:54.416426 [debug] [Thread-1 (]: Using postgres connection "model.elementary.model_run_results"
[0m16:01:54.418695 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public_public"."seed_run_results__dbt_backup"
[0m16:01:54.418962 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:01:54.419195 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:01:54.419410 [debug] [Thread-1 (]: On model.elementary.model_run_results: COMMIT
[0m16:01:54.419906 [debug] [Thread-4 (]: Using postgres connection "model.elementary.seed_run_results"
[0m16:01:54.420681 [debug] [Thread-3 (]: On model.elementary.monitors_runs: Close
[0m16:01:54.421405 [debug] [Thread-2 (]: On model.elementary.metrics_anomaly_score: Close
[0m16:01:54.421660 [debug] [Thread-4 (]: On model.elementary.seed_run_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.seed_run_results"} */
drop view if exists "podcast_analytics"."public_public"."seed_run_results__dbt_backup" cascade
[0m16:01:54.422066 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3ec100>]}
[0m16:01:54.422526 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:01:54.422813 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0eaa0>]}
[0m16:01:54.423280 [info ] [Thread-3 (]: 22 of 39 OK created sql view model public_public.monitors_runs ................. [[32mCREATE VIEW[0m in 0.11s]
[0m16:01:54.426286 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public_public"."model_run_results__dbt_backup"
[0m16:01:54.426629 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:01:54.426945 [info ] [Thread-2 (]: 21 of 39 OK created sql view model public_public.metrics_anomaly_score ......... [[32mCREATE VIEW[0m in 0.11s]
[0m16:01:54.427403 [debug] [Thread-3 (]: Finished running node model.elementary.monitors_runs
[0m16:01:54.427945 [debug] [Thread-1 (]: Using postgres connection "model.elementary.model_run_results"
[0m16:01:54.428795 [debug] [Thread-4 (]: On model.elementary.seed_run_results: Close
[0m16:01:54.429134 [debug] [Thread-2 (]: Finished running node model.elementary.metrics_anomaly_score
[0m16:01:54.429428 [debug] [Thread-3 (]: Began running node model.elementary.alerts_dbt_source_freshness
[0m16:01:54.429717 [debug] [Thread-1 (]: On model.elementary.model_run_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.model_run_results"} */
drop view if exists "podcast_analytics"."public_public"."model_run_results__dbt_backup" cascade
[0m16:01:54.429995 [debug] [Thread-2 (]: Began running node model.elementary.snapshot_run_results
[0m16:01:54.430330 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0bd5a0>]}
[0m16:01:54.430724 [info ] [Thread-3 (]: 25 of 39 START sql view model public_public.alerts_dbt_source_freshness ........ [RUN]
[0m16:01:54.431188 [info ] [Thread-2 (]: 26 of 39 START sql view model public_public.snapshot_run_results ............... [RUN]
[0m16:01:54.431917 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.elementary.monitors_runs, now model.elementary.alerts_dbt_source_freshness)
[0m16:01:54.432322 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.elementary.metrics_anomaly_score, now model.elementary.snapshot_run_results)
[0m16:01:54.432747 [debug] [Thread-3 (]: Began compiling node model.elementary.alerts_dbt_source_freshness
[0m16:01:54.433002 [debug] [Thread-2 (]: Began compiling node model.elementary.snapshot_run_results
[0m16:01:54.437486 [debug] [Thread-3 (]: Writing injected SQL for node "model.elementary.alerts_dbt_source_freshness"
[0m16:01:54.437825 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m16:01:54.441032 [debug] [Thread-2 (]: Writing injected SQL for node "model.elementary.snapshot_run_results"
[0m16:01:54.442272 [debug] [Thread-1 (]: On model.elementary.model_run_results: Close
[0m16:01:54.442626 [debug] [Thread-3 (]: Began executing node model.elementary.alerts_dbt_source_freshness
[0m16:01:54.443048 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4ff10>]}
[0m16:01:54.447565 [debug] [Thread-3 (]: Writing runtime sql for node "model.elementary.alerts_dbt_source_freshness"
[0m16:01:54.448094 [debug] [Thread-2 (]: Began executing node model.elementary.snapshot_run_results
[0m16:01:54.451857 [debug] [Thread-2 (]: Writing runtime sql for node "model.elementary.snapshot_run_results"
[0m16:01:54.452316 [debug] [Thread-2 (]: Using postgres connection "model.elementary.snapshot_run_results"
[0m16:01:54.452594 [debug] [Thread-3 (]: Using postgres connection "model.elementary.alerts_dbt_source_freshness"
[0m16:01:54.452843 [debug] [Thread-2 (]: On model.elementary.snapshot_run_results: BEGIN
[0m16:01:54.453068 [debug] [Thread-3 (]: On model.elementary.alerts_dbt_source_freshness: BEGIN
[0m16:01:54.453362 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:54.453607 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:54.467029 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m16:01:54.467380 [debug] [Thread-3 (]: Using postgres connection "model.elementary.alerts_dbt_source_freshness"
[0m16:01:54.467597 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m16:01:54.467858 [debug] [Thread-3 (]: On model.elementary.alerts_dbt_source_freshness: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_dbt_source_freshness"} */

  create view "podcast_analytics"."public_public"."alerts_dbt_source_freshness__dbt_tmp"
    
    
  as (
    

with results as (
  select * from "podcast_analytics"."public_public"."dbt_source_freshness_results"
),

sources as (
  select * from "podcast_analytics"."public_public"."dbt_sources"
)

select
  results.source_freshness_execution_id as alert_id,
  results.max_loaded_at,
  results.snapshotted_at,
  cast(results.generated_at as timestamp) as detected_at,
  results.max_loaded_at_time_ago_in_s,
  results.status,
  results.error,
  results.warn_after,
  results.error_after,
  results.filter,
  sources.unique_id,
  sources.database_name,
  sources.schema_name,
  sources.source_name,
  sources.identifier,
  sources.tags,
  sources.meta,
  sources.owner,
  sources.package_name,
  sources.path,
  -- These columns below are deprecated. We add them since this view
  -- was used to be loaded into an incremental model with those columns, their names were later changed
  -- and Databricks doesn't respect `on_schema_change = 'append_new_columns'` properly, as described here -
  -- https://docs.databricks.com/en/delta/update-schema.html#automatic-schema-evolution-for-delta-lake-merge
  results.error_after as freshness_error_after,
  results.warn_after as freshness_warn_after,
  results.filter as freshness_filter
from results
join sources on results.unique_id = sources.unique_id
where True and lower(status) != 'pass'
  );
[0m16:01:54.468118 [debug] [Thread-2 (]: Using postgres connection "model.elementary.snapshot_run_results"
[0m16:01:54.468403 [debug] [Thread-2 (]: On model.elementary.snapshot_run_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.snapshot_run_results"} */

  create view "podcast_analytics"."public_public"."snapshot_run_results__dbt_tmp"
    
    
  as (
    

with dbt_run_results as (
    select * from "podcast_analytics"."public_public"."dbt_run_results"
),

dbt_snapshots as (
    select * from "podcast_analytics"."public_public"."dbt_snapshots"
)

SELECT
    run_results.model_execution_id,
    run_results.unique_id,
    run_results.invocation_id,
    run_results.query_id,
    run_results.name,
    run_results.generated_at,
    run_results.status,
    run_results.full_refresh,
    run_results.message,
    run_results.execution_time,
    run_results.execute_started_at,
    run_results.execute_completed_at,
    run_results.compile_started_at,
    run_results.compile_completed_at,
    run_results.compiled_code,
    run_results.adapter_response,
    run_results.thread_id,
    snapshots.database_name,
    snapshots.schema_name,
    coalesce(run_results.materialization, snapshots.materialization) as materialization,
    snapshots.tags,
    snapshots.package_name,
    snapshots.path,
    snapshots.original_path,
    snapshots.owner,
    snapshots.alias
FROM dbt_run_results run_results
JOIN dbt_snapshots snapshots ON run_results.unique_id = snapshots.unique_id
  );
[0m16:01:54.472732 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:01:54.475755 [debug] [Thread-3 (]: Using postgres connection "model.elementary.alerts_dbt_source_freshness"
[0m16:01:54.475984 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:01:54.476292 [debug] [Thread-3 (]: On model.elementary.alerts_dbt_source_freshness: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_dbt_source_freshness"} */
alter table "podcast_analytics"."public_public"."alerts_dbt_source_freshness" rename to "alerts_dbt_source_freshness__dbt_backup"
[0m16:01:54.479886 [debug] [Thread-2 (]: Using postgres connection "model.elementary.snapshot_run_results"
[0m16:01:54.480206 [debug] [Thread-2 (]: On model.elementary.snapshot_run_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.snapshot_run_results"} */
alter table "podcast_analytics"."public_public"."snapshot_run_results" rename to "snapshot_run_results__dbt_backup"
[0m16:01:54.481176 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:54.481412 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:54.483958 [debug] [Thread-3 (]: Using postgres connection "model.elementary.alerts_dbt_source_freshness"
[0m16:01:54.486296 [debug] [Thread-2 (]: Using postgres connection "model.elementary.snapshot_run_results"
[0m16:01:54.486594 [debug] [Thread-3 (]: On model.elementary.alerts_dbt_source_freshness: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_dbt_source_freshness"} */
alter table "podcast_analytics"."public_public"."alerts_dbt_source_freshness__dbt_tmp" rename to "alerts_dbt_source_freshness"
[0m16:01:54.486817 [debug] [Thread-2 (]: On model.elementary.snapshot_run_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.snapshot_run_results"} */
alter table "podcast_analytics"."public_public"."snapshot_run_results__dbt_tmp" rename to "snapshot_run_results"
[0m16:01:54.487938 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:54.488901 [debug] [Thread-2 (]: On model.elementary.snapshot_run_results: COMMIT
[0m16:01:54.489132 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:01:54.489345 [debug] [Thread-2 (]: Using postgres connection "model.elementary.snapshot_run_results"
[0m16:01:54.490178 [debug] [Thread-3 (]: On model.elementary.alerts_dbt_source_freshness: COMMIT
[0m16:01:54.490403 [debug] [Thread-2 (]: On model.elementary.snapshot_run_results: COMMIT
[0m16:01:54.490633 [debug] [Thread-3 (]: Using postgres connection "model.elementary.alerts_dbt_source_freshness"
[0m16:01:54.490880 [debug] [Thread-3 (]: On model.elementary.alerts_dbt_source_freshness: COMMIT
[0m16:01:54.491916 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:01:54.494620 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public_public"."snapshot_run_results__dbt_backup"
[0m16:01:54.494834 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m16:01:54.495288 [debug] [Thread-2 (]: Using postgres connection "model.elementary.snapshot_run_results"
[0m16:01:54.497304 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public_public"."alerts_dbt_source_freshness__dbt_backup"
[0m16:01:54.497555 [debug] [Thread-2 (]: On model.elementary.snapshot_run_results: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.snapshot_run_results"} */
drop view if exists "podcast_analytics"."public_public"."snapshot_run_results__dbt_backup" cascade
[0m16:01:54.498055 [debug] [Thread-3 (]: Using postgres connection "model.elementary.alerts_dbt_source_freshness"
[0m16:01:54.498302 [debug] [Thread-3 (]: On model.elementary.alerts_dbt_source_freshness: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_dbt_source_freshness"} */
drop view if exists "podcast_analytics"."public_public"."alerts_dbt_source_freshness__dbt_backup" cascade
[0m16:01:54.500157 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:01:54.500400 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:01:54.501182 [debug] [Thread-3 (]: On model.elementary.alerts_dbt_source_freshness: Close
[0m16:01:54.501815 [debug] [Thread-2 (]: On model.elementary.snapshot_run_results: Close
[0m16:01:54.502186 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1f4820>]}
[0m16:01:54.502462 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b28f10>]}
[0m16:01:54.881930 [debug] [Thread-4 (]: An error was encountered while trying to send an event
[0m16:01:54.882436 [info ] [Thread-1 (]: 23 of 39 OK created sql view model public_public.model_run_results ............. [[32mCREATE VIEW[0m in 0.10s]
[0m16:01:54.882951 [info ] [Thread-3 (]: 25 of 39 OK created sql view model public_public.alerts_dbt_source_freshness ... [[32mCREATE VIEW[0m in 0.07s]
[0m16:01:54.884042 [debug] [Thread-1 (]: Finished running node model.elementary.model_run_results
[0m16:01:54.883383 [info ] [Thread-4 (]: 24 of 39 OK created sql view model public_public.seed_run_results .............. [[32mCREATE VIEW[0m in 0.09s]
[0m16:01:54.883732 [info ] [Thread-2 (]: 26 of 39 OK created sql view model public_public.snapshot_run_results .......... [[32mCREATE VIEW[0m in 0.07s]
[0m16:01:54.884516 [debug] [Thread-3 (]: Finished running node model.elementary.alerts_dbt_source_freshness
[0m16:01:54.884790 [debug] [Thread-1 (]: Began running node model.elementary.dbt_artifacts_hashes
[0m16:01:54.885176 [debug] [Thread-4 (]: Finished running node model.elementary.seed_run_results
[0m16:01:54.885504 [debug] [Thread-2 (]: Finished running node model.elementary.snapshot_run_results
[0m16:01:54.885771 [debug] [Thread-3 (]: Began running node model.podcast_analytics.dim_episodes
[0m16:01:54.886088 [info ] [Thread-1 (]: 27 of 39 START sql view model public_public.dbt_artifacts_hashes ............... [RUN]
[0m16:01:54.886374 [debug] [Thread-4 (]: Began running node model.elementary.alerts_anomaly_detection
[0m16:01:54.886618 [debug] [Thread-2 (]: Began running node model.elementary.alerts_dbt_tests
[0m16:01:54.886978 [info ] [Thread-3 (]: 28 of 39 START sql table model public.dim_episodes ............................. [RUN]
[0m16:01:54.887448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elementary.model_run_results, now model.elementary.dbt_artifacts_hashes)
[0m16:01:54.887916 [info ] [Thread-4 (]: 29 of 39 START sql view model public_public.alerts_anomaly_detection ........... [RUN]
[0m16:01:54.888261 [info ] [Thread-2 (]: 30 of 39 START sql view model public_public.alerts_dbt_tests ................... [RUN]
[0m16:01:54.888563 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.elementary.alerts_dbt_source_freshness, now model.podcast_analytics.dim_episodes)
[0m16:01:54.888811 [debug] [Thread-1 (]: Began compiling node model.elementary.dbt_artifacts_hashes
[0m16:01:54.889050 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.elementary.seed_run_results, now model.elementary.alerts_anomaly_detection)
[0m16:01:54.889286 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.elementary.snapshot_run_results, now model.elementary.alerts_dbt_tests)
[0m16:01:54.889515 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.dim_episodes
[0m16:01:54.893670 [debug] [Thread-1 (]: Writing injected SQL for node "model.elementary.dbt_artifacts_hashes"
[0m16:01:54.893943 [debug] [Thread-4 (]: Began compiling node model.elementary.alerts_anomaly_detection
[0m16:01:54.894160 [debug] [Thread-2 (]: Began compiling node model.elementary.alerts_dbt_tests
[0m16:01:54.897300 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.dim_episodes"
[0m16:01:54.947630 [debug] [Thread-4 (]: Writing injected SQL for node "model.elementary.alerts_anomaly_detection"
[0m16:01:54.951198 [debug] [Thread-2 (]: Writing injected SQL for node "model.elementary.alerts_dbt_tests"
[0m16:01:54.951524 [debug] [Thread-1 (]: Began executing node model.elementary.dbt_artifacts_hashes
[0m16:01:54.955605 [debug] [Thread-1 (]: Writing runtime sql for node "model.elementary.dbt_artifacts_hashes"
[0m16:01:54.955849 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.dim_episodes
[0m16:01:54.956079 [debug] [Thread-4 (]: Began executing node model.elementary.alerts_anomaly_detection
[0m16:01:54.956375 [debug] [Thread-2 (]: Began executing node model.elementary.alerts_dbt_tests
[0m16:01:54.959129 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.dim_episodes"
[0m16:01:54.962207 [debug] [Thread-4 (]: Writing runtime sql for node "model.elementary.alerts_anomaly_detection"
[0m16:01:54.962464 [debug] [Thread-1 (]: Using postgres connection "model.elementary.dbt_artifacts_hashes"
[0m16:01:54.965990 [debug] [Thread-2 (]: Writing runtime sql for node "model.elementary.alerts_dbt_tests"
[0m16:01:54.966388 [debug] [Thread-1 (]: On model.elementary.dbt_artifacts_hashes: BEGIN
[0m16:01:54.966647 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m16:01:54.966895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:54.967111 [debug] [Thread-4 (]: Using postgres connection "model.elementary.alerts_anomaly_detection"
[0m16:01:54.967307 [debug] [Thread-2 (]: Using postgres connection "model.elementary.alerts_dbt_tests"
[0m16:01:54.967507 [debug] [Thread-3 (]: On model.podcast_analytics.dim_episodes: BEGIN
[0m16:01:54.967796 [debug] [Thread-4 (]: On model.elementary.alerts_anomaly_detection: BEGIN
[0m16:01:54.968004 [debug] [Thread-2 (]: On model.elementary.alerts_dbt_tests: BEGIN
[0m16:01:54.968207 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:54.968405 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:54.968604 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:55.006004 [debug] [Thread-3 (]: SQL status: BEGIN in 0.038 seconds
[0m16:01:55.006474 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m16:01:55.006764 [debug] [Thread-1 (]: SQL status: BEGIN in 0.040 seconds
[0m16:01:55.007069 [debug] [Thread-3 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */

  
    

  create  table "podcast_analytics"."public"."dim_episodes__dbt_tmp"
  
  
    as
  
  (
    -- dim_episodes.sql : dimension table for episodes (one row per episode)
select 
    episode_id as "Episode ID",
    podcast_id as "Podcast ID",
    title as "Title",
    release_date as "Release Date",
    duration_seconds as "Duration (seconds)"
from "podcast_analytics"."public"."stg_episodes"
  );
  
[0m16:01:55.007379 [debug] [Thread-4 (]: SQL status: BEGIN in 0.039 seconds
[0m16:01:55.007679 [debug] [Thread-2 (]: SQL status: BEGIN in 0.039 seconds
[0m16:01:55.007911 [debug] [Thread-1 (]: Using postgres connection "model.elementary.dbt_artifacts_hashes"
[0m16:01:55.008306 [debug] [Thread-4 (]: Using postgres connection "model.elementary.alerts_anomaly_detection"
[0m16:01:55.008596 [debug] [Thread-2 (]: Using postgres connection "model.elementary.alerts_dbt_tests"
[0m16:01:55.008875 [debug] [Thread-1 (]: On model.elementary.dbt_artifacts_hashes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_artifacts_hashes"} */

  create view "podcast_analytics"."public_public"."dbt_artifacts_hashes__dbt_tmp"
    
    
  as (
    




select
  'dbt_models' as artifacts_model,
   metadata_hash
from "podcast_analytics"."public_public"."dbt_models"
 union all 

select
  'dbt_tests' as artifacts_model,
   metadata_hash
from "podcast_analytics"."public_public"."dbt_tests"
 union all 

select
  'dbt_sources' as artifacts_model,
   metadata_hash
from "podcast_analytics"."public_public"."dbt_sources"
 union all 

select
  'dbt_snapshots' as artifacts_model,
   metadata_hash
from "podcast_analytics"."public_public"."dbt_snapshots"
 union all 

select
  'dbt_metrics' as artifacts_model,
   metadata_hash
from "podcast_analytics"."public_public"."dbt_metrics"
 union all 

select
  'dbt_exposures' as artifacts_model,
   metadata_hash
from "podcast_analytics"."public_public"."dbt_exposures"
 union all 

select
  'dbt_seeds' as artifacts_model,
   metadata_hash
from "podcast_analytics"."public_public"."dbt_seeds"
 union all 

select
  'dbt_columns' as artifacts_model,
   metadata_hash
from "podcast_analytics"."public_public"."dbt_columns"


order by metadata_hash
  );
[0m16:01:55.009187 [debug] [Thread-4 (]: On model.elementary.alerts_anomaly_detection: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_anomaly_detection"} */

  create view "podcast_analytics"."public_public"."alerts_anomaly_detection__dbt_tmp"
    
    
  as (
    

with elementary_test_results as (
    select * from "podcast_analytics"."public_public"."elementary_test_results"
),

alerts_anomaly_detection as (
    select id as alert_id,
           data_issue_id,
           test_execution_id,
           test_unique_id,
           model_unique_id,
           detected_at,
           database_name,
           schema_name,
           table_name,
           column_name,
           test_type as alert_type,
           test_sub_type as sub_type,
           test_results_description as alert_description,
           owners,
           tags,
           test_results_query as alert_results_query,
           other,
           test_name,
           test_short_name,
           test_params,
           severity,
           status,
           result_rows
        from elementary_test_results
        where True and lower(status) != 'pass'and lower(status) != 'skipped'and test_type = 'anomaly_detection'
)

select * from alerts_anomaly_detection
  );
[0m16:01:55.009465 [debug] [Thread-2 (]: On model.elementary.alerts_dbt_tests: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_dbt_tests"} */

  create view "podcast_analytics"."public_public"."alerts_dbt_tests__dbt_tmp"
    
    
  as (
    

with elementary_test_results as (
    select * from "podcast_analytics"."public_public"."elementary_test_results"
),

alerts_dbt_tests as (
    select id as alert_id,
           data_issue_id,
           test_execution_id,
           test_unique_id,
           model_unique_id,
           detected_at,
           database_name,
           schema_name,
           table_name,
           column_name,
           test_type as alert_type,
           test_sub_type as sub_type,
           test_results_description as alert_description,
           owners,
           tags,
           test_results_query as alert_results_query,
           other,
           test_name,
           test_short_name,
           test_params,
           severity,
           status,
           result_rows
        from elementary_test_results
        where True and lower(status) != 'pass'   and lower(status) != 'skipped'  and test_type = 'dbt_test'
)

select * from alerts_dbt_tests
  );
[0m16:01:55.013555 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:01:55.013831 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:01:55.017730 [debug] [Thread-1 (]: Using postgres connection "model.elementary.dbt_artifacts_hashes"
[0m16:01:55.018049 [debug] [Thread-3 (]: SQL status: SELECT 50 in 0.010 seconds
[0m16:01:55.018306 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m16:01:55.021100 [debug] [Thread-4 (]: Using postgres connection "model.elementary.alerts_anomaly_detection"
[0m16:01:55.021385 [debug] [Thread-1 (]: On model.elementary.dbt_artifacts_hashes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_artifacts_hashes"} */
alter table "podcast_analytics"."public_public"."dbt_artifacts_hashes" rename to "dbt_artifacts_hashes__dbt_backup"
[0m16:01:55.024729 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m16:01:55.027345 [debug] [Thread-2 (]: Using postgres connection "model.elementary.alerts_dbt_tests"
[0m16:01:55.027598 [debug] [Thread-4 (]: On model.elementary.alerts_anomaly_detection: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_anomaly_detection"} */
alter table "podcast_analytics"."public_public"."alerts_anomaly_detection" rename to "alerts_anomaly_detection__dbt_backup"
[0m16:01:55.027851 [debug] [Thread-3 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */
alter table "podcast_analytics"."public"."dim_episodes" rename to "dim_episodes__dbt_backup"
[0m16:01:55.028120 [debug] [Thread-2 (]: On model.elementary.alerts_dbt_tests: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_dbt_tests"} */
alter table "podcast_analytics"."public_public"."alerts_dbt_tests" rename to "alerts_dbt_tests__dbt_backup"
[0m16:01:55.028848 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:55.031423 [debug] [Thread-1 (]: Using postgres connection "model.elementary.dbt_artifacts_hashes"
[0m16:01:55.031668 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:01:55.031902 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:01:55.032119 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:01:55.032358 [debug] [Thread-1 (]: On model.elementary.dbt_artifacts_hashes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_artifacts_hashes"} */
alter table "podcast_analytics"."public_public"."dbt_artifacts_hashes__dbt_tmp" rename to "dbt_artifacts_hashes"
[0m16:01:55.035476 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m16:01:55.037964 [debug] [Thread-2 (]: Using postgres connection "model.elementary.alerts_dbt_tests"
[0m16:01:55.040456 [debug] [Thread-4 (]: Using postgres connection "model.elementary.alerts_anomaly_detection"
[0m16:01:55.040795 [debug] [Thread-3 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */
alter table "podcast_analytics"."public"."dim_episodes__dbt_tmp" rename to "dim_episodes"
[0m16:01:55.041086 [debug] [Thread-2 (]: On model.elementary.alerts_dbt_tests: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_dbt_tests"} */
alter table "podcast_analytics"."public_public"."alerts_dbt_tests__dbt_tmp" rename to "alerts_dbt_tests"
[0m16:01:55.041320 [debug] [Thread-4 (]: On model.elementary.alerts_anomaly_detection: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_anomaly_detection"} */
alter table "podcast_analytics"."public_public"."alerts_anomaly_detection__dbt_tmp" rename to "alerts_anomaly_detection"
[0m16:01:55.041775 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:55.042788 [debug] [Thread-1 (]: On model.elementary.dbt_artifacts_hashes: COMMIT
[0m16:01:55.043071 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:55.043282 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:01:55.043479 [debug] [Thread-1 (]: Using postgres connection "model.elementary.dbt_artifacts_hashes"
[0m16:01:55.043654 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m16:01:55.044535 [debug] [Thread-4 (]: On model.elementary.alerts_anomaly_detection: COMMIT
[0m16:01:55.045497 [debug] [Thread-2 (]: On model.elementary.alerts_dbt_tests: COMMIT
[0m16:01:55.045708 [debug] [Thread-1 (]: On model.elementary.dbt_artifacts_hashes: COMMIT
[0m16:01:55.046487 [debug] [Thread-3 (]: On model.podcast_analytics.dim_episodes: COMMIT
[0m16:01:55.046709 [debug] [Thread-4 (]: Using postgres connection "model.elementary.alerts_anomaly_detection"
[0m16:01:55.046918 [debug] [Thread-2 (]: Using postgres connection "model.elementary.alerts_dbt_tests"
[0m16:01:55.047150 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m16:01:55.047392 [debug] [Thread-4 (]: On model.elementary.alerts_anomaly_detection: COMMIT
[0m16:01:55.047584 [debug] [Thread-2 (]: On model.elementary.alerts_dbt_tests: COMMIT
[0m16:01:55.047770 [debug] [Thread-3 (]: On model.podcast_analytics.dim_episodes: COMMIT
[0m16:01:55.048325 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:01:55.051500 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public_public"."dbt_artifacts_hashes__dbt_backup"
[0m16:01:55.051714 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m16:01:55.051908 [debug] [Thread-4 (]: SQL status: COMMIT in 0.004 seconds
[0m16:01:55.052100 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m16:01:55.052546 [debug] [Thread-1 (]: Using postgres connection "model.elementary.dbt_artifacts_hashes"
[0m16:01:55.054641 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."dim_episodes__dbt_backup"
[0m16:01:55.056593 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public_public"."alerts_anomaly_detection__dbt_backup"
[0m16:01:55.058896 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public_public"."alerts_dbt_tests__dbt_backup"
[0m16:01:55.059121 [debug] [Thread-1 (]: On model.elementary.dbt_artifacts_hashes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.dbt_artifacts_hashes"} */
drop view if exists "podcast_analytics"."public_public"."dbt_artifacts_hashes__dbt_backup" cascade
[0m16:01:55.059549 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m16:01:55.059950 [debug] [Thread-4 (]: Using postgres connection "model.elementary.alerts_anomaly_detection"
[0m16:01:55.060384 [debug] [Thread-2 (]: Using postgres connection "model.elementary.alerts_dbt_tests"
[0m16:01:55.060636 [debug] [Thread-3 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */
drop table if exists "podcast_analytics"."public"."dim_episodes__dbt_backup" cascade
[0m16:01:55.060961 [debug] [Thread-4 (]: On model.elementary.alerts_anomaly_detection: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_anomaly_detection"} */
drop view if exists "podcast_analytics"."public_public"."alerts_anomaly_detection__dbt_backup" cascade
[0m16:01:55.061249 [debug] [Thread-2 (]: On model.elementary.alerts_dbt_tests: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_dbt_tests"} */
drop view if exists "podcast_analytics"."public_public"."alerts_dbt_tests__dbt_backup" cascade
[0m16:01:55.062991 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:01:55.063910 [debug] [Thread-1 (]: On model.elementary.dbt_artifacts_hashes: Close
[0m16:01:55.064183 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:01:55.064965 [debug] [Thread-4 (]: On model.elementary.alerts_anomaly_detection: Close
[0m16:01:55.065307 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d4ff10>]}
[0m16:01:55.065529 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:01:55.065729 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.004 seconds
[0m16:01:55.066095 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d04160>]}
[0m16:01:55.066556 [info ] [Thread-1 (]: 27 of 39 OK created sql view model public_public.dbt_artifacts_hashes .......... [[32mCREATE VIEW[0m in 0.18s]
[0m16:01:55.067351 [debug] [Thread-2 (]: On model.elementary.alerts_dbt_tests: Close
[0m16:01:55.068165 [debug] [Thread-3 (]: On model.podcast_analytics.dim_episodes: Close
[0m16:01:55.068596 [info ] [Thread-4 (]: 29 of 39 OK created sql view model public_public.alerts_anomaly_detection ...... [[32mCREATE VIEW[0m in 0.18s]
[0m16:01:55.068986 [debug] [Thread-1 (]: Finished running node model.elementary.dbt_artifacts_hashes
[0m16:01:55.069398 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b59030>]}
[0m16:01:55.069802 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d045e0>]}
[0m16:01:55.070120 [debug] [Thread-4 (]: Finished running node model.elementary.alerts_anomaly_detection
[0m16:01:55.070407 [debug] [Thread-1 (]: Began running node model.elementary.alerts_schema_changes
[0m16:01:55.070829 [info ] [Thread-2 (]: 30 of 39 OK created sql view model public_public.alerts_dbt_tests .............. [[32mCREATE VIEW[0m in 0.18s]
[0m16:01:55.071188 [info ] [Thread-3 (]: 28 of 39 OK created sql table model public.dim_episodes ........................ [[32mSELECT 50[0m in 0.18s]
[0m16:01:55.071498 [debug] [Thread-4 (]: Began running node model.elementary.test_result_rows
[0m16:01:55.071845 [info ] [Thread-1 (]: 31 of 39 START sql view model public_public.alerts_schema_changes .............. [RUN]
[0m16:01:55.072220 [debug] [Thread-2 (]: Finished running node model.elementary.alerts_dbt_tests
[0m16:01:55.072551 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.dim_episodes
[0m16:01:55.072872 [info ] [Thread-4 (]: 32 of 39 START sql incremental model public_public.test_result_rows ............ [RUN]
[0m16:01:55.073226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elementary.dbt_artifacts_hashes, now model.elementary.alerts_schema_changes)
[0m16:01:55.073539 [debug] [Thread-2 (]: Began running node model.podcast_analytics.fact_user_events
[0m16:01:55.073873 [debug] [Thread-3 (]: Began running node model.podcast_analytics.int_user_sessions
[0m16:01:55.074229 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.elementary.alerts_anomaly_detection, now model.elementary.test_result_rows)
[0m16:01:55.074460 [debug] [Thread-1 (]: Began compiling node model.elementary.alerts_schema_changes
[0m16:01:55.074718 [info ] [Thread-2 (]: 33 of 39 START sql table model public.fact_user_events ......................... [RUN]
[0m16:01:55.074976 [info ] [Thread-3 (]: 34 of 39 START sql view model public.int_user_sessions ......................... [RUN]
[0m16:01:55.075343 [debug] [Thread-4 (]: Began compiling node model.elementary.test_result_rows
[0m16:01:55.079649 [debug] [Thread-1 (]: Writing injected SQL for node "model.elementary.alerts_schema_changes"
[0m16:01:55.079960 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.elementary.alerts_dbt_tests, now model.podcast_analytics.fact_user_events)
[0m16:01:55.080182 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.dim_episodes, now model.podcast_analytics.int_user_sessions)
[0m16:01:55.085801 [debug] [Thread-4 (]: Writing injected SQL for node "model.elementary.test_result_rows"
[0m16:01:55.086314 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.fact_user_events
[0m16:01:55.086650 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m16:01:55.086968 [debug] [Thread-1 (]: Began executing node model.elementary.alerts_schema_changes
[0m16:01:55.089373 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.fact_user_events"
[0m16:01:55.092855 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m16:01:55.093151 [debug] [Thread-4 (]: Began executing node model.elementary.test_result_rows
[0m16:01:55.097487 [debug] [Thread-1 (]: Writing runtime sql for node "model.elementary.alerts_schema_changes"
[0m16:01:55.101278 [debug] [Thread-4 (]: Using postgres connection "model.elementary.test_result_rows"
[0m16:01:55.101648 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.fact_user_events
[0m16:01:55.101926 [debug] [Thread-4 (]: On model.elementary.test_result_rows: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.test_result_rows"} */

    
  
    

  create temporary table "test_result_rows__dbt_tmp160155100016"
  
  
    as
  
  (
    -- indexes are not supported in all warehouses, relevant to postgres only


-- depends_on: "podcast_analytics"."public_public"."elementary_test_results"
select * from (
            select
            
                
        cast('this_is_just_a_long_dummy_string' as text) as elementary_test_results_id

,
                
        cast('this_is_just_a_long_dummy_string' as text) as result_row

,
                cast('2091-02-17' as timestamp) as detected_at

,
                cast('2091-02-17' as timestamp) as created_at


        ) as empty_table
        where 1 = 0
  );
  
  
[0m16:01:55.102219 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m16:01:55.105219 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.fact_user_events"
[0m16:01:55.105463 [debug] [Thread-1 (]: Using postgres connection "model.elementary.alerts_schema_changes"
[0m16:01:55.105753 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:55.109325 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m16:01:55.109639 [debug] [Thread-1 (]: On model.elementary.alerts_schema_changes: BEGIN
[0m16:01:55.110042 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m16:01:55.110291 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:55.110521 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m16:01:55.110733 [debug] [Thread-2 (]: On model.podcast_analytics.fact_user_events: BEGIN
[0m16:01:55.111015 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m16:01:55.111259 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:55.111504 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:55.128431 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m16:01:55.128816 [debug] [Thread-4 (]: SQL status: SELECT 0 in 0.023 seconds
[0m16:01:55.129049 [debug] [Thread-1 (]: Using postgres connection "model.elementary.alerts_schema_changes"
[0m16:01:55.131998 [debug] [Thread-4 (]: Using postgres connection "model.elementary.test_result_rows"
[0m16:01:55.132319 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m16:01:55.132631 [debug] [Thread-1 (]: On model.elementary.alerts_schema_changes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_schema_changes"} */

  create view "podcast_analytics"."public_public"."alerts_schema_changes__dbt_tmp"
    
    
  as (
    


with elementary_test_results as (
    select * from "podcast_analytics"."public_public"."elementary_test_results"
),

alerts_schema_changes as (
    select id as alert_id,
           data_issue_id,
           test_execution_id,
           test_unique_id,
           model_unique_id,
           detected_at,
           database_name,
           schema_name,
           table_name,
           column_name,
           test_type as alert_type,
           test_sub_type as sub_type,
           test_results_description as alert_description,
           owners,
           tags,
           test_results_query as alert_results_query,
           other,
           test_name,
           test_short_name,
           test_params,
           severity,
           status,
           result_rows
        from elementary_test_results
        where True and lower(status) != 'pass'and lower(status) != 'skipped'and test_type = 'schema_change'
)

select * from alerts_schema_changes
  );
[0m16:01:55.132957 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m16:01:55.133195 [debug] [Thread-4 (]: On model.elementary.test_result_rows: BEGIN
[0m16:01:55.133402 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m16:01:55.133699 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m16:01:55.134178 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions

-- 1. Bring in all user events from the staging model
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

-- 2. For each event, get the timestamp of the previous event for the same user
events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

-- 3. Flag the start of a new session:
--    - If there is no previous event (first event for user)
--    - Or if the gap between events is more than 30 minutes
flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

-- 4. Assign a session number to each event for each user by cumulatively summing the new session flags
numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

-- 5. Aggregate events into sessions:
--    - Find session start/end timestamps
--    - Sum up listening duration for the session
agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end,
        sum(coalesce(duration, 0)) as total_listening_duration
    from numbered
    group by user_id, session_number
),

-- 6. Generate a surrogate session_id and select final session fields
final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        total_listening_duration as session_duration
    from agg
)

-- 7. Output the final sessionized data
select * from final
  );
[0m16:01:55.134541 [debug] [Thread-2 (]: On model.podcast_analytics.fact_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.fact_user_events"} */

  
    

  create  table "podcast_analytics"."public"."fact_user_events__dbt_tmp"
  
  
    as
  
  (
    
-- fact_user_events.sql : central fact table of cleaned user events with de-duplication on event_id

with base as (
    select *
    from "podcast_analytics"."public"."stg_user_events"
),

dedup as (
    select
        *,
        row_number() over (partition by event_id order by event_ts desc nulls last) as rn
    from base
)

select
    event_id as "Event ID",
    event_ts as "Event Timestamp",
    user_id as "User ID",
    episode_id as "Episode ID",
    event_type as "Event Type",
    duration as "Duration"
from dedup
where rn = 1
  );
  
[0m16:01:55.134817 [debug] [Thread-4 (]: SQL status: BEGIN in 0.001 seconds
[0m16:01:55.135160 [debug] [Thread-4 (]: Using postgres connection "model.elementary.test_result_rows"
[0m16:01:55.135448 [debug] [Thread-4 (]: On model.elementary.test_result_rows: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.test_result_rows"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'test_result_rows__dbt_tmp160155100016'
        
      order by ordinal_position

  
[0m16:01:55.138264 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m16:01:55.141301 [debug] [Thread-1 (]: Using postgres connection "model.elementary.alerts_schema_changes"
[0m16:01:55.141629 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.006 seconds
[0m16:01:55.141912 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:01:55.142142 [debug] [Thread-1 (]: On model.elementary.alerts_schema_changes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_schema_changes"} */
alter table "podcast_analytics"."public_public"."alerts_schema_changes" rename to "alerts_schema_changes__dbt_backup"
[0m16:01:55.145429 [debug] [Thread-4 (]: Using postgres connection "model.elementary.test_result_rows"
[0m16:01:55.148032 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m16:01:55.148388 [debug] [Thread-4 (]: On model.elementary.test_result_rows: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.test_result_rows"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'test_result_rows'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:55.148662 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m16:01:55.149398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:55.151957 [debug] [Thread-1 (]: Using postgres connection "model.elementary.alerts_schema_changes"
[0m16:01:55.152259 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:01:55.152469 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.004 seconds
[0m16:01:55.152662 [debug] [Thread-1 (]: On model.elementary.alerts_schema_changes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_schema_changes"} */
alter table "podcast_analytics"."public_public"."alerts_schema_changes__dbt_tmp" rename to "alerts_schema_changes"
[0m16:01:55.153666 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m16:01:55.197823 [debug] [Thread-4 (]: Using postgres connection "model.elementary.test_result_rows"
[0m16:01:55.198108 [debug] [Thread-2 (]: SQL status: SELECT 4860 in 0.063 seconds
[0m16:01:55.198440 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m16:01:55.198733 [debug] [Thread-4 (]: On model.elementary.test_result_rows: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.test_result_rows"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'test_result_rows__dbt_tmp160155100016'
        
      order by ordinal_position

  
[0m16:01:55.201481 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m16:01:55.201724 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m16:01:55.201932 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m16:01:55.202182 [debug] [Thread-2 (]: On model.podcast_analytics.fact_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.fact_user_events"} */
alter table "podcast_analytics"."public"."fact_user_events" rename to "fact_user_events__dbt_backup"
[0m16:01:55.203255 [debug] [Thread-1 (]: On model.elementary.alerts_schema_changes: COMMIT
[0m16:01:55.203653 [debug] [Thread-1 (]: Using postgres connection "model.elementary.alerts_schema_changes"
[0m16:01:55.203893 [debug] [Thread-1 (]: On model.elementary.alerts_schema_changes: COMMIT
[0m16:01:55.204151 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.002 seconds
[0m16:01:55.206986 [debug] [Thread-4 (]: Using postgres connection "model.elementary.test_result_rows"
[0m16:01:55.207275 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m16:01:55.207535 [debug] [Thread-4 (]: On model.elementary.test_result_rows: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.test_result_rows"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'test_result_rows'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:55.207734 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m16:01:55.207954 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m16:01:55.210571 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public_public"."alerts_schema_changes__dbt_backup"
[0m16:01:55.212625 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m16:01:55.212856 [debug] [Thread-4 (]: SQL status: SELECT 4 in 0.002 seconds
[0m16:01:55.215132 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m16:01:55.215606 [debug] [Thread-1 (]: Using postgres connection "model.elementary.alerts_schema_changes"
[0m16:01:55.216019 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m16:01:55.216882 [debug] [Thread-4 (]: 
    In "podcast_analytics"."public_public"."test_result_rows":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m16:01:55.217111 [debug] [Thread-2 (]: On model.podcast_analytics.fact_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.fact_user_events"} */
alter table "podcast_analytics"."public"."fact_user_events__dbt_tmp" rename to "fact_user_events"
[0m16:01:55.217321 [debug] [Thread-1 (]: On model.elementary.alerts_schema_changes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_schema_changes"} */
drop view if exists "podcast_analytics"."public_public"."alerts_schema_changes__dbt_backup" cascade
[0m16:01:55.217516 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m16:01:55.218157 [debug] [Thread-4 (]: Writing runtime sql for node "model.elementary.test_result_rows"
[0m16:01:55.218739 [debug] [Thread-4 (]: Using postgres connection "model.elementary.test_result_rows"
[0m16:01:55.219035 [debug] [Thread-4 (]: On model.elementary.test_result_rows: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.test_result_rows"} */

      
        
        
        delete from "podcast_analytics"."public_public"."test_result_rows" as DBT_INTERNAL_DEST
        where (elementary_test_results_id) in (
            select distinct elementary_test_results_id
            from "test_result_rows__dbt_tmp160155100016" as DBT_INTERNAL_SOURCE
        );

    

    insert into "podcast_analytics"."public_public"."test_result_rows" ("elementary_test_results_id", "result_row", "detected_at", "created_at")
    (
        select "elementary_test_results_id", "result_row", "detected_at", "created_at"
        from "test_result_rows__dbt_tmp160155100016"
    )
  
[0m16:01:55.219348 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:55.219542 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m16:01:55.220594 [debug] [Thread-2 (]: On model.podcast_analytics.fact_user_events: COMMIT
[0m16:01:55.220843 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m16:01:55.221038 [debug] [Thread-4 (]: SQL status: INSERT 0 0 in 0.001 seconds
[0m16:01:55.221737 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: Close
[0m16:01:55.221955 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m16:01:55.222638 [debug] [Thread-1 (]: On model.elementary.alerts_schema_changes: Close
[0m16:01:55.223404 [debug] [Thread-4 (]: On model.elementary.test_result_rows: COMMIT
[0m16:01:55.223650 [debug] [Thread-2 (]: On model.podcast_analytics.fact_user_events: COMMIT
[0m16:01:55.223968 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3dde10>]}
[0m16:01:55.224280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c284a00>]}
[0m16:01:55.224491 [debug] [Thread-4 (]: Using postgres connection "model.elementary.test_result_rows"
[0m16:01:55.224920 [info ] [Thread-3 (]: 34 of 39 OK created sql view model public.int_user_sessions .................... [[32mCREATE VIEW[0m in 0.14s]
[0m16:01:55.225600 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m16:01:55.225387 [info ] [Thread-1 (]: 31 of 39 OK created sql view model public_public.alerts_schema_changes ......... [[32mCREATE VIEW[0m in 0.15s]
[0m16:01:55.225937 [debug] [Thread-4 (]: On model.elementary.test_result_rows: COMMIT
[0m16:01:55.226245 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m16:01:55.229296 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."fact_user_events__dbt_backup"
[0m16:01:55.229666 [debug] [Thread-1 (]: Finished running node model.elementary.alerts_schema_changes
[0m16:01:55.229932 [debug] [Thread-3 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m16:01:55.230527 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m16:01:55.230802 [debug] [Thread-1 (]: Began running node model.podcast_analytics.dim_users
[0m16:01:55.231030 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:01:55.231382 [info ] [Thread-3 (]: 35 of 39 START sql table model public.mart_top_episodes ........................ [RUN]
[0m16:01:55.231719 [debug] [Thread-2 (]: On model.podcast_analytics.fact_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.fact_user_events"} */
drop table if exists "podcast_analytics"."public"."fact_user_events__dbt_backup" cascade
[0m16:01:55.231985 [info ] [Thread-1 (]: 36 of 39 START sql table model public.dim_users ................................ [RUN]
[0m16:01:55.232433 [debug] [Thread-4 (]: On model.elementary.test_result_rows: Close
[0m16:01:55.232673 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.int_user_sessions, now model.podcast_analytics.mart_top_episodes)
[0m16:01:55.232940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.elementary.alerts_schema_changes, now model.podcast_analytics.dim_users)
[0m16:01:55.233368 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0b0910>]}
[0m16:01:55.233615 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m16:01:55.233883 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.dim_users
[0m16:01:55.238161 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m16:01:55.234324 [info ] [Thread-4 (]: 32 of 39 OK created sql incremental model public_public.test_result_rows ....... [[32mINSERT 0 0[0m in 0.16s]
[0m16:01:55.238631 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.006 seconds
[0m16:01:55.240955 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.dim_users"
[0m16:01:55.241443 [debug] [Thread-4 (]: Finished running node model.elementary.test_result_rows
[0m16:01:55.242365 [debug] [Thread-2 (]: On model.podcast_analytics.fact_user_events: Close
[0m16:01:55.242770 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m16:01:55.243105 [debug] [Thread-4 (]: Began running node model.elementary.anomaly_threshold_sensitivity
[0m16:01:55.243449 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.dim_users
[0m16:01:55.243832 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4a0610>]}
[0m16:01:55.247599 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m16:01:55.250732 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.dim_users"
[0m16:01:55.247912 [info ] [Thread-4 (]: 37 of 39 START sql view model public_public.anomaly_threshold_sensitivity ...... [RUN]
[0m16:01:55.251326 [info ] [Thread-2 (]: 33 of 39 OK created sql table model public.fact_user_events .................... [[32mSELECT 4860[0m in 0.16s]
[0m16:01:55.251757 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.elementary.test_result_rows, now model.elementary.anomaly_threshold_sensitivity)
[0m16:01:55.252156 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.fact_user_events
[0m16:01:55.252446 [debug] [Thread-4 (]: Began compiling node model.elementary.anomaly_threshold_sensitivity
[0m16:01:55.252703 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m16:01:55.252952 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m16:01:55.253224 [debug] [Thread-2 (]: Began running node model.elementary.alerts_dbt_models
[0m16:01:55.258585 [debug] [Thread-4 (]: Writing injected SQL for node "model.elementary.anomaly_threshold_sensitivity"
[0m16:01:55.258941 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m16:01:55.259176 [debug] [Thread-1 (]: On model.podcast_analytics.dim_users: BEGIN
[0m16:01:55.259540 [info ] [Thread-2 (]: 38 of 39 START sql view model public_public.alerts_dbt_models .................. [RUN]
[0m16:01:55.260008 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:55.260355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:55.260656 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.fact_user_events, now model.elementary.alerts_dbt_models)
[0m16:01:55.260898 [debug] [Thread-4 (]: Began executing node model.elementary.anomaly_threshold_sensitivity
[0m16:01:55.261293 [debug] [Thread-2 (]: Began compiling node model.elementary.alerts_dbt_models
[0m16:01:55.264902 [debug] [Thread-4 (]: Writing runtime sql for node "model.elementary.anomaly_threshold_sensitivity"
[0m16:01:55.269050 [debug] [Thread-2 (]: Writing injected SQL for node "model.elementary.alerts_dbt_models"
[0m16:01:55.269675 [debug] [Thread-4 (]: Using postgres connection "model.elementary.anomaly_threshold_sensitivity"
[0m16:01:55.269983 [debug] [Thread-4 (]: On model.elementary.anomaly_threshold_sensitivity: BEGIN
[0m16:01:55.270269 [debug] [Thread-2 (]: Began executing node model.elementary.alerts_dbt_models
[0m16:01:55.270560 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:55.274480 [debug] [Thread-2 (]: Writing runtime sql for node "model.elementary.alerts_dbt_models"
[0m16:01:55.275248 [debug] [Thread-2 (]: Using postgres connection "model.elementary.alerts_dbt_models"
[0m16:01:55.275495 [debug] [Thread-2 (]: On model.elementary.alerts_dbt_models: BEGIN
[0m16:01:55.275768 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:55.276646 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:01:55.276887 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m16:01:55.277137 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m16:01:55.277466 [debug] [Thread-1 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */

  
    

  create  table "podcast_analytics"."public"."dim_users__dbt_tmp"
  
  
    as
  
  (
    -- dim_users.sql : dimension table for users (one row per user)
select 
    user_id as "User ID",
    signup_date as "Signup Date",
    country as "Country"
from "podcast_analytics"."public"."stg_users"
  );
  
[0m16:01:55.277732 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m16:01:55.278085 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  
    

  create  table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
  
  
    as
  
  (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
  
[0m16:01:55.282637 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.005 seconds
[0m16:01:55.285758 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m16:01:55.286091 [debug] [Thread-1 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */
alter table "podcast_analytics"."public"."dim_users" rename to "dim_users__dbt_backup"
[0m16:01:55.286951 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:55.289419 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m16:01:55.289705 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m16:01:55.290031 [debug] [Thread-1 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */
alter table "podcast_analytics"."public"."dim_users__dbt_tmp" rename to "dim_users"
[0m16:01:55.290297 [debug] [Thread-4 (]: Using postgres connection "model.elementary.anomaly_threshold_sensitivity"
[0m16:01:55.290690 [debug] [Thread-4 (]: On model.elementary.anomaly_threshold_sensitivity: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.anomaly_threshold_sensitivity"} */

  create view "podcast_analytics"."public_public"."anomaly_threshold_sensitivity__dbt_tmp"
    
    
  as (
    

with metrics_anomaly_score as (

    select * from "podcast_analytics"."public_public"."metrics_anomaly_score"

),

score_sensitivity as (

    select
        full_table_name,
        column_name,
        metric_name,
        latest_metric_value,
        training_avg as metric_avg,
        training_stddev as metric_stddev,
        anomaly_score,
        case when abs(anomaly_score) >= 1.5 then true else false end as "is_anomaly_1_5",
        case when abs(anomaly_score) >= 2 then true else false end as "is_anomaly_2",
        case when abs(anomaly_score) >= 2.5 then true else false end as "is_anomaly_2_5",
        case when abs(anomaly_score) >= 3 then true else false end as "is_anomaly_3",
        case when abs(anomaly_score) >= 3.5 then true else false end as "is_anomaly_3_5",
        case when abs(anomaly_score) >= 4 then true else false end as "is_anomaly_4",
        case when abs(anomaly_score) >= 4.5 then true else false end as "is_anomaly_4_5"
    from metrics_anomaly_score
    where abs(anomaly_score) >= 1.5

)

select * from score_sensitivity
  );
[0m16:01:55.291210 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m16:01:55.291452 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:55.291697 [debug] [Thread-2 (]: Using postgres connection "model.elementary.alerts_dbt_models"
[0m16:01:55.292650 [debug] [Thread-1 (]: On model.podcast_analytics.dim_users: COMMIT
[0m16:01:55.292968 [debug] [Thread-2 (]: On model.elementary.alerts_dbt_models: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_dbt_models"} */

  create view "podcast_analytics"."public_public"."alerts_dbt_models__dbt_tmp"
    
    
  as (
    

with error_models as (
  
    select  model_execution_id,
            unique_id,
            invocation_id,
            name,
            generated_at,
            status,
            full_refresh,
            message,
            execution_time,
            execute_started_at,
            execute_completed_at,
            compile_started_at,
            compile_completed_at,
            compiled_code,
            database_name,
            schema_name,
            materialization,
            tags,
            package_name,
            path,
            original_path,
            owner,
            alias 
    from "podcast_analytics"."public_public"."model_run_results"
  
    union all
  
    select  model_execution_id,
            unique_id,
            invocation_id,
            name,
            generated_at,
            status,
            full_refresh,
            message,
            execution_time,
            execute_started_at,
            execute_completed_at,
            compile_started_at,
            compile_completed_at,
            compiled_code,
            database_name,
            schema_name,
            materialization,
            tags,
            package_name,
            path,
            original_path,
            owner,
            alias  
  from "podcast_analytics"."public_public"."snapshot_run_results"
)


select model_execution_id as alert_id,
       unique_id,
       cast(generated_at as timestamp) as detected_at,
       database_name,
       materialization,
       path,
       original_path,
       schema_name,
       message,
       owner as owners,
       tags,
       alias,
       status,
       full_refresh
from error_models
where True and lower(status) != 'success'and lower(status) != 'skipped'
  );
[0m16:01:55.293274 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m16:01:55.293512 [debug] [Thread-1 (]: On model.podcast_analytics.dim_users: COMMIT
[0m16:01:55.294410 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:01:55.297487 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."dim_users__dbt_backup"
[0m16:01:55.297745 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m16:01:55.297960 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m16:01:55.298416 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m16:01:55.300744 [debug] [Thread-2 (]: Using postgres connection "model.elementary.alerts_dbt_models"
[0m16:01:55.302962 [debug] [Thread-4 (]: Using postgres connection "model.elementary.anomaly_threshold_sensitivity"
[0m16:01:55.303173 [debug] [Thread-1 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */
drop table if exists "podcast_analytics"."public"."dim_users__dbt_backup" cascade
[0m16:01:55.303407 [debug] [Thread-2 (]: On model.elementary.alerts_dbt_models: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_dbt_models"} */
alter table "podcast_analytics"."public_public"."alerts_dbt_models__dbt_tmp" rename to "alerts_dbt_models"
[0m16:01:55.303640 [debug] [Thread-4 (]: On model.elementary.anomaly_threshold_sensitivity: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.anomaly_threshold_sensitivity"} */
alter table "podcast_analytics"."public_public"."anomaly_threshold_sensitivity__dbt_tmp" rename to "anomaly_threshold_sensitivity"
[0m16:01:55.304597 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:55.304827 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:55.305626 [debug] [Thread-4 (]: On model.elementary.anomaly_threshold_sensitivity: COMMIT
[0m16:01:55.306531 [debug] [Thread-2 (]: On model.elementary.alerts_dbt_models: COMMIT
[0m16:01:55.306801 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m16:01:55.307015 [debug] [Thread-4 (]: Using postgres connection "model.elementary.anomaly_threshold_sensitivity"
[0m16:01:55.307236 [debug] [Thread-2 (]: Using postgres connection "model.elementary.alerts_dbt_models"
[0m16:01:55.307949 [debug] [Thread-1 (]: On model.podcast_analytics.dim_users: Close
[0m16:01:55.308153 [debug] [Thread-4 (]: On model.elementary.anomaly_threshold_sensitivity: COMMIT
[0m16:01:55.308355 [debug] [Thread-2 (]: On model.elementary.alerts_dbt_models: COMMIT
[0m16:01:55.308717 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a56e90>]}
[0m16:01:55.309405 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m16:01:55.309148 [info ] [Thread-1 (]: 36 of 39 OK created sql table model public.dim_users ........................... [[32mSELECT 100[0m in 0.08s]
[0m16:01:55.312460 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public_public"."anomaly_threshold_sensitivity__dbt_backup"
[0m16:01:55.312693 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m16:01:55.313049 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.dim_users
[0m16:01:55.313561 [debug] [Thread-4 (]: Using postgres connection "model.elementary.anomaly_threshold_sensitivity"
[0m16:01:55.315765 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public_public"."alerts_dbt_models__dbt_backup"
[0m16:01:55.316139 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m16:01:55.316469 [debug] [Thread-4 (]: On model.elementary.anomaly_threshold_sensitivity: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.anomaly_threshold_sensitivity"} */
drop view if exists "podcast_analytics"."public_public"."anomaly_threshold_sensitivity__dbt_backup" cascade
[0m16:01:55.316999 [debug] [Thread-2 (]: Using postgres connection "model.elementary.alerts_dbt_models"
[0m16:01:55.317322 [info ] [Thread-1 (]: 39 of 39 START sql table model public.mart_user_session_metrics ................ [RUN]
[0m16:01:55.317636 [debug] [Thread-2 (]: On model.elementary.alerts_dbt_models: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.elementary.alerts_dbt_models"} */
drop view if exists "podcast_analytics"."public_public"."alerts_dbt_models__dbt_backup" cascade
[0m16:01:55.317935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.dim_users, now model.podcast_analytics.mart_user_session_metrics)
[0m16:01:55.318281 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m16:01:55.320703 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m16:01:55.321037 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m16:01:55.321282 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m16:01:55.322229 [debug] [Thread-2 (]: On model.elementary.alerts_dbt_models: Close
[0m16:01:55.322987 [debug] [Thread-4 (]: On model.elementary.anomaly_threshold_sensitivity: Close
[0m16:01:55.323347 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m16:01:55.323874 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0b0910>]}
[0m16:01:55.324176 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4d4f70>]}
[0m16:01:55.328108 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m16:01:55.328442 [debug] [Thread-3 (]: SQL status: SELECT 50 in 0.050 seconds
[0m16:01:55.328946 [info ] [Thread-4 (]: 37 of 39 OK created sql view model public_public.anomaly_threshold_sensitivity . [[32mCREATE VIEW[0m in 0.07s]
[0m16:01:55.329476 [info ] [Thread-2 (]: 38 of 39 OK created sql view model public_public.alerts_dbt_models ............. [[32mCREATE VIEW[0m in 0.06s]
[0m16:01:55.332417 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m16:01:55.332880 [debug] [Thread-4 (]: Finished running node model.elementary.anomaly_threshold_sensitivity
[0m16:01:55.333159 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m16:01:55.333432 [debug] [Thread-2 (]: Finished running node model.elementary.alerts_dbt_models
[0m16:01:55.333649 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes" rename to "mart_top_episodes__dbt_backup"
[0m16:01:55.333926 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m16:01:55.334260 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:55.335265 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:55.337948 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m16:01:55.338211 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m16:01:55.339151 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:55.340233 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m16:01:55.340468 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m16:01:55.340663 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m16:01:55.341612 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m16:01:55.344581 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m16:01:55.345205 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m16:01:55.345485 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop table if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m16:01:55.345888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m16:01:55.346089 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m16:01:55.346302 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  
    

  create  table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
  
  
    as
  
  (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
  
[0m16:01:55.347797 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:01:55.348572 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m16:01:55.348935 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3ec910>]}
[0m16:01:55.349310 [info ] [Thread-3 (]: 35 of 39 OK created sql table model public.mart_top_episodes ................... [[32mSELECT 50[0m in 0.12s]
[0m16:01:55.349631 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m16:01:55.397757 [debug] [Thread-1 (]: SQL status: SELECT 100 in 0.051 seconds
[0m16:01:55.400708 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m16:01:55.400939 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics" rename to "mart_user_session_metrics__dbt_backup"
[0m16:01:55.402076 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:55.404629 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m16:01:55.404918 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m16:01:55.405802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m16:01:55.406724 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m16:01:55.406929 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m16:01:55.407109 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m16:01:55.408654 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m16:01:55.411710 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m16:01:55.412179 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m16:01:55.412381 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop table if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m16:01:55.414904 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m16:01:55.415766 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m16:01:55.416134 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f76d50b2-be25-48cf-9233-05c0a1bfc74d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a56e90>]}
[0m16:01:55.416511 [info ] [Thread-1 (]: 39 of 39 OK created sql table model public.mart_user_session_metrics ........... [[32mSELECT 100[0m in 0.10s]
[0m16:01:55.416839 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m16:01:55.417613 [info ] [MainThread]: 
[0m16:01:55.417854 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:55.418009 [debug] [MainThread]: On master: BEGIN
[0m16:01:55.418161 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:01:55.429895 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:01:55.430213 [debug] [MainThread]: On master: COMMIT
[0m16:01:55.430385 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:55.430544 [debug] [MainThread]: On master: COMMIT
[0m16:01:55.431162 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:01:55.444990 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:55.445329 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
    select artifacts_model, metadata_hash from "podcast_analytics"."public_public"."dbt_artifacts_hashes"
    order by metadata_hash
    
  
[0m16:01:55.448824 [debug] [MainThread]: SQL status: SELECT 171 in 0.003 seconds
[0m16:01:55.450457 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m16:01:55.452676 [debug] [MainThread]: Elementary: [dbt_models] Artifacts already ran.
[0m16:01:55.453152 [debug] [MainThread]: Elementary: [dbt_tests] Artifacts already ran.
[0m16:01:55.453748 [debug] [MainThread]: Elementary: [dbt_sources] Artifacts already ran.
[0m16:01:55.454224 [debug] [MainThread]: Elementary: [dbt_snapshots] Artifacts already ran.
[0m16:01:55.454698 [debug] [MainThread]: Elementary: [dbt_metrics] Artifacts already ran.
[0m16:01:55.455101 [debug] [MainThread]: Elementary: [dbt_exposures] Artifacts already ran.
[0m16:01:55.455505 [debug] [MainThread]: Elementary: [dbt_seeds] Artifacts already ran.
[0m16:01:55.455910 [debug] [MainThread]: Elementary: [dbt_columns] Artifacts already ran.
[0m16:01:55.456307 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m16:01:55.458484 [debug] [MainThread]: Elementary: Uploading run results.
[0m16:01:55.459005 [debug] [MainThread]: Elementary: [dbt_run_results] Flattening the artifacts.
[0m16:01:55.486919 [debug] [MainThread]: Elementary: [dbt_run_results] Flattened 39 artifacts.
[0m16:01:55.495301 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:55.495549 [debug] [MainThread]: On master: BEGIN
[0m16:01:55.496580 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:01:55.496787 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:55.496982 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_run_results'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:55.503141 [debug] [MainThread]: SQL status: SELECT 22 in 0.006 seconds
[0m16:01:55.504382 [debug] [MainThread]: Elementary: Inserting 39 rows to table "podcast_analytics"."public_public"."dbt_run_results"
[0m16:01:55.796262 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:01:55.797103 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:55.799431 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."dbt_run_results"
         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values
    ('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.dbt_invocations','model.elementary.dbt_invocations','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'dbt_invocations','INSERT 0 0','success','model',0.46823596954345703,'2025-07-05T15:01:53.012864Z','2025-07-05T15:01:53.352359Z','2025-07-05T15:01:52.958202Z','2025-07-05T15:01:52.995662Z',0,False,'

select * from (
            select
            
                
        cast(''this_is_just_a_long_dummy_string'' as text) as invocation_id

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as job_id

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as job_name

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as job_run_id

,
                
        cast(''dummy_string'' as varchar(4096)) as run_started_at

,
                
        cast(''dummy_string'' as varchar(4096)) as run_completed_at

,
                
        cast(''dummy_string'' as varchar(4096)) as generated_at

,
                cast(''2091-02-17'' as timestamp) as created_at

,
                
        cast(''dummy_string'' as varchar(4096)) as command

,
                
        cast(''dummy_string'' as varchar(4096)) as dbt_version

,
                
        cast(''dummy_string'' as varchar(4096)) as elementary_version

,
                
        cast (True as boolean) as full_refresh

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as invocation_vars

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as vars

,
                
        cast(''dummy_string'' as varchar(4096)) as target_name

,
                
        cast(''dummy_string'' as varchar(4096)) as target_database

,
                
        cast(''dummy_string'' as varchar(4096)) as target_schema

,
                
        cast(''dummy_string'' as varchar(4096)) as target_profile_name

,
                
        cast(123456789 as integer) as threads

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as selected

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as yaml_selector

,
                
        cast(''dummy_string'' as varchar(4096)) as project_id

,
                
        cast(''dummy_string'' as varchar(4096)) as project_name

,
                
        cast(''dummy_string'' as varchar(4096)) as env

,
                
        cast(''dummy_string'' as varchar(4096)) as env_id

,
                
        cast(''dummy_string'' as varchar(4096)) as cause_category

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as cause

,
                
        cast(''dummy_string'' as varchar(4096)) as pull_request_id

,
                
        cast(''dummy_string'' as varchar(4096)) as git_sha

,
                
        cast(''dummy_string'' as varchar(4096)) as orchestrator

,
                
        cast(''dummy_string'' as varchar(4096)) as dbt_user

,
                
        cast(''dummy_string'' as varchar(4096)) as job_url

,
                
        cast(''dummy_string'' as varchar(4096)) as job_run_url

,
                
        cast(''dummy_string'' as varchar(4096)) as account_id

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as target_adapter_specific_fields


        ) as empty_table
        where 1 = 0',NULL,NULL,'Thread-4 (worker)','incremental','{"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.data_monitoring_metrics','model.elementary.data_monitoring_metrics','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'data_monitoring_metrics','INSERT 0 0','success','model',0.47195005416870117,'2025-07-05T15:01:52.971148Z','2025-07-05T15:01:53.354774Z','2025-07-05T15:01:52.885988Z','2025-07-05T15:01:52.970655Z',0,False,'


    
    
        
    
    select * from (
            select
            
                
        cast(''dummy_string'' as varchar(4096)) as id

,
                
        cast(''dummy_string'' as varchar(4096)) as full_table_name

,
                
        cast(''dummy_string'' as varchar(4096)) as column_name

,
                
        cast(''dummy_string'' as varchar(4096)) as metric_name

,
                
        cast(''dummy_string'' as varchar(4096)) as metric_type

,
                
        cast(123456789.99 as float) as metric_value

,
                
        cast(''dummy_string'' as varchar(4096)) as source_value

,
                cast(''2091-02-17'' as timestamp) as bucket_start

,
                cast(''2091-02-17'' as timestamp) as bucket_end

,
                
        cast(123456789 as integer) as bucket_duration_hours

,
                cast(''2091-02-17'' as timestamp) as updated_at

,
                
        cast(''dummy_string'' as varchar(4096)) as dimension

,
                
        cast(''dummy_string'' as varchar(4096)) as dimension_value

,
                
        cast(''dummy_string'' as varchar(4096)) as metric_properties

,
                cast(''2091-02-17'' as timestamp) as created_at


        ) as empty_table
        where 1 = 0
',NULL,NULL,'Thread-1 (worker)','incremental','{"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.dbt_exposures','model.elementary.dbt_exposures','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'dbt_exposures','INSERT 0 0','success','model',0.5119051933288574,'2025-07-05T15:01:52.989405Z','2025-07-05T15:01:53.395759Z','2025-07-05T15:01:52.915692Z','2025-07-05T15:01:52.970904Z',0,False,'

select * from (
            select
            
                
        cast(''dummy_string'' as varchar(4096)) as unique_id

,
                
        cast(''dummy_string'' as varchar(4096)) as name

,
                
        cast(''dummy_string'' as varchar(4096)) as maturity

,
                
        cast(''dummy_string'' as varchar(4096)) as type

,
                
        cast(''dummy_string'' as varchar(4096)) as owner_email

,
                
        cast(''dummy_string'' as varchar(4096)) as owner_name

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as url

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as depends_on_macros

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as depends_on_nodes

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as depends_on_columns

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as description

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as tags

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as meta

,
                
        cast(''dummy_string'' as varchar(4096)) as package_name

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as original_path

,
                
        cast(''dummy_string'' as varchar(4096)) as path

,
                
        cast(''dummy_string'' as varchar(4096)) as generated_at

,
                
        cast(''dummy_string'' as varchar(4096)) as metadata_hash

,
                
        cast(''dummy_string'' as varchar(4096)) as label

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as raw_queries


        ) as empty_table
        where 1 = 0',NULL,NULL,'Thread-3 (worker)','incremental','{"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.dbt_columns','model.elementary.dbt_columns','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'dbt_columns','INSERT 0 0','success','model',0.5164997577667236,'2025-07-05T15:01:53.008845Z','2025-07-05T15:01:53.399354Z','2025-07-05T15:01:52.908032Z','2025-07-05T15:01:52.989148Z',0,False,'

select * from (
            select
            
                
        cast(''dummy_string'' as varchar(4096)) as unique_id

,
                
        cast(''dummy_string'' as varchar(4096)) as parent_unique_id

,
                
        cast(''dummy_string'' as varchar(4096)) as name

,
                
        cast(''dummy_string'' as varchar(4096)) as data_type

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as tags

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as meta

,
                
        cast(''dummy_string'' as varchar(4096)) as database_name

,
                
        cast(''dummy_string'' as varchar(4096)) as schema_name

,
                
        cast(''dummy_string'' as varchar(4096)) as table_name

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as description

,
                
        cast(''dummy_string'' as varchar(4096)) as resource_type

,
                
        cast(''dummy_string'' as varchar(4096)) as generated_at

,
                
        cast(''dummy_string'' as varchar(4096)) as metadata_hash


        ) as empty_table
        where 1 = 0',NULL,NULL,'Thread-2 (worker)','incremental','{"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.dbt_metrics','model.elementary.dbt_metrics','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'dbt_metrics','INSERT 0 0','success','model',0.25934886932373047,'2025-07-05T15:01:53.386657Z','2025-07-05T15:01:53.618777Z','2025-07-05T15:01:53.364836Z','2025-07-05T15:01:53.385192Z',0,False,'

select * from (
            select
            
                
        cast(''dummy_string'' as varchar(4096)) as unique_id

,
                
        cast(''dummy_string'' as varchar(4096)) as name

,
                
        cast(''dummy_string'' as varchar(4096)) as label

,
                
        cast(''dummy_string'' as varchar(4096)) as model

,
                
        cast(''dummy_string'' as varchar(4096)) as type

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as sql

,
                
        cast(''dummy_string'' as varchar(4096)) as timestamp

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as filters

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as time_grains

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as dimensions

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as depends_on_macros

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as depends_on_nodes

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as description

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as tags

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as meta

,
                
        cast(''dummy_string'' as varchar(4096)) as package_name

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as original_path

,
                
        cast(''dummy_string'' as varchar(4096)) as path

,
                
        cast(''dummy_string'' as varchar(4096)) as generated_at

,
                
        cast(''dummy_string'' as varchar(4096)) as metadata_hash


        ) as empty_table
        where 1 = 0',NULL,NULL,'Thread-4 (worker)','incremental','{"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.dbt_models','model.elementary.dbt_models','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'dbt_models','INSERT 0 0','success','model',0.25835609436035156,'2025-07-05T15:01:53.391282Z','2025-07-05T15:01:53.619407Z','2025-07-05T15:01:53.375117Z','2025-07-05T15:01:53.386319Z',0,False,'

select * from (
            select
            
                
        cast(''dummy_string'' as varchar(4096)) as unique_id

,
                
        cast(''dummy_string'' as varchar(4096)) as alias

,
                
        cast(''dummy_string'' as varchar(4096)) as checksum

,
                
        cast(''dummy_string'' as varchar(4096)) as materialization

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as tags

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as meta

,
                
        cast(''dummy_string'' as varchar(4096)) as owner

,
                
        cast(''dummy_string'' as varchar(4096)) as database_name

,
                
        cast(''dummy_string'' as varchar(4096)) as schema_name

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as depends_on_macros

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as depends_on_nodes

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as description

,
                
        cast(''dummy_string'' as varchar(4096)) as name

,
                
        cast(''dummy_string'' as varchar(4096)) as package_name

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as original_path

,
                
        cast(''dummy_string'' as varchar(4096)) as path

,
                
        cast(''dummy_string'' as varchar(4096)) as patch_path

,
                
        cast(''dummy_string'' as varchar(4096)) as generated_at

,
                
        cast(''dummy_string'' as varchar(4096)) as metadata_hash

,
                
        cast(''dummy_string'' as varchar(4096)) as unique_key

,
                
        cast(''dummy_string'' as varchar(4096)) as incremental_strategy


        ) as empty_table
        where 1 = 0',NULL,NULL,'Thread-1 (worker)','incremental','{"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.dbt_run_results','model.elementary.dbt_run_results','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'dbt_run_results','INSERT 0 0','success','model',0.22225713729858398,'2025-07-05T15:01:53.428176Z','2025-07-05T15:01:53.620953Z','2025-07-05T15:01:53.401861Z','2025-07-05T15:01:53.423313Z',0,False,'

select * from (
            select
            
                
        cast(''this_is_just_a_long_dummy_string'' as text) as model_execution_id

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as unique_id

,
                
        cast(''dummy_string'' as varchar(4096)) as invocation_id

,
                
        cast(''dummy_string'' as varchar(4096)) as generated_at

,
                cast(''2091-02-17'' as timestamp) as created_at

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as name

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as message

,
                
        cast(''dummy_string'' as varchar(4096)) as status

,
                
        cast(''dummy_string'' as varchar(4096)) as resource_type

,
                
        cast(123456789.99 as float) as execution_time

,
                
        cast(''dummy_string'' as varchar(4096)) as execute_started_at

,
                
        cast(''dummy_string'' as varchar(4096)) as execute_completed_at

,
                
        cast(''dummy_string'' as varchar(4096)) as compile_started_at

,
                
        cast(''dummy_string'' as varchar(4096)) as compile_completed_at

,
                
        cast(31474836478 as bigint) as rows_affected

,
                
        cast (True as boolean) as full_refresh

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as compiled_code

,
                
        cast(31474836478 as bigint) as failures

,
                
        cast(''dummy_string'' as varchar(4096)) as query_id

,
                
        cast(''dummy_string'' as varchar(4096)) as thread_id

,
                
        cast(''dummy_string'' as varchar(4096)) as materialization

,
                
        cast(''dummy_string'' as varchar(4096)) as adapter_response


        ) as empty_table
        where 1 = 0',NULL,NULL,'Thread-3 (worker)','incremental','{"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.dbt_seeds','model.elementary.dbt_seeds','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'dbt_seeds','INSERT 0 0','success','model',0.26030898094177246,'2025-07-05T15:01:53.435855Z','2025-07-05T15:01:53.676143Z','2025-07-05T15:01:53.416694Z','2025-07-05T15:01:53.435185Z',0,False,'

select * from (
            select
            
                
        cast(''dummy_string'' as varchar(4096)) as unique_id

,
                
        cast(''dummy_string'' as varchar(4096)) as alias

,
                
        cast(''dummy_string'' as varchar(4096)) as checksum

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as tags

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as meta

,
                
        cast(''dummy_string'' as varchar(4096)) as owner

,
                
        cast(''dummy_string'' as varchar(4096)) as database_name

,
                
        cast(''dummy_string'' as varchar(4096)) as schema_name

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as description

,
                
        cast(''dummy_string'' as varchar(4096)) as name

,
                
        cast(''dummy_string'' as varchar(4096)) as package_name

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as original_path

,
                
        cast(''dummy_string'' as varchar(4096)) as path

,
                
        cast(''dummy_string'' as varchar(4096)) as generated_at

,
                
        cast(''dummy_string'' as varchar(4096)) as metadata_hash


        ) as empty_table
        where 1 = 0',NULL,NULL,'Thread-2 (worker)','incremental','{"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.dbt_source_freshness_results','model.elementary.dbt_source_freshness_results','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'dbt_source_freshness_results','INSERT 0 0','success','model',0.3161439895629883,'2025-07-05T15:01:53.665505Z','2025-07-05T15:01:53.940343Z','2025-07-05T15:01:53.634704Z','2025-07-05T15:01:53.657127Z',0,False,'


    select * from (
            select
            
                
        cast(''dummy_string'' as varchar(4096)) as source_freshness_execution_id

,
                
        cast(''dummy_string'' as varchar(4096)) as unique_id

,
                
        cast(''dummy_string'' as varchar(4096)) as max_loaded_at

,
                
        cast(''dummy_string'' as varchar(4096)) as snapshotted_at

,
                
        cast(''dummy_string'' as varchar(4096)) as generated_at

,
                cast(''2091-02-17'' as timestamp) as created_at

,
                
        cast(123456789.99 as float) as max_loaded_at_time_ago_in_s

,
                
        cast(''dummy_string'' as varchar(4096)) as status

,
                
        cast(''dummy_string'' as varchar(4096)) as error

,
                
        cast(''dummy_string'' as varchar(4096)) as compile_started_at

,
                
        cast(''dummy_string'' as varchar(4096)) as compile_completed_at

,
                
        cast(''dummy_string'' as varchar(4096)) as execute_started_at

,
                
        cast(''dummy_string'' as varchar(4096)) as execute_completed_at

,
                
        cast(''dummy_string'' as varchar(4096)) as invocation_id

,
                
        cast(''dummy_string'' as varchar(4096)) as warn_after

,
                
        cast(''dummy_string'' as varchar(4096)) as error_after

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as filter


        ) as empty_table
        where 1 = 0
',NULL,NULL,'Thread-1 (worker)','incremental','{"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.dbt_sources','model.elementary.dbt_sources','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'dbt_sources','INSERT 0 0','success','model',0.31903791427612305,'2025-07-05T15:01:53.657358Z','2025-07-05T15:01:53.945229Z','2025-07-05T15:01:53.643217Z','2025-07-05T15:01:53.656186Z',0,False,'

select * from (
            select
            
                
        cast(''dummy_string'' as varchar(4096)) as unique_id

,
                
        cast(''dummy_string'' as varchar(4096)) as database_name

,
                
        cast(''dummy_string'' as varchar(4096)) as schema_name

,
                
        cast(''dummy_string'' as varchar(4096)) as source_name

,
                
        cast(''dummy_string'' as varchar(4096)) as name

,
                
        cast(''dummy_string'' as varchar(4096)) as identifier

,
                
        cast(''dummy_string'' as varchar(4096)) as loaded_at_field

,
                
        cast(''dummy_string'' as varchar(4096)) as freshness_warn_after

,
                
        cast(''dummy_string'' as varchar(4096)) as freshness_error_after

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as freshness_filter

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as freshness_description

,
                
        cast(''dummy_string'' as varchar(4096)) as relation_name

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as tags

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as meta

,
                
        cast(''dummy_string'' as varchar(4096)) as owner

,
                
        cast(''dummy_string'' as varchar(4096)) as package_name

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as original_path

,
                
        cast(''dummy_string'' as varchar(4096)) as path

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as source_description

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as description

,
                
        cast(''dummy_string'' as varchar(4096)) as generated_at

,
                
        cast(''dummy_string'' as varchar(4096)) as metadata_hash


        ) as empty_table
        where 1 = 0',NULL,NULL,'Thread-3 (worker)','incremental','{"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.dbt_snapshots','model.elementary.dbt_snapshots','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'dbt_snapshots','INSERT 0 0','success','model',0.32009387016296387,'2025-07-05T15:01:53.661254Z','2025-07-05T15:01:53.945868Z','2025-07-05T15:01:53.628216Z','2025-07-05T15:01:53.656429Z',0,False,'

select * from (
            select
            
                
        cast(''dummy_string'' as varchar(4096)) as unique_id

,
                
        cast(''dummy_string'' as varchar(4096)) as alias

,
                
        cast(''dummy_string'' as varchar(4096)) as checksum

,
                
        cast(''dummy_string'' as varchar(4096)) as materialization

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as tags

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as meta

,
                
        cast(''dummy_string'' as varchar(4096)) as owner

,
                
        cast(''dummy_string'' as varchar(4096)) as database_name

,
                
        cast(''dummy_string'' as varchar(4096)) as schema_name

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as depends_on_macros

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as depends_on_nodes

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as description

,
                
        cast(''dummy_string'' as varchar(4096)) as name

,
                
        cast(''dummy_string'' as varchar(4096)) as package_name

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as original_path

,
                
        cast(''dummy_string'' as varchar(4096)) as path

,
                
        cast(''dummy_string'' as varchar(4096)) as patch_path

,
                
        cast(''dummy_string'' as varchar(4096)) as generated_at

,
                
        cast(''dummy_string'' as varchar(4096)) as metadata_hash

,
                
        cast(''dummy_string'' as varchar(4096)) as unique_key

,
                
        cast(''dummy_string'' as varchar(4096)) as incremental_strategy


        ) as empty_table
        where 1 = 0',NULL,NULL,'Thread-4 (worker)','incremental','{"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.dbt_tests','model.elementary.dbt_tests','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'dbt_tests','INSERT 0 0','success','model',0.3007340431213379,'2025-07-05T15:01:53.690340Z','2025-07-05T15:01:53.973680Z','2025-07-05T15:01:53.678643Z','2025-07-05T15:01:53.690028Z',0,False,'

select * from (
            select
            
                
        cast(''dummy_string'' as varchar(4096)) as unique_id

,
                
        cast(''dummy_string'' as varchar(4096)) as database_name

,
                
        cast(''dummy_string'' as varchar(4096)) as schema_name

,
                
        cast(''dummy_string'' as varchar(4096)) as name

,
                
        cast(''dummy_string'' as varchar(4096)) as short_name

,
                
        cast(''dummy_string'' as varchar(4096)) as alias

,
                
        cast(''dummy_string'' as varchar(4096)) as test_column_name

,
                
        cast(''dummy_string'' as varchar(4096)) as severity

,
                
        cast(''dummy_string'' as varchar(4096)) as warn_if

,
                
        cast(''dummy_string'' as varchar(4096)) as error_if

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as test_params

,
                
        cast(''dummy_string'' as varchar(4096)) as test_namespace

,
                
        cast(''dummy_string'' as varchar(4096)) as test_original_name

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as tags

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as model_tags

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as model_owners

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as meta

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as depends_on_macros

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as depends_on_nodes

,
                
        cast(''dummy_string'' as varchar(4096)) as parent_model_unique_id

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as description

,
                
        cast(''dummy_string'' as varchar(4096)) as package_name

,
                
        cast(''dummy_string'' as varchar(4096)) as type

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as original_path

,
                
        cast(''dummy_string'' as varchar(4096)) as path

,
                
        cast(''dummy_string'' as varchar(4096)) as generated_at

,
                
        cast(''dummy_string'' as varchar(4096)) as metadata_hash

,
                
        cast(''dummy_string'' as varchar(4096)) as quality_dimension


        ) as empty_table
        where 1 = 0',NULL,NULL,'Thread-2 (worker)','incremental','{"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.metadata','model.elementary.metadata','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'metadata','SELECT 1','success','model',0.17661094665527344,'2025-07-05T15:01:53.979229Z','2025-07-05T15:01:54.135289Z','2025-07-05T15:01:53.961891Z','2025-07-05T15:01:53.977975Z',1,False,'

SELECT
    ''0.18.2'' as dbt_pkg_version',NULL,NULL,'Thread-3 (worker)','table','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.podcast_analytics.stg_episodes','model.podcast_analytics.stg_episodes','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'stg_episodes','CREATE VIEW','success','model',0.14508891105651855,'2025-07-05T15:01:54.000111Z','2025-07-05T15:01:54.140217Z','2025-07-05T15:01:53.996638Z','2025-07-05T15:01:53.999768Z',-1,False,'-- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source',NULL,NULL,'Thread-2 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.elementary_test_results','model.elementary.elementary_test_results','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'elementary_test_results','INSERT 0 0','success','model',0.1966569423675537,'2025-07-05T15:01:53.973985Z','2025-07-05T15:01:54.143368Z','2025-07-05T15:01:53.950331Z','2025-07-05T15:01:53.965981Z',0,False,'


    select * from (
            select
            
                
        cast(''this_is_just_a_long_dummy_string'' as text) as id

,
                
        cast(''dummy_string'' as varchar(4096)) as data_issue_id

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as test_execution_id

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as test_unique_id

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as model_unique_id

,
                
        cast(''dummy_string'' as varchar(4096)) as invocation_id

,
                cast(''2091-02-17'' as timestamp) as detected_at

,
                cast(''2091-02-17'' as timestamp) as created_at

,
                
        cast(''dummy_string'' as varchar(4096)) as database_name

,
                
        cast(''dummy_string'' as varchar(4096)) as schema_name

,
                
        cast(''dummy_string'' as varchar(4096)) as table_name

,
                
        cast(''dummy_string'' as varchar(4096)) as column_name

,
                
        cast(''dummy_string'' as varchar(4096)) as test_type

,
                
        cast(''dummy_string'' as varchar(4096)) as test_sub_type

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as test_results_description

,
                
        cast(''dummy_string'' as varchar(4096)) as owners

,
                
        cast(''dummy_string'' as varchar(4096)) as tags

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as test_results_query

,
                
        cast(''dummy_string'' as varchar(4096)) as other

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as test_name

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as test_params

,
                
        cast(''dummy_string'' as varchar(4096)) as severity

,
                
        cast(''dummy_string'' as varchar(4096)) as status

,
                
        cast(31474836478 as bigint) as failures

,
                
        cast(''dummy_string'' as varchar(4096)) as test_short_name

,
                
        cast(''dummy_string'' as varchar(4096)) as test_alias

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as result_rows

,
                
        cast(31474836478 as bigint) as failed_row_count


        ) as empty_table
        where 1 = 0
',NULL,NULL,'Thread-1 (worker)','incremental','{"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.schema_columns_snapshot','model.elementary.schema_columns_snapshot','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'schema_columns_snapshot','INSERT 0 0','success','model',0.18584203720092773,'2025-07-05T15:01:53.989457Z','2025-07-05T15:01:54.144963Z','2025-07-05T15:01:53.966289Z','2025-07-05T15:01:53.988285Z',0,False,'


    select * from (
            select
            
                
        cast(''dummy_string'' as varchar(4096)) as column_state_id

,
                
        cast(''dummy_string'' as varchar(4096)) as full_column_name

,
                
        cast(''dummy_string'' as varchar(4096)) as full_table_name

,
                
        cast(''dummy_string'' as varchar(4096)) as column_name

,
                
        cast(''dummy_string'' as varchar(4096)) as data_type

,
                
        cast (True as boolean) as is_new

,
                cast(''2091-02-17'' as timestamp) as detected_at

,
                cast(''2091-02-17'' as timestamp) as created_at


        ) as empty_table
        where 1 = 0
',NULL,NULL,'Thread-4 (worker)','incremental','{"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.podcast_analytics.stg_user_events_invalid','model.podcast_analytics.stg_user_events_invalid','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'stg_user_events_invalid','CREATE VIEW','success','model',0.1460428237915039,'2025-07-05T15:01:54.172946Z','2025-07-05T15:01:54.303450Z','2025-07-05T15:01:54.161197Z','2025-07-05T15:01:54.169488Z',-1,False,'-- stg_user_events_invalid.sql : capture invalid event records for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

invalid_events as (
    select 
        data,
        data ->> ''user_id'' as user_id,
        data ->> ''episode_id'' as episode_id,
        data ->> ''timestamp'' as timestamp,
        data ->> ''event_type'' as event_type,
        data ->> ''duration'' as duration,
        case 
            when data ->> ''event_type'' is null then ''missing_event_type''
            when data ->> ''event_type'' not in (''play'', ''pause'', ''seek'', ''complete'') then ''invalid_event_type''
            when data ->> ''timestamp'' is null or data ->> ''timestamp'' = '''' then ''missing_timestamp''
            when not ((data ->> ''timestamp'') ~ ''^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}'') then ''malformed_timestamp''
            when data ->> ''user_id'' is null then ''missing_user_id''
            when data ->> ''episode_id'' is null then ''missing_episode_id''
            else ''other_issue''
        end as issue_type
    from source
    where data ->> ''event_type'' is null 
       or data ->> ''event_type'' not in (''play'', ''pause'', ''seek'', ''complete'')
       or data ->> ''timestamp'' is null 
       or data ->> ''timestamp'' = ''''
       or not ((data ->> ''timestamp'') ~ ''^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}'')
       or data ->> ''user_id'' is null
       or data ->> ''episode_id'' is null
)

select * from invalid_events',NULL,NULL,'Thread-2 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.podcast_analytics.stg_user_events','model.podcast_analytics.stg_user_events','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'stg_user_events','CREATE VIEW','success','model',0.16120004653930664,'2025-07-05T15:01:54.164049Z','2025-07-05T15:01:54.304105Z','2025-07-05T15:01:54.147675Z','2025-07-05T15:01:54.160713Z',-1,False,'-- stg_user_events.sql : typed raw event records from JSONB
-- Note: Invalid events are captured in stg_user_events_invalid.sql for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

valid_events as (
    select * from source
    where data ->> ''event_type'' is not null
      and data ->> ''event_type'' in (''play'', ''pause'', ''seek'', ''complete'')
      and data ->> ''timestamp'' is not null
      and data ->> ''timestamp'' != ''''
      and data ->> ''user_id'' is not null
      and data ->> ''episode_id'' is not null
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> ''user_id'' as TEXT), ''_dbt_utils_surrogate_key_null_'') || ''-'' || coalesce(cast(data ->> ''episode_id'' as TEXT), ''_dbt_utils_surrogate_key_null_'') || ''-'' || coalesce(cast(data ->> ''timestamp'' as TEXT), ''_dbt_utils_surrogate_key_null_'') || ''-'' || coalesce(cast(data ->> ''event_type'' as TEXT), ''_dbt_utils_surrogate_key_null_'') as TEXT)) as event_id,
        data ->> ''user_id''      as user_id,
        data ->> ''episode_id''   as episode_id,
        case 
            when (data ->> ''timestamp'') ~ ''^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}'' then (data ->> ''timestamp'')::timestamp
            else null
        end as event_ts,
        data ->> ''event_type''         as event_type,
        (data ->> ''duration'')::integer as duration
    from valid_events
    where (data ->> ''timestamp'') ~ ''^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}''
)
select * from typed',NULL,NULL,'Thread-3 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.podcast_analytics.stg_users','model.podcast_analytics.stg_users','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'stg_users','CREATE VIEW','success','model',0.14673876762390137,'2025-07-05T15:01:54.191718Z','2025-07-05T15:01:54.309322Z','2025-07-05T15:01:54.169772Z','2025-07-05T15:01:54.188211Z',-1,False,'-- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source',NULL,NULL,'Thread-1 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.job_run_results','model.elementary.job_run_results','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'job_run_results','CREATE VIEW','success','model',0.14380097389221191,'2025-07-05T15:01:54.196393Z','2025-07-05T15:01:54.311422Z','2025-07-05T15:01:54.176614Z','2025-07-05T15:01:54.196106Z',-1,False,'





with jobs as (
  select
    job_name,
    job_id,
    job_run_id,
    
min(cast(run_started_at as timestamp))
 as job_run_started_at,
    
max(cast(run_completed_at as timestamp))
 as job_run_completed_at,
    
    
        (
        (
        (
        ((
max(cast(run_completed_at as timestamp))
)::date - (
min(cast(run_started_at as timestamp))
)::date)
     * 24 + date_part(''hour'', (
max(cast(run_completed_at as timestamp))
)::timestamp) - date_part(''hour'', (
min(cast(run_started_at as timestamp))
)::timestamp))
     * 60 + date_part(''minute'', (
max(cast(run_completed_at as timestamp))
)::timestamp) - date_part(''minute'', (
min(cast(run_started_at as timestamp))
)::timestamp))
     * 60 + floor(date_part(''second'', (
max(cast(run_completed_at as timestamp))
)::timestamp)) - floor(date_part(''second'', (
min(cast(run_started_at as timestamp))
)::timestamp)))
    
 as job_run_execution_time
  from "podcast_analytics"."public_public"."dbt_invocations"
  where job_id is not null
  group by job_name, job_id, job_run_id
)

select
  job_name as name,
  job_id as id,
  job_run_id as run_id,
  job_run_started_at as run_started_at,
  job_run_completed_at as run_completed_at,
  job_run_execution_time as run_execution_time
from jobs',NULL,NULL,'Thread-4 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.monitors_runs','model.elementary.monitors_runs','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'monitors_runs','CREATE VIEW','success','model',0.11020588874816895,'2025-07-05T15:01:54.338968Z','2025-07-05T15:01:54.420614Z','2025-07-05T15:01:54.328954Z','2025-07-05T15:01:54.333519Z',-1,False,'

with data_monitoring_metrics as (

    select * from "podcast_analytics"."public_public"."data_monitoring_metrics"

),

max_bucket_end as (

    select full_table_name,
           column_name,
           metric_name,
           metric_properties,
           max(bucket_end) as last_bucket_end,
           min(bucket_end) as first_bucket_end
    from data_monitoring_metrics
    group by 1,2,3,4

)

select * from max_bucket_end',NULL,NULL,'Thread-3 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.metrics_anomaly_score','model.elementary.metrics_anomaly_score','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'metrics_anomaly_score','CREATE VIEW','success','model',0.1122128963470459,'2025-07-05T15:01:54.333755Z','2025-07-05T15:01:54.421341Z','2025-07-05T15:01:54.313462Z','2025-07-05T15:01:54.332735Z',-1,False,'

with data_monitoring_metrics as (

    select * from "podcast_analytics"."public_public"."data_monitoring_metrics"

),

time_window_aggregation as (

    select
        id,
        full_table_name,
        column_name,
        dimension,
        dimension_value,
        metric_name,
        metric_value,
        source_value,
        bucket_start,
        bucket_end,
        bucket_duration_hours,
        updated_at,
        avg(metric_value) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) as training_avg,
        stddev(metric_value) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) as training_stddev,
        count(metric_value) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) as training_set_size,
        last_value(bucket_end) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) training_end,
        first_value(bucket_end) over (partition by metric_name, full_table_name, column_name order by bucket_start asc rows between unbounded preceding and current row) as training_start
    from data_monitoring_metrics
    group by 1,2,3,4,5,6,7,8,9,10,11,12
),

metrics_anomaly_score as (

    select
        id,
        full_table_name,
        column_name,
        dimension,
        dimension_value,
        metric_name,
        case
            when training_stddev is null then null
            when training_stddev = 0 then 0
            else (metric_value - training_avg) / (training_stddev)
        end as anomaly_score,
        metric_value as latest_metric_value,
        bucket_start,
        bucket_end,
        training_avg,
        training_stddev,
        training_start,
        training_end,
        training_set_size,
        max(updated_at) as updated_at
    from time_window_aggregation
        where
            metric_value is not null
            and training_avg is not null
            and bucket_end >= 
    cast(date_trunc(''day'', 
    current_timestamp::timestamp
) as timestamp) + cast(-7 as integer) * INTERVAL ''1 day''

    group by 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15
    order by bucket_end desc


),

final as (

    select
        id,
        full_table_name,
        column_name,
        dimension,
        dimension_value,
        metric_name,
        anomaly_score,
        latest_metric_value,
        bucket_start,
        bucket_end,
        training_avg,
        training_stddev,
        training_start,
        training_end,
        training_set_size,
        updated_at,
        case
            when abs(anomaly_score) > 3 then true
            else false end
        as is_anomaly
    from metrics_anomaly_score
)

select * from final',NULL,NULL,'Thread-2 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.model_run_results','model.elementary.model_run_results','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'model_run_results','CREATE VIEW','success','model',0.10460400581359863,'2025-07-05T15:01:54.354928Z','2025-07-05T15:01:54.442193Z','2025-07-05T15:01:54.343895Z','2025-07-05T15:01:54.354364Z',-1,False,'

with dbt_run_results as (
    select * from "podcast_analytics"."public_public"."dbt_run_results"
),

dbt_models as (
    select * from "podcast_analytics"."public_public"."dbt_models"
)

SELECT
    run_results.model_execution_id,
    run_results.unique_id,
    run_results.invocation_id,
    run_results.query_id,
    run_results.name,
    run_results.generated_at,
    run_results.status,
    run_results.full_refresh,
    run_results.message,
    run_results.execution_time,
    run_results.execute_started_at,
    run_results.execute_completed_at,
    run_results.compile_started_at,
    run_results.compile_completed_at,
    run_results.compiled_code,
    run_results.adapter_response,
    run_results.thread_id,
    models.database_name,
    models.schema_name,
    coalesce(run_results.materialization, models.materialization) as materialization,
    models.tags,
    models.package_name,
    models.path,
    models.original_path,
    models.owner,
    models.alias,
    ROW_NUMBER() OVER (PARTITION BY run_results.unique_id ORDER BY run_results.generated_at DESC) AS model_invocation_reverse_index,
    CASE WHEN FIRST_VALUE(invocation_id) OVER (PARTITION BY 
    date_trunc(''day'', cast(run_results.generated_at as timestamp))
 ORDER BY run_results.generated_at ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING ) = invocation_id
              THEN TRUE
              ELSE FALSE 
         END                                                               AS is_the_first_invocation_of_the_day,
    CASE WHEN LAST_VALUE(invocation_id) OVER (PARTITION BY 
    date_trunc(''day'', cast(run_results.generated_at as timestamp))
 ORDER BY run_results.generated_at ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING ) = invocation_id
              THEN TRUE
              ELSE FALSE 
         END                                                               AS is_the_last_invocation_of_the_day
    
FROM dbt_run_results run_results
JOIN dbt_models models ON run_results.unique_id = models.unique_id',NULL,NULL,'Thread-1 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.alerts_dbt_source_freshness','model.elementary.alerts_dbt_source_freshness','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'alerts_dbt_source_freshness','CREATE VIEW','success','model',0.07024502754211426,'2025-07-05T15:01:54.443257Z','2025-07-05T15:01:54.501111Z','2025-07-05T15:01:54.433446Z','2025-07-05T15:01:54.442548Z',-1,False,'

with results as (
  select * from "podcast_analytics"."public_public"."dbt_source_freshness_results"
),

sources as (
  select * from "podcast_analytics"."public_public"."dbt_sources"
)

select
  results.source_freshness_execution_id as alert_id,
  results.max_loaded_at,
  results.snapshotted_at,
  cast(results.generated_at as timestamp) as detected_at,
  results.max_loaded_at_time_ago_in_s,
  results.status,
  results.error,
  results.warn_after,
  results.error_after,
  results.filter,
  sources.unique_id,
  sources.database_name,
  sources.schema_name,
  sources.source_name,
  sources.identifier,
  sources.tags,
  sources.meta,
  sources.owner,
  sources.package_name,
  sources.path,
  -- These columns below are deprecated. We add them since this view
  -- was used to be loaded into an incremental model with those columns, their names were later changed
  -- and Databricks doesn''t respect `on_schema_change = ''append_new_columns''` properly, as described here -
  -- https://docs.databricks.com/en/delta/update-schema.html#automatic-schema-evolution-for-delta-lake-merge
  results.error_after as freshness_error_after,
  results.warn_after as freshness_warn_after,
  results.filter as freshness_filter
from results
join sources on results.unique_id = sources.unique_id
where True and lower(status) != ''pass''',NULL,NULL,'Thread-3 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.seed_run_results','model.elementary.seed_run_results','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'seed_run_results','CREATE VIEW','success','model',0.08692789077758789,'2025-07-05T15:01:54.359226Z','2025-07-05T15:01:54.428720Z','2025-07-05T15:01:54.350176Z','2025-07-05T15:01:54.358960Z',-1,False,'

with dbt_run_results as (
    select * from "podcast_analytics"."public_public"."dbt_run_results"
),

dbt_seeds as (
    select * from "podcast_analytics"."public_public"."dbt_seeds"
)

SELECT
    run_results.model_execution_id,
    run_results.unique_id,
    run_results.invocation_id,
    run_results.query_id,
    run_results.name,
    run_results.generated_at,
    run_results.status,
    run_results.full_refresh,
    run_results.message,
    run_results.execution_time,
    run_results.execute_started_at,
    run_results.execute_completed_at,
    run_results.compile_started_at,
    run_results.compile_completed_at,
    run_results.compiled_code,
    run_results.adapter_response,
    run_results.thread_id,
    seeds.database_name,
    seeds.schema_name,
    run_results.materialization,
    seeds.tags,
    seeds.package_name,
    seeds.path,
    seeds.original_path,
    seeds.owner,
    seeds.alias
FROM dbt_run_results run_results
JOIN dbt_seeds seeds ON run_results.unique_id = seeds.unique_id',NULL,NULL,'Thread-4 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.snapshot_run_results','model.elementary.snapshot_run_results','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'snapshot_run_results','CREATE VIEW','success','model',0.07018327713012695,'2025-07-05T15:01:54.448663Z','2025-07-05T15:01:54.501757Z','2025-07-05T15:01:54.438346Z','2025-07-05T15:01:54.448011Z',-1,False,'

with dbt_run_results as (
    select * from "podcast_analytics"."public_public"."dbt_run_results"
),

dbt_snapshots as (
    select * from "podcast_analytics"."public_public"."dbt_snapshots"
)

SELECT
    run_results.model_execution_id,
    run_results.unique_id,
    run_results.invocation_id,
    run_results.query_id,
    run_results.name,
    run_results.generated_at,
    run_results.status,
    run_results.full_refresh,
    run_results.message,
    run_results.execution_time,
    run_results.execute_started_at,
    run_results.execute_completed_at,
    run_results.compile_started_at,
    run_results.compile_completed_at,
    run_results.compiled_code,
    run_results.adapter_response,
    run_results.thread_id,
    snapshots.database_name,
    snapshots.schema_name,
    coalesce(run_results.materialization, snapshots.materialization) as materialization,
    snapshots.tags,
    snapshots.package_name,
    snapshots.path,
    snapshots.original_path,
    snapshots.owner,
    snapshots.alias
FROM dbt_run_results run_results
JOIN dbt_snapshots snapshots ON run_results.unique_id = snapshots.unique_id',NULL,NULL,'Thread-2 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.dbt_artifacts_hashes','model.elementary.dbt_artifacts_hashes','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'dbt_artifacts_hashes','CREATE VIEW','success','model',0.1780087947845459,'2025-07-05T15:01:54.951902Z','2025-07-05T15:01:55.063836Z','2025-07-05T15:01:54.889683Z','2025-07-05T15:01:54.951448Z',-1,False,'




select
  ''dbt_models'' as artifacts_model,
   metadata_hash
from "podcast_analytics"."public_public"."dbt_models"
 union all 

select
  ''dbt_tests'' as artifacts_model,
   metadata_hash
from "podcast_analytics"."public_public"."dbt_tests"
 union all 

select
  ''dbt_sources'' as artifacts_model,
   metadata_hash
from "podcast_analytics"."public_public"."dbt_sources"
 union all 

select
  ''dbt_snapshots'' as artifacts_model,
   metadata_hash
from "podcast_analytics"."public_public"."dbt_snapshots"
 union all 

select
  ''dbt_metrics'' as artifacts_model,
   metadata_hash
from "podcast_analytics"."public_public"."dbt_metrics"
 union all 

select
  ''dbt_exposures'' as artifacts_model,
   metadata_hash
from "podcast_analytics"."public_public"."dbt_exposures"
 union all 

select
  ''dbt_seeds'' as artifacts_model,
   metadata_hash
from "podcast_analytics"."public_public"."dbt_seeds"
 union all 

select
  ''dbt_columns'' as artifacts_model,
   metadata_hash
from "podcast_analytics"."public_public"."dbt_columns"


order by metadata_hash',NULL,NULL,'Thread-1 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.alerts_anomaly_detection','model.elementary.alerts_anomaly_detection','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'alerts_anomaly_detection','CREATE VIEW','success','model',0.17697906494140625,'2025-07-05T15:01:54.959296Z','2025-07-05T15:01:55.064901Z','2025-07-05T15:01:54.897683Z','2025-07-05T15:01:54.956002Z',-1,False,'

with elementary_test_results as (
    select * from "podcast_analytics"."public_public"."elementary_test_results"
),

alerts_anomaly_detection as (
    select id as alert_id,
           data_issue_id,
           test_execution_id,
           test_unique_id,
           model_unique_id,
           detected_at,
           database_name,
           schema_name,
           table_name,
           column_name,
           test_type as alert_type,
           test_sub_type as sub_type,
           test_results_description as alert_description,
           owners,
           tags,
           test_results_query as alert_results_query,
           other,
           test_name,
           test_short_name,
           test_params,
           severity,
           status,
           result_rows
        from elementary_test_results
        where True and lower(status) != ''pass''and lower(status) != ''skipped''and test_type = ''anomaly_detection''
)

select * from alerts_anomaly_detection',NULL,NULL,'Thread-4 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.alerts_dbt_tests','model.elementary.alerts_dbt_tests','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'alerts_dbt_tests','CREATE VIEW','success','model',0.18004798889160156,'2025-07-05T15:01:54.962620Z','2025-07-05T15:01:55.067282Z','2025-07-05T15:01:54.947956Z','2025-07-05T15:01:54.956304Z',-1,False,'

with elementary_test_results as (
    select * from "podcast_analytics"."public_public"."elementary_test_results"
),

alerts_dbt_tests as (
    select id as alert_id,
           data_issue_id,
           test_execution_id,
           test_unique_id,
           model_unique_id,
           detected_at,
           database_name,
           schema_name,
           table_name,
           column_name,
           test_type as alert_type,
           test_sub_type as sub_type,
           test_results_description as alert_description,
           owners,
           tags,
           test_results_query as alert_results_query,
           other,
           test_name,
           test_short_name,
           test_params,
           severity,
           status,
           result_rows
        from elementary_test_results
        where True and lower(status) != ''pass''   and lower(status) != ''skipped''  and test_type = ''dbt_test''
)

select * from alerts_dbt_tests',NULL,NULL,'Thread-2 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.podcast_analytics.dim_episodes','model.podcast_analytics.dim_episodes','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'dim_episodes','SELECT 50','success','model',0.18123102188110352,'2025-07-05T15:01:54.956551Z','2025-07-05T15:01:55.068096Z','2025-07-05T15:01:54.894318Z','2025-07-05T15:01:54.955787Z',50,False,'-- dim_episodes.sql : dimension table for episodes (one row per episode)
select 
    episode_id as "Episode ID",
    podcast_id as "Podcast ID",
    title as "Title",
    release_date as "Release Date",
    duration_seconds as "Duration (seconds)"
from "podcast_analytics"."public"."stg_episodes"',NULL,NULL,'Thread-3 (worker)','table','{"_message": "SELECT 50", "code": "SELECT", "rows_affected": 50}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.podcast_analytics.int_user_sessions','model.podcast_analytics.int_user_sessions','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'int_user_sessions','CREATE VIEW','success','model',0.1437230110168457,'2025-07-05T15:01:55.105959Z','2025-07-05T15:01:55.221672Z','2025-07-05T15:01:55.089609Z','2025-07-05T15:01:55.102134Z',-1,False,'-- int_user_sessions.sql : derive user listening sessions

-- 1. Bring in all user events from the staging model
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

-- 2. For each event, get the timestamp of the previous event for the same user
events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

-- 3. Flag the start of a new session:
--    - If there is no previous event (first event for user)
--    - Or if the gap between events is more than 30 minutes
flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

-- 4. Assign a session number to each event for each user by cumulatively summing the new session flags
numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

-- 5. Aggregate events into sessions:
--    - Find session start/end timestamps
--    - Sum up listening duration for the session
agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end,
        sum(coalesce(duration, 0)) as total_listening_duration
    from numbered
    group by user_id, session_number
),

-- 6. Generate a surrogate session_id and select final session fields
final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), ''_dbt_utils_surrogate_key_null_'') || ''-'' || coalesce(cast(session_number as TEXT), ''_dbt_utils_surrogate_key_null_'') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        total_listening_duration as session_duration
    from agg
)

-- 7. Output the final sessionized data
select * from final',NULL,NULL,'Thread-3 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.alerts_schema_changes','model.elementary.alerts_schema_changes','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'alerts_schema_changes','CREATE VIEW','success','model',0.15108394622802734,'2025-07-05T15:01:55.093401Z','2025-07-05T15:01:55.222577Z','2025-07-05T15:01:55.075554Z','2025-07-05T15:01:55.086899Z',-1,False,'


with elementary_test_results as (
    select * from "podcast_analytics"."public_public"."elementary_test_results"
),

alerts_schema_changes as (
    select id as alert_id,
           data_issue_id,
           test_execution_id,
           test_unique_id,
           model_unique_id,
           detected_at,
           database_name,
           schema_name,
           table_name,
           column_name,
           test_type as alert_type,
           test_sub_type as sub_type,
           test_results_description as alert_description,
           owners,
           tags,
           test_results_query as alert_results_query,
           other,
           test_name,
           test_short_name,
           test_params,
           severity,
           status,
           result_rows
        from elementary_test_results
        where True and lower(status) != ''pass''and lower(status) != ''skipped''and test_type = ''schema_change''
)

select * from alerts_schema_changes',NULL,NULL,'Thread-1 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.test_result_rows','model.elementary.test_result_rows','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'test_result_rows','INSERT 0 0','success','model',0.15909481048583984,'2025-07-05T15:01:55.097869Z','2025-07-05T15:01:55.232367Z','2025-07-05T15:01:55.080340Z','2025-07-05T15:01:55.093028Z',0,False,'-- indexes are not supported in all warehouses, relevant to postgres only


-- depends_on: "podcast_analytics"."public_public"."elementary_test_results"
select * from (
            select
            
                
        cast(''this_is_just_a_long_dummy_string'' as text) as elementary_test_results_id

,
                
        cast(''this_is_just_a_long_dummy_string'' as text) as result_row

,
                cast(''2091-02-17'' as timestamp) as detected_at

,
                cast(''2091-02-17'' as timestamp) as created_at


        ) as empty_table
        where 1 = 0',NULL,NULL,'Thread-4 (worker)','incremental','{"_message": "INSERT 0 0", "code": "INSERT", "rows_affected": 0}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.podcast_analytics.fact_user_events','model.podcast_analytics.fact_user_events','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'fact_user_events','SELECT 4860','success','model',0.16383695602416992,'2025-07-05T15:01:55.102388Z','2025-07-05T15:01:55.242289Z','2025-07-05T15:01:55.087197Z','2025-07-05T15:01:55.101566Z',4860,False,'
-- fact_user_events.sql : central fact table of cleaned user events with de-duplication on event_id

with base as (
    select *
    from "podcast_analytics"."public"."stg_user_events"
),

dedup as (
    select
        *,
        row_number() over (partition by event_id order by event_ts desc nulls last) as rn
    from base
)

select
    event_id as "Event ID",
    event_ts as "Event Timestamp",
    user_id as "User ID",
    episode_id as "Episode ID",
    event_type as "Event Type",
    duration as "Duration"
from dedup
where rn = 1',NULL,NULL,'Thread-2 (worker)','table','{"_message": "SELECT 4860", "code": "SELECT", "rows_affected": 4860}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.podcast_analytics.dim_users','model.podcast_analytics.dim_users','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'dim_users','SELECT 100','success','model',0.07572412490844727,'2025-07-05T15:01:55.248050Z','2025-07-05T15:01:55.307888Z','2025-07-05T15:01:55.238854Z','2025-07-05T15:01:55.243366Z',100,False,'-- dim_users.sql : dimension table for users (one row per user)
select 
    user_id as "User ID",
    signup_date as "Signup Date",
    country as "Country"
from "podcast_analytics"."public"."stg_users"',NULL,NULL,'Thread-1 (worker)','table','{"_message": "SELECT 100", "code": "SELECT", "rows_affected": 100}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.anomaly_threshold_sensitivity','model.elementary.anomaly_threshold_sensitivity','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'anomaly_threshold_sensitivity','CREATE VIEW','success','model',0.07210183143615723,'2025-07-05T15:01:55.261451Z','2025-07-05T15:01:55.322927Z','2025-07-05T15:01:55.253423Z','2025-07-05T15:01:55.260812Z',-1,False,'

with metrics_anomaly_score as (

    select * from "podcast_analytics"."public_public"."metrics_anomaly_score"

),

score_sensitivity as (

    select
        full_table_name,
        column_name,
        metric_name,
        latest_metric_value,
        training_avg as metric_avg,
        training_stddev as metric_stddev,
        anomaly_score,
        case when abs(anomaly_score) >= 1.5 then true else false end as "is_anomaly_1_5",
        case when abs(anomaly_score) >= 2 then true else false end as "is_anomaly_2",
        case when abs(anomaly_score) >= 2.5 then true else false end as "is_anomaly_2_5",
        case when abs(anomaly_score) >= 3 then true else false end as "is_anomaly_3",
        case when abs(anomaly_score) >= 3.5 then true else false end as "is_anomaly_3_5",
        case when abs(anomaly_score) >= 4 then true else false end as "is_anomaly_4",
        case when abs(anomaly_score) >= 4.5 then true else false end as "is_anomaly_4_5"
    from metrics_anomaly_score
    where abs(anomaly_score) >= 1.5

)

select * from score_sensitivity',NULL,NULL,'Thread-4 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.elementary.alerts_dbt_models','model.elementary.alerts_dbt_models','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'alerts_dbt_models','CREATE VIEW','success','model',0.06355881690979004,'2025-07-05T15:01:55.270763Z','2025-07-05T15:01:55.322144Z','2025-07-05T15:01:55.265185Z','2025-07-05T15:01:55.270187Z',-1,False,'

with error_models as (
  
    select  model_execution_id,
            unique_id,
            invocation_id,
            name,
            generated_at,
            status,
            full_refresh,
            message,
            execution_time,
            execute_started_at,
            execute_completed_at,
            compile_started_at,
            compile_completed_at,
            compiled_code,
            database_name,
            schema_name,
            materialization,
            tags,
            package_name,
            path,
            original_path,
            owner,
            alias 
    from "podcast_analytics"."public_public"."model_run_results"
  
    union all
  
    select  model_execution_id,
            unique_id,
            invocation_id,
            name,
            generated_at,
            status,
            full_refresh,
            message,
            execution_time,
            execute_started_at,
            execute_completed_at,
            compile_started_at,
            compile_completed_at,
            compiled_code,
            database_name,
            schema_name,
            materialization,
            tags,
            package_name,
            path,
            original_path,
            owner,
            alias  
  from "podcast_analytics"."public_public"."snapshot_run_results"
)


select model_execution_id as alert_id,
       unique_id,
       cast(generated_at as timestamp) as detected_at,
       database_name,
       materialization,
       path,
       original_path,
       schema_name,
       message,
       owner as owners,
       tags,
       alias,
       status,
       full_refresh
from error_models
where True and lower(status) != ''success''and lower(status) != ''skipped''',NULL,NULL,'Thread-2 (worker)','view','{"_message": "CREATE VIEW", "code": "CREATE VIEW", "rows_affected": -1}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.podcast_analytics.mart_top_episodes','model.podcast_analytics.mart_top_episodes','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'mart_top_episodes','SELECT 50','success','model',0.11621975898742676,'2025-07-05T15:01:55.244027Z','2025-07-05T15:01:55.348508Z','2025-07-05T15:01:55.234482Z','2025-07-05T15:01:55.242662Z',50,False,'-- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = ''play''
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = ''complete''
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc',NULL,NULL,'Thread-3 (worker)','table','{"_message": "SELECT 50", "code": "SELECT", "rows_affected": 50}'),('f76d50b2-be25-48cf-9233-05c0a1bfc74d.model.podcast_analytics.mart_user_session_metrics','model.podcast_analytics.mart_user_session_metrics','f76d50b2-be25-48cf-9233-05c0a1bfc74d','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'mart_user_session_metrics','SELECT 100','success','model',0.0981912612915039,'2025-07-05T15:01:55.324344Z','2025-07-05T15:01:55.415695Z','2025-07-05T15:01:55.318448Z','2025-07-05T15:01:55.323243Z',100,False,'-- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics',NULL,NULL,'Thread-1 (worker)','table','{"_message": "SELECT 100", "code": "SELECT", "rows_affected": 100}')
  
[0m16:01:55.816088 [debug] [MainThread]: SQL status: INSERT 0 39 in 0.014 seconds
[0m16:01:55.817241 [debug] [MainThread]: On master: COMMIT
[0m16:01:55.817466 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:55.817655 [debug] [MainThread]: On master: COMMIT
[0m16:01:55.820429 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m16:01:55.821480 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:
[0m16:01:55.822008 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.027322 (1 runs)
[0m16:01:55.822403 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.010864 (1 runs)
[0m16:01:55.822796 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.000221 (1 runs)
[0m16:01:55.823176 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.277353 (39 runs)
[0m16:01:55.823560 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.284948 (1 runs)
[0m16:01:55.823980 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.020185 (1 runs)
[0m16:01:55.824346 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.commit: 0:00:00.003592 (1 runs)
[0m16:01:55.824712 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:00.327645 (1 runs)
[0m16:01:55.825082 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:00.362323 (1 runs)
[0m16:01:55.825479 [debug] [MainThread]: Elementary: Uploaded run results successfully.
[0m16:01:55.833546 [debug] [MainThread]: Elementary: Uploading dbt invocation.
[0m16:01:55.862734 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:55.863159 [debug] [MainThread]: On master: BEGIN
[0m16:01:55.865875 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:01:55.866084 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:55.866279 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_invocations'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:55.876339 [debug] [MainThread]: SQL status: SELECT 35 in 0.010 seconds
[0m16:01:55.877832 [debug] [MainThread]: Elementary: Inserting 1 rows to table "podcast_analytics"."public_public"."dbt_invocations"
[0m16:01:55.888616 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:01:55.889128 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:55.889347 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."dbt_invocations"
         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values
    ('f76d50b2-be25-48cf-9233-05c0a1bfc74d',NULL,NULL,NULL,'2025-07-05 15:01:52','2025-07-05 15:01:55','2025-07-05 15:01:55',
    current_timestamp::timestamp
,'run','1.10.3','0.18.2',False,'{}','{}','local','podcast_analytics','public','podcast_analytics',4,'[]',NULL,NULL,'podcast_analytics',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'{"user": "podcast"}')
  
[0m16:01:55.891873 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.002 seconds
[0m16:01:55.892700 [debug] [MainThread]: On master: COMMIT
[0m16:01:55.892898 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:55.893078 [debug] [MainThread]: On master: COMMIT
[0m16:01:55.896102 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m16:01:55.896846 [debug] [MainThread]: Elementary: Uploaded dbt invocation successfully.
[0m16:01:55.900303 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m16:01:55.900895 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]
[0m16:01:55.901171 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-end.0 ........................................ [[32mOK[0m in 0.47s]
[0m16:01:55.901379 [debug] [MainThread]: On master: Close
[0m16:01:55.901615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:55.901767 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m16:01:55.901913 [debug] [MainThread]: Connection 'model.elementary.alerts_dbt_models' was properly closed.
[0m16:01:55.902053 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m16:01:55.902191 [debug] [MainThread]: Connection 'model.elementary.anomaly_threshold_sensitivity' was properly closed.
[0m16:01:55.902480 [info ] [MainThread]: 
[0m16:01:55.902697 [info ] [MainThread]: Finished running 15 incremental models, 2 project hooks, 6 table models, 18 view models in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m16:01:55.905417 [debug] [MainThread]: Command end result
[0m16:01:55.951439 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m16:01:55.952989 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m16:01:55.957878 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m16:01:55.958131 [info ] [MainThread]: 
[0m16:01:55.958343 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:55.958534 [info ] [MainThread]: 
[0m16:01:55.958716 [info ] [MainThread]: Done. PASS=41 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=41
[0m16:01:55.960615 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8187594, "process_in_blocks": "0", "process_kernel_time": 0.250895, "process_mem_max_rss": "138608640", "process_out_blocks": "0", "process_user_time": 3.728797}
[0m16:01:55.960927 [debug] [MainThread]: Command `dbt run` succeeded at 16:01:55.960876 after 3.82 seconds
[0m16:01:55.961152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104753460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10117b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d5e110>]}
[0m16:01:55.961372 [debug] [MainThread]: Flushing usage events
[0m16:01:56.390860 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:01:57.292752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10387b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d7460>]}


============================== 16:01:57.295111 | 93eb05db-cd2b-45f7-9499-07acf6f30836 ==============================
[0m16:01:57.295111 [info ] [MainThread]: Running with dbt=1.10.3
[0m16:01:57.295465 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/samydoreau/global-assignment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --profiles-dir /Users/samydoreau/global-assignment', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:01:57.393062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93eb05db-cd2b-45f7-9499-07acf6f30836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039d5f60>]}
[0m16:01:57.426952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93eb05db-cd2b-45f7-9499-07acf6f30836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047933d0>]}
[0m16:01:57.427598 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:01:57.493571 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m16:01:57.649336 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:01:57.649671 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:01:57.696116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93eb05db-cd2b-45f7-9499-07acf6f30836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d0130>]}
[0m16:01:57.797508 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m16:01:57.798946 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m16:01:57.814002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93eb05db-cd2b-45f7-9499-07acf6f30836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d9a80>]}
[0m16:01:57.814366 [info ] [MainThread]: Found 39 models, 2 seeds, 2 operations, 23 data tests, 3 sources, 1248 macros
[0m16:01:57.814587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93eb05db-cd2b-45f7-9499-07acf6f30836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047571c0>]}
[0m16:01:57.816153 [info ] [MainThread]: 
[0m16:01:57.816409 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m16:01:57.816627 [info ] [MainThread]: 
[0m16:01:57.816931 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:01:57.820801 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m16:01:57.821211 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public_public'
[0m16:01:57.848249 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m16:01:57.848540 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m16:01:57.848721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:57.849027 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public_public"
[0m16:01:57.849256 [debug] [ThreadPool]: On list_podcast_analytics_public_public: BEGIN
[0m16:01:57.849427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:01:57.884049 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m16:01:57.884427 [debug] [ThreadPool]: SQL status: BEGIN in 0.035 seconds
[0m16:01:57.884684 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m16:01:57.884882 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public_public"
[0m16:01:57.885078 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:01:57.885293 [debug] [ThreadPool]: On list_podcast_analytics_public_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m16:01:57.888833 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.003 seconds
[0m16:01:57.889804 [debug] [ThreadPool]: On list_podcast_analytics_public_public: ROLLBACK
[0m16:01:57.890599 [debug] [ThreadPool]: On list_podcast_analytics_public_public: Close
[0m16:01:57.893074 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.008 seconds
[0m16:01:57.893811 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m16:01:57.894750 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m16:01:57.900508 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:57.900827 [debug] [MainThread]: On master: BEGIN
[0m16:01:57.901006 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:01:57.913172 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:01:57.913502 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:57.913772 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:01:57.937131 [debug] [MainThread]: SQL status: SELECT 55 in 0.023 seconds
[0m16:01:57.941339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93eb05db-cd2b-45f7-9499-07acf6f30836', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d9210>]}
[0m16:01:57.941724 [debug] [MainThread]: On master: ROLLBACK
[0m16:01:57.942714 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:57.942971 [debug] [MainThread]: On master: BEGIN
[0m16:01:57.944253 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:01:57.944472 [debug] [MainThread]: On master: COMMIT
[0m16:01:57.944665 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:57.944849 [debug] [MainThread]: On master: COMMIT
[0m16:01:57.945517 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:01:57.968411 [debug] [MainThread]: Elementary: Materialization override is enabled.
[0m16:01:57.985349 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:57.985649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    select count(*) from pg_namespace where nspname = 'public_public__tests'
  
[0m16:01:57.987170 [debug] [MainThread]: SQL status: SELECT 1 in 0.001 seconds
[0m16:01:57.988811 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m16:01:57.990860 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]
[0m16:01:57.991182 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-start.0 ...................................... [[32mOK[0m in 0.05s]
[0m16:01:57.991370 [info ] [MainThread]: 
[0m16:01:57.991572 [debug] [MainThread]: On master: Close
[0m16:01:57.993020 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:01:57.993273 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:01:57.993517 [debug] [Thread-3 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:01:57.993745 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:01:57.993950 [info ] [Thread-1 (]: 1 of 23 START test accepted_values_fact_user_events__Event_Type___play__pause__seek__complete  [RUN]
[0m16:01:57.994199 [info ] [Thread-2 (]: 2 of 23 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m16:01:57.994437 [info ] [Thread-3 (]: 3 of 23 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [RUN]
[0m16:01:57.994755 [info ] [Thread-4 (]: 4 of 23 START test not_null_dim_episodes__Duration_seconds_ .................... [RUN]
[0m16:01:57.995093 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8)
[0m16:01:57.995325 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m16:01:57.995596 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7'
[0m16:01:57.995854 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444'
[0m16:01:57.996071 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:01:57.996338 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:01:57.996570 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:01:57.996777 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:01:58.005373 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:01:58.008959 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:01:58.013548 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:01:58.019230 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:01:58.020165 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:01:58.059897 [warn ] [Thread-1 (]: [[33mWARNING[0m]: Installed package 'elementary' is overriding the built-in
materialization 'test'. Overrides of built-in materializations from installed
packages will be deprecated in future versions of dbt. For more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m16:01:58.060326 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '93eb05db-cd2b-45f7-9499-07acf6f30836', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105976890>]}
[0m16:01:58.060601 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:01:58.079655 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:01:58.079972 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:01:58.201533 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:01:58.202161 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:01:58.202651 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:01:58.203786 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:01:58.204392 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:01:58.204687 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:01:58.204993 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: BEGIN
[0m16:01:58.205224 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: BEGIN
[0m16:01:58.205485 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:01:58.205733 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:01:58.205929 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:01:58.206149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:58.206350 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m16:01:58.206570 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: BEGIN
[0m16:01:58.206962 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:58.207173 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:01:58.241299 [debug] [Thread-3 (]: SQL status: BEGIN in 0.034 seconds
[0m16:01:58.241603 [debug] [Thread-4 (]: SQL status: BEGIN in 0.036 seconds
[0m16:01:58.241892 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:01:58.242117 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:01:58.242368 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','missing_timestamp','malformed_timestamp','missing_user_id','missing_episode_id','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m16:01:58.242621 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Duration (seconds)"
from "podcast_analytics"."public"."dim_episodes"
where "Duration (seconds)" is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.244109 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m16:01:58.244363 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:01:58.244604 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        "Event Type" as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by "Event Type"

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m16:01:58.244957 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:01:58.253283 [debug] [Thread-2 (]: SQL status: BEGIN in 0.046 seconds
[0m16:01:58.259764 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m16:01:58.270111 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: ROLLBACK
[0m16:01:58.270389 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.026 seconds
[0m16:01:58.270676 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:01:58.273627 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: ROLLBACK
[0m16:01:58.276964 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: ROLLBACK
[0m16:01:58.277293 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: Close
[0m16:01:58.277596 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m16:01:58.278601 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: Close
[0m16:01:58.278879 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: Close
[0m16:01:58.278313 [info ] [Thread-4 (]: 4 of 23 PASS not_null_dim_episodes__Duration_seconds_ .......................... [[32mPASS[0m in 0.28s]
[0m16:01:58.279450 [info ] [Thread-1 (]: 1 of 23 PASS accepted_values_fact_user_events__Event_Type___play__pause__seek__complete  [[32mPASS[0m in 0.28s]
[0m16:01:58.279849 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:01:58.280149 [info ] [Thread-3 (]: 3 of 23 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [[32mPASS[0m in 0.28s]
[0m16:01:58.280502 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:01:58.280745 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:01:58.281037 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:01:58.281405 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:01:58.281725 [info ] [Thread-4 (]: 5 of 23 START test not_null_dim_episodes__Episode_ID_ .......................... [RUN]
[0m16:01:58.282061 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:01:58.282363 [info ] [Thread-1 (]: 6 of 23 START test not_null_dim_episodes__Podcast_ID_ .......................... [RUN]
[0m16:01:58.282705 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444, now test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc)
[0m16:01:58.283237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8, now test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7)
[0m16:01:58.282979 [info ] [Thread-3 (]: 7 of 23 START test not_null_dim_users__User_ID_ ................................ [RUN]
[0m16:01:58.283684 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:01:58.283915 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:01:58.284175 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba)
[0m16:01:58.287704 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:01:58.290868 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:01:58.291173 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:01:58.295131 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:01:58.295467 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:01:58.295767 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:01:58.300217 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:01:58.300537 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.022 seconds
[0m16:01:58.305102 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:01:58.305389 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:01:58.308600 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m16:01:58.309020 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:01:58.313338 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:01:58.313685 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: BEGIN
[0m16:01:58.313936 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:01:58.314208 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:58.314444 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m16:01:58.314660 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: BEGIN
[0m16:01:58.314877 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:01:58.315354 [info ] [Thread-2 (]: 2 of 23 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.32s]
[0m16:01:58.315587 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:58.315813 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: BEGIN
[0m16:01:58.316116 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:01:58.316388 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:58.316702 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:01:58.317173 [info ] [Thread-2 (]: 8 of 23 START test not_null_fact_user_events__Episode_ID_ ...................... [RUN]
[0m16:01:58.317480 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae)
[0m16:01:58.317704 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:01:58.321603 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:01:58.322148 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:01:58.326796 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:01:58.327438 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:01:58.327667 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: BEGIN
[0m16:01:58.328355 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:58.331459 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:01:58.331798 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m16:01:58.332211 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:01:58.332565 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:01:58.332909 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Podcast ID"
from "podcast_analytics"."public"."dim_episodes"
where "Podcast ID" is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.333233 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Episode ID"
from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.333793 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m16:01:58.334010 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:01:58.334217 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "User ID"
from "podcast_analytics"."public"."dim_users"
where "User ID" is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.335908 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:01:58.336214 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:01:58.339514 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: ROLLBACK
[0m16:01:58.339870 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:01:58.343496 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: ROLLBACK
[0m16:01:58.343798 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m16:01:58.346798 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: ROLLBACK
[0m16:01:58.347075 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: Close
[0m16:01:58.347441 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:01:58.347992 [info ] [Thread-1 (]: 6 of 23 PASS not_null_dim_episodes__Podcast_ID_ ................................ [[32mPASS[0m in 0.06s]
[0m16:01:58.348304 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: Close
[0m16:01:58.348518 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Episode ID"
from "podcast_analytics"."public"."fact_user_events"
where "Episode ID" is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.348753 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: Close
[0m16:01:58.349125 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:01:58.349486 [info ] [Thread-4 (]: 5 of 23 PASS not_null_dim_episodes__Episode_ID_ ................................ [[32mPASS[0m in 0.07s]
[0m16:01:58.350103 [info ] [Thread-3 (]: 7 of 23 PASS not_null_dim_users__User_ID_ ...................................... [[32mPASS[0m in 0.07s]
[0m16:01:58.350432 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:01:58.350731 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:01:58.351036 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:01:58.351248 [info ] [Thread-1 (]: 9 of 23 START test not_null_fact_user_events__Event_ID_ ........................ [RUN]
[0m16:01:58.351489 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd
[0m16:01:58.351715 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:01:58.351948 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7, now test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c)
[0m16:01:58.352178 [info ] [Thread-4 (]: 10 of 23 START test not_null_fact_user_events__Event_Timestamp_ ................ [RUN]
[0m16:01:58.352545 [info ] [Thread-3 (]: 11 of 23 START test not_null_fact_user_events__User_ID_ ........................ [RUN]
[0m16:01:58.352826 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:01:58.353199 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc, now test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd)
[0m16:01:58.353558 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba, now test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2)
[0m16:01:58.356941 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:01:58.357349 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd
[0m16:01:58.357643 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.008 seconds
[0m16:01:58.357866 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:01:58.361373 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"
[0m16:01:58.364647 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: ROLLBACK
[0m16:01:58.367934 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:01:58.368215 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:01:58.373104 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:01:58.373538 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: Close
[0m16:01:58.373904 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd
[0m16:01:58.374222 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:01:58.374811 [info ] [Thread-2 (]: 8 of 23 PASS not_null_fact_user_events__Episode_ID_ ............................ [[32mPASS[0m in 0.06s]
[0m16:01:58.379396 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"
[0m16:01:58.419687 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:01:58.420793 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:01:58.421166 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:01:58.421523 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: BEGIN
[0m16:01:58.421986 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"
[0m16:01:58.422295 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:01:58.422635 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:01:58.422866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:58.423093 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd: BEGIN
[0m16:01:58.423312 [info ] [Thread-2 (]: 12 of 23 START test not_null_stg_episodes_episode_id ........................... [RUN]
[0m16:01:58.423538 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: BEGIN
[0m16:01:58.423853 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:58.424111 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae, now test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422)
[0m16:01:58.424323 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:58.424830 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:01:58.428333 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:01:58.428828 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:01:58.433365 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:01:58.433863 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:01:58.434094 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m16:01:58.434296 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:58.439810 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:01:58.440150 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:01:58.440430 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Event ID"
from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.441589 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m16:01:58.441827 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:01:58.442038 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "User ID"
from "podcast_analytics"."public"."fact_user_events"
where "User ID" is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.442263 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m16:01:58.442541 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"
[0m16:01:58.442782 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Event Timestamp"
from "podcast_analytics"."public"."fact_user_events"
where "Event Timestamp" is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.443463 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:01:58.447221 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: ROLLBACK
[0m16:01:58.447505 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:01:58.447694 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:01:58.450725 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd: ROLLBACK
[0m16:01:58.450988 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: Close
[0m16:01:58.451260 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m16:01:58.454414 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: ROLLBACK
[0m16:01:58.454880 [info ] [Thread-1 (]: 9 of 23 PASS not_null_fact_user_events__Event_ID_ .............................. [[32mPASS[0m in 0.10s]
[0m16:01:58.455151 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:01:58.455393 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd: Close
[0m16:01:58.455755 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:01:58.456044 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.456335 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: Close
[0m16:01:58.456964 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:01:58.456727 [info ] [Thread-4 (]: 10 of 23 PASS not_null_fact_user_events__Event_Timestamp_ ...................... [[32mPASS[0m in 0.10s]
[0m16:01:58.457453 [info ] [Thread-3 (]: 11 of 23 PASS not_null_fact_user_events__User_ID_ .............................. [[32mPASS[0m in 0.10s]
[0m16:01:58.457690 [info ] [Thread-1 (]: 13 of 23 START test not_null_stg_episodes_podcast_id ........................... [RUN]
[0m16:01:58.457984 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd
[0m16:01:58.458246 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:01:58.458464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c, now test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1)
[0m16:01:58.458688 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:01:58.458935 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:01:58.459174 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:01:58.459376 [info ] [Thread-4 (]: 14 of 23 START test not_null_stg_user_events_episode_id ........................ [RUN]
[0m16:01:58.459675 [info ] [Thread-3 (]: 15 of 23 START test not_null_stg_user_events_event_id .......................... [RUN]
[0m16:01:58.463433 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:01:58.463728 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m16:01:58.463996 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd, now test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110)
[0m16:01:58.464221 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2, now test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7)
[0m16:01:58.467972 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m16:01:58.468367 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:01:58.468653 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:01:58.468895 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:01:58.472453 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:01:58.472738 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m16:01:58.476246 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:01:58.481053 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:01:58.481678 [info ] [Thread-2 (]: 12 of 23 PASS not_null_stg_episodes_episode_id ................................. [[32mPASS[0m in 0.06s]
[0m16:01:58.482306 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:01:58.482607 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:01:58.482874 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:01:58.483095 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:01:58.483441 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:01:58.487695 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:01:58.488040 [info ] [Thread-2 (]: 16 of 23 START test not_null_stg_user_events_event_ts .......................... [RUN]
[0m16:01:58.492348 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:01:58.492632 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: BEGIN
[0m16:01:58.493067 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502)
[0m16:01:58.493498 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:01:58.493825 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:58.494152 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:01:58.494435 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: BEGIN
[0m16:01:58.494698 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:01:58.498211 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:01:58.498539 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:58.498863 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m16:01:58.499266 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:58.499617 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:01:58.504881 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:01:58.505489 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:01:58.505736 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: BEGIN
[0m16:01:58.505930 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:58.508008 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:01:58.508307 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:01:58.508533 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select podcast_id
from "podcast_analytics"."public"."stg_episodes"
where podcast_id is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.511734 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:01:58.515028 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: ROLLBACK
[0m16:01:58.515308 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m16:01:58.515711 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:01:58.515959 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_user_events"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.516174 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: Close
[0m16:01:58.516987 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m16:01:58.516733 [info ] [Thread-1 (]: 13 of 23 PASS not_null_stg_episodes_podcast_id ................................. [[32mPASS[0m in 0.06s]
[0m16:01:58.517347 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:01:58.517734 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:01:58.518024 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.518338 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:01:58.518691 [info ] [Thread-1 (]: 17 of 23 START test not_null_stg_user_events_user_id ........................... [RUN]
[0m16:01:58.519019 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1, now test.podcast_analytics.not_null_stg_user_events_user_id.82058db005)
[0m16:01:58.519380 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m16:01:58.519613 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:01:58.519821 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:01:58.523505 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:01:58.523866 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:01:58.524144 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_ts
from "podcast_analytics"."public"."stg_user_events"
where event_ts is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.527342 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: ROLLBACK
[0m16:01:58.527734 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:01:58.532433 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:01:58.532693 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: Close
[0m16:01:58.533187 [info ] [Thread-4 (]: 14 of 23 PASS not_null_stg_user_events_episode_id .............................. [[32mPASS[0m in 0.07s]
[0m16:01:58.533582 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:01:58.533836 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:01:58.534109 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:01:58.534332 [info ] [Thread-4 (]: 18 of 23 START test not_null_stg_users_user_id ................................. [RUN]
[0m16:01:58.534559 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: BEGIN
[0m16:01:58.534855 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m16:01:58.535129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:58.535358 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:01:58.538798 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:01:58.539299 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:01:58.544234 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:01:58.544560 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.026 seconds
[0m16:01:58.547902 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m16:01:58.548329 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:01:58.548544 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m16:01:58.548765 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m16:01:58.549059 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:58.549351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m16:01:58.549725 [info ] [Thread-3 (]: 15 of 23 PASS not_null_stg_user_events_event_id ................................ [[32mPASS[0m in 0.09s]
[0m16:01:58.550119 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:01:58.550570 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:01:58.550857 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_user_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.551160 [debug] [Thread-3 (]: Began running node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:01:58.551576 [info ] [Thread-3 (]: 19 of 23 START test relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_  [RUN]
[0m16:01:58.551930 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f)
[0m16:01:58.552164 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:01:58.557784 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:01:58.558145 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:01:58.558442 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.031 seconds
[0m16:01:58.562749 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: ROLLBACK
[0m16:01:58.566110 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: ROLLBACK
[0m16:01:58.566543 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:01:58.571172 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:01:58.571451 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: Close
[0m16:01:58.571766 [debug] [Thread-4 (]: SQL status: BEGIN in 0.023 seconds
[0m16:01:58.571981 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: Close
[0m16:01:58.572738 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:01:58.572515 [info ] [Thread-1 (]: 17 of 23 PASS not_null_stg_user_events_user_id ................................. [[32mPASS[0m in 0.05s]
[0m16:01:58.573525 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.573824 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:01:58.573296 [info ] [Thread-2 (]: 16 of 23 PASS not_null_stg_user_events_event_ts ................................ [[32mPASS[0m in 0.08s]
[0m16:01:58.574309 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:01:58.574585 [debug] [Thread-3 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: BEGIN
[0m16:01:58.574951 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:01:58.575255 [debug] [Thread-1 (]: Began running node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:01:58.575583 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:58.575878 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:01:58.576426 [info ] [Thread-1 (]: 20 of 23 START test relationships_fact_user_events__User_ID____User_ID___ref_dim_users_  [RUN]
[0m16:01:58.576970 [info ] [Thread-2 (]: 21 of 23 START test unique_dim_episodes__Episode_ID_ ........................... [RUN]
[0m16:01:58.577465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_user_id.82058db005, now test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24)
[0m16:01:58.577842 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:01:58.578160 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502, now test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de)
[0m16:01:58.578481 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:01:58.582179 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m16:01:58.582506 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:01:58.586535 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:01:58.591086 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:01:58.591383 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m16:01:58.592079 [info ] [Thread-4 (]: 18 of 23 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.06s]
[0m16:01:58.592605 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:01:58.592998 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:01:58.593506 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m16:01:58.593708 [info ] [Thread-4 (]: 22 of 23 START test unique_dim_users__User_ID_ ................................. [RUN]
[0m16:01:58.594010 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:01:58.594312 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:01:58.594571 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:01:58.594888 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77, now test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a)
[0m16:01:58.600247 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:01:58.604593 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:01:58.604886 [debug] [Thread-3 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select "Episode ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "Episode ID" is not null
),

parent as (
    select "Episode ID" as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.605125 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:01:58.605696 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:01:58.609223 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:01:58.609626 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:01:58.609934 [debug] [Thread-1 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: BEGIN
[0m16:01:58.610244 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:01:58.613432 [debug] [Thread-3 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: ROLLBACK
[0m16:01:58.613745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:01:58.614008 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:01:58.614235 [debug] [Thread-2 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: BEGIN
[0m16:01:58.618912 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:01:58.619210 [debug] [Thread-3 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: Close
[0m16:01:58.619464 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:01:58.619975 [info ] [Thread-3 (]: 19 of 23 PASS relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_  [[32mPASS[0m in 0.07s]
[0m16:01:58.620612 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:01:58.620911 [debug] [Thread-3 (]: Began running node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:01:58.621145 [info ] [Thread-3 (]: 23 of 23 START test unique_fact_user_events__Event_ID_ ......................... [RUN]
[0m16:01:58.621435 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f, now test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a)
[0m16:01:58.621789 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:01:58.622166 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:01:58.622432 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: BEGIN
[0m16:01:58.626382 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:01:58.626765 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:01:58.627282 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:01:58.631539 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:01:58.631872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m16:01:58.632290 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:01:58.632551 [debug] [Thread-1 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select "User ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "User ID" is not null
),

parent as (
    select "User ID" as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:01:58.633039 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:01:58.633280 [debug] [Thread-3 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: BEGIN
[0m16:01:58.633477 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:01:58.633902 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m16:01:58.634182 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:01:58.634416 [debug] [Thread-2 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    "Episode ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is not null
group by "Episode ID"
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:01:58.639331 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:01:58.639638 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:01:58.642909 [debug] [Thread-2 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: ROLLBACK
[0m16:01:58.643208 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m16:01:58.646848 [debug] [Thread-1 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: ROLLBACK
[0m16:01:58.647289 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:01:58.647671 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    "User ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where "User ID" is not null
group by "User ID"
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:01:58.647947 [debug] [Thread-2 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: Close
[0m16:01:58.648282 [debug] [Thread-1 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: Close
[0m16:01:58.648776 [info ] [Thread-2 (]: 21 of 23 PASS unique_dim_episodes__Episode_ID_ ................................. [[32mPASS[0m in 0.07s]
[0m16:01:58.649119 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m16:01:58.649473 [info ] [Thread-1 (]: 20 of 23 PASS relationships_fact_user_events__User_ID____User_ID___ref_dim_users_  [[32mPASS[0m in 0.07s]
[0m16:01:58.649816 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:01:58.650041 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:01:58.650345 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:01:58.650762 [debug] [Thread-3 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    "Event ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is not null
group by "Event ID"
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:01:58.651121 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:01:58.654095 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: ROLLBACK
[0m16:01:58.655021 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: Close
[0m16:01:58.655411 [info ] [Thread-4 (]: 22 of 23 PASS unique_dim_users__User_ID_ ....................................... [[32mPASS[0m in 0.06s]
[0m16:01:58.655867 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:01:58.656206 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:01:58.659393 [debug] [Thread-3 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: ROLLBACK
[0m16:01:58.660287 [debug] [Thread-3 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: Close
[0m16:01:58.660725 [info ] [Thread-3 (]: 23 of 23 PASS unique_fact_user_events__Event_ID_ ............................... [[32mPASS[0m in 0.04s]
[0m16:01:58.661110 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:01:58.661903 [info ] [MainThread]: 
[0m16:01:58.662195 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:58.662364 [debug] [MainThread]: On master: BEGIN
[0m16:01:58.662520 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:01:58.675005 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:01:58.675324 [debug] [MainThread]: On master: COMMIT
[0m16:01:58.675498 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:58.675667 [debug] [MainThread]: On master: COMMIT
[0m16:01:58.676417 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:01:58.695198 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:58.695513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
    select artifacts_model, metadata_hash from "podcast_analytics"."public_public"."dbt_artifacts_hashes"
    order by metadata_hash
    
  
[0m16:01:58.698966 [debug] [MainThread]: SQL status: SELECT 171 in 0.003 seconds
[0m16:01:58.744986 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m16:01:58.759649 [debug] [MainThread]: Elementary: [dbt_models] Flattening the artifacts.
[0m16:01:58.783825 [debug] [MainThread]: Elementary: [dbt_models] Flattened 39 artifacts.
[0m16:01:58.787169 [debug] [MainThread]: Elementary: [dbt_models] Comparing the artifacts state.
[0m16:01:58.787658 [debug] [MainThread]: Elementary: [dbt_models] Artifacts did not change.
[0m16:01:58.788323 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:
[0m16:01:58.788727 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.023496 (1 runs)
[0m16:01:58.789094 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.028683 (1 runs)
[0m16:01:58.791612 [debug] [MainThread]: Elementary: [dbt_tests] Flattening the artifacts.
[0m16:01:58.820932 [debug] [MainThread]: Elementary: [dbt_tests] Flattened 23 artifacts.
[0m16:01:58.821909 [debug] [MainThread]: Elementary: [dbt_tests] Comparing the artifacts state.
[0m16:01:58.822372 [debug] [MainThread]: Elementary: [dbt_tests] Artifacts did not change.
[0m16:01:58.823355 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:
[0m16:01:58.823903 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00.028741 (1 runs)
[0m16:01:58.824329 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.031653 (1 runs)
[0m16:01:58.827306 [debug] [MainThread]: Elementary: [dbt_sources] Flattening the artifacts.
[0m16:01:58.836619 [debug] [MainThread]: Elementary: [dbt_sources] Flattened 3 artifacts.
[0m16:01:58.837691 [debug] [MainThread]: Elementary: [dbt_sources] Comparing the artifacts state.
[0m16:01:58.838281 [debug] [MainThread]: Elementary: [dbt_sources] Artifacts did not change.
[0m16:01:58.838984 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:
[0m16:01:58.839383 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.008641 (1 runs)
[0m16:01:58.839758 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.011665 (1 runs)
[0m16:01:58.842215 [debug] [MainThread]: Elementary: [dbt_snapshots] Flattening the artifacts.
[0m16:01:58.842942 [debug] [MainThread]: Elementary: [dbt_snapshots] Flattened 0 artifacts.
[0m16:01:58.843635 [debug] [MainThread]: Elementary: [dbt_snapshots] Comparing the artifacts state.
[0m16:01:58.844014 [debug] [MainThread]: Elementary: [dbt_snapshots] Artifacts did not change.
[0m16:01:58.844559 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:
[0m16:01:58.844977 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00.000222 (1 runs)
[0m16:01:58.845349 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.002329 (1 runs)
[0m16:01:58.848045 [debug] [MainThread]: Elementary: [dbt_metrics] Flattening the artifacts.
[0m16:01:58.848914 [debug] [MainThread]: Elementary: [dbt_metrics] Flattened 0 artifacts.
[0m16:01:58.849613 [debug] [MainThread]: Elementary: [dbt_metrics] Comparing the artifacts state.
[0m16:01:58.850062 [debug] [MainThread]: Elementary: [dbt_metrics] Artifacts did not change.
[0m16:01:58.850630 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:
[0m16:01:58.850999 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00.000175 (1 runs)
[0m16:01:58.851407 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.002603 (1 runs)
[0m16:01:58.854087 [debug] [MainThread]: Elementary: [dbt_exposures] Flattening the artifacts.
[0m16:01:58.854900 [debug] [MainThread]: Elementary: [dbt_exposures] Flattened 0 artifacts.
[0m16:01:58.855579 [debug] [MainThread]: Elementary: [dbt_exposures] Comparing the artifacts state.
[0m16:01:58.856026 [debug] [MainThread]: Elementary: [dbt_exposures] Artifacts did not change.
[0m16:01:58.856615 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:
[0m16:01:58.857132 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00.000254 (1 runs)
[0m16:01:58.857832 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.002531 (1 runs)
[0m16:01:58.860435 [debug] [MainThread]: Elementary: [dbt_seeds] Flattening the artifacts.
[0m16:01:58.868370 [debug] [MainThread]: Elementary: [dbt_seeds] Flattened 2 artifacts.
[0m16:01:58.869155 [debug] [MainThread]: Elementary: [dbt_seeds] Comparing the artifacts state.
[0m16:01:58.869609 [debug] [MainThread]: Elementary: [dbt_seeds] Artifacts did not change.
[0m16:01:58.870201 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:
[0m16:01:58.870585 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00.007394 (1 runs)
[0m16:01:58.870985 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.009752 (1 runs)
[0m16:01:58.873586 [debug] [MainThread]: Elementary: [dbt_columns] Flattening the artifacts.
[0m16:01:58.959004 [debug] [MainThread]: Elementary: [dbt_columns] Flattened 104 artifacts.
[0m16:01:58.959849 [debug] [MainThread]: Elementary: [dbt_columns] Comparing the artifacts state.
[0m16:01:58.960469 [debug] [MainThread]: Elementary: [dbt_columns] Artifacts did not change.
[0m16:01:58.961016 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:
[0m16:01:58.961396 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:00.084783 (1 runs)
[0m16:01:58.962010 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:00.087417 (1 runs)
[0m16:01:58.962604 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m16:01:58.965025 [debug] [MainThread]: Elementary: Uploading run results.
[0m16:01:58.965588 [debug] [MainThread]: Elementary: [dbt_run_results] Flattening the artifacts.
[0m16:01:58.985594 [debug] [MainThread]: Elementary: [dbt_run_results] Flattened 23 artifacts.
[0m16:01:58.996347 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:58.996758 [debug] [MainThread]: On master: BEGIN
[0m16:01:58.999693 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m16:01:58.999896 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:59.000096 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_run_results'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:59.014813 [debug] [MainThread]: SQL status: SELECT 22 in 0.014 seconds
[0m16:01:59.017525 [debug] [MainThread]: Elementary: Inserting 23 rows to table "podcast_analytics"."public_public"."dbt_run_results"
[0m16:01:59.238921 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:01:59.239797 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:59.240558 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."dbt_run_results"
         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values
    ('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'not_null_dim_episodes__Duration_seconds_',NULL,'pass','test',0.2823967933654785,'2025-07-05T15:01:58.104897Z','2025-07-05T15:01:58.269998Z','2025-07-05T15:01:58.013741Z','2025-07-05T15:01:58.060522Z',1,False,'
    
    



select "Duration (seconds)"
from "podcast_analytics"."public"."dim_episodes"
where "Duration (seconds)" is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'accepted_values_fact_user_events__Event_Type___play__pause__seek__complete',NULL,'pass','test',0.2843461036682129,'2025-07-05T15:01:58.020347Z','2025-07-05T15:01:58.276867Z','2025-07-05T15:01:57.996925Z','2025-07-05T15:01:58.020087Z',1,False,'
    
    

with all_values as (

    select
        "Event Type" as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by "Event Type"

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue',NULL,'pass','test',0.2845618724822998,'2025-07-05T15:01:58.192480Z','2025-07-05T15:01:58.273535Z','2025-07-05T15:01:58.009214Z','2025-07-05T15:01:58.079894Z',1,False,'
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    ''missing_event_type'',''invalid_event_type'',''missing_timestamp'',''malformed_timestamp'',''missing_user_id'',''missing_episode_id'',''other_issue''
)


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'accepted_values_stg_user_events_event_type__play__pause__seek__complete',NULL,'pass','test',0.31997203826904297,'2025-07-05T15:01:58.111296Z','2025-07-05T15:01:58.308498Z','2025-07-05T15:01:58.005691Z','2025-07-05T15:01:58.079503Z',1,False,'
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'not_null_dim_episodes__Podcast_ID_',NULL,'pass','test',0.06470990180969238,'2025-07-05T15:01:58.296026Z','2025-07-05T15:01:58.339396Z','2025-07-05T15:01:58.287971Z','2025-07-05T15:01:58.295400Z',1,False,'
    
    



select "Podcast ID"
from "podcast_analytics"."public"."dim_episodes"
where "Podcast ID" is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'not_null_dim_episodes__Episode_ID_',NULL,'pass','test',0.06678390502929688,'2025-07-05T15:01:58.300754Z','2025-07-05T15:01:58.343337Z','2025-07-05T15:01:58.284350Z','2025-07-05T15:01:58.295655Z',1,False,'
    
    



select "Episode ID"
from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'not_null_dim_users__User_ID_',NULL,'pass','test',0.06590890884399414,'2025-07-05T15:01:58.309237Z','2025-07-05T15:01:58.346719Z','2025-07-05T15:01:58.291667Z','2025-07-05T15:01:58.305289Z',1,False,'
    
    



select "User ID"
from "podcast_analytics"."public"."dim_users"
where "User ID" is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'not_null_fact_user_events__Episode_ID_',NULL,'pass','test',0.05720686912536621,'2025-07-05T15:01:58.322323Z','2025-07-05T15:01:58.364526Z','2025-07-05T15:01:58.317855Z','2025-07-05T15:01:58.322074Z',1,False,'
    
    



select "Episode ID"
from "podcast_analytics"."public"."fact_user_events"
where "Episode ID" is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'not_null_fact_user_events__Event_ID_',NULL,'pass','test',0.1028757095336914,'2025-07-05T15:01:58.368553Z','2025-07-05T15:01:58.447131Z','2025-07-05T15:01:58.353788Z','2025-07-05T15:01:58.368148Z',1,False,'
    
    



select "Event ID"
from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'not_null_fact_user_events__Event_Timestamp_',NULL,'pass','test',0.10351371765136719,'2025-07-05T15:01:58.375124Z','2025-07-05T15:01:58.450644Z','2025-07-05T15:01:58.358097Z','2025-07-05T15:01:58.373815Z',1,False,'
    
    



select "Event Timestamp"
from "podcast_analytics"."public"."fact_user_events"
where "Event Timestamp" is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'not_null_fact_user_events__User_ID_',NULL,'pass','test',0.10391592979431152,'2025-07-05T15:01:58.379708Z','2025-07-05T15:01:58.454335Z','2025-07-05T15:01:58.364897Z','2025-07-05T15:01:58.374144Z',1,False,'
    
    



select "User ID"
from "podcast_analytics"."public"."fact_user_events"
where "User ID" is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'not_null_stg_episodes_episode_id',NULL,'pass','test',0.057515859603881836,'2025-07-05T15:01:58.428987Z','2025-07-05T15:01:58.467869Z','2025-07-05T15:01:58.425230Z','2025-07-05T15:01:58.428759Z',1,False,'
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'not_null_stg_episodes_podcast_id',NULL,'pass','test',0.0581972599029541,'2025-07-05T15:01:58.476552Z','2025-07-05T15:01:58.514924Z','2025-07-05T15:01:58.459870Z','2025-07-05T15:01:58.468832Z',1,False,'
    
    



select podcast_id
from "podcast_analytics"."public"."stg_episodes"
where podcast_id is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'not_null_stg_user_events_episode_id',NULL,'pass','test',0.0691671371459961,'2025-07-05T15:01:58.483593Z','2025-07-05T15:01:58.527251Z','2025-07-05T15:01:58.469089Z','2025-07-05T15:01:58.482523Z',1,False,'
    
    



select episode_id
from "podcast_analytics"."public"."stg_user_events"
where episode_id is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'not_null_stg_user_events_event_id',NULL,'pass','test',0.08543896675109863,'2025-07-05T15:01:58.488304Z','2025-07-05T15:01:58.547807Z','2025-07-05T15:01:58.472983Z','2025-07-05T15:01:58.483016Z',1,False,'
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'not_null_stg_user_events_user_id',NULL,'pass','test',0.05347800254821777,'2025-07-05T15:01:58.527909Z','2025-07-05T15:01:58.562637Z','2025-07-05T15:01:58.519978Z','2025-07-05T15:01:58.527657Z',1,False,'
    
    



select user_id
from "podcast_analytics"."public"."stg_user_events"
where user_id is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'not_null_stg_user_events_event_ts',NULL,'pass','test',0.08024311065673828,'2025-07-05T15:01:58.499771Z','2025-07-05T15:01:58.566005Z','2025-07-05T15:01:58.495061Z','2025-07-05T15:01:58.499547Z',1,False,'
    
    



select event_ts
from "podcast_analytics"."public"."stg_user_events"
where event_ts is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'not_null_stg_users_user_id',NULL,'pass','test',0.05720400810241699,'2025-07-05T15:01:58.539460Z','2025-07-05T15:01:58.582083Z','2025-07-05T15:01:58.535639Z','2025-07-05T15:01:58.539231Z',1,False,'
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_',NULL,'pass','test',0.06803107261657715,'2025-07-05T15:01:58.566755Z','2025-07-05T15:01:58.613342Z','2025-07-05T15:01:58.552319Z','2025-07-05T15:01:58.566458Z',1,False,'
    
    

with child as (
    select "Episode ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "Episode ID" is not null
),

parent as (
    select "Episode ID" as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'unique_dim_episodes__Episode_ID_',NULL,'pass','test',0.07059717178344727,'2025-07-05T15:01:58.600513Z','2025-07-05T15:01:58.642824Z','2025-07-05T15:01:58.586834Z','2025-07-05T15:01:58.594227Z',1,False,'
    
    

select
    "Episode ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is not null
group by "Episode ID"
having count(*) > 1


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'relationships_fact_user_events__User_ID____User_ID___ref_dim_users_',NULL,'pass','test',0.07209610939025879,'2025-07-05T15:01:58.595066Z','2025-07-05T15:01:58.646746Z','2025-07-05T15:01:58.582758Z','2025-07-05T15:01:58.593911Z',1,False,'
    
    

with child as (
    select "User ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "User ID" is not null
),

parent as (
    select "User ID" as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'unique_dim_users__User_ID_',NULL,'pass','test',0.06052994728088379,'2025-07-05T15:01:58.614552Z','2025-07-05T15:01:58.654008Z','2025-07-05T15:01:58.605913Z','2025-07-05T15:01:58.613933Z',1,False,'
    
    

select
    "User ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where "User ID" is not null
group by "User ID"
having count(*) > 1


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','93eb05db-cd2b-45f7-9499-07acf6f30836','2025-07-05 15:01:58',
    current_timestamp::timestamp
,'unique_fact_user_events__Event_ID_',NULL,'pass','test',0.03928089141845703,'2025-07-05T15:01:58.627446Z','2025-07-05T15:01:58.659296Z','2025-07-05T15:01:58.622610Z','2025-07-05T15:01:58.627204Z',1,False,'
    
    

select
    "Event ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is not null
group by "Event ID"
having count(*) > 1


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}')
  
[0m16:01:59.246558 [debug] [MainThread]: SQL status: INSERT 0 23 in 0.005 seconds
[0m16:01:59.247625 [debug] [MainThread]: On master: COMMIT
[0m16:01:59.247842 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:59.248034 [debug] [MainThread]: On master: COMMIT
[0m16:01:59.250523 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:01:59.251619 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:
[0m16:01:59.252038 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.019371 (1 runs)
[0m16:01:59.252433 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.025057 (1 runs)
[0m16:01:59.252857 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.000278 (1 runs)
[0m16:01:59.253248 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.206052 (23 runs)
[0m16:01:59.253632 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.213679 (1 runs)
[0m16:01:59.254012 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.007820 (1 runs)
[0m16:01:59.254380 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.commit: 0:00:00.003308 (1 runs)
[0m16:01:59.254802 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:00.259035 (1 runs)
[0m16:01:59.255324 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:00.285911 (1 runs)
[0m16:01:59.255879 [debug] [MainThread]: Elementary: Uploaded run results successfully.
[0m16:01:59.261091 [debug] [MainThread]: Elementary: Handling test results.
[0m16:01:59.278860 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:59.279170 [debug] [MainThread]: On master: BEGIN
[0m16:01:59.280922 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:01:59.281255 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:59.281475 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'elementary_test_results'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:59.290759 [debug] [MainThread]: SQL status: SELECT 28 in 0.009 seconds
[0m16:01:59.292595 [debug] [MainThread]: Elementary: Inserting 23 rows to table "podcast_analytics"."public_public"."elementary_test_results"
[0m16:01:59.478779 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:01:59.479389 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:59.480276 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."elementary_test_results"
         (id,data_issue_id,test_execution_id,test_unique_id,model_unique_id,invocation_id,detected_at,created_at,database_name,schema_name,table_name,column_name,test_type,test_sub_type,test_results_description,owners,tags,test_results_query,other,test_name,test_params,severity,status,failures,test_short_name,test_alias,result_rows,failed_row_count) values
    ('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','model.podcast_analytics.dim_episodes','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Duration (seconds)"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Duration (seconds)"
from "podcast_analytics"."public"."dim_episodes"
where "Duration (seconds)" is null


',NULL,'not_null_dim_episodes__Duration_seconds_','{"column_name": "\"Duration (seconds)\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_episodes__Duration_seconds_',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','model.podcast_analytics.fact_user_events','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event Type"','dbt_test','generic',NULL,'[]','[]','
    
    

with all_values as (

    select
        "Event Type" as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by "Event Type"

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',NULL,'accepted_values_fact_user_events__Event_Type___play__pause__seek__complete','{"values": ["play", "pause", "seek", "complete"], "column_name": "\"Event Type\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'accepted_values','accepted_values_fact_user_even_fbc631ab6baad050aa8d81cbe6f1af99',NULL,NULL),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','model.podcast_analytics.stg_user_events_invalid','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events_invalid','issue_type','dbt_test','generic',NULL,'[]','[]','
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    ''missing_event_type'',''invalid_event_type'',''missing_timestamp'',''malformed_timestamp'',''missing_user_id'',''missing_episode_id'',''other_issue''
)


',NULL,'accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue','{"values": ["missing_event_type", "invalid_event_type", "missing_timestamp", "malformed_timestamp", "missing_user_id", "missing_episode_id", "other_issue"], "column_name": "issue_type", "model": "{{ get_where_subquery(ref(''stg_user_events_invalid'')) }}"}','ERROR','pass',0,'accepted_values','accepted_values_stg_user_event_43bb633c97e04e462eb7fee334f302ba',NULL,NULL),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','model.podcast_analytics.stg_user_events','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','event_type','dbt_test','generic',NULL,'[]','[]','
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',NULL,'accepted_values_stg_user_events_event_type__play__pause__seek__complete','{"values": ["play", "pause", "seek", "complete"], "column_name": "event_type", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'accepted_values','accepted_values_stg_user_event_94634d24690dcf7d4e511df98c6e0582',NULL,NULL),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','model.podcast_analytics.dim_episodes','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Podcast ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Podcast ID"
from "podcast_analytics"."public"."dim_episodes"
where "Podcast ID" is null


',NULL,'not_null_dim_episodes__Podcast_ID_','{"column_name": "\"Podcast ID\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_episodes__Podcast_ID_',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','model.podcast_analytics.dim_episodes','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Episode ID"
from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is null


',NULL,'not_null_dim_episodes__Episode_ID_','{"column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_episodes__Episode_ID_',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','model.podcast_analytics.dim_users','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_users','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "User ID"
from "podcast_analytics"."public"."dim_users"
where "User ID" is null


',NULL,'not_null_dim_users__User_ID_','{"column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''dim_users'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_users__User_ID_',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','model.podcast_analytics.fact_user_events','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Episode ID"
from "podcast_analytics"."public"."fact_user_events"
where "Episode ID" is null


',NULL,'not_null_fact_user_events__Episode_ID_','{"column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__Episode_ID_',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','model.podcast_analytics.fact_user_events','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Event ID"
from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is null


',NULL,'not_null_fact_user_events__Event_ID_','{"column_name": "\"Event ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__Event_ID_',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','model.podcast_analytics.fact_user_events','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event Timestamp"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Event Timestamp"
from "podcast_analytics"."public"."fact_user_events"
where "Event Timestamp" is null


',NULL,'not_null_fact_user_events__Event_Timestamp_','{"column_name": "\"Event Timestamp\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__Event_Timestamp_',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','model.podcast_analytics.fact_user_events','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "User ID"
from "podcast_analytics"."public"."fact_user_events"
where "User ID" is null


',NULL,'not_null_fact_user_events__User_ID_','{"column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__User_ID_',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','model.podcast_analytics.stg_episodes','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_episodes','episode_id','dbt_test','generic',NULL,'[]','[]','
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null


',NULL,'not_null_stg_episodes_episode_id','{"column_name": "episode_id", "model": "{{ get_where_subquery(ref(''stg_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_episodes_episode_id',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','model.podcast_analytics.stg_episodes','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_episodes','podcast_id','dbt_test','generic',NULL,'[]','[]','
    
    



select podcast_id
from "podcast_analytics"."public"."stg_episodes"
where podcast_id is null


',NULL,'not_null_stg_episodes_podcast_id','{"column_name": "podcast_id", "model": "{{ get_where_subquery(ref(''stg_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_episodes_podcast_id',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','model.podcast_analytics.stg_user_events','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','episode_id','dbt_test','generic',NULL,'[]','[]','
    
    



select episode_id
from "podcast_analytics"."public"."stg_user_events"
where episode_id is null


',NULL,'not_null_stg_user_events_episode_id','{"column_name": "episode_id", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_episode_id',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','model.podcast_analytics.stg_user_events','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','event_id','dbt_test','generic',NULL,'[]','[]','
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null


',NULL,'not_null_stg_user_events_event_id','{"column_name": "event_id", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_event_id',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_user_events_user_id.82058db005',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','model.podcast_analytics.stg_user_events','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','user_id','dbt_test','generic',NULL,'[]','[]','
    
    



select user_id
from "podcast_analytics"."public"."stg_user_events"
where user_id is null


',NULL,'not_null_stg_user_events_user_id','{"column_name": "user_id", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_user_id',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','model.podcast_analytics.stg_user_events','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','event_ts','dbt_test','generic',NULL,'[]','[]','
    
    



select event_ts
from "podcast_analytics"."public"."stg_user_events"
where event_ts is null


',NULL,'not_null_stg_user_events_event_ts','{"column_name": "event_ts", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_event_ts',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','model.podcast_analytics.stg_users','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_users','user_id','dbt_test','generic',NULL,'[]','[]','
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null


',NULL,'not_null_stg_users_user_id','{"column_name": "user_id", "model": "{{ get_where_subquery(ref(''stg_users'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_users_user_id',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','model.podcast_analytics.fact_user_events','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    

with child as (
    select "Episode ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "Episode ID" is not null
),

parent as (
    select "Episode ID" as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',NULL,'relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_','{"to": "ref(''dim_episodes'')", "field": "\"Episode ID\"", "column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'relationships','relationships_fact_user_events_a5d0f4791bd5f2dd7a1079d5e9d2dc3a',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','model.podcast_analytics.dim_episodes','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    

select
    "Episode ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is not null
group by "Episode ID"
having count(*) > 1


',NULL,'unique_dim_episodes__Episode_ID_','{"column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'unique','unique_dim_episodes__Episode_ID_',NULL,NULL),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','model.podcast_analytics.fact_user_events','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    

with child as (
    select "User ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "User ID" is not null
),

parent as (
    select "User ID" as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',NULL,'relationships_fact_user_events__User_ID____User_ID___ref_dim_users_','{"to": "ref(''dim_users'')", "field": "\"User ID\"", "column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'relationships','relationships_fact_user_events_18a41013c7410998f321251d32b88faf',NULL,0),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','model.podcast_analytics.dim_users','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_users','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    

select
    "User ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where "User ID" is not null
group by "User ID"
having count(*) > 1


',NULL,'unique_dim_users__User_ID_','{"column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''dim_users'')) }}"}','ERROR','pass',0,'unique','unique_dim_users__User_ID_',NULL,NULL),('93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a',NULL,'93eb05db-cd2b-45f7-9499-07acf6f30836.test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','model.podcast_analytics.fact_user_events','93eb05db-cd2b-45f7-9499-07acf6f30836',cast('2025-07-05 15:01:58' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event ID"','dbt_test','generic',NULL,'[]','[]','
    
    

select
    "Event ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is not null
group by "Event ID"
having count(*) > 1


',NULL,'unique_fact_user_events__Event_ID_','{"column_name": "\"Event ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'unique','unique_fact_user_events__Event_ID_',NULL,NULL)
  
[0m16:01:59.485428 [debug] [MainThread]: SQL status: INSERT 0 23 in 0.004 seconds
[0m16:01:59.486774 [debug] [MainThread]: On master: COMMIT
[0m16:01:59.487019 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:59.487226 [debug] [MainThread]: On master: COMMIT
[0m16:01:59.489342 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:01:59.490140 [debug] [MainThread]: Elementary: Handled test results successfully.
[0m16:01:59.498179 [debug] [MainThread]: Elementary: Uploading dbt invocation.
[0m16:01:59.530960 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:59.531312 [debug] [MainThread]: On master: BEGIN
[0m16:01:59.533063 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:01:59.533404 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:59.533632 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_invocations'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:01:59.539165 [debug] [MainThread]: SQL status: SELECT 35 in 0.005 seconds
[0m16:01:59.540682 [debug] [MainThread]: Elementary: Inserting 1 rows to table "podcast_analytics"."public_public"."dbt_invocations"
[0m16:01:59.551580 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:01:59.552252 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:59.552481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."dbt_invocations"
         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values
    ('93eb05db-cd2b-45f7-9499-07acf6f30836',NULL,NULL,NULL,'2025-07-05 15:01:57','2025-07-05 15:01:59','2025-07-05 15:01:59',
    current_timestamp::timestamp
,'test','1.10.3','0.18.2',False,'{}','{}','local','podcast_analytics','public','podcast_analytics',4,'[]',NULL,NULL,'podcast_analytics',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'{"user": "podcast"}')
  
[0m16:01:59.555191 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.002 seconds
[0m16:01:59.556245 [debug] [MainThread]: On master: COMMIT
[0m16:01:59.556474 [debug] [MainThread]: Using postgres connection "master"
[0m16:01:59.556660 [debug] [MainThread]: On master: COMMIT
[0m16:01:59.559437 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m16:01:59.560529 [debug] [MainThread]: Elementary: Uploaded dbt invocation successfully.
[0m16:01:59.564136 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m16:01:59.564774 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]
[0m16:01:59.565095 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-end.0 ........................................ [[32mOK[0m in 0.89s]
[0m16:01:59.565317 [debug] [MainThread]: On master: Close
[0m16:01:59.565584 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:01:59.565744 [debug] [MainThread]: Connection 'test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24' was properly closed.
[0m16:01:59.565892 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de' was properly closed.
[0m16:01:59.566029 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a' was properly closed.
[0m16:01:59.566165 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a' was properly closed.
[0m16:01:59.566372 [info ] [MainThread]: 
[0m16:01:59.566552 [info ] [MainThread]: Finished running 2 project hooks, 23 data tests in 0 hours 0 minutes and 1.75 seconds (1.75s).
[0m16:01:59.568455 [debug] [MainThread]: Command end result
[0m16:01:59.612410 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m16:01:59.613808 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m16:01:59.618292 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m16:01:59.618570 [info ] [MainThread]: 
[0m16:01:59.618815 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:01:59.619025 [info ] [MainThread]: 
[0m16:01:59.619219 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=25
[0m16:01:59.619561 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageMaterializationOverrideDeprecation: 23 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:01:59.621116 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.3671744, "process_in_blocks": "0", "process_kernel_time": 0.190214, "process_mem_max_rss": "141443072", "process_out_blocks": "0", "process_user_time": 2.739147}
[0m16:01:59.621382 [debug] [MainThread]: Command `dbt test` succeeded at 16:01:59.621334 after 2.37 seconds
[0m16:01:59.621616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10387b4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059dae00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d9a80>]}
[0m16:01:59.621843 [debug] [MainThread]: Flushing usage events
[0m16:01:59.963893 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:14:25.400924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105507430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645f7c0>]}


============================== 16:14:25.404008 | b6743aa8-ea3d-45b5-9b33-2f3572d9119d ==============================
[0m16:14:25.404008 [info ] [MainThread]: Running with dbt=1.10.3
[0m16:14:25.404391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/samydoreau/global-assignment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir /Users/samydoreau/global-assignment', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:14:25.563872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6743aa8-ea3d-45b5-9b33-2f3572d9119d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dac700>]}
[0m16:14:25.596933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6743aa8-ea3d-45b5-9b33-2f3572d9119d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106880e50>]}
[0m16:14:25.598760 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:14:25.670978 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m16:14:25.878447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:14:25.879216 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/schema.yml
[0m16:14:26.273485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6743aa8-ea3d-45b5-9b33-2f3572d9119d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079584c0>]}
[0m16:14:26.409395 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m16:14:26.412037 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m16:14:26.433767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6743aa8-ea3d-45b5-9b33-2f3572d9119d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794c160>]}
[0m16:14:26.434182 [info ] [MainThread]: Found 39 models, 2 seeds, 2 operations, 24 data tests, 3 sources, 1248 macros
[0m16:14:26.434408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6743aa8-ea3d-45b5-9b33-2f3572d9119d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10784dd50>]}
[0m16:14:26.436074 [info ] [MainThread]: 
[0m16:14:26.436285 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m16:14:26.436452 [info ] [MainThread]: 
[0m16:14:26.436742 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:14:26.440570 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m16:14:26.440923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public_public'
[0m16:14:26.475172 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m16:14:26.475483 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public_public"
[0m16:14:26.475774 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m16:14:26.476064 [debug] [ThreadPool]: On list_podcast_analytics_public_public: BEGIN
[0m16:14:26.476279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:26.476457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:26.479712 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m16:14:26.479952 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m16:14:26.481055 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m16:14:26.481262 [debug] [ThreadPool]: Postgres adapter: Error running SQL: BEGIN
[0m16:14:26.481434 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:14:26.481606 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:14:26.481820 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m16:14:26.482029 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_relations_without_caching
[0m16:14:26.482239 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:14:26.482447 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m16:14:26.482640 [debug] [ThreadPool]: On list_podcast_analytics_public: No close available on handle
[0m16:14:26.482832 [debug] [ThreadPool]: On list_podcast_analytics_public_public: No close available on handle
[0m16:14:26.483379 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:26.483578 [debug] [MainThread]: Connection 'list_podcast_analytics_public' was properly closed.
[0m16:14:26.483740 [debug] [MainThread]: Connection 'list_podcast_analytics_public_public' was properly closed.
[0m16:14:26.483914 [info ] [MainThread]: 
[0m16:14:26.484178 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.05 seconds (0.05s).
[0m16:14:26.484583 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  connection to server at "localhost" (::1), port 5432 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m16:14:26.486866 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 1.1309, "process_in_blocks": "0", "process_kernel_time": 0.200396, "process_mem_max_rss": "138215424", "process_out_blocks": "0", "process_user_time": 1.446522}
[0m16:14:26.487235 [debug] [MainThread]: Command `dbt test` failed at 16:14:26.487180 after 1.13 seconds
[0m16:14:26.487487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105507430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10784dd50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107606740>]}
[0m16:14:26.487723 [debug] [MainThread]: Flushing usage events
[0m16:14:26.881365 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:14:36.439216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10639f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e3b670>]}


============================== 16:14:36.441930 | 205749d8-b89c-4373-9928-e878a4a274e0 ==============================
[0m16:14:36.441930 [info ] [MainThread]: Running with dbt=1.10.3
[0m16:14:36.442276 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'profiles_dir': '/Users/samydoreau/global-assignment', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --profiles-dir /Users/samydoreau/global-assignment', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:14:36.546141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '205749d8-b89c-4373-9928-e878a4a274e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b23f70>]}
[0m16:14:36.578404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '205749d8-b89c-4373-9928-e878a4a274e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11029b4c0>]}
[0m16:14:36.579238 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:14:36.647570 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m16:14:36.837568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:14:36.837896 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:14:36.883831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '205749d8-b89c-4373-9928-e878a4a274e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11372c370>]}
[0m16:14:36.979129 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m16:14:36.980627 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m16:14:36.998861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '205749d8-b89c-4373-9928-e878a4a274e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137273d0>]}
[0m16:14:36.999209 [info ] [MainThread]: Found 39 models, 2 seeds, 2 operations, 24 data tests, 3 sources, 1248 macros
[0m16:14:36.999434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '205749d8-b89c-4373-9928-e878a4a274e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113727790>]}
[0m16:14:37.001003 [info ] [MainThread]: 
[0m16:14:37.001203 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m16:14:37.001371 [info ] [MainThread]: 
[0m16:14:37.001649 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:14:37.005434 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public_public'
[0m16:14:37.005790 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m16:14:37.040916 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public_public"
[0m16:14:37.041191 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m16:14:37.041447 [debug] [ThreadPool]: On list_podcast_analytics_public_public: BEGIN
[0m16:14:37.041637 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m16:14:37.041816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:37.041991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:37.101470 [debug] [ThreadPool]: SQL status: BEGIN in 0.060 seconds
[0m16:14:37.101838 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public_public"
[0m16:14:37.102060 [debug] [ThreadPool]: On list_podcast_analytics_public_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m16:14:37.103817 [debug] [ThreadPool]: SQL status: BEGIN in 0.062 seconds
[0m16:14:37.104087 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m16:14:37.104295 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:14:37.107513 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.003 seconds
[0m16:14:37.107776 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.005 seconds
[0m16:14:37.108762 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m16:14:37.109672 [debug] [ThreadPool]: On list_podcast_analytics_public_public: ROLLBACK
[0m16:14:37.110494 [debug] [ThreadPool]: On list_podcast_analytics_public_public: Close
[0m16:14:37.110691 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m16:14:37.118696 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:37.118960 [debug] [MainThread]: On master: BEGIN
[0m16:14:37.119137 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:14:37.131057 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:14:37.131374 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:37.131626 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:14:37.154132 [debug] [MainThread]: SQL status: SELECT 55 in 0.022 seconds
[0m16:14:37.158340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '205749d8-b89c-4373-9928-e878a4a274e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bebf40>]}
[0m16:14:37.158669 [debug] [MainThread]: On master: ROLLBACK
[0m16:14:37.159510 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:37.159710 [debug] [MainThread]: On master: BEGIN
[0m16:14:37.160922 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:14:37.161178 [debug] [MainThread]: On master: COMMIT
[0m16:14:37.161388 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:37.161580 [debug] [MainThread]: On master: COMMIT
[0m16:14:37.162261 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:14:37.183777 [debug] [MainThread]: Elementary: Materialization override is enabled.
[0m16:14:37.200289 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:37.200571 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    select count(*) from pg_namespace where nspname = 'public_public__tests'
  
[0m16:14:37.201989 [debug] [MainThread]: SQL status: SELECT 1 in 0.001 seconds
[0m16:14:37.203436 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m16:14:37.206655 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]
[0m16:14:37.206971 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-start.0 ...................................... [[32mOK[0m in 0.04s]
[0m16:14:37.207160 [info ] [MainThread]: 
[0m16:14:37.207350 [debug] [MainThread]: On master: Close
[0m16:14:37.209358 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:14:37.209598 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:14:37.209854 [debug] [Thread-3 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:14:37.210093 [debug] [Thread-4 (]: Began running node test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf
[0m16:14:37.210314 [info ] [Thread-1 (]: 1 of 24 START test accepted_values_fact_user_events__Event_Type___play__pause__seek__complete  [RUN]
[0m16:14:37.210565 [info ] [Thread-2 (]: 2 of 24 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m16:14:37.210828 [info ] [Thread-3 (]: 3 of 24 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [RUN]
[0m16:14:37.211076 [info ] [Thread-4 (]: 4 of 24 START test dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01  [RUN]
[0m16:14:37.211338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public_public, now test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8)
[0m16:14:37.211577 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m16:14:37.211859 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7'
[0m16:14:37.212139 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf'
[0m16:14:37.212356 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:14:37.212573 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:14:37.212999 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:14:37.213278 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf
[0m16:14:37.222407 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:14:37.225599 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:14:37.230142 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:14:37.268076 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf"
[0m16:14:37.269069 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:14:37.269376 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:14:37.271375 [warn ] [Thread-3 (]: [[33mWARNING[0m]: Installed package 'elementary' is overriding the built-in
materialization 'test'. Overrides of built-in materializations from installed
packages will be deprecated in future versions of dbt. For more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m16:14:37.271698 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf
[0m16:14:37.273499 [warn ] [Thread-2 (]: [[33mWARNING[0m]: Installed package 'elementary' is overriding the built-in
materialization 'test'. Overrides of built-in materializations from installed
packages will be deprecated in future versions of dbt. For more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m16:14:37.273783 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:14:37.273993 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '205749d8-b89c-4373-9928-e878a4a274e0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136d43d0>]}
[0m16:14:37.275732 [warn ] [Thread-4 (]: [[33mWARNING[0m]: Installed package 'elementary' is overriding the built-in
materialization 'test'. Overrides of built-in materializations from installed
packages will be deprecated in future versions of dbt. For more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m16:14:37.275974 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '205749d8-b89c-4373-9928-e878a4a274e0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103c3730>]}
[0m16:14:37.278293 [warn ] [Thread-1 (]: [[33mWARNING[0m]: Installed package 'elementary' is overriding the built-in
materialization 'test'. Overrides of built-in materializations from installed
packages will be deprecated in future versions of dbt. For more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m16:14:37.297626 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '205749d8-b89c-4373-9928-e878a4a274e0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138b3700>]}
[0m16:14:37.334945 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '205749d8-b89c-4373-9928-e878a4a274e0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f10820>]}
[0m16:14:37.383441 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:14:37.384670 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:14:37.387208 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:14:37.388891 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf"
[0m16:14:37.389632 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:14:37.389901 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf"
[0m16:14:37.390129 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:14:37.390326 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m16:14:37.390530 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:14:37.390739 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf: BEGIN
[0m16:14:37.390944 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: BEGIN
[0m16:14:37.391158 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:14:37.391367 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: BEGIN
[0m16:14:37.391559 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:14:37.391757 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:14:37.392019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:14:37.427624 [debug] [Thread-3 (]: SQL status: BEGIN in 0.036 seconds
[0m16:14:37.427990 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:14:37.428416 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','missing_timestamp','malformed_timestamp','missing_user_id','missing_episode_id','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m16:14:37.429475 [debug] [Thread-4 (]: SQL status: BEGIN in 0.038 seconds
[0m16:14:37.429790 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf"
[0m16:14:37.430055 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "podcast_analytics"."public"."fact_user_events"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not Event Timestamp >= 2025-03-01
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m16:14:37.430419 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m16:14:37.430639 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:14:37.430858 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        "Event Type" as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by "Event Type"

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m16:14:37.431199 [debug] [Thread-4 (]: Postgres adapter: Postgres error: syntax error at or near "Timestamp"
LINE 24:     or not Event Timestamp >= 2025-03-01
                          ^

[0m16:14:37.431425 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf: ROLLBACK
[0m16:14:37.431834 [debug] [Thread-2 (]: SQL status: BEGIN in 0.041 seconds
[0m16:14:37.432185 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf: Close
[0m16:14:37.432445 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:14:37.432943 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m16:14:37.435373 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:14:37.453990 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.025 seconds
[0m16:14:37.454284 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.021 seconds
[0m16:14:37.460701 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: ROLLBACK
[0m16:14:37.463438 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: ROLLBACK
[0m16:14:37.466113 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m16:14:37.467160 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m16:14:37.467504 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: Close
[0m16:14:37.467756 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: Close
[0m16:14:37.468179 [info ] [Thread-2 (]: 2 of 24 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.26s]
[0m16:14:37.468667 [info ] [Thread-3 (]: 3 of 24 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [[32mPASS[0m in 0.26s]
[0m16:14:37.469347 [debug] [Thread-4 (]: Database Error in test dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01 (models/schema.yml)
  syntax error at or near "Timestamp"
  LINE 24:     or not Event Timestamp >= 2025-03-01
                            ^
  compiled code at target/run/podcast_analytics/models/schema.yml/dbt_utils_accepted_range_fact__7e46db9cbf1d0f562d9cdf6b5fb8aab9.sql
[0m16:14:37.470047 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:14:37.469709 [info ] [Thread-1 (]: 1 of 24 PASS accepted_values_fact_user_events__Event_Type___play__pause__seek__complete  [[32mPASS[0m in 0.26s]
[0m16:14:37.470495 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:14:37.470793 [error] [Thread-4 (]: 4 of 24 ERROR dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01  [[31mERROR[0m in 0.26s]
[0m16:14:37.471123 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:14:37.471643 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:14:37.471928 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:14:37.472279 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf
[0m16:14:37.472719 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:14:37.472510 [info ] [Thread-2 (]: 5 of 24 START test not_null_dim_episodes__Duration_seconds_ .................... [RUN]
[0m16:14:37.473310 [info ] [Thread-3 (]: 6 of 24 START test not_null_dim_episodes__Episode_ID_ .......................... [RUN]
[0m16:14:37.473678 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:14:37.474054 [debug] [Thread-7 (]: Marking all children of 'test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01 (models/schema.yml)
  syntax error at or near "Timestamp"
  LINE 24:     or not Event Timestamp >= 2025-03-01
                            ^
  compiled code at target/run/podcast_analytics/models/schema.yml/dbt_utils_accepted_range_fact__7e46db9cbf1d0f562d9cdf6b5fb8aab9.sql.
[0m16:14:37.474329 [info ] [Thread-1 (]: 7 of 24 START test not_null_dim_episodes__Podcast_ID_ .......................... [RUN]
[0m16:14:37.474726 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444)
[0m16:14:37.474991 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc)
[0m16:14:37.475239 [info ] [Thread-4 (]: 8 of 24 START test not_null_dim_users__User_ID_ ................................ [RUN]
[0m16:14:37.475582 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8, now test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7)
[0m16:14:37.475825 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:14:37.476038 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:14:37.476262 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf, now test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba)
[0m16:14:37.476472 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:14:37.481818 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:14:37.485021 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:14:37.485301 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:14:37.488203 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:14:37.492438 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:14:37.492878 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:14:37.493109 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:14:37.497232 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:14:37.501625 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:14:37.501949 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:14:37.502387 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:14:37.506625 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:14:37.510603 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:14:37.510865 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:14:37.511095 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:14:37.511456 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: BEGIN
[0m16:14:37.511720 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: BEGIN
[0m16:14:37.511949 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:14:37.512160 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:14:37.512375 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:14:37.512575 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:14:37.512778 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: BEGIN
[0m16:14:37.512967 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: BEGIN
[0m16:14:37.513296 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:14:37.513501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:14:37.533670 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m16:14:37.534143 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:14:37.534538 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Duration (seconds)"
from "podcast_analytics"."public"."dim_episodes"
where "Duration (seconds)" is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.534806 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m16:14:37.535162 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:14:37.535446 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Podcast ID"
from "podcast_analytics"."public"."dim_episodes"
where "Podcast ID" is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.535728 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m16:14:37.536039 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:14:37.536293 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "User ID"
from "podcast_analytics"."public"."dim_users"
where "User ID" is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.536538 [debug] [Thread-3 (]: SQL status: BEGIN in 0.024 seconds
[0m16:14:37.536775 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:14:37.536986 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Episode ID"
from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.537376 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:14:37.537680 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:14:37.540962 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: ROLLBACK
[0m16:14:37.541249 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:14:37.541501 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:14:37.544509 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: ROLLBACK
[0m16:14:37.547804 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: ROLLBACK
[0m16:14:37.548065 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: Close
[0m16:14:37.551172 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: ROLLBACK
[0m16:14:37.551695 [info ] [Thread-2 (]: 5 of 24 PASS not_null_dim_episodes__Duration_seconds_ .......................... [[32mPASS[0m in 0.08s]
[0m16:14:37.552220 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:14:37.552453 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: Close
[0m16:14:37.552679 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: Close
[0m16:14:37.552862 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: Close
[0m16:14:37.553118 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471
[0m16:14:37.553583 [info ] [Thread-1 (]: 7 of 24 PASS not_null_dim_episodes__Podcast_ID_ ................................ [[32mPASS[0m in 0.08s]
[0m16:14:37.553995 [info ] [Thread-4 (]: 8 of 24 PASS not_null_dim_users__User_ID_ ...................................... [[32mPASS[0m in 0.08s]
[0m16:14:37.554321 [info ] [Thread-3 (]: 6 of 24 PASS not_null_dim_episodes__Episode_ID_ ................................ [[32mPASS[0m in 0.08s]
[0m16:14:37.554594 [info ] [Thread-2 (]: 9 of 24 START test not_null_fact_user_events_Event_Timestamp ................... [RUN]
[0m16:14:37.554945 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:14:37.555236 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:14:37.555508 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:14:37.555736 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444, now test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471)
[0m16:14:37.555970 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:14:37.556178 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:14:37.556420 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:14:37.556659 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471
[0m16:14:37.557008 [info ] [Thread-1 (]: 10 of 24 START test not_null_fact_user_events__Episode_ID_ ..................... [RUN]
[0m16:14:37.557301 [info ] [Thread-4 (]: 11 of 24 START test not_null_fact_user_events__Event_ID_ ....................... [RUN]
[0m16:14:37.557584 [info ] [Thread-3 (]: 12 of 24 START test not_null_fact_user_events__User_ID_ ........................ [RUN]
[0m16:14:37.560912 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471"
[0m16:14:37.561219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7, now test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae)
[0m16:14:37.561440 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba, now test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c)
[0m16:14:37.561649 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc, now test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2)
[0m16:14:37.562043 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:14:37.562294 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:14:37.562512 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:14:37.565560 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:14:37.569061 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:14:37.572439 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:14:37.572724 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471
[0m16:14:37.577654 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471"
[0m16:14:37.577955 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:14:37.578224 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:14:37.582225 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:14:37.582501 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:14:37.624493 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:14:37.624876 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471"
[0m16:14:37.628904 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:14:37.629221 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471: BEGIN
[0m16:14:37.629443 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:14:37.629756 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:14:37.629952 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:14:37.630236 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: BEGIN
[0m16:14:37.630441 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:14:37.630643 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: BEGIN
[0m16:14:37.630903 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:14:37.631102 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: BEGIN
[0m16:14:37.631299 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:14:37.631569 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:14:37.660554 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m16:14:37.660896 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:14:37.661176 [debug] [Thread-2 (]: SQL status: BEGIN in 0.031 seconds
[0m16:14:37.661465 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m16:14:37.661760 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "User ID"
from "podcast_analytics"."public"."fact_user_events"
where "User ID" is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.662004 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471"
[0m16:14:37.662220 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:14:37.662595 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select Event Timestamp
from "podcast_analytics"."public"."fact_user_events"
where Event Timestamp is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.662913 [debug] [Thread-4 (]: SQL status: BEGIN in 0.032 seconds
[0m16:14:37.663199 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Episode ID"
from "podcast_analytics"."public"."fact_user_events"
where "Episode ID" is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.663527 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:14:37.663824 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Event ID"
from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.664533 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near "Timestamp"
LINE 18: where Event Timestamp is null
                     ^

[0m16:14:37.664792 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471: ROLLBACK
[0m16:14:37.665473 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471: Close
[0m16:14:37.666401 [debug] [Thread-2 (]: Database Error in test not_null_fact_user_events_Event_Timestamp (models/schema.yml)
  syntax error at or near "Timestamp"
  LINE 18: where Event Timestamp is null
                       ^
  compiled code at target/run/podcast_analytics/models/schema.yml/not_null_fact_user_events_Event_Timestamp.sql
[0m16:14:37.666665 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:14:37.666872 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:14:37.667352 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:14:37.667164 [error] [Thread-2 (]: 9 of 24 ERROR not_null_fact_user_events_Event_Timestamp ........................ [[31mERROR[0m in 0.11s]
[0m16:14:37.670764 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: ROLLBACK
[0m16:14:37.674078 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: ROLLBACK
[0m16:14:37.677327 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: ROLLBACK
[0m16:14:37.677756 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471
[0m16:14:37.678308 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:14:37.678682 [debug] [Thread-7 (]: Marking all children of 'test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_user_events_Event_Timestamp (models/schema.yml)
  syntax error at or near "Timestamp"
  LINE 18: where Event Timestamp is null
                       ^
  compiled code at target/run/podcast_analytics/models/schema.yml/not_null_fact_user_events_Event_Timestamp.sql.
[0m16:14:37.678954 [info ] [Thread-2 (]: 13 of 24 START test not_null_stg_episodes_episode_id ........................... [RUN]
[0m16:14:37.679189 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: Close
[0m16:14:37.679568 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471, now test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422)
[0m16:14:37.679768 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: Close
[0m16:14:37.680046 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:14:37.680290 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: Close
[0m16:14:37.680596 [info ] [Thread-4 (]: 11 of 24 PASS not_null_fact_user_events__Event_ID_ ............................. [[32mPASS[0m in 0.12s]
[0m16:14:37.681097 [info ] [Thread-3 (]: 12 of 24 PASS not_null_fact_user_events__User_ID_ .............................. [[32mPASS[0m in 0.12s]
[0m16:14:37.684453 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:14:37.685285 [info ] [Thread-1 (]: 10 of 24 PASS not_null_fact_user_events__Episode_ID_ ........................... [[32mPASS[0m in 0.12s]
[0m16:14:37.685672 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:14:37.685952 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:14:37.686402 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:14:37.686764 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:14:37.687067 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:14:37.687270 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:14:37.687543 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:14:37.687815 [info ] [Thread-4 (]: 14 of 24 START test not_null_stg_episodes_podcast_id ........................... [RUN]
[0m16:14:37.688057 [info ] [Thread-3 (]: 15 of 24 START test not_null_stg_user_events_episode_id ........................ [RUN]
[0m16:14:37.692773 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:14:37.693080 [info ] [Thread-1 (]: 16 of 24 START test not_null_stg_user_events_event_id .......................... [RUN]
[0m16:14:37.693335 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c, now test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1)
[0m16:14:37.693554 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2, now test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110)
[0m16:14:37.693928 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae, now test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7)
[0m16:14:37.694196 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:14:37.694451 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:14:37.694655 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:14:37.694897 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:14:37.698125 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:14:37.701204 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:14:37.705026 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:14:37.705337 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m16:14:37.705776 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:14:37.706398 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:14:37.706686 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:14:37.706948 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:14:37.711195 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:14:37.715518 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:14:37.719279 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:14:37.720070 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:14:37.720307 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m16:14:37.720509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:14:37.721125 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m16:14:37.721530 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:14:37.721783 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:14:37.722048 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:14:37.722307 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: BEGIN
[0m16:14:37.722598 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.722901 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: BEGIN
[0m16:14:37.723173 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:14:37.723476 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:14:37.726109 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:14:37.729372 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m16:14:37.730987 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m16:14:37.731370 [info ] [Thread-2 (]: 13 of 24 PASS not_null_stg_episodes_episode_id ................................. [[32mPASS[0m in 0.05s]
[0m16:14:37.731930 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:14:37.732188 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:14:37.732426 [info ] [Thread-2 (]: 17 of 24 START test not_null_stg_user_events_event_ts .......................... [RUN]
[0m16:14:37.732686 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502)
[0m16:14:37.732904 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:14:37.736621 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:14:37.736988 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:14:37.737495 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:14:37.737823 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.738351 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:14:37.742585 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:14:37.742865 [debug] [Thread-3 (]: SQL status: BEGIN in 0.019 seconds
[0m16:14:37.743126 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m16:14:37.743364 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:14:37.743596 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:14:37.743879 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_user_events"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.744203 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:14:37.744430 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select podcast_id
from "podcast_analytics"."public"."stg_episodes"
where podcast_id is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.744687 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: BEGIN
[0m16:14:37.744915 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:14:37.746937 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:14:37.750903 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: ROLLBACK
[0m16:14:37.751578 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:14:37.755369 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: ROLLBACK
[0m16:14:37.755615 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: Close
[0m16:14:37.756146 [info ] [Thread-4 (]: 14 of 24 PASS not_null_stg_episodes_podcast_id ................................. [[32mPASS[0m in 0.06s]
[0m16:14:37.756525 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:14:37.756785 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: Close
[0m16:14:37.757123 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:14:37.757617 [info ] [Thread-3 (]: 15 of 24 PASS not_null_stg_user_events_episode_id .............................. [[32mPASS[0m in 0.06s]
[0m16:14:37.757916 [info ] [Thread-4 (]: 18 of 24 START test not_null_stg_user_events_user_id ........................... [RUN]
[0m16:14:37.758249 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:14:37.758545 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1, now test.podcast_analytics.not_null_stg_user_events_user_id.82058db005)
[0m16:14:37.758851 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:14:37.759072 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:14:37.759305 [info ] [Thread-3 (]: 19 of 24 START test not_null_stg_users_user_id ................................. [RUN]
[0m16:14:37.762658 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:14:37.763012 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m16:14:37.763402 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m16:14:37.763695 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.025 seconds
[0m16:14:37.763987 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:14:37.764217 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:14:37.767505 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m16:14:37.767805 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:14:37.768012 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_ts
from "podcast_analytics"."public"."stg_user_events"
where event_ts is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.771370 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:14:37.775711 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:14:37.776065 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m16:14:37.776826 [info ] [Thread-1 (]: 16 of 24 PASS not_null_stg_user_events_event_id ................................ [[32mPASS[0m in 0.08s]
[0m16:14:37.777316 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:14:37.777571 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:14:37.777806 [debug] [Thread-1 (]: Began running node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:14:37.778098 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:14:37.782430 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:14:37.782933 [info ] [Thread-1 (]: 20 of 24 START test relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_  [RUN]
[0m16:14:37.783277 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: BEGIN
[0m16:14:37.783719 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f)
[0m16:14:37.784015 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:14:37.784263 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:14:37.784506 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:14:37.790064 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:14:37.790347 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m16:14:37.790700 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:14:37.791134 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:14:37.796387 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:14:37.796898 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:14:37.797118 [debug] [Thread-1 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: BEGIN
[0m16:14:37.797304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:14:37.803929 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.027 seconds
[0m16:14:37.807171 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: ROLLBACK
[0m16:14:37.807960 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: Close
[0m16:14:37.808486 [info ] [Thread-2 (]: 17 of 24 PASS not_null_stg_user_events_event_ts ................................ [[32mPASS[0m in 0.08s]
[0m16:14:37.808850 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:14:37.809094 [debug] [Thread-2 (]: Began running node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:14:37.809320 [info ] [Thread-2 (]: 21 of 24 START test relationships_fact_user_events__User_ID____User_ID___ref_dim_users_  [RUN]
[0m16:14:37.809578 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502, now test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24)
[0m16:14:37.809792 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:14:37.814349 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:14:37.814684 [debug] [Thread-4 (]: SQL status: BEGIN in 0.031 seconds
[0m16:14:37.815414 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:14:37.815686 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_user_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.816063 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:14:37.821730 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:14:37.822063 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m16:14:37.822327 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m16:14:37.822542 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m16:14:37.822894 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:14:37.825966 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: ROLLBACK
[0m16:14:37.826386 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:14:37.826652 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:14:37.826901 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.827172 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: BEGIN
[0m16:14:37.827521 [debug] [Thread-1 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select "Episode ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "Episode ID" is not null
),

parent as (
    select "Episode ID" as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.827964 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:14:37.828346 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: Close
[0m16:14:37.828989 [info ] [Thread-4 (]: 18 of 24 PASS not_null_stg_user_events_user_id ................................. [[32mPASS[0m in 0.07s]
[0m16:14:37.829367 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:14:37.829607 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:14:37.829821 [info ] [Thread-4 (]: 22 of 24 START test unique_dim_episodes__Episode_ID_ ........................... [RUN]
[0m16:14:37.830283 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_user_id.82058db005, now test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de)
[0m16:14:37.830543 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:14:37.830784 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:14:37.835538 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:14:37.838754 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m16:14:37.838998 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.011 seconds
[0m16:14:37.842774 [debug] [Thread-1 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: ROLLBACK
[0m16:14:37.843112 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:14:37.843462 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m16:14:37.847951 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:14:37.848257 [debug] [Thread-1 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: Close
[0m16:14:37.848487 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m16:14:37.848938 [info ] [Thread-3 (]: 19 of 24 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.09s]
[0m16:14:37.849473 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:14:37.849858 [info ] [Thread-1 (]: 20 of 24 PASS relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_  [[32mPASS[0m in 0.07s]
[0m16:14:37.850286 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:14:37.850566 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select "User ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "User ID" is not null
),

parent as (
    select "User ID" as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:14:37.850867 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:14:37.851142 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:14:37.851400 [debug] [Thread-3 (]: Began running node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:14:37.851829 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: BEGIN
[0m16:14:37.852129 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:14:37.852414 [info ] [Thread-3 (]: 23 of 24 START test unique_dim_users__User_ID_ ................................. [RUN]
[0m16:14:37.852647 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:14:37.852937 [info ] [Thread-1 (]: 24 of 24 START test unique_fact_user_events__Event_ID_ ......................... [RUN]
[0m16:14:37.853319 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77, now test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a)
[0m16:14:37.853724 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f, now test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a)
[0m16:14:37.854021 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:14:37.854280 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:14:37.857934 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:14:37.858353 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:14:37.862055 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:14:37.865587 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: ROLLBACK
[0m16:14:37.866202 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:14:37.870821 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:14:37.871141 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: Close
[0m16:14:37.871461 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m16:14:37.871804 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:14:37.872093 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:14:37.872478 [info ] [Thread-2 (]: 21 of 24 PASS relationships_fact_user_events__User_ID____User_ID___ref_dim_users_  [[32mPASS[0m in 0.06s]
[0m16:14:37.916095 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:14:37.920095 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:14:37.920373 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    "Episode ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is not null
group by "Episode ID"
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:14:37.920856 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:14:37.921101 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: BEGIN
[0m16:14:37.921573 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:14:37.921834 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:14:37.922225 [debug] [Thread-1 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: BEGIN
[0m16:14:37.922495 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:14:37.924207 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:14:37.927286 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: ROLLBACK
[0m16:14:37.928169 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: Close
[0m16:14:37.928615 [info ] [Thread-4 (]: 22 of 24 PASS unique_dim_episodes__Episode_ID_ ................................. [[32mPASS[0m in 0.10s]
[0m16:14:37.929064 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:14:37.937304 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m16:14:37.937628 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m16:14:37.937964 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:14:37.938198 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:14:37.938424 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    "User ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where "User ID" is not null
group by "User ID"
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:14:37.938673 [debug] [Thread-1 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    "Event ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is not null
group by "Event ID"
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:14:37.941469 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:14:37.944461 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: ROLLBACK
[0m16:14:37.944718 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m16:14:37.947576 [debug] [Thread-1 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: ROLLBACK
[0m16:14:37.947852 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: Close
[0m16:14:37.948284 [info ] [Thread-3 (]: 23 of 24 PASS unique_dim_users__User_ID_ ....................................... [[32mPASS[0m in 0.09s]
[0m16:14:37.948761 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:14:37.949069 [debug] [Thread-1 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: Close
[0m16:14:37.949490 [info ] [Thread-1 (]: 24 of 24 PASS unique_fact_user_events__Event_ID_ ............................... [[32mPASS[0m in 0.10s]
[0m16:14:37.949916 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:14:37.950748 [info ] [MainThread]: 
[0m16:14:37.950993 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:37.951160 [debug] [MainThread]: On master: BEGIN
[0m16:14:37.951322 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:14:37.963998 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:14:37.964357 [debug] [MainThread]: On master: COMMIT
[0m16:14:37.964550 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:37.964721 [debug] [MainThread]: On master: COMMIT
[0m16:14:37.965417 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:14:37.983903 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:37.984226 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
    select artifacts_model, metadata_hash from "podcast_analytics"."public_public"."dbt_artifacts_hashes"
    order by metadata_hash
    
  
[0m16:14:37.988338 [debug] [MainThread]: SQL status: SELECT 171 in 0.004 seconds
[0m16:14:37.990192 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m16:14:38.004312 [debug] [MainThread]: Elementary: [dbt_models] Flattening the artifacts.
[0m16:14:38.028893 [debug] [MainThread]: Elementary: [dbt_models] Flattened 39 artifacts.
[0m16:14:38.032262 [debug] [MainThread]: Elementary: [dbt_models] Comparing the artifacts state.
[0m16:14:38.032856 [debug] [MainThread]: Elementary: [dbt_models] Artifacts did not change.
[0m16:14:38.033663 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:
[0m16:14:38.034077 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.023878 (1 runs)
[0m16:14:38.034463 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.029349 (1 runs)
[0m16:14:38.037244 [debug] [MainThread]: Elementary: [dbt_tests] Flattening the artifacts.
[0m16:14:38.067720 [debug] [MainThread]: Elementary: [dbt_tests] Flattened 24 artifacts.
[0m16:14:38.068502 [debug] [MainThread]: Elementary: [dbt_tests] Comparing the artifacts state.
[0m16:14:38.068921 [debug] [MainThread]: Elementary: [dbt_tests] Artifacts changed.
[0m16:14:38.073139 [debug] [MainThread]: Elementary: Deleting from and inserting to: "podcast_analytics"."public_public"."dbt_tests"
[0m16:14:38.088809 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.089085 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
  
    

  create temporary table "dbt_tests__tmp_20250705151438076601161438082652"
  
  
    as
  
  (
    
        SELECT
        
            
                metadata_hash
            
        
        FROM "podcast_analytics"."public_public"."dbt_tests"
        WHERE 1 = 0
    
  );
  
  
[0m16:14:38.094112 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m16:14:38.105088 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.105355 [debug] [MainThread]: On master: BEGIN
[0m16:14:38.106460 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:14:38.106684 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.106887 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_tests__tmp_20250705151438076601161438082652'
        
      order by ordinal_position

  
[0m16:14:38.112390 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m16:14:38.114375 [debug] [MainThread]: Elementary: Inserting 1 rows to table "dbt_tests__tmp_20250705151438076601161438082652"
[0m16:14:38.132645 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:14:38.133273 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.133481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "dbt_tests__tmp_20250705151438076601161438082652"
         (metadata_hash) values
    ('072cb2745390f986f29a300fd037aa87')
  
[0m16:14:38.134559 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.001 seconds
[0m16:14:38.136544 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.136768 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
  
    

  create temporary table "dbt_tests__tmp_20250705151438135641161438136008"
  
  
    as
  
  (
    
        SELECT
        
            *
        
        FROM "podcast_analytics"."public_public"."dbt_tests"
        WHERE 1 = 0
    
  );
  
  
[0m16:14:38.137982 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m16:14:38.140668 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.140898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_tests__tmp_20250705151438135641161438136008'
        
      order by ordinal_position

  
[0m16:14:38.143530 [debug] [MainThread]: SQL status: SELECT 28 in 0.002 seconds
[0m16:14:38.144951 [debug] [MainThread]: Elementary: Inserting 2 rows to table "dbt_tests__tmp_20250705151438135641161438136008"
[0m16:14:38.161257 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:14:38.161808 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.162061 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "dbt_tests__tmp_20250705151438135641161438136008"
         (unique_id,database_name,schema_name,name,short_name,alias,test_column_name,severity,warn_if,error_if,test_params,test_namespace,test_original_name,tags,model_tags,model_owners,meta,depends_on_macros,depends_on_nodes,parent_model_unique_id,description,package_name,type,original_path,path,generated_at,metadata_hash,quality_dimension) values
    ('test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471','podcast_analytics','public','not_null_fact_user_events_Event_Timestamp','not_null','not_null_fact_user_events_Event_Timestamp','Event Timestamp','ERROR','!= 0','!= 0','{"column_name": "Event Timestamp", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}',NULL,'not_null','[]','[]','[]','{}','["macro.dbt.test_not_null"]','["model.podcast_analytics.fact_user_events"]','model.podcast_analytics.fact_user_events','This test validates that there are no `null` values present in a column.','podcast_analytics','generic','models/schema.yml','not_null_fact_user_events_Event_Timestamp.sql','2025-07-05 15:14:38','28ffa300e5ca9ef500945cdaab7ab687','completeness'),('test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf','podcast_analytics','public','dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01','accepted_range','dbt_utils_accepted_range_fact__7e46db9cbf1d0f562d9cdf6b5fb8aab9','Event Timestamp','ERROR','!= 0','!= 0','{"min_value": "2025-03-01", "inclusive": true, "column_name": "Event Timestamp", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','dbt_utils','accepted_range','[]','[]','[]','{}','["macro.dbt.get_where_subquery", "macro.dbt_utils.test_accepted_range"]','["model.podcast_analytics.fact_user_events"]','model.podcast_analytics.fact_user_events','Asserts that a column''s values fall inside an expected range.','podcast_analytics','generic','models/schema.yml','dbt_utils_accepted_range_fact__7e46db9cbf1d0f562d9cdf6b5fb8aab9.sql','2025-07-05 15:14:38','589ead6273740471e31f68a6f7787009','validity')
  
[0m16:14:38.163298 [debug] [MainThread]: SQL status: INSERT 0 2 in 0.001 seconds
[0m16:14:38.166594 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.166845 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
        begin transaction;
        
            delete from "podcast_analytics"."public_public"."dbt_tests"
            where
            metadata_hash is null
            or metadata_hash in (select metadata_hash from "dbt_tests__tmp_20250705151438076601161438082652");
        
        
            insert into "podcast_analytics"."public_public"."dbt_tests" select * from "dbt_tests__tmp_20250705151438135641161438136008";
        
        commit;
    
  
[0m16:14:38.168820 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:14:38.173408 [debug] [MainThread]: Applying DROP to: "dbt_tests__tmp_20250705151438076601161438082652"
[0m16:14:38.175605 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.175834 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
drop table if exists "dbt_tests__tmp_20250705151438076601161438082652" cascade
[0m16:14:38.177760 [debug] [MainThread]: SQL status: DROP TABLE in 0.002 seconds
[0m16:14:38.180135 [debug] [MainThread]: Applying DROP to: "dbt_tests__tmp_20250705151438135641161438136008"
[0m16:14:38.180547 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.180735 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
drop table if exists "dbt_tests__tmp_20250705151438135641161438136008" cascade
[0m16:14:38.181866 [debug] [MainThread]: SQL status: DROP TABLE in 0.001 seconds
[0m16:14:38.182464 [debug] [MainThread]: Elementary: Finished deleting from and inserting to: "podcast_analytics"."public_public"."dbt_tests"
[0m16:14:38.183185 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:
[0m16:14:38.184324 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00.029891 (1 runs)
[0m16:14:38.184702 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.get_columns_in_relation: 0:00:00.019104 (2 runs)
[0m16:14:38.185076 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.000402 (2 runs)
[0m16:14:38.185445 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.023087 (3 runs)
[0m16:14:38.185805 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.get_insert_rows_queries: 0:00:00.027204 (2 runs)
[0m16:14:38.186218 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.run_insert_rows_query: 0:00:00.004485 (2 runs)
[0m16:14:38.186573 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows: 0:00:00.059872 (2 runs)
[0m16:14:38.186935 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.145857 (1 runs)
[0m16:14:38.189398 [debug] [MainThread]: Elementary: [dbt_sources] Flattening the artifacts.
[0m16:14:38.198294 [debug] [MainThread]: Elementary: [dbt_sources] Flattened 3 artifacts.
[0m16:14:38.199018 [debug] [MainThread]: Elementary: [dbt_sources] Comparing the artifacts state.
[0m16:14:38.199412 [debug] [MainThread]: Elementary: [dbt_sources] Artifacts did not change.
[0m16:14:38.200086 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:
[0m16:14:38.200474 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.008312 (1 runs)
[0m16:14:38.200840 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.010666 (1 runs)
[0m16:14:38.203209 [debug] [MainThread]: Elementary: [dbt_snapshots] Flattening the artifacts.
[0m16:14:38.203919 [debug] [MainThread]: Elementary: [dbt_snapshots] Flattened 0 artifacts.
[0m16:14:38.204608 [debug] [MainThread]: Elementary: [dbt_snapshots] Comparing the artifacts state.
[0m16:14:38.204975 [debug] [MainThread]: Elementary: [dbt_snapshots] Artifacts did not change.
[0m16:14:38.205511 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:
[0m16:14:38.205915 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00.000226 (1 runs)
[0m16:14:38.206263 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.002289 (1 runs)
[0m16:14:38.208510 [debug] [MainThread]: Elementary: [dbt_metrics] Flattening the artifacts.
[0m16:14:38.209196 [debug] [MainThread]: Elementary: [dbt_metrics] Flattened 0 artifacts.
[0m16:14:38.209835 [debug] [MainThread]: Elementary: [dbt_metrics] Comparing the artifacts state.
[0m16:14:38.210247 [debug] [MainThread]: Elementary: [dbt_metrics] Artifacts did not change.
[0m16:14:38.210778 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:
[0m16:14:38.211136 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00.000148 (1 runs)
[0m16:14:38.211647 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.002254 (1 runs)
[0m16:14:38.213890 [debug] [MainThread]: Elementary: [dbt_exposures] Flattening the artifacts.
[0m16:14:38.214564 [debug] [MainThread]: Elementary: [dbt_exposures] Flattened 0 artifacts.
[0m16:14:38.215190 [debug] [MainThread]: Elementary: [dbt_exposures] Comparing the artifacts state.
[0m16:14:38.215595 [debug] [MainThread]: Elementary: [dbt_exposures] Artifacts did not change.
[0m16:14:38.216152 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:
[0m16:14:38.216518 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00.000204 (1 runs)
[0m16:14:38.216914 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.002225 (1 runs)
[0m16:14:38.219163 [debug] [MainThread]: Elementary: [dbt_seeds] Flattening the artifacts.
[0m16:14:38.226394 [debug] [MainThread]: Elementary: [dbt_seeds] Flattened 2 artifacts.
[0m16:14:38.227096 [debug] [MainThread]: Elementary: [dbt_seeds] Comparing the artifacts state.
[0m16:14:38.227532 [debug] [MainThread]: Elementary: [dbt_seeds] Artifacts did not change.
[0m16:14:38.228076 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:
[0m16:14:38.228440 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00.006682 (1 runs)
[0m16:14:38.228826 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.008903 (1 runs)
[0m16:14:38.231301 [debug] [MainThread]: Elementary: [dbt_columns] Flattening the artifacts.
[0m16:14:38.312115 [debug] [MainThread]: Elementary: [dbt_columns] Flattened 104 artifacts.
[0m16:14:38.312889 [debug] [MainThread]: Elementary: [dbt_columns] Comparing the artifacts state.
[0m16:14:38.313440 [debug] [MainThread]: Elementary: [dbt_columns] Artifacts changed.
[0m16:14:38.315899 [debug] [MainThread]: Elementary: Deleting from and inserting to: "podcast_analytics"."public_public"."dbt_columns"
[0m16:14:38.317193 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.317404 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
  
    

  create temporary table "dbt_columns__tmp_20250705151438316289161438316580"
  
  
    as
  
  (
    
        SELECT
        
            
                metadata_hash
            
        
        FROM "podcast_analytics"."public_public"."dbt_columns"
        WHERE 1 = 0
    
  );
  
  
[0m16:14:38.323585 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m16:14:38.326385 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.326611 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_columns__tmp_20250705151438316289161438316580'
        
      order by ordinal_position

  
[0m16:14:38.333647 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m16:14:38.334539 [debug] [MainThread]: Elementary: Inserting 1 rows to table "dbt_columns__tmp_20250705151438316289161438316580"
[0m16:14:38.336317 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:14:38.336850 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.337054 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "dbt_columns__tmp_20250705151438316289161438316580"
         (metadata_hash) values
    ('0683a836f1d8784325200fea1ef96476')
  
[0m16:14:38.338759 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.002 seconds
[0m16:14:38.341026 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.341241 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
  
    

  create temporary table "dbt_columns__tmp_20250705151438339761161438340054"
  
  
    as
  
  (
    
        SELECT
        
            *
        
        FROM "podcast_analytics"."public_public"."dbt_columns"
        WHERE 1 = 0
    
  );
  
  
[0m16:14:38.346652 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m16:14:38.349385 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.349617 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_columns__tmp_20250705151438339761161438340054'
        
      order by ordinal_position

  
[0m16:14:38.357536 [debug] [MainThread]: SQL status: SELECT 13 in 0.008 seconds
[0m16:14:38.358595 [debug] [MainThread]: Elementary: Inserting 1 rows to table "dbt_columns__tmp_20250705151438339761161438340054"
[0m16:14:38.363724 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:14:38.364227 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.364446 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "dbt_columns__tmp_20250705151438339761161438340054"
         (unique_id,parent_unique_id,name,data_type,tags,meta,database_name,schema_name,table_name,description,resource_type,generated_at,metadata_hash) values
    ('column.model.podcast_analytics.fact_user_events.Event Timestamp','model.podcast_analytics.fact_user_events','Event Timestamp',NULL,'[]','{}','podcast_analytics','public','fact_user_events','Timestamp of the event','model','2025-07-05 15:14:38','6455ab792f1e7b1df027f6a345626331')
  
[0m16:14:38.366644 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.002 seconds
[0m16:14:38.367961 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.368185 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
        begin transaction;
        
            delete from "podcast_analytics"."public_public"."dbt_columns"
            where
            metadata_hash is null
            or metadata_hash in (select metadata_hash from "dbt_columns__tmp_20250705151438316289161438316580");
        
        
            insert into "podcast_analytics"."public_public"."dbt_columns" select * from "dbt_columns__tmp_20250705151438339761161438340054";
        
        commit;
    
  
[0m16:14:38.372009 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m16:14:38.374873 [debug] [MainThread]: Applying DROP to: "dbt_columns__tmp_20250705151438316289161438316580"
[0m16:14:38.375312 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.375518 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
drop table if exists "dbt_columns__tmp_20250705151438316289161438316580" cascade
[0m16:14:38.378339 [debug] [MainThread]: SQL status: DROP TABLE in 0.003 seconds
[0m16:14:38.380640 [debug] [MainThread]: Applying DROP to: "dbt_columns__tmp_20250705151438339761161438340054"
[0m16:14:38.381062 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.381262 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
drop table if exists "dbt_columns__tmp_20250705151438339761161438340054" cascade
[0m16:14:38.384276 [debug] [MainThread]: SQL status: DROP TABLE in 0.003 seconds
[0m16:14:38.384781 [debug] [MainThread]: Elementary: Finished deleting from and inserting to: "podcast_analytics"."public_public"."dbt_columns"
[0m16:14:38.385494 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:
[0m16:14:38.385895 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:00.080200 (1 runs)
[0m16:14:38.386336 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].insert_rows.get_columns_in_relation: 0:00:00.020773 (2 runs)
[0m16:14:38.386727 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.000379 (2 runs)
[0m16:14:38.387111 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.004246 (2 runs)
[0m16:14:38.387494 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].insert_rows.get_insert_rows_queries: 0:00:00.005644 (2 runs)
[0m16:14:38.387876 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].insert_rows.run_insert_rows_query: 0:00:00.006046 (2 runs)
[0m16:14:38.388300 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].insert_rows: 0:00:00.035245 (2 runs)
[0m16:14:38.388676 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:00.154081 (1 runs)
[0m16:14:38.389095 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m16:14:38.391493 [debug] [MainThread]: Elementary: Uploading run results.
[0m16:14:38.392021 [debug] [MainThread]: Elementary: [dbt_run_results] Flattening the artifacts.
[0m16:14:38.412539 [debug] [MainThread]: Elementary: [dbt_run_results] Flattened 24 artifacts.
[0m16:14:38.414948 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.415162 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_run_results'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:14:38.422284 [debug] [MainThread]: SQL status: SELECT 22 in 0.007 seconds
[0m16:14:38.423405 [debug] [MainThread]: Elementary: Inserting 24 rows to table "podcast_analytics"."public_public"."dbt_run_results"
[0m16:14:38.568561 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:14:38.569119 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.569880 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."dbt_run_results"
         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values
    ('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'accepted_values_stg_user_events_event_type__play__pause__seek__complete',NULL,'pass','test',0.25653696060180664,'2025-07-05T15:14:37.271884Z','2025-07-05T15:14:37.466041Z','2025-07-05T15:14:37.222667Z','2025-07-05T15:14:37.269255Z',1,False,'
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue',NULL,'pass','test',0.25681281089782715,'2025-07-05T15:14:37.269594Z','2025-07-05T15:14:37.463352Z','2025-07-05T15:14:37.225826Z','2025-07-05T15:14:37.268975Z',1,False,'
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    ''missing_event_type'',''invalid_event_type'',''missing_timestamp'',''malformed_timestamp'',''missing_user_id'',''missing_episode_id'',''other_issue''
)


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'accepted_values_fact_user_events__Event_Type___play__pause__seek__complete',NULL,'pass','test',0.2583627700805664,'2025-07-05T15:14:37.276136Z','2025-07-05T15:14:37.460601Z','2025-07-05T15:14:37.213506Z','2025-07-05T15:14:37.273704Z',1,False,'
    
    

with all_values as (

    select
        "Event Type" as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by "Event Type"

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf','test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01','Database Error in test dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01 (models/schema.yml)
  syntax error at or near "Timestamp"
  LINE 24:     or not Event Timestamp >= 2025-03-01
                            ^
  compiled code at target/run/podcast_analytics/models/schema.yml/dbt_utils_accepted_range_fact__7e46db9cbf1d0f562d9cdf6b5fb8aab9.sql','error','test',0.25867295265197754,'2025-07-05T15:14:37.274158Z','2025-07-05T15:14:37.432101Z','2025-07-05T15:14:37.230344Z','2025-07-05T15:14:37.271624Z',NULL,False,'

with meet_condition as(
  select *
  from "podcast_analytics"."public"."fact_user_events"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don''t meet the rule.
    or not Event Timestamp >= 2025-03-01
)

select *
from validation_errors

',NULL,NULL,'Thread-4 (worker)','test','{}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'not_null_dim_episodes__Duration_seconds_',NULL,'pass','test',0.07694792747497559,'2025-07-05T15:14:37.497483Z','2025-07-05T15:14:37.540862Z','2025-07-05T15:14:37.476629Z','2025-07-05T15:14:37.493034Z',1,False,'
    
    



select "Duration (seconds)"
from "podcast_analytics"."public"."dim_episodes"
where "Duration (seconds)" is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'not_null_dim_episodes__Podcast_ID_',NULL,'pass','test',0.07794713973999023,'2025-07-05T15:14:37.502622Z','2025-07-05T15:14:37.544429Z','2025-07-05T15:14:37.485483Z','2025-07-05T15:14:37.501825Z',1,False,'
    
    



select "Podcast ID"
from "podcast_analytics"."public"."dim_episodes"
where "Podcast ID" is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'not_null_dim_users__User_ID_',NULL,'pass','test',0.07770395278930664,'2025-07-05T15:14:37.506849Z','2025-07-05T15:14:37.547712Z','2025-07-05T15:14:37.488654Z','2025-07-05T15:14:37.502324Z',1,False,'
    
    



select "User ID"
from "podcast_analytics"."public"."dim_users"
where "User ID" is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'not_null_dim_episodes__Episode_ID_',NULL,'pass','test',0.07931685447692871,'2025-07-05T15:14:37.493318Z','2025-07-05T15:14:37.551091Z','2025-07-05T15:14:37.482088Z','2025-07-05T15:14:37.492804Z',1,False,'
    
    



select "Episode ID"
from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471','test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'not_null_fact_user_events_Event_Timestamp','Database Error in test not_null_fact_user_events_Event_Timestamp (models/schema.yml)
  syntax error at or near "Timestamp"
  LINE 18: where Event Timestamp is null
                       ^
  compiled code at target/run/podcast_analytics/models/schema.yml/not_null_fact_user_events_Event_Timestamp.sql','error','test',0.11139488220214844,'2025-07-05T15:14:37.573308Z','2025-07-05T15:14:37.665373Z','2025-07-05T15:14:37.557777Z','2025-07-05T15:14:37.572630Z',NULL,False,'
    
    



select Event Timestamp
from "podcast_analytics"."public"."fact_user_events"
where Event Timestamp is null


',NULL,NULL,'Thread-2 (worker)','test','{}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'not_null_fact_user_events__Event_ID_',NULL,'pass','test',0.11910414695739746,'2025-07-05T15:14:37.578490Z','2025-07-05T15:14:37.674005Z','2025-07-05T15:14:37.565844Z','2025-07-05T15:14:37.577846Z',1,False,'
    
    



select "Event ID"
from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'not_null_fact_user_events__User_ID_',NULL,'pass','test',0.11937904357910156,'2025-07-05T15:14:37.625168Z','2025-07-05T15:14:37.677208Z','2025-07-05T15:14:37.569311Z','2025-07-05T15:14:37.582411Z',1,False,'
    
    



select "User ID"
from "podcast_analytics"."public"."fact_user_events"
where "User ID" is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'not_null_fact_user_events__Episode_ID_',NULL,'pass','test',0.12389302253723145,'2025-07-05T15:14:37.582743Z','2025-07-05T15:14:37.670657Z','2025-07-05T15:14:37.562669Z','2025-07-05T15:14:37.578166Z',1,False,'
    
    



select "Episode ID"
from "podcast_analytics"."public"."fact_user_events"
where "Episode ID" is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'not_null_stg_episodes_episode_id',NULL,'pass','test',0.051802873611450195,'2025-07-05T15:14:37.688233Z','2025-07-05T15:14:37.729273Z','2025-07-05T15:14:37.681303Z','2025-07-05T15:14:37.687218Z',1,False,'
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'not_null_stg_episodes_podcast_id',NULL,'pass','test',0.06274986267089844,'2025-07-05T15:14:37.715736Z','2025-07-05T15:14:37.750793Z','2025-07-05T15:14:37.695048Z','2025-07-05T15:14:37.706874Z',1,False,'
    
    



select podcast_id
from "podcast_analytics"."public"."stg_episodes"
where podcast_id is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'not_null_stg_user_events_episode_id',NULL,'pass','test',0.0639951229095459,'2025-07-05T15:14:37.707153Z','2025-07-05T15:14:37.755275Z','2025-07-05T15:14:37.698312Z','2025-07-05T15:14:37.706316Z',1,False,'
    
    



select episode_id
from "podcast_analytics"."public"."stg_user_events"
where episode_id is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'not_null_stg_user_events_event_id',NULL,'pass','test',0.08288407325744629,'2025-07-05T15:14:37.711455Z','2025-07-05T15:14:37.767424Z','2025-07-05T15:14:37.701475Z','2025-07-05T15:14:37.706587Z',1,False,'
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'not_null_stg_user_events_event_ts',NULL,'pass','test',0.07572603225708008,'2025-07-05T15:14:37.738567Z','2025-07-05T15:14:37.807079Z','2025-07-05T15:14:37.733058Z','2025-07-05T15:14:37.738249Z',1,False,'
    
    



select event_ts
from "podcast_analytics"."public"."stg_user_events"
where event_ts is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'not_null_stg_user_events_user_id',NULL,'pass','test',0.07040882110595703,'2025-07-05T15:14:37.771627Z','2025-07-05T15:14:37.825871Z','2025-07-05T15:14:37.759473Z','2025-07-05T15:14:37.767741Z',1,False,'
    
    



select user_id
from "podcast_analytics"."public"."stg_user_events"
where user_id is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'not_null_stg_users_user_id',NULL,'pass','test',0.08554792404174805,'2025-07-05T15:14:37.778238Z','2025-07-05T15:14:37.838661Z','2025-07-05T15:14:37.768190Z','2025-07-05T15:14:37.777508Z',1,False,'
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_',NULL,'pass','test',0.06616592407226562,'2025-07-05T15:14:37.791307Z','2025-07-05T15:14:37.842681Z','2025-07-05T15:14:37.784764Z','2025-07-05T15:14:37.791056Z',1,False,'
    
    

with child as (
    select "Episode ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "Episode ID" is not null
),

parent as (
    select "Episode ID" as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'relationships_fact_user_events__User_ID____User_ID___ref_dim_users_',NULL,'pass','test',0.06286406517028809,'2025-07-05T15:14:37.816293Z','2025-07-05T15:14:37.865476Z','2025-07-05T15:14:37.810033Z','2025-07-05T15:14:37.815955Z',1,False,'
    
    

with child as (
    select "User ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "User ID" is not null
),

parent as (
    select "User ID" as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'unique_dim_episodes__Episode_ID_',NULL,'pass','test',0.09831809997558594,'2025-07-05T15:14:37.843685Z','2025-07-05T15:14:37.927180Z','2025-07-05T15:14:37.830950Z','2025-07-05T15:14:37.842983Z',1,False,'
    
    

select
    "Episode ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is not null
group by "Episode ID"
having count(*) > 1


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'unique_dim_users__User_ID_',NULL,'pass','test',0.09493708610534668,'2025-07-05T15:14:37.866447Z','2025-07-05T15:14:37.944374Z','2025-07-05T15:14:37.854505Z','2025-07-05T15:14:37.866114Z',1,False,'
    
    

select
    "User ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where "User ID" is not null
group by "User ID"
having count(*) > 1


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','205749d8-b89c-4373-9928-e878a4a274e0','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'unique_fact_user_events__Event_ID_',NULL,'pass','test',0.09574294090270996,'2025-07-05T15:14:37.872779Z','2025-07-05T15:14:37.947492Z','2025-07-05T15:14:37.858586Z','2025-07-05T15:14:37.871729Z',1,False,'
    
    

select
    "Event ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is not null
group by "Event ID"
having count(*) > 1


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}')
  
[0m16:14:38.580723 [debug] [MainThread]: SQL status: INSERT 0 24 in 0.010 seconds
[0m16:14:38.581616 [debug] [MainThread]: On master: COMMIT
[0m16:14:38.581831 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.582026 [debug] [MainThread]: On master: COMMIT
[0m16:14:38.583703 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:14:38.584755 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:
[0m16:14:38.585159 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.019907 (1 runs)
[0m16:14:38.585539 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.010029 (1 runs)
[0m16:14:38.585976 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.000217 (1 runs)
[0m16:14:38.586359 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.140957 (24 runs)
[0m16:14:38.586731 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.144173 (1 runs)
[0m16:14:38.587099 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.012462 (1 runs)
[0m16:14:38.587468 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.commit: 0:00:00.002474 (1 runs)
[0m16:14:38.587882 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:00.171071 (1 runs)
[0m16:14:38.588246 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:00.192614 (1 runs)
[0m16:14:38.588623 [debug] [MainThread]: Elementary: Uploaded run results successfully.
[0m16:14:38.593326 [debug] [MainThread]: Elementary: Handling test results.
[0m16:14:38.613075 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.613312 [debug] [MainThread]: On master: BEGIN
[0m16:14:38.615448 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:14:38.615631 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.615819 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'elementary_test_results'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:14:38.625196 [debug] [MainThread]: SQL status: SELECT 28 in 0.009 seconds
[0m16:14:38.626501 [debug] [MainThread]: Elementary: Inserting 24 rows to table "podcast_analytics"."public_public"."elementary_test_results"
[0m16:14:38.813587 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:14:38.814312 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.815262 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."elementary_test_results"
         (id,data_issue_id,test_execution_id,test_unique_id,model_unique_id,invocation_id,detected_at,created_at,database_name,schema_name,table_name,column_name,test_type,test_sub_type,test_results_description,owners,tags,test_results_query,other,test_name,test_params,severity,status,failures,test_short_name,test_alias,result_rows,failed_row_count) values
    ('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','model.podcast_analytics.stg_user_events','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','event_type','dbt_test','generic',NULL,'[]','[]','
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',NULL,'accepted_values_stg_user_events_event_type__play__pause__seek__complete','{"values": ["play", "pause", "seek", "complete"], "column_name": "event_type", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'accepted_values','accepted_values_stg_user_event_94634d24690dcf7d4e511df98c6e0582',NULL,NULL),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','model.podcast_analytics.stg_user_events_invalid','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events_invalid','issue_type','dbt_test','generic',NULL,'[]','[]','
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    ''missing_event_type'',''invalid_event_type'',''missing_timestamp'',''malformed_timestamp'',''missing_user_id'',''missing_episode_id'',''other_issue''
)


',NULL,'accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue','{"values": ["missing_event_type", "invalid_event_type", "missing_timestamp", "malformed_timestamp", "missing_user_id", "missing_episode_id", "other_issue"], "column_name": "issue_type", "model": "{{ get_where_subquery(ref(''stg_user_events_invalid'')) }}"}','ERROR','pass',0,'accepted_values','accepted_values_stg_user_event_43bb633c97e04e462eb7fee334f302ba',NULL,NULL),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','model.podcast_analytics.fact_user_events','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event Type"','dbt_test','generic',NULL,'[]','[]','
    
    

with all_values as (

    select
        "Event Type" as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by "Event Type"

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',NULL,'accepted_values_fact_user_events__Event_Type___play__pause__seek__complete','{"values": ["play", "pause", "seek", "complete"], "column_name": "\"Event Type\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'accepted_values','accepted_values_fact_user_even_fbc631ab6baad050aa8d81cbe6f1af99',NULL,NULL),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf','test.podcast_analytics.dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01.9ae321adcf','model.podcast_analytics.fact_user_events','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:38' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','Event Timestamp','dbt_test','generic','Database Error in test dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01 (models/schema.yml)
  syntax error at or near "Timestamp"
  LINE 24:     or not Event Timestamp >= 2025-03-01
                            ^
  compiled code at target/run/podcast_analytics/models/schema.yml/dbt_utils_accepted_range_fact__7e46db9cbf1d0f562d9cdf6b5fb8aab9.sql','[]','[]','

with meet_condition as(
  select *
  from "podcast_analytics"."public"."fact_user_events"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don''t meet the rule.
    or not Event Timestamp >= 2025-03-01
)

select *
from validation_errors

',NULL,'dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01','{"min_value": "2025-03-01", "inclusive": true, "column_name": "Event Timestamp", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','error',NULL,'accepted_range','dbt_utils_accepted_range_fact__7e46db9cbf1d0f562d9cdf6b5fb8aab9',NULL,NULL),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','model.podcast_analytics.dim_episodes','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Duration (seconds)"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Duration (seconds)"
from "podcast_analytics"."public"."dim_episodes"
where "Duration (seconds)" is null


',NULL,'not_null_dim_episodes__Duration_seconds_','{"column_name": "\"Duration (seconds)\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_episodes__Duration_seconds_',NULL,0),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','model.podcast_analytics.dim_episodes','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Podcast ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Podcast ID"
from "podcast_analytics"."public"."dim_episodes"
where "Podcast ID" is null


',NULL,'not_null_dim_episodes__Podcast_ID_','{"column_name": "\"Podcast ID\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_episodes__Podcast_ID_',NULL,0),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','model.podcast_analytics.dim_users','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_users','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "User ID"
from "podcast_analytics"."public"."dim_users"
where "User ID" is null


',NULL,'not_null_dim_users__User_ID_','{"column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''dim_users'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_users__User_ID_',NULL,0),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','model.podcast_analytics.dim_episodes','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Episode ID"
from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is null


',NULL,'not_null_dim_episodes__Episode_ID_','{"column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_episodes__Episode_ID_',NULL,0),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471','test.podcast_analytics.not_null_fact_user_events_Event_Timestamp.aa35f8a471','model.podcast_analytics.fact_user_events','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:38' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','Event Timestamp','dbt_test','generic','Database Error in test not_null_fact_user_events_Event_Timestamp (models/schema.yml)
  syntax error at or near "Timestamp"
  LINE 18: where Event Timestamp is null
                       ^
  compiled code at target/run/podcast_analytics/models/schema.yml/not_null_fact_user_events_Event_Timestamp.sql','[]','[]','
    
    



select Event Timestamp
from "podcast_analytics"."public"."fact_user_events"
where Event Timestamp is null


',NULL,'not_null_fact_user_events_Event_Timestamp','{"column_name": "Event Timestamp", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','error',NULL,'not_null','not_null_fact_user_events_Event_Timestamp',NULL,NULL),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','model.podcast_analytics.fact_user_events','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Event ID"
from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is null


',NULL,'not_null_fact_user_events__Event_ID_','{"column_name": "\"Event ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__Event_ID_',NULL,0),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','model.podcast_analytics.fact_user_events','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "User ID"
from "podcast_analytics"."public"."fact_user_events"
where "User ID" is null


',NULL,'not_null_fact_user_events__User_ID_','{"column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__User_ID_',NULL,0),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','model.podcast_analytics.fact_user_events','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Episode ID"
from "podcast_analytics"."public"."fact_user_events"
where "Episode ID" is null


',NULL,'not_null_fact_user_events__Episode_ID_','{"column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__Episode_ID_',NULL,0),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','model.podcast_analytics.stg_episodes','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_episodes','episode_id','dbt_test','generic',NULL,'[]','[]','
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null


',NULL,'not_null_stg_episodes_episode_id','{"column_name": "episode_id", "model": "{{ get_where_subquery(ref(''stg_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_episodes_episode_id',NULL,0),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','model.podcast_analytics.stg_episodes','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_episodes','podcast_id','dbt_test','generic',NULL,'[]','[]','
    
    



select podcast_id
from "podcast_analytics"."public"."stg_episodes"
where podcast_id is null


',NULL,'not_null_stg_episodes_podcast_id','{"column_name": "podcast_id", "model": "{{ get_where_subquery(ref(''stg_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_episodes_podcast_id',NULL,0),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','model.podcast_analytics.stg_user_events','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','episode_id','dbt_test','generic',NULL,'[]','[]','
    
    



select episode_id
from "podcast_analytics"."public"."stg_user_events"
where episode_id is null


',NULL,'not_null_stg_user_events_episode_id','{"column_name": "episode_id", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_episode_id',NULL,0),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','model.podcast_analytics.stg_user_events','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','event_id','dbt_test','generic',NULL,'[]','[]','
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null


',NULL,'not_null_stg_user_events_event_id','{"column_name": "event_id", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_event_id',NULL,0),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','model.podcast_analytics.stg_user_events','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','event_ts','dbt_test','generic',NULL,'[]','[]','
    
    



select event_ts
from "podcast_analytics"."public"."stg_user_events"
where event_ts is null


',NULL,'not_null_stg_user_events_event_ts','{"column_name": "event_ts", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_event_ts',NULL,0),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_user_events_user_id.82058db005',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','model.podcast_analytics.stg_user_events','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','user_id','dbt_test','generic',NULL,'[]','[]','
    
    



select user_id
from "podcast_analytics"."public"."stg_user_events"
where user_id is null


',NULL,'not_null_stg_user_events_user_id','{"column_name": "user_id", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_user_id',NULL,0),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','model.podcast_analytics.stg_users','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_users','user_id','dbt_test','generic',NULL,'[]','[]','
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null


',NULL,'not_null_stg_users_user_id','{"column_name": "user_id", "model": "{{ get_where_subquery(ref(''stg_users'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_users_user_id',NULL,0),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','model.podcast_analytics.fact_user_events','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    

with child as (
    select "Episode ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "Episode ID" is not null
),

parent as (
    select "Episode ID" as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',NULL,'relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_','{"to": "ref(''dim_episodes'')", "field": "\"Episode ID\"", "column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'relationships','relationships_fact_user_events_a5d0f4791bd5f2dd7a1079d5e9d2dc3a',NULL,0),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','model.podcast_analytics.fact_user_events','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    

with child as (
    select "User ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "User ID" is not null
),

parent as (
    select "User ID" as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',NULL,'relationships_fact_user_events__User_ID____User_ID___ref_dim_users_','{"to": "ref(''dim_users'')", "field": "\"User ID\"", "column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'relationships','relationships_fact_user_events_18a41013c7410998f321251d32b88faf',NULL,0),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','model.podcast_analytics.dim_episodes','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    

select
    "Episode ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is not null
group by "Episode ID"
having count(*) > 1


',NULL,'unique_dim_episodes__Episode_ID_','{"column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'unique','unique_dim_episodes__Episode_ID_',NULL,NULL),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','model.podcast_analytics.dim_users','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_users','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    

select
    "User ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where "User ID" is not null
group by "User ID"
having count(*) > 1


',NULL,'unique_dim_users__User_ID_','{"column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''dim_users'')) }}"}','ERROR','pass',0,'unique','unique_dim_users__User_ID_',NULL,NULL),('205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a',NULL,'205749d8-b89c-4373-9928-e878a4a274e0.test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','model.podcast_analytics.fact_user_events','205749d8-b89c-4373-9928-e878a4a274e0',cast('2025-07-05 15:14:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event ID"','dbt_test','generic',NULL,'[]','[]','
    
    

select
    "Event ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is not null
group by "Event ID"
having count(*) > 1


',NULL,'unique_fact_user_events__Event_ID_','{"column_name": "\"Event ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'unique','unique_fact_user_events__Event_ID_',NULL,NULL)
  
[0m16:14:38.823505 [debug] [MainThread]: SQL status: INSERT 0 24 in 0.007 seconds
[0m16:14:38.824468 [debug] [MainThread]: On master: COMMIT
[0m16:14:38.824681 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.824868 [debug] [MainThread]: On master: COMMIT
[0m16:14:38.828147 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m16:14:38.828862 [debug] [MainThread]: Elementary: Handled test results successfully.
[0m16:14:38.836803 [debug] [MainThread]: Elementary: Uploading dbt invocation.
[0m16:14:38.865635 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.865886 [debug] [MainThread]: On master: BEGIN
[0m16:14:38.868052 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:14:38.868233 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.868418 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_invocations'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:14:38.878148 [debug] [MainThread]: SQL status: SELECT 35 in 0.010 seconds
[0m16:14:38.879521 [debug] [MainThread]: Elementary: Inserting 1 rows to table "podcast_analytics"."public_public"."dbt_invocations"
[0m16:14:38.889888 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:14:38.890365 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.890580 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."dbt_invocations"
         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values
    ('205749d8-b89c-4373-9928-e878a4a274e0',NULL,NULL,NULL,'2025-07-05 15:14:36','2025-07-05 15:14:38','2025-07-05 15:14:38',
    current_timestamp::timestamp
,'test','1.10.3','0.18.2',False,'{}','{}','local','podcast_analytics','public','podcast_analytics',4,'[]',NULL,NULL,'podcast_analytics',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'{"user": "podcast"}')
  
[0m16:14:38.893419 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.003 seconds
[0m16:14:38.894236 [debug] [MainThread]: On master: COMMIT
[0m16:14:38.894433 [debug] [MainThread]: Using postgres connection "master"
[0m16:14:38.894616 [debug] [MainThread]: On master: COMMIT
[0m16:14:38.897345 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m16:14:38.898082 [debug] [MainThread]: Elementary: Uploaded dbt invocation successfully.
[0m16:14:38.901288 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m16:14:38.902118 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]
[0m16:14:38.902415 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-end.0 ........................................ [[32mOK[0m in 0.94s]
[0m16:14:38.902619 [debug] [MainThread]: On master: Close
[0m16:14:38.902849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:38.903001 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a' was properly closed.
[0m16:14:38.903146 [debug] [MainThread]: Connection 'test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24' was properly closed.
[0m16:14:38.903288 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a' was properly closed.
[0m16:14:38.903427 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de' was properly closed.
[0m16:14:38.903635 [info ] [MainThread]: 
[0m16:14:38.903825 [info ] [MainThread]: Finished running 2 project hooks, 24 data tests in 0 hours 0 minutes and 1.90 seconds (1.90s).
[0m16:14:38.905640 [debug] [MainThread]: Command end result
[0m16:14:39.007097 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m16:14:39.008530 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m16:14:39.013003 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m16:14:39.013238 [info ] [MainThread]: 
[0m16:14:39.013465 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:14:39.013651 [info ] [MainThread]: 
[0m16:14:39.013870 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01 (models/schema.yml)[0m
[0m16:14:39.014087 [error] [MainThread]:   Database Error in test dbt_utils_accepted_range_fact_user_events_Event_Timestamp__True__2025_03_01 (models/schema.yml)
  syntax error at or near "Timestamp"
  LINE 24:     or not Event Timestamp >= 2025-03-01
                            ^
  compiled code at target/run/podcast_analytics/models/schema.yml/dbt_utils_accepted_range_fact__7e46db9cbf1d0f562d9cdf6b5fb8aab9.sql
[0m16:14:39.014258 [info ] [MainThread]: 
[0m16:14:39.014453 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/schema.yml/dbt_utils_accepted_range_fact__7e46db9cbf1d0f562d9cdf6b5fb8aab9.sql
[0m16:14:39.014620 [info ] [MainThread]: 
[0m16:14:39.014812 [error] [MainThread]: [31mFailure in test not_null_fact_user_events_Event_Timestamp (models/schema.yml)[0m
[0m16:14:39.015008 [error] [MainThread]:   Database Error in test not_null_fact_user_events_Event_Timestamp (models/schema.yml)
  syntax error at or near "Timestamp"
  LINE 18: where Event Timestamp is null
                       ^
  compiled code at target/run/podcast_analytics/models/schema.yml/not_null_fact_user_events_Event_Timestamp.sql
[0m16:14:39.015168 [info ] [MainThread]: 
[0m16:14:39.015353 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/schema.yml/not_null_fact_user_events_Event_Timestamp.sql
[0m16:14:39.015528 [info ] [MainThread]: 
[0m16:14:39.015704 [info ] [MainThread]: Done. PASS=24 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=26
[0m16:14:39.016037 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageMaterializationOverrideDeprecation: 24 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:14:39.018174 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.6184983, "process_in_blocks": "0", "process_kernel_time": 0.242068, "process_mem_max_rss": "140738560", "process_out_blocks": "0", "process_user_time": 2.807393}
[0m16:14:39.018421 [debug] [MainThread]: Command `dbt test` failed at 16:14:39.018376 after 2.62 seconds
[0m16:14:39.018703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10639f490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113727fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137273d0>]}
[0m16:14:39.018995 [debug] [MainThread]: Flushing usage events
[0m16:14:39.361855 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:15:42.830279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10673bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10673b820>]}


============================== 16:15:42.833181 | 58c055a9-b314-430f-92a8-985c4fdcaf83 ==============================
[0m16:15:42.833181 [info ] [MainThread]: Running with dbt=1.10.3
[0m16:15:42.833533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/samydoreau/global-assignment', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --profiles-dir /Users/samydoreau/global-assignment', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:15:42.956256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58c055a9-b314-430f-92a8-985c4fdcaf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5c850>]}
[0m16:15:42.987618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58c055a9-b314-430f-92a8-985c4fdcaf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106739c00>]}
[0m16:15:42.988289 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:15:43.059145 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m16:15:43.256540 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:15:43.257269 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/schema.yml
[0m16:15:43.522316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58c055a9-b314-430f-92a8-985c4fdcaf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187844f0>]}
[0m16:15:43.654097 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m16:15:43.656185 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m16:15:43.675027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58c055a9-b314-430f-92a8-985c4fdcaf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11876f8b0>]}
[0m16:15:43.675381 [info ] [MainThread]: Found 39 models, 2 seeds, 2 operations, 24 data tests, 3 sources, 1248 macros
[0m16:15:43.675595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58c055a9-b314-430f-92a8-985c4fdcaf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11876cee0>]}
[0m16:15:43.677186 [info ] [MainThread]: 
[0m16:15:43.677386 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m16:15:43.677554 [info ] [MainThread]: 
[0m16:15:43.677835 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:15:43.681383 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public_public'
[0m16:15:43.681735 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m16:15:43.715021 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public_public"
[0m16:15:43.715284 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m16:15:43.715520 [debug] [ThreadPool]: On list_podcast_analytics_public_public: BEGIN
[0m16:15:43.715710 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m16:15:43.715881 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:43.716054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:43.771059 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m16:15:43.771385 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m16:15:43.771601 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:15:43.773261 [debug] [ThreadPool]: SQL status: BEGIN in 0.057 seconds
[0m16:15:43.773579 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public_public"
[0m16:15:43.773805 [debug] [ThreadPool]: On list_podcast_analytics_public_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m16:15:43.777905 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.006 seconds
[0m16:15:43.778950 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m16:15:43.779206 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.005 seconds
[0m16:15:43.780103 [debug] [ThreadPool]: On list_podcast_analytics_public_public: ROLLBACK
[0m16:15:43.780318 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m16:15:43.782192 [debug] [ThreadPool]: On list_podcast_analytics_public_public: Close
[0m16:15:43.788948 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:43.789219 [debug] [MainThread]: On master: BEGIN
[0m16:15:43.789394 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:43.803912 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m16:15:43.804247 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:43.804515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:15:43.825333 [debug] [MainThread]: SQL status: SELECT 55 in 0.021 seconds
[0m16:15:43.829746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58c055a9-b314-430f-92a8-985c4fdcaf83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11876e800>]}
[0m16:15:43.830094 [debug] [MainThread]: On master: ROLLBACK
[0m16:15:43.830945 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:43.831223 [debug] [MainThread]: On master: BEGIN
[0m16:15:43.832508 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:15:43.832719 [debug] [MainThread]: On master: COMMIT
[0m16:15:43.832906 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:43.833089 [debug] [MainThread]: On master: COMMIT
[0m16:15:43.833731 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:15:43.854961 [debug] [MainThread]: Elementary: Materialization override is enabled.
[0m16:15:43.872330 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:43.872626 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    select count(*) from pg_namespace where nspname = 'public_public__tests'
  
[0m16:15:43.873974 [debug] [MainThread]: SQL status: SELECT 1 in 0.001 seconds
[0m16:15:43.875390 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m16:15:43.878187 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]
[0m16:15:43.878520 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-start.0 ...................................... [[32mOK[0m in 0.04s]
[0m16:15:43.878714 [info ] [MainThread]: 
[0m16:15:43.878912 [debug] [MainThread]: On master: Close
[0m16:15:43.881016 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:15:43.881249 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:15:43.881504 [info ] [Thread-1 (]: 1 of 24 START test accepted_values_fact_user_events__Event_Type___play__pause__seek__complete  [RUN]
[0m16:15:43.881765 [debug] [Thread-3 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:15:43.881991 [info ] [Thread-2 (]: 2 of 24 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m16:15:43.882240 [debug] [Thread-4 (]: Began running node test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075
[0m16:15:43.882464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public_public, now test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8)
[0m16:15:43.882694 [info ] [Thread-3 (]: 3 of 24 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [RUN]
[0m16:15:43.882948 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m16:15:43.883167 [info ] [Thread-4 (]: 4 of 24 START test dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01  [RUN]
[0m16:15:43.883445 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:15:43.883849 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7'
[0m16:15:43.884084 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:15:43.884491 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075'
[0m16:15:43.887973 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:15:43.888325 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:15:43.892170 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:15:43.892535 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075
[0m16:15:43.898123 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:15:43.901782 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075"
[0m16:15:43.902109 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:15:43.904659 [warn ] [Thread-1 (]: [[33mWARNING[0m]: Installed package 'elementary' is overriding the built-in
materialization 'test'. Overrides of built-in materializations from installed
packages will be deprecated in future versions of dbt. For more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m16:15:43.905012 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:15:43.905271 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075
[0m16:15:43.905450 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '58c055a9-b314-430f-92a8-985c4fdcaf83', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cfaf20>]}
[0m16:15:43.907303 [warn ] [Thread-2 (]: [[33mWARNING[0m]: Installed package 'elementary' is overriding the built-in
materialization 'test'. Overrides of built-in materializations from installed
packages will be deprecated in future versions of dbt. For more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m16:15:43.907561 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:15:43.909301 [warn ] [Thread-4 (]: [[33mWARNING[0m]: Installed package 'elementary' is overriding the built-in
materialization 'test'. Overrides of built-in materializations from installed
packages will be deprecated in future versions of dbt. For more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m16:15:43.922431 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '58c055a9-b314-430f-92a8-985c4fdcaf83', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118cc3b20>]}
[0m16:15:43.975363 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '58c055a9-b314-430f-92a8-985c4fdcaf83', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118dcac20>]}
[0m16:15:44.017914 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:15:44.020101 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:15:44.021878 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:15:44.024359 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075"
[0m16:15:44.024996 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:15:44.025302 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:15:44.025512 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m16:15:44.025761 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:15:44.026041 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075"
[0m16:15:44.026229 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: BEGIN
[0m16:15:44.026441 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:44.026651 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: BEGIN
[0m16:15:44.026849 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075: BEGIN
[0m16:15:44.027036 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:44.027546 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:15:44.027748 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:15:44.052941 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m16:15:44.053271 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075"
[0m16:15:44.053519 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "podcast_analytics"."public"."fact_user_events"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not "Event Timestamp" >= 2025-03-01
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m16:15:44.055580 [debug] [Thread-4 (]: Postgres adapter: Postgres error: operator does not exist: timestamp without time zone >= integer
LINE 24:     or not "Event Timestamp" >= 2025-03-01
                                      ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m16:15:44.055926 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075: ROLLBACK
[0m16:15:44.058621 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075: Close
[0m16:15:44.059652 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m16:15:44.059983 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:15:44.060277 [debug] [Thread-3 (]: SQL status: BEGIN in 0.033 seconds
[0m16:15:44.060577 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m16:15:44.060862 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:15:44.061188 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','missing_timestamp','malformed_timestamp','missing_user_id','missing_episode_id','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m16:15:44.062895 [debug] [Thread-1 (]: SQL status: BEGIN in 0.036 seconds
[0m16:15:44.063168 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:15:44.063402 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        "Event Type" as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by "Event Type"

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m16:15:44.065194 [debug] [Thread-4 (]: Database Error in test dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01 (models/schema.yml)
  operator does not exist: timestamp without time zone >= integer
  LINE 24:     or not "Event Timestamp" >= 2025-03-01
                                        ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/podcast_analytics/models/schema.yml/dbt_utils_accepted_range_fact__c4e4d7ba49daef703bc304120079b001.sql
[0m16:15:44.065559 [error] [Thread-4 (]: 4 of 24 ERROR dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01  [[31mERROR[0m in 0.18s]
[0m16:15:44.065925 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075
[0m16:15:44.066169 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:15:44.066444 [debug] [Thread-7 (]: Marking all children of 'test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075' to be skipped because of status 'error'.  Reason: Database Error in test dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01 (models/schema.yml)
  operator does not exist: timestamp without time zone >= integer
  LINE 24:     or not "Event Timestamp" >= 2025-03-01
                                        ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/podcast_analytics/models/schema.yml/dbt_utils_accepted_range_fact__c4e4d7ba49daef703bc304120079b001.sql.
[0m16:15:44.066694 [info ] [Thread-4 (]: 5 of 24 START test not_null_dim_episodes__Duration_seconds_ .................... [RUN]
[0m16:15:44.066984 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:15:44.067352 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075, now test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444)
[0m16:15:44.079953 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.018 seconds
[0m16:15:44.093857 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: ROLLBACK
[0m16:15:44.094151 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.033 seconds
[0m16:15:44.094379 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:15:44.097158 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: ROLLBACK
[0m16:15:44.100147 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m16:15:44.104950 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:15:44.105187 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: Close
[0m16:15:44.105807 [info ] [Thread-1 (]: 1 of 24 PASS accepted_values_fact_user_events__Event_Type___play__pause__seek__complete  [[32mPASS[0m in 0.22s]
[0m16:15:44.106181 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:15:44.106550 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m16:15:44.106810 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:15:44.107208 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: Close
[0m16:15:44.107857 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:15:44.107640 [info ] [Thread-2 (]: 2 of 24 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.22s]
[0m16:15:44.108174 [info ] [Thread-1 (]: 6 of 24 START test not_null_dim_episodes__Episode_ID_ .......................... [RUN]
[0m16:15:44.108563 [info ] [Thread-3 (]: 3 of 24 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [[32mPASS[0m in 0.22s]
[0m16:15:44.113326 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:15:44.113821 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:15:44.114160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8, now test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc)
[0m16:15:44.114483 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:15:44.114785 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:15:44.115064 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:15:44.115306 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:15:44.115533 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:15:44.115780 [info ] [Thread-2 (]: 7 of 24 START test not_null_dim_episodes__Podcast_ID_ .......................... [RUN]
[0m16:15:44.119065 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:15:44.119356 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: BEGIN
[0m16:15:44.119644 [info ] [Thread-3 (]: 8 of 24 START test not_null_dim_users__User_ID_ ................................ [RUN]
[0m16:15:44.119939 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7)
[0m16:15:44.120217 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:15:44.120470 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba)
[0m16:15:44.120699 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:15:44.120886 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:15:44.121162 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:15:44.161555 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:15:44.161893 [debug] [Thread-4 (]: SQL status: BEGIN in 0.042 seconds
[0m16:15:44.166155 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:15:44.169382 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:15:44.169769 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:15:44.170271 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Duration (seconds)"
from "podcast_analytics"."public"."dim_episodes"
where "Duration (seconds)" is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.170587 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:15:44.174496 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:15:44.174850 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:15:44.175115 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:15:44.175436 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: BEGIN
[0m16:15:44.175654 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:15:44.178814 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: ROLLBACK
[0m16:15:44.179068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:44.179291 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:15:44.183414 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:15:44.183883 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: BEGIN
[0m16:15:44.184203 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:44.184492 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: Close
[0m16:15:44.184747 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:15:44.185066 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: BEGIN
[0m16:15:44.185465 [info ] [Thread-4 (]: 5 of 24 PASS not_null_dim_episodes__Duration_seconds_ .......................... [[32mPASS[0m in 0.12s]
[0m16:15:44.185902 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:44.186290 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:15:44.186693 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:15:44.186975 [info ] [Thread-4 (]: 9 of 24 START test not_null_fact_user_events__Episode_ID_ ...................... [RUN]
[0m16:15:44.187381 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444, now test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae)
[0m16:15:44.187636 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:15:44.190985 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:15:44.191769 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:15:44.196998 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:15:44.197786 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:15:44.198053 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: BEGIN
[0m16:15:44.198314 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:15:44.200957 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m16:15:44.201245 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m16:15:44.201582 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:15:44.201859 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m16:15:44.202156 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:15:44.202416 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Episode ID"
from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.202669 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:15:44.202898 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Podcast ID"
from "podcast_analytics"."public"."dim_episodes"
where "Podcast ID" is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.203168 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "User ID"
from "podcast_analytics"."public"."dim_users"
where "User ID" is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.205162 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:15:44.208326 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: ROLLBACK
[0m16:15:44.208579 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:15:44.208812 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:15:44.211784 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: ROLLBACK
[0m16:15:44.212029 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: Close
[0m16:15:44.215616 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: ROLLBACK
[0m16:15:44.215966 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m16:15:44.216591 [info ] [Thread-1 (]: 6 of 24 PASS not_null_dim_episodes__Episode_ID_ ................................ [[32mPASS[0m in 0.10s]
[0m16:15:44.216949 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:15:44.217255 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:15:44.217442 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: Close
[0m16:15:44.217739 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Episode ID"
from "podcast_analytics"."public"."fact_user_events"
where "Episode ID" is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.217986 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: Close
[0m16:15:44.218267 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:15:44.218697 [info ] [Thread-3 (]: 8 of 24 PASS not_null_dim_users__User_ID_ ...................................... [[32mPASS[0m in 0.10s]
[0m16:15:44.219266 [info ] [Thread-2 (]: 7 of 24 PASS not_null_dim_episodes__Podcast_ID_ ................................ [[32mPASS[0m in 0.10s]
[0m16:15:44.219558 [info ] [Thread-1 (]: 10 of 24 START test not_null_fact_user_events__Event_ID_ ....................... [RUN]
[0m16:15:44.219878 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:15:44.220148 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:15:44.220375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc, now test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c)
[0m16:15:44.220610 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd
[0m16:15:44.220926 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:15:44.221224 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:15:44.221468 [info ] [Thread-3 (]: 11 of 24 START test not_null_fact_user_events__Event_Timestamp_ ................ [RUN]
[0m16:15:44.221694 [info ] [Thread-2 (]: 12 of 24 START test not_null_fact_user_events__User_ID_ ........................ [RUN]
[0m16:15:44.225459 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:15:44.225860 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba, now test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd)
[0m16:15:44.226103 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:15:44.226317 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7, now test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2)
[0m16:15:44.226658 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd
[0m16:15:44.230133 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: ROLLBACK
[0m16:15:44.230525 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:15:44.230788 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:15:44.234108 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"
[0m16:15:44.238101 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:15:44.238450 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: Close
[0m16:15:44.242862 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:15:44.243440 [info ] [Thread-4 (]: 9 of 24 PASS not_null_fact_user_events__Episode_ID_ ............................ [[32mPASS[0m in 0.06s]
[0m16:15:44.243758 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd
[0m16:15:44.244108 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:15:44.244422 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:15:44.248956 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"
[0m16:15:44.249355 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:15:44.253662 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:15:44.253989 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:15:44.254365 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: BEGIN
[0m16:15:44.254811 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"
[0m16:15:44.255070 [info ] [Thread-4 (]: 13 of 24 START test not_null_stg_episodes_episode_id ........................... [RUN]
[0m16:15:44.255391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:44.255725 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd: BEGIN
[0m16:15:44.256002 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:15:44.256337 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae, now test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422)
[0m16:15:44.256801 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:44.257083 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: BEGIN
[0m16:15:44.257362 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:15:44.257713 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:44.261122 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:15:44.261793 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:15:44.266634 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:15:44.267209 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:15:44.267428 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m16:15:44.267632 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:15:44.271349 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:15:44.271622 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:15:44.271838 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Event ID"
from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.273849 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m16:15:44.274252 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"
[0m16:15:44.274517 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Event Timestamp"
from "podcast_analytics"."public"."fact_user_events"
where "Event Timestamp" is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.275407 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m16:15:44.275628 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:15:44.275869 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:15:44.276175 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "User ID"
from "podcast_analytics"."public"."fact_user_events"
where "User ID" is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.279438 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: ROLLBACK
[0m16:15:44.279681 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:15:44.283151 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd: ROLLBACK
[0m16:15:44.283511 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: Close
[0m16:15:44.283785 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m16:15:44.283983 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:15:44.284475 [info ] [Thread-1 (]: 10 of 24 PASS not_null_fact_user_events__Event_ID_ ............................. [[32mPASS[0m in 0.06s]
[0m16:15:44.284785 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:15:44.285095 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd: Close
[0m16:15:44.288411 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: ROLLBACK
[0m16:15:44.288871 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:15:44.289150 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.289634 [info ] [Thread-3 (]: 11 of 24 PASS not_null_fact_user_events__Event_Timestamp_ ...................... [[32mPASS[0m in 0.06s]
[0m16:15:44.290070 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:15:44.290604 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd
[0m16:15:44.290892 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: Close
[0m16:15:44.291141 [info ] [Thread-1 (]: 14 of 24 START test not_null_stg_episodes_podcast_id ........................... [RUN]
[0m16:15:44.291439 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:15:44.291881 [info ] [Thread-2 (]: 12 of 24 PASS not_null_fact_user_events__User_ID_ .............................. [[32mPASS[0m in 0.07s]
[0m16:15:44.292191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c, now test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1)
[0m16:15:44.292485 [info ] [Thread-3 (]: 15 of 24 START test not_null_stg_user_events_episode_id ........................ [RUN]
[0m16:15:44.292875 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:15:44.293127 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:15:44.293322 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:15:44.293548 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd, now test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110)
[0m16:15:44.293782 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:15:44.297154 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:15:44.300206 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m16:15:44.300465 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:15:44.300680 [info ] [Thread-2 (]: 16 of 24 START test not_null_stg_user_events_event_id .......................... [RUN]
[0m16:15:44.303833 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:15:44.304166 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m16:15:44.304492 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2, now test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7)
[0m16:15:44.304880 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:15:44.305263 [info ] [Thread-4 (]: 13 of 24 PASS not_null_stg_episodes_episode_id ................................. [[32mPASS[0m in 0.05s]
[0m16:15:44.305521 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:15:44.310479 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:15:44.310760 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:15:44.311156 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:15:44.314512 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:15:44.318990 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:15:44.319320 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:15:44.319633 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:15:44.320102 [info ] [Thread-4 (]: 17 of 24 START test not_null_stg_user_events_event_ts .......................... [RUN]
[0m16:15:44.320511 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:15:44.320804 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: BEGIN
[0m16:15:44.321079 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:15:44.321411 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502)
[0m16:15:44.325774 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:15:44.326074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:44.326327 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: BEGIN
[0m16:15:44.326548 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:15:44.326910 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:44.368536 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:15:44.371331 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:15:44.371678 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m16:15:44.371952 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m16:15:44.372285 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:15:44.372512 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:44.372773 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select podcast_id
from "podcast_analytics"."public"."stg_episodes"
where podcast_id is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.373011 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:15:44.377617 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:15:44.377931 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:15:44.381561 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: ROLLBACK
[0m16:15:44.382048 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:15:44.382355 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: BEGIN
[0m16:15:44.382570 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:15:44.383106 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: Close
[0m16:15:44.383494 [info ] [Thread-1 (]: 14 of 24 PASS not_null_stg_episodes_podcast_id ................................. [[32mPASS[0m in 0.09s]
[0m16:15:44.383820 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:15:44.384048 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:15:44.384259 [info ] [Thread-1 (]: 18 of 24 START test not_null_stg_user_events_user_id ........................... [RUN]
[0m16:15:44.384640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1, now test.podcast_analytics.not_null_stg_user_events_user_id.82058db005)
[0m16:15:44.384862 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:15:44.388448 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:15:44.389708 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:15:44.393914 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:15:44.394281 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m16:15:44.394593 [debug] [Thread-3 (]: SQL status: BEGIN in 0.068 seconds
[0m16:15:44.394959 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:15:44.395221 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:15:44.395592 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.395944 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_user_events"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.396269 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:15:44.396580 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: BEGIN
[0m16:15:44.396778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:44.398219 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m16:15:44.398641 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:15:44.398894 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_ts
from "podcast_analytics"."public"."stg_user_events"
where event_ts is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.403662 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:15:44.407218 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: ROLLBACK
[0m16:15:44.408843 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: Close
[0m16:15:44.409412 [info ] [Thread-3 (]: 15 of 24 PASS not_null_stg_user_events_episode_id .............................. [[32mPASS[0m in 0.12s]
[0m16:15:44.410510 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:15:44.411367 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:15:44.413689 [info ] [Thread-3 (]: 19 of 24 START test not_null_stg_users_user_id ................................. [RUN]
[0m16:15:44.415745 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m16:15:44.416637 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:15:44.420719 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:15:44.421367 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:15:44.425557 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:15:44.425846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.029 seconds
[0m16:15:44.426107 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.030 seconds
[0m16:15:44.426440 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:15:44.430544 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m16:15:44.430845 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.032 seconds
[0m16:15:44.431161 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_user_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.431505 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:15:44.434819 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: ROLLBACK
[0m16:15:44.435098 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m16:15:44.435362 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m16:15:44.435726 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:44.436347 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: Close
[0m16:15:44.436106 [info ] [Thread-2 (]: 16 of 24 PASS not_null_stg_user_events_event_id ................................ [[32mPASS[0m in 0.13s]
[0m16:15:44.437227 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:15:44.436922 [info ] [Thread-4 (]: 17 of 24 PASS not_null_stg_user_events_event_ts ................................ [[32mPASS[0m in 0.12s]
[0m16:15:44.437635 [debug] [Thread-2 (]: Began running node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:15:44.437949 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:15:44.438219 [info ] [Thread-2 (]: 20 of 24 START test relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_  [RUN]
[0m16:15:44.438483 [debug] [Thread-4 (]: Began running node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:15:44.438801 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f)
[0m16:15:44.439094 [info ] [Thread-4 (]: 21 of 24 START test relationships_fact_user_events__User_ID____User_ID___ref_dim_users_  [RUN]
[0m16:15:44.439403 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:15:44.439677 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502, now test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24)
[0m16:15:44.443671 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:15:44.444039 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m16:15:44.444331 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:15:44.448167 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: ROLLBACK
[0m16:15:44.452938 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:15:44.453405 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:15:44.458246 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:15:44.458528 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: Close
[0m16:15:44.459363 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:15:44.459096 [info ] [Thread-1 (]: 18 of 24 PASS not_null_stg_user_events_user_id ................................. [[32mPASS[0m in 0.07s]
[0m16:15:44.464285 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:15:44.464679 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:15:44.464972 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m16:15:44.465426 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:15:44.465785 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: BEGIN
[0m16:15:44.466070 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:15:44.466346 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:15:44.466647 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:15:44.466902 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:44.467152 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.467402 [info ] [Thread-1 (]: 22 of 24 START test unique_dim_episodes__Episode_ID_ ........................... [RUN]
[0m16:15:44.467648 [debug] [Thread-4 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: BEGIN
[0m16:15:44.468049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_user_id.82058db005, now test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de)
[0m16:15:44.468317 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:15:44.468566 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:15:44.473561 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:15:44.473947 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m16:15:44.477321 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m16:15:44.477736 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:15:44.483195 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:15:44.483526 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m16:15:44.484156 [info ] [Thread-3 (]: 19 of 24 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.07s]
[0m16:15:44.484643 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:15:44.484919 [debug] [Thread-3 (]: Began running node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:15:44.485179 [info ] [Thread-3 (]: 23 of 24 START test unique_dim_users__User_ID_ ................................. [RUN]
[0m16:15:44.485496 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77, now test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a)
[0m16:15:44.485771 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:15:44.486008 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:15:44.486236 [debug] [Thread-1 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: BEGIN
[0m16:15:44.489629 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:15:44.489994 [debug] [Thread-4 (]: SQL status: BEGIN in 0.022 seconds
[0m16:15:44.490277 [debug] [Thread-2 (]: SQL status: BEGIN in 0.023 seconds
[0m16:15:44.490611 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:44.490960 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:15:44.491216 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:15:44.491599 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:15:44.491909 [debug] [Thread-4 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select "User ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "User ID" is not null
),

parent as (
    select "User ID" as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.492252 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select "Episode ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "Episode ID" is not null
),

parent as (
    select "Episode ID" as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:15:44.497253 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:15:44.497997 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:15:44.498244 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: BEGIN
[0m16:15:44.498441 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:44.501162 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:15:44.501483 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:15:44.505508 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: ROLLBACK
[0m16:15:44.508942 [debug] [Thread-4 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: ROLLBACK
[0m16:15:44.509221 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m16:15:44.509561 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:15:44.509900 [debug] [Thread-1 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    "Episode ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is not null
group by "Episode ID"
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:15:44.510164 [debug] [Thread-4 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: Close
[0m16:15:44.510390 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: Close
[0m16:15:44.510824 [info ] [Thread-4 (]: 21 of 24 PASS relationships_fact_user_events__User_ID____User_ID___ref_dim_users_  [[32mPASS[0m in 0.07s]
[0m16:15:44.511157 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m16:15:44.511825 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:15:44.511509 [info ] [Thread-2 (]: 20 of 24 PASS relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_  [[32mPASS[0m in 0.07s]
[0m16:15:44.512192 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:15:44.512484 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:15:44.512811 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:15:44.513301 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    "User ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where "User ID" is not null
group by "User ID"
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:15:44.513983 [info ] [Thread-4 (]: 24 of 24 START test unique_fact_user_events__Event_ID_ ......................... [RUN]
[0m16:15:44.514394 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:15:44.515043 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24, now test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a)
[0m16:15:44.518756 [debug] [Thread-1 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: ROLLBACK
[0m16:15:44.519062 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:15:44.519374 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:15:44.522349 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: ROLLBACK
[0m16:15:44.522603 [debug] [Thread-1 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: Close
[0m16:15:44.525975 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:15:44.526460 [info ] [Thread-1 (]: 22 of 24 PASS unique_dim_episodes__Episode_ID_ ................................. [[32mPASS[0m in 0.06s]
[0m16:15:44.526923 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:15:44.527264 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: Close
[0m16:15:44.527611 [info ] [Thread-3 (]: 23 of 24 PASS unique_dim_users__User_ID_ ....................................... [[32mPASS[0m in 0.04s]
[0m16:15:44.527928 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:15:44.528313 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:15:44.533137 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:15:44.533726 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:15:44.533940 [debug] [Thread-4 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: BEGIN
[0m16:15:44.534128 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:15:44.545820 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m16:15:44.546193 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:15:44.546532 [debug] [Thread-4 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    "Event ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is not null
group by "Event ID"
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:15:44.551168 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:15:44.554276 [debug] [Thread-4 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: ROLLBACK
[0m16:15:44.555117 [debug] [Thread-4 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: Close
[0m16:15:44.555477 [info ] [Thread-4 (]: 24 of 24 PASS unique_fact_user_events__Event_ID_ ............................... [[32mPASS[0m in 0.04s]
[0m16:15:44.555894 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:15:44.556776 [info ] [MainThread]: 
[0m16:15:44.557025 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.557200 [debug] [MainThread]: On master: BEGIN
[0m16:15:44.557362 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:15:44.570039 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:15:44.570390 [debug] [MainThread]: On master: COMMIT
[0m16:15:44.570570 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.570734 [debug] [MainThread]: On master: COMMIT
[0m16:15:44.571422 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:15:44.590653 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.591021 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
    select artifacts_model, metadata_hash from "podcast_analytics"."public_public"."dbt_artifacts_hashes"
    order by metadata_hash
    
  
[0m16:15:44.595141 [debug] [MainThread]: SQL status: SELECT 172 in 0.004 seconds
[0m16:15:44.596892 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m16:15:44.611232 [debug] [MainThread]: Elementary: [dbt_models] Flattening the artifacts.
[0m16:15:44.634560 [debug] [MainThread]: Elementary: [dbt_models] Flattened 39 artifacts.
[0m16:15:44.637748 [debug] [MainThread]: Elementary: [dbt_models] Comparing the artifacts state.
[0m16:15:44.638208 [debug] [MainThread]: Elementary: [dbt_models] Artifacts did not change.
[0m16:15:44.638822 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:
[0m16:15:44.639194 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.022637 (1 runs)
[0m16:15:44.639555 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.027620 (1 runs)
[0m16:15:44.642090 [debug] [MainThread]: Elementary: [dbt_tests] Flattening the artifacts.
[0m16:15:44.672044 [debug] [MainThread]: Elementary: [dbt_tests] Flattened 24 artifacts.
[0m16:15:44.672795 [debug] [MainThread]: Elementary: [dbt_tests] Comparing the artifacts state.
[0m16:15:44.673426 [debug] [MainThread]: Elementary: [dbt_tests] Artifacts changed.
[0m16:15:44.677732 [debug] [MainThread]: Elementary: Deleting from and inserting to: "podcast_analytics"."public_public"."dbt_tests"
[0m16:15:44.693355 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.693618 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
  
    

  create temporary table "dbt_tests__tmp_20250705151544681298161544687377"
  
  
    as
  
  (
    
        SELECT
        
            
                metadata_hash
            
        
        FROM "podcast_analytics"."public_public"."dbt_tests"
        WHERE 1 = 0
    
  );
  
  
[0m16:15:44.698165 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m16:15:44.708653 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.708909 [debug] [MainThread]: On master: BEGIN
[0m16:15:44.709885 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:15:44.710119 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.710313 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_tests__tmp_20250705151544681298161544687377'
        
      order by ordinal_position

  
[0m16:15:44.715799 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m16:15:44.717950 [debug] [MainThread]: Elementary: Inserting 2 rows to table "dbt_tests__tmp_20250705151544681298161544687377"
[0m16:15:44.737185 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:15:44.737748 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.737963 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "dbt_tests__tmp_20250705151544681298161544687377"
         (metadata_hash) values
    ('28ffa300e5ca9ef500945cdaab7ab687'),('589ead6273740471e31f68a6f7787009')
  
[0m16:15:44.739086 [debug] [MainThread]: SQL status: INSERT 0 2 in 0.001 seconds
[0m16:15:44.740983 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.741194 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
  
    

  create temporary table "dbt_tests__tmp_20250705151544740176161544740460"
  
  
    as
  
  (
    
        SELECT
        
            *
        
        FROM "podcast_analytics"."public_public"."dbt_tests"
        WHERE 1 = 0
    
  );
  
  
[0m16:15:44.742707 [debug] [MainThread]: SQL status: SELECT 0 in 0.001 seconds
[0m16:15:44.745628 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.745878 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_tests__tmp_20250705151544740176161544740460'
        
      order by ordinal_position

  
[0m16:15:44.751151 [debug] [MainThread]: SQL status: SELECT 28 in 0.005 seconds
[0m16:15:44.752359 [debug] [MainThread]: Elementary: Inserting 2 rows to table "dbt_tests__tmp_20250705151544740176161544740460"
[0m16:15:44.768385 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:15:44.768875 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.769128 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "dbt_tests__tmp_20250705151544740176161544740460"
         (unique_id,database_name,schema_name,name,short_name,alias,test_column_name,severity,warn_if,error_if,test_params,test_namespace,test_original_name,tags,model_tags,model_owners,meta,depends_on_macros,depends_on_nodes,parent_model_unique_id,description,package_name,type,original_path,path,generated_at,metadata_hash,quality_dimension) values
    ('test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','podcast_analytics','public','not_null_fact_user_events__Event_Timestamp_','not_null','not_null_fact_user_events__Event_Timestamp_','"Event Timestamp"','ERROR','!= 0','!= 0','{"column_name": "\"Event Timestamp\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}',NULL,'not_null','[]','[]','[]','{}','["macro.dbt.test_not_null"]','["model.podcast_analytics.fact_user_events"]','model.podcast_analytics.fact_user_events','This test validates that there are no `null` values present in a column.','podcast_analytics','generic','models/schema.yml','not_null_fact_user_events__Event_Timestamp_.sql','2025-07-05 15:15:44','072cb2745390f986f29a300fd037aa87','completeness'),('test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075','podcast_analytics','public','dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01','accepted_range','dbt_utils_accepted_range_fact__c4e4d7ba49daef703bc304120079b001','"Event Timestamp"','ERROR','!= 0','!= 0','{"min_value": "2025-03-01", "inclusive": true, "column_name": "\"Event Timestamp\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','dbt_utils','accepted_range','[]','[]','[]','{}','["macro.dbt.get_where_subquery", "macro.dbt_utils.test_accepted_range"]','["model.podcast_analytics.fact_user_events"]','model.podcast_analytics.fact_user_events','Asserts that a column''s values fall inside an expected range.','podcast_analytics','generic','models/schema.yml','dbt_utils_accepted_range_fact__c4e4d7ba49daef703bc304120079b001.sql','2025-07-05 15:15:44','36d0629f4480f2d759ec8ad256fbdef6','validity')
  
[0m16:15:44.770282 [debug] [MainThread]: SQL status: INSERT 0 2 in 0.001 seconds
[0m16:15:44.773520 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.773757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
        begin transaction;
        
            delete from "podcast_analytics"."public_public"."dbt_tests"
            where
            metadata_hash is null
            or metadata_hash in (select metadata_hash from "dbt_tests__tmp_20250705151544681298161544687377");
        
        
            insert into "podcast_analytics"."public_public"."dbt_tests" select * from "dbt_tests__tmp_20250705151544740176161544740460";
        
        commit;
    
  
[0m16:15:44.775924 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:15:44.780334 [debug] [MainThread]: Applying DROP to: "dbt_tests__tmp_20250705151544681298161544687377"
[0m16:15:44.782602 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.782824 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
drop table if exists "dbt_tests__tmp_20250705151544681298161544687377" cascade
[0m16:15:44.784872 [debug] [MainThread]: SQL status: DROP TABLE in 0.002 seconds
[0m16:15:44.787420 [debug] [MainThread]: Applying DROP to: "dbt_tests__tmp_20250705151544740176161544740460"
[0m16:15:44.788427 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.788642 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
drop table if exists "dbt_tests__tmp_20250705151544740176161544740460" cascade
[0m16:15:44.790001 [debug] [MainThread]: SQL status: DROP TABLE in 0.001 seconds
[0m16:15:44.790587 [debug] [MainThread]: Elementary: Finished deleting from and inserting to: "podcast_analytics"."public_public"."dbt_tests"
[0m16:15:44.791331 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:
[0m16:15:44.791728 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00.029386 (1 runs)
[0m16:15:44.792115 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.get_columns_in_relation: 0:00:00.021351 (2 runs)
[0m16:15:44.792545 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.000397 (2 runs)
[0m16:15:44.792919 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.023291 (4 runs)
[0m16:15:44.793294 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.get_insert_rows_queries: 0:00:00.027511 (2 runs)
[0m16:15:44.793662 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.run_insert_rows_query: 0:00:00.004543 (2 runs)
[0m16:15:44.794069 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows: 0:00:00.062720 (2 runs)
[0m16:15:44.794423 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.149145 (1 runs)
[0m16:15:44.797197 [debug] [MainThread]: Elementary: [dbt_sources] Flattening the artifacts.
[0m16:15:44.806769 [debug] [MainThread]: Elementary: [dbt_sources] Flattened 3 artifacts.
[0m16:15:44.807584 [debug] [MainThread]: Elementary: [dbt_sources] Comparing the artifacts state.
[0m16:15:44.807994 [debug] [MainThread]: Elementary: [dbt_sources] Artifacts did not change.
[0m16:15:44.808599 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:
[0m16:15:44.808969 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.008879 (1 runs)
[0m16:15:44.809330 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.011402 (1 runs)
[0m16:15:44.811782 [debug] [MainThread]: Elementary: [dbt_snapshots] Flattening the artifacts.
[0m16:15:44.812517 [debug] [MainThread]: Elementary: [dbt_snapshots] Flattened 0 artifacts.
[0m16:15:44.813271 [debug] [MainThread]: Elementary: [dbt_snapshots] Comparing the artifacts state.
[0m16:15:44.813672 [debug] [MainThread]: Elementary: [dbt_snapshots] Artifacts did not change.
[0m16:15:44.814229 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:
[0m16:15:44.814647 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00.000236 (1 runs)
[0m16:15:44.815006 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.002435 (1 runs)
[0m16:15:44.817288 [debug] [MainThread]: Elementary: [dbt_metrics] Flattening the artifacts.
[0m16:15:44.817986 [debug] [MainThread]: Elementary: [dbt_metrics] Flattened 0 artifacts.
[0m16:15:44.818623 [debug] [MainThread]: Elementary: [dbt_metrics] Comparing the artifacts state.
[0m16:15:44.819173 [debug] [MainThread]: Elementary: [dbt_metrics] Artifacts did not change.
[0m16:15:44.819715 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:
[0m16:15:44.820091 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00.000152 (1 runs)
[0m16:15:44.820484 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.002402 (1 runs)
[0m16:15:44.822782 [debug] [MainThread]: Elementary: [dbt_exposures] Flattening the artifacts.
[0m16:15:44.823468 [debug] [MainThread]: Elementary: [dbt_exposures] Flattened 0 artifacts.
[0m16:15:44.824098 [debug] [MainThread]: Elementary: [dbt_exposures] Comparing the artifacts state.
[0m16:15:44.824504 [debug] [MainThread]: Elementary: [dbt_exposures] Artifacts did not change.
[0m16:15:44.825039 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:
[0m16:15:44.825403 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00.000208 (1 runs)
[0m16:15:44.825796 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.002243 (1 runs)
[0m16:15:44.828047 [debug] [MainThread]: Elementary: [dbt_seeds] Flattening the artifacts.
[0m16:15:44.835282 [debug] [MainThread]: Elementary: [dbt_seeds] Flattened 2 artifacts.
[0m16:15:44.835977 [debug] [MainThread]: Elementary: [dbt_seeds] Comparing the artifacts state.
[0m16:15:44.836400 [debug] [MainThread]: Elementary: [dbt_seeds] Artifacts did not change.
[0m16:15:44.836950 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:
[0m16:15:44.837317 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00.006743 (1 runs)
[0m16:15:44.837708 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.008888 (1 runs)
[0m16:15:44.840128 [debug] [MainThread]: Elementary: [dbt_columns] Flattening the artifacts.
[0m16:15:44.963883 [debug] [MainThread]: Elementary: [dbt_columns] Flattened 104 artifacts.
[0m16:15:44.964705 [debug] [MainThread]: Elementary: [dbt_columns] Comparing the artifacts state.
[0m16:15:44.965214 [debug] [MainThread]: Elementary: [dbt_columns] Artifacts changed.
[0m16:15:44.967710 [debug] [MainThread]: Elementary: Deleting from and inserting to: "podcast_analytics"."public_public"."dbt_columns"
[0m16:15:44.968972 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.969180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
  
    

  create temporary table "dbt_columns__tmp_20250705151544968059161544968393"
  
  
    as
  
  (
    
        SELECT
        
            
                metadata_hash
            
        
        FROM "podcast_analytics"."public_public"."dbt_columns"
        WHERE 1 = 0
    
  );
  
  
[0m16:15:44.977528 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m16:15:44.980548 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.980775 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_columns__tmp_20250705151544968059161544968393'
        
      order by ordinal_position

  
[0m16:15:44.987158 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m16:15:44.988109 [debug] [MainThread]: Elementary: Inserting 1 rows to table "dbt_columns__tmp_20250705151544968059161544968393"
[0m16:15:44.989882 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:15:44.990380 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.990580 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "dbt_columns__tmp_20250705151544968059161544968393"
         (metadata_hash) values
    ('6455ab792f1e7b1df027f6a345626331')
  
[0m16:15:44.992186 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.001 seconds
[0m16:15:44.994609 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:44.994837 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
  
    

  create temporary table "dbt_columns__tmp_20250705151544993754161544994073"
  
  
    as
  
  (
    
        SELECT
        
            *
        
        FROM "podcast_analytics"."public_public"."dbt_columns"
        WHERE 1 = 0
    
  );
  
  
[0m16:15:44.998928 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m16:15:45.002014 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:45.002286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_columns__tmp_20250705151544993754161544994073'
        
      order by ordinal_position

  
[0m16:15:45.004441 [debug] [MainThread]: SQL status: SELECT 13 in 0.002 seconds
[0m16:15:45.005710 [debug] [MainThread]: Elementary: Inserting 1 rows to table "dbt_columns__tmp_20250705151544993754161544994073"
[0m16:15:45.010731 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:15:45.011242 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:45.011463 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "dbt_columns__tmp_20250705151544993754161544994073"
         (unique_id,parent_unique_id,name,data_type,tags,meta,database_name,schema_name,table_name,description,resource_type,generated_at,metadata_hash) values
    ('column.model.podcast_analytics.fact_user_events."Event Timestamp"','model.podcast_analytics.fact_user_events','"Event Timestamp"',NULL,'[]','{}','podcast_analytics','public','fact_user_events','Timestamp of the event','model','2025-07-05 15:15:44','0683a836f1d8784325200fea1ef96476')
  
[0m16:15:45.013735 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.002 seconds
[0m16:15:45.015113 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:45.015345 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
        begin transaction;
        
            delete from "podcast_analytics"."public_public"."dbt_columns"
            where
            metadata_hash is null
            or metadata_hash in (select metadata_hash from "dbt_columns__tmp_20250705151544968059161544968393");
        
        
            insert into "podcast_analytics"."public_public"."dbt_columns" select * from "dbt_columns__tmp_20250705151544993754161544994073";
        
        commit;
    
  
[0m16:15:45.017574 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:15:45.020506 [debug] [MainThread]: Applying DROP to: "dbt_columns__tmp_20250705151544968059161544968393"
[0m16:15:45.020957 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:45.021162 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
drop table if exists "dbt_columns__tmp_20250705151544968059161544968393" cascade
[0m16:15:45.022723 [debug] [MainThread]: SQL status: DROP TABLE in 0.001 seconds
[0m16:15:45.025069 [debug] [MainThread]: Applying DROP to: "dbt_columns__tmp_20250705151544993754161544994073"
[0m16:15:45.025505 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:45.025704 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
drop table if exists "dbt_columns__tmp_20250705151544993754161544994073" cascade
[0m16:15:45.026909 [debug] [MainThread]: SQL status: DROP TABLE in 0.001 seconds
[0m16:15:45.027441 [debug] [MainThread]: Elementary: Finished deleting from and inserting to: "podcast_analytics"."public_public"."dbt_columns"
[0m16:15:45.028151 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:
[0m16:15:45.028550 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:00.123143 (1 runs)
[0m16:15:45.028981 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].insert_rows.get_columns_in_relation: 0:00:00.014931 (2 runs)
[0m16:15:45.029360 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.000490 (2 runs)
[0m16:15:45.029744 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.004040 (2 runs)
[0m16:15:45.030167 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].insert_rows.get_insert_rows_queries: 0:00:00.005631 (2 runs)
[0m16:15:45.030561 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].insert_rows.run_insert_rows_query: 0:00:00.006032 (2 runs)
[0m16:15:45.030990 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].insert_rows: 0:00:00.029932 (2 runs)
[0m16:15:45.031363 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:00.187911 (1 runs)
[0m16:15:45.031797 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m16:15:45.034165 [debug] [MainThread]: Elementary: Uploading run results.
[0m16:15:45.034683 [debug] [MainThread]: Elementary: [dbt_run_results] Flattening the artifacts.
[0m16:15:45.054847 [debug] [MainThread]: Elementary: [dbt_run_results] Flattened 24 artifacts.
[0m16:15:45.057446 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:45.057671 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_run_results'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:15:45.065634 [debug] [MainThread]: SQL status: SELECT 22 in 0.008 seconds
[0m16:15:45.066787 [debug] [MainThread]: Elementary: Inserting 24 rows to table "podcast_analytics"."public_public"."dbt_run_results"
[0m16:15:45.211998 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:15:45.212572 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:45.213347 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."dbt_run_results"
         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values
    ('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075','test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01','Database Error in test dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01 (models/schema.yml)
  operator does not exist: timestamp without time zone >= integer
  LINE 24:     or not "Event Timestamp" >= 2025-03-01
                                        ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/podcast_analytics/models/schema.yml/dbt_utils_accepted_range_fact__c4e4d7ba49daef703bc304120079b001.sql','error','test',0.18114495277404785,'2025-07-05T15:15:43.907735Z','2025-07-05T15:15:44.058513Z','2025-07-05T15:15:43.898518Z','2025-07-05T15:15:43.905203Z',NULL,False,'

with meet_condition as(
  select *
  from "podcast_analytics"."public"."fact_user_events"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don''t meet the rule.
    or not "Event Timestamp" >= 2025-03-01
)

select *
from validation_errors

',NULL,NULL,'Thread-4 (worker)','test','{}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'accepted_values_fact_user_events__Event_Type___play__pause__seek__complete',NULL,'pass','test',0.2232980728149414,'2025-07-05T15:15:43.902411Z','2025-07-05T15:15:44.093735Z','2025-07-05T15:15:43.884786Z','2025-07-05T15:15:43.902017Z',1,False,'
    
    

with all_values as (

    select
        "Event Type" as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by "Event Type"

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'accepted_values_stg_user_events_event_type__play__pause__seek__complete',NULL,'pass','test',0.22465896606445312,'2025-07-05T15:15:43.905644Z','2025-07-05T15:15:44.100036Z','2025-07-05T15:15:43.888491Z','2025-07-05T15:15:43.904938Z',1,False,'
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue',NULL,'pass','test',0.22475290298461914,'2025-07-05T15:15:43.951623Z','2025-07-05T15:15:44.097076Z','2025-07-05T15:15:43.892847Z','2025-07-05T15:15:43.907487Z',1,False,'
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    ''missing_event_type'',''invalid_event_type'',''missing_timestamp'',''malformed_timestamp'',''missing_user_id'',''missing_episode_id'',''other_issue''
)


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'not_null_dim_episodes__Duration_seconds_',NULL,'pass','test',0.11808586120605469,'2025-07-05T15:15:44.108840Z','2025-07-05T15:15:44.178732Z','2025-07-05T15:15:44.100381Z','2025-07-05T15:15:44.107783Z',1,False,'
    
    



select "Duration (seconds)"
from "podcast_analytics"."public"."dim_episodes"
where "Duration (seconds)" is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'not_null_dim_episodes__Episode_ID_',NULL,'pass','test',0.10241007804870605,'2025-07-05T15:15:44.162182Z','2025-07-05T15:15:44.208234Z','2025-07-05T15:15:44.115963Z','2025-07-05T15:15:44.120832Z',1,False,'
    
    



select "Episode ID"
from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'not_null_dim_users__User_ID_',NULL,'pass','test',0.09820389747619629,'2025-07-05T15:15:44.179473Z','2025-07-05T15:15:44.211708Z','2025-07-05T15:15:44.166387Z','2025-07-05T15:15:44.175589Z',1,False,'
    
    



select "User ID"
from "podcast_analytics"."public"."dim_users"
where "User ID" is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'not_null_dim_episodes__Podcast_ID_',NULL,'pass','test',0.09930706024169922,'2025-07-05T15:15:44.170794Z','2025-07-05T15:15:44.215484Z','2025-07-05T15:15:44.121385Z','2025-07-05T15:15:44.170518Z',1,False,'
    
    



select "Podcast ID"
from "podcast_analytics"."public"."dim_episodes"
where "Podcast ID" is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'not_null_fact_user_events__Episode_ID_',NULL,'pass','test',0.05605912208557129,'2025-07-05T15:15:44.191997Z','2025-07-05T15:15:44.230040Z','2025-07-05T15:15:44.187791Z','2025-07-05T15:15:44.191663Z',1,False,'
    
    



select "Episode ID"
from "podcast_analytics"."public"."fact_user_events"
where "Episode ID" is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'not_null_fact_user_events__Event_ID_',NULL,'pass','test',0.06404304504394531,'2025-07-05T15:15:44.238751Z','2025-07-05T15:15:44.279322Z','2025-07-05T15:15:44.221957Z','2025-07-05T15:15:44.230717Z',1,False,'
    
    



select "Event ID"
from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'not_null_fact_user_events__Event_Timestamp_',NULL,'pass','test',0.06373906135559082,'2025-07-05T15:15:44.244648Z','2025-07-05T15:15:44.283022Z','2025-07-05T15:15:44.230979Z','2025-07-05T15:15:44.243688Z',1,False,'
    
    



select "Event Timestamp"
from "podcast_analytics"."public"."fact_user_events"
where "Event Timestamp" is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'not_null_fact_user_events__User_ID_',NULL,'pass','test',0.06548595428466797,'2025-07-05T15:15:44.249655Z','2025-07-05T15:15:44.288265Z','2025-07-05T15:15:44.234374Z','2025-07-05T15:15:44.244022Z',1,False,'
    
    



select "User ID"
from "podcast_analytics"."public"."fact_user_events"
where "User ID" is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'not_null_stg_episodes_episode_id',NULL,'pass','test',0.048915863037109375,'2025-07-05T15:15:44.261968Z','2025-07-05T15:15:44.300112Z','2025-07-05T15:15:44.257980Z','2025-07-05T15:15:44.261716Z',1,False,'
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'not_null_stg_episodes_podcast_id',NULL,'pass','test',0.09129786491394043,'2025-07-05T15:15:44.305716Z','2025-07-05T15:15:44.381471Z','2025-07-05T15:15:44.293933Z','2025-07-05T15:15:44.304802Z',1,False,'
    
    



select podcast_id
from "podcast_analytics"."public"."stg_episodes"
where podcast_id is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'not_null_stg_user_events_episode_id',NULL,'pass','test',0.11574196815490723,'2025-07-05T15:15:44.314860Z','2025-07-05T15:15:44.407125Z','2025-07-05T15:15:44.300999Z','2025-07-05T15:15:44.310652Z',1,False,'
    
    



select episode_id
from "podcast_analytics"."public"."stg_user_events"
where episode_id is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'not_null_stg_user_events_event_id',NULL,'pass','test',0.13159489631652832,'2025-07-05T15:15:44.321582Z','2025-07-05T15:15:44.430444Z','2025-07-05T15:15:44.311349Z','2025-07-05T15:15:44.320397Z',1,False,'
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'not_null_stg_user_events_event_ts',NULL,'pass','test',0.11552095413208008,'2025-07-05T15:15:44.373293Z','2025-07-05T15:15:44.434723Z','2025-07-05T15:15:44.327070Z','2025-07-05T15:15:44.372938Z',1,False,'
    
    



select event_ts
from "podcast_analytics"."public"."stg_user_events"
where event_ts is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'not_null_stg_user_events_user_id',NULL,'pass','test',0.07440900802612305,'2025-07-05T15:15:44.389939Z','2025-07-05T15:15:44.448063Z','2025-07-05T15:15:44.385019Z','2025-07-05T15:15:44.389600Z',1,False,'
    
    



select user_id
from "podcast_analytics"."public"."stg_user_events"
where user_id is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'not_null_stg_users_user_id',NULL,'pass','test',0.06846284866333008,'2025-07-05T15:15:44.421578Z','2025-07-05T15:15:44.477215Z','2025-07-05T15:15:44.417005Z','2025-07-05T15:15:44.421264Z',1,False,'
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'relationships_fact_user_events__User_ID____User_ID___ref_dim_users_',NULL,'pass','test',0.07110190391540527,'2025-07-05T15:15:44.459703Z','2025-07-05T15:15:44.508850Z','2025-07-05T15:15:44.448447Z','2025-07-05T15:15:44.459255Z',1,False,'
    
    

with child as (
    select "User ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "User ID" is not null
),

parent as (
    select "User ID" as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_',NULL,'pass','test',0.07271790504455566,'2025-07-05T15:15:44.453734Z','2025-07-05T15:15:44.505331Z','2025-07-05T15:15:44.439882Z','2025-07-05T15:15:44.453274Z',1,False,'
    
    

with child as (
    select "Episode ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "Episode ID" is not null
),

parent as (
    select "Episode ID" as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'unique_dim_episodes__Episode_ID_',NULL,'pass','test',0.05839204788208008,'2025-07-05T15:15:44.477933Z','2025-07-05T15:15:44.518644Z','2025-07-05T15:15:44.468865Z','2025-07-05T15:15:44.477638Z',1,False,'
    
    

select
    "Episode ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is not null
group by "Episode ID"
having count(*) > 1


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'unique_dim_users__User_ID_',NULL,'pass','test',0.04211020469665527,'2025-07-05T15:15:44.492480Z','2025-07-05T15:15:44.522249Z','2025-07-05T15:15:44.486432Z','2025-07-05T15:15:44.491519Z',1,False,'
    
    

select
    "User ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where "User ID" is not null
group by "User ID"
having count(*) > 1


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','58c055a9-b314-430f-92a8-985c4fdcaf83','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'unique_fact_user_events__Event_ID_',NULL,'pass','test',0.04045891761779785,'2025-07-05T15:15:44.528531Z','2025-07-05T15:15:44.554188Z','2025-07-05T15:15:44.522768Z','2025-07-05T15:15:44.528217Z',1,False,'
    
    

select
    "Event ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is not null
group by "Event ID"
having count(*) > 1


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}')
  
[0m16:15:45.226201 [debug] [MainThread]: SQL status: INSERT 0 24 in 0.012 seconds
[0m16:15:45.227118 [debug] [MainThread]: On master: COMMIT
[0m16:15:45.227339 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:45.227530 [debug] [MainThread]: On master: COMMIT
[0m16:15:45.229366 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:15:45.230419 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:
[0m16:15:45.230823 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.019566 (1 runs)
[0m16:15:45.231203 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.011097 (1 runs)
[0m16:15:45.231630 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.000227 (1 runs)
[0m16:15:45.232008 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.141312 (24 runs)
[0m16:15:45.232392 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.144663 (1 runs)
[0m16:15:45.232762 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.014508 (1 runs)
[0m16:15:45.233130 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.commit: 0:00:00.002633 (1 runs)
[0m16:15:45.233546 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:00.174429 (1 runs)
[0m16:15:45.233915 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:00.195610 (1 runs)
[0m16:15:45.234291 [debug] [MainThread]: Elementary: Uploaded run results successfully.
[0m16:15:45.239085 [debug] [MainThread]: Elementary: Handling test results.
[0m16:15:45.257072 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:45.257308 [debug] [MainThread]: On master: BEGIN
[0m16:15:45.259673 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:15:45.259853 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:45.260039 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'elementary_test_results'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:15:45.269916 [debug] [MainThread]: SQL status: SELECT 28 in 0.010 seconds
[0m16:15:45.271228 [debug] [MainThread]: Elementary: Inserting 24 rows to table "podcast_analytics"."public_public"."elementary_test_results"
[0m16:15:45.457069 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:15:45.457588 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:45.458498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."elementary_test_results"
         (id,data_issue_id,test_execution_id,test_unique_id,model_unique_id,invocation_id,detected_at,created_at,database_name,schema_name,table_name,column_name,test_type,test_sub_type,test_results_description,owners,tags,test_results_query,other,test_name,test_params,severity,status,failures,test_short_name,test_alias,result_rows,failed_row_count) values
    ('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075','test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01.b207117075','model.podcast_analytics.fact_user_events','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:45' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event Timestamp"','dbt_test','generic','Database Error in test dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01 (models/schema.yml)
  operator does not exist: timestamp without time zone >= integer
  LINE 24:     or not "Event Timestamp" >= 2025-03-01
                                        ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/podcast_analytics/models/schema.yml/dbt_utils_accepted_range_fact__c4e4d7ba49daef703bc304120079b001.sql','[]','[]','

with meet_condition as(
  select *
  from "podcast_analytics"."public"."fact_user_events"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don''t meet the rule.
    or not "Event Timestamp" >= 2025-03-01
)

select *
from validation_errors

',NULL,'dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01','{"min_value": "2025-03-01", "inclusive": true, "column_name": "\"Event Timestamp\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','error',NULL,'accepted_range','dbt_utils_accepted_range_fact__c4e4d7ba49daef703bc304120079b001',NULL,NULL),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','model.podcast_analytics.fact_user_events','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:43' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event Type"','dbt_test','generic',NULL,'[]','[]','
    
    

with all_values as (

    select
        "Event Type" as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by "Event Type"

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',NULL,'accepted_values_fact_user_events__Event_Type___play__pause__seek__complete','{"values": ["play", "pause", "seek", "complete"], "column_name": "\"Event Type\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'accepted_values','accepted_values_fact_user_even_fbc631ab6baad050aa8d81cbe6f1af99',NULL,NULL),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','model.podcast_analytics.stg_user_events','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','event_type','dbt_test','generic',NULL,'[]','[]','
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',NULL,'accepted_values_stg_user_events_event_type__play__pause__seek__complete','{"values": ["play", "pause", "seek", "complete"], "column_name": "event_type", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'accepted_values','accepted_values_stg_user_event_94634d24690dcf7d4e511df98c6e0582',NULL,NULL),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','model.podcast_analytics.stg_user_events_invalid','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events_invalid','issue_type','dbt_test','generic',NULL,'[]','[]','
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    ''missing_event_type'',''invalid_event_type'',''missing_timestamp'',''malformed_timestamp'',''missing_user_id'',''missing_episode_id'',''other_issue''
)


',NULL,'accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue','{"values": ["missing_event_type", "invalid_event_type", "missing_timestamp", "malformed_timestamp", "missing_user_id", "missing_episode_id", "other_issue"], "column_name": "issue_type", "model": "{{ get_where_subquery(ref(''stg_user_events_invalid'')) }}"}','ERROR','pass',0,'accepted_values','accepted_values_stg_user_event_43bb633c97e04e462eb7fee334f302ba',NULL,NULL),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','model.podcast_analytics.dim_episodes','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Duration (seconds)"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Duration (seconds)"
from "podcast_analytics"."public"."dim_episodes"
where "Duration (seconds)" is null


',NULL,'not_null_dim_episodes__Duration_seconds_','{"column_name": "\"Duration (seconds)\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_episodes__Duration_seconds_',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','model.podcast_analytics.dim_episodes','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Episode ID"
from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is null


',NULL,'not_null_dim_episodes__Episode_ID_','{"column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_episodes__Episode_ID_',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','model.podcast_analytics.dim_users','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_users','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "User ID"
from "podcast_analytics"."public"."dim_users"
where "User ID" is null


',NULL,'not_null_dim_users__User_ID_','{"column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''dim_users'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_users__User_ID_',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','model.podcast_analytics.dim_episodes','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Podcast ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Podcast ID"
from "podcast_analytics"."public"."dim_episodes"
where "Podcast ID" is null


',NULL,'not_null_dim_episodes__Podcast_ID_','{"column_name": "\"Podcast ID\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_episodes__Podcast_ID_',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','model.podcast_analytics.fact_user_events','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Episode ID"
from "podcast_analytics"."public"."fact_user_events"
where "Episode ID" is null


',NULL,'not_null_fact_user_events__Episode_ID_','{"column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__Episode_ID_',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','model.podcast_analytics.fact_user_events','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Event ID"
from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is null


',NULL,'not_null_fact_user_events__Event_ID_','{"column_name": "\"Event ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__Event_ID_',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','model.podcast_analytics.fact_user_events','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event Timestamp"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Event Timestamp"
from "podcast_analytics"."public"."fact_user_events"
where "Event Timestamp" is null


',NULL,'not_null_fact_user_events__Event_Timestamp_','{"column_name": "\"Event Timestamp\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__Event_Timestamp_',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','model.podcast_analytics.fact_user_events','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "User ID"
from "podcast_analytics"."public"."fact_user_events"
where "User ID" is null


',NULL,'not_null_fact_user_events__User_ID_','{"column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__User_ID_',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','model.podcast_analytics.stg_episodes','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_episodes','episode_id','dbt_test','generic',NULL,'[]','[]','
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null


',NULL,'not_null_stg_episodes_episode_id','{"column_name": "episode_id", "model": "{{ get_where_subquery(ref(''stg_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_episodes_episode_id',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','model.podcast_analytics.stg_episodes','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_episodes','podcast_id','dbt_test','generic',NULL,'[]','[]','
    
    



select podcast_id
from "podcast_analytics"."public"."stg_episodes"
where podcast_id is null


',NULL,'not_null_stg_episodes_podcast_id','{"column_name": "podcast_id", "model": "{{ get_where_subquery(ref(''stg_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_episodes_podcast_id',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','model.podcast_analytics.stg_user_events','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','episode_id','dbt_test','generic',NULL,'[]','[]','
    
    



select episode_id
from "podcast_analytics"."public"."stg_user_events"
where episode_id is null


',NULL,'not_null_stg_user_events_episode_id','{"column_name": "episode_id", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_episode_id',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','model.podcast_analytics.stg_user_events','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','event_id','dbt_test','generic',NULL,'[]','[]','
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null


',NULL,'not_null_stg_user_events_event_id','{"column_name": "event_id", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_event_id',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','model.podcast_analytics.stg_user_events','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','event_ts','dbt_test','generic',NULL,'[]','[]','
    
    



select event_ts
from "podcast_analytics"."public"."stg_user_events"
where event_ts is null


',NULL,'not_null_stg_user_events_event_ts','{"column_name": "event_ts", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_event_ts',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_user_events_user_id.82058db005',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','model.podcast_analytics.stg_user_events','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','user_id','dbt_test','generic',NULL,'[]','[]','
    
    



select user_id
from "podcast_analytics"."public"."stg_user_events"
where user_id is null


',NULL,'not_null_stg_user_events_user_id','{"column_name": "user_id", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_user_id',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','model.podcast_analytics.stg_users','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_users','user_id','dbt_test','generic',NULL,'[]','[]','
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null


',NULL,'not_null_stg_users_user_id','{"column_name": "user_id", "model": "{{ get_where_subquery(ref(''stg_users'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_users_user_id',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','model.podcast_analytics.fact_user_events','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    

with child as (
    select "User ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "User ID" is not null
),

parent as (
    select "User ID" as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',NULL,'relationships_fact_user_events__User_ID____User_ID___ref_dim_users_','{"to": "ref(''dim_users'')", "field": "\"User ID\"", "column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'relationships','relationships_fact_user_events_18a41013c7410998f321251d32b88faf',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','model.podcast_analytics.fact_user_events','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    

with child as (
    select "Episode ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "Episode ID" is not null
),

parent as (
    select "Episode ID" as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',NULL,'relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_','{"to": "ref(''dim_episodes'')", "field": "\"Episode ID\"", "column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'relationships','relationships_fact_user_events_a5d0f4791bd5f2dd7a1079d5e9d2dc3a',NULL,0),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','model.podcast_analytics.dim_episodes','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    

select
    "Episode ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is not null
group by "Episode ID"
having count(*) > 1


',NULL,'unique_dim_episodes__Episode_ID_','{"column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'unique','unique_dim_episodes__Episode_ID_',NULL,NULL),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','model.podcast_analytics.dim_users','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_users','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    

select
    "User ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where "User ID" is not null
group by "User ID"
having count(*) > 1


',NULL,'unique_dim_users__User_ID_','{"column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''dim_users'')) }}"}','ERROR','pass',0,'unique','unique_dim_users__User_ID_',NULL,NULL),('58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a',NULL,'58c055a9-b314-430f-92a8-985c4fdcaf83.test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','model.podcast_analytics.fact_user_events','58c055a9-b314-430f-92a8-985c4fdcaf83',cast('2025-07-05 15:15:44' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event ID"','dbt_test','generic',NULL,'[]','[]','
    
    

select
    "Event ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is not null
group by "Event ID"
having count(*) > 1


',NULL,'unique_fact_user_events__Event_ID_','{"column_name": "\"Event ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'unique','unique_fact_user_events__Event_ID_',NULL,NULL)
  
[0m16:15:45.467274 [debug] [MainThread]: SQL status: INSERT 0 24 in 0.008 seconds
[0m16:15:45.468175 [debug] [MainThread]: On master: COMMIT
[0m16:15:45.468390 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:45.468583 [debug] [MainThread]: On master: COMMIT
[0m16:15:45.473262 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m16:15:45.474025 [debug] [MainThread]: Elementary: Handled test results successfully.
[0m16:15:45.481671 [debug] [MainThread]: Elementary: Uploading dbt invocation.
[0m16:15:45.511505 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:45.511792 [debug] [MainThread]: On master: BEGIN
[0m16:15:45.513926 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:15:45.514114 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:45.514304 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_invocations'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:15:45.524293 [debug] [MainThread]: SQL status: SELECT 35 in 0.010 seconds
[0m16:15:45.525729 [debug] [MainThread]: Elementary: Inserting 1 rows to table "podcast_analytics"."public_public"."dbt_invocations"
[0m16:15:45.536959 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:15:45.537492 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:45.537717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."dbt_invocations"
         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values
    ('58c055a9-b314-430f-92a8-985c4fdcaf83',NULL,NULL,NULL,'2025-07-05 15:15:42','2025-07-05 15:15:45','2025-07-05 15:15:45',
    current_timestamp::timestamp
,'test','1.10.3','0.18.2',False,'{}','{}','local','podcast_analytics','public','podcast_analytics',4,'[]',NULL,NULL,'podcast_analytics',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'{"user": "podcast"}')
  
[0m16:15:45.541036 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.003 seconds
[0m16:15:45.541899 [debug] [MainThread]: On master: COMMIT
[0m16:15:45.542116 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:45.542297 [debug] [MainThread]: On master: COMMIT
[0m16:15:45.546122 [debug] [MainThread]: SQL status: COMMIT in 0.004 seconds
[0m16:15:45.546884 [debug] [MainThread]: Elementary: Uploaded dbt invocation successfully.
[0m16:15:45.550360 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m16:15:45.551215 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]
[0m16:15:45.551505 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-end.0 ........................................ [[32mOK[0m in 0.98s]
[0m16:15:45.551708 [debug] [MainThread]: On master: Close
[0m16:15:45.551957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:45.552120 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de' was properly closed.
[0m16:15:45.552265 [debug] [MainThread]: Connection 'test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f' was properly closed.
[0m16:15:45.552408 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a' was properly closed.
[0m16:15:45.552548 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a' was properly closed.
[0m16:15:45.552763 [info ] [MainThread]: 
[0m16:15:45.552936 [info ] [MainThread]: Finished running 2 project hooks, 24 data tests in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m16:15:45.554775 [debug] [MainThread]: Command end result
[0m16:15:45.602501 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m16:15:45.604026 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m16:15:45.608358 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m16:15:45.608593 [info ] [MainThread]: 
[0m16:15:45.608807 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:15:45.608990 [info ] [MainThread]: 
[0m16:15:45.609211 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01 (models/schema.yml)[0m
[0m16:15:45.609431 [error] [MainThread]:   Database Error in test dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True__2025_03_01 (models/schema.yml)
  operator does not exist: timestamp without time zone >= integer
  LINE 24:     or not "Event Timestamp" >= 2025-03-01
                                        ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/podcast_analytics/models/schema.yml/dbt_utils_accepted_range_fact__c4e4d7ba49daef703bc304120079b001.sql
[0m16:15:45.609612 [info ] [MainThread]: 
[0m16:15:45.609812 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/schema.yml/dbt_utils_accepted_range_fact__c4e4d7ba49daef703bc304120079b001.sql
[0m16:15:45.609991 [info ] [MainThread]: 
[0m16:15:45.610167 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=26
[0m16:15:45.610499 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageMaterializationOverrideDeprecation: 24 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:15:45.612705 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.8252723, "process_in_blocks": "0", "process_kernel_time": 0.258037, "process_mem_max_rss": "149700608", "process_out_blocks": "0", "process_user_time": 3.039407}
[0m16:15:45.613039 [debug] [MainThread]: Command `dbt test` failed at 16:15:45.612987 after 2.83 seconds
[0m16:15:45.613284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bf7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11838a8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11838a590>]}
[0m16:15:45.613757 [debug] [MainThread]: Flushing usage events
[0m16:15:46.011576 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:17:36.094710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cb4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108527b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108527460>]}


============================== 16:17:36.097817 | 0b9d08b8-672b-406f-b801-9721de1ba7ca ==============================
[0m16:17:36.097817 [info ] [MainThread]: Running with dbt=1.10.3
[0m16:17:36.098195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/samydoreau/global-assignment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --profiles-dir /Users/samydoreau/global-assignment', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:17:36.216852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b9d08b8-672b-406f-b801-9721de1ba7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107729f60>]}
[0m16:17:36.248044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b9d08b8-672b-406f-b801-9721de1ba7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e33d0>]}
[0m16:17:36.248720 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:17:36.322061 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m16:17:36.516126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:17:36.516836 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/schema.yml
[0m16:17:36.777723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b9d08b8-672b-406f-b801-9721de1ba7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a18550>]}
[0m16:17:36.905566 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m16:17:36.907096 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m16:17:36.925550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b9d08b8-672b-406f-b801-9721de1ba7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a71390>]}
[0m16:17:36.925887 [info ] [MainThread]: Found 39 models, 2 seeds, 2 operations, 24 data tests, 3 sources, 1248 macros
[0m16:17:36.926101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b9d08b8-672b-406f-b801-9721de1ba7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c8910>]}
[0m16:17:36.927686 [info ] [MainThread]: 
[0m16:17:36.927902 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m16:17:36.928075 [info ] [MainThread]: 
[0m16:17:36.928356 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:17:36.931977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m16:17:36.932391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public_public'
[0m16:17:36.966501 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m16:17:36.966767 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public_public"
[0m16:17:36.967022 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m16:17:36.967209 [debug] [ThreadPool]: On list_podcast_analytics_public_public: BEGIN
[0m16:17:36.967391 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:36.967561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:37.013332 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m16:17:37.013684 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m16:17:37.013900 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:17:37.017519 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m16:17:37.017764 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public_public"
[0m16:17:37.017976 [debug] [ThreadPool]: On list_podcast_analytics_public_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m16:17:37.022658 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.004 seconds
[0m16:17:37.023796 [debug] [ThreadPool]: On list_podcast_analytics_public_public: ROLLBACK
[0m16:17:37.024037 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.010 seconds
[0m16:17:37.024760 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m16:17:37.024995 [debug] [ThreadPool]: On list_podcast_analytics_public_public: Close
[0m16:17:37.027580 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m16:17:37.033518 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:37.033779 [debug] [MainThread]: On master: BEGIN
[0m16:17:37.033953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:17:37.045711 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:17:37.046011 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:37.046262 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:17:37.068399 [debug] [MainThread]: SQL status: SELECT 55 in 0.022 seconds
[0m16:17:37.072657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b9d08b8-672b-406f-b801-9721de1ba7ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f7070>]}
[0m16:17:37.073023 [debug] [MainThread]: On master: ROLLBACK
[0m16:17:37.073964 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:37.074190 [debug] [MainThread]: On master: BEGIN
[0m16:17:37.075513 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:17:37.075773 [debug] [MainThread]: On master: COMMIT
[0m16:17:37.075986 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:37.076178 [debug] [MainThread]: On master: COMMIT
[0m16:17:37.076933 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:17:37.097787 [debug] [MainThread]: Elementary: Materialization override is enabled.
[0m16:17:37.114873 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:37.115157 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    select count(*) from pg_namespace where nspname = 'public_public__tests'
  
[0m16:17:37.116494 [debug] [MainThread]: SQL status: SELECT 1 in 0.001 seconds
[0m16:17:37.117857 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m16:17:37.120663 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]
[0m16:17:37.120979 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-start.0 ...................................... [[32mOK[0m in 0.04s]
[0m16:17:37.121174 [info ] [MainThread]: 
[0m16:17:37.121375 [debug] [MainThread]: On master: Close
[0m16:17:37.123561 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:17:37.123830 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:17:37.124081 [info ] [Thread-1 (]: 1 of 24 START test accepted_values_fact_user_events__Event_Type___play__pause__seek__complete  [RUN]
[0m16:17:37.124354 [debug] [Thread-3 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:17:37.124590 [info ] [Thread-2 (]: 2 of 24 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m16:17:37.124870 [debug] [Thread-4 (]: Began running node test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699
[0m16:17:37.125187 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8)
[0m16:17:37.125430 [info ] [Thread-3 (]: 3 of 24 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [RUN]
[0m16:17:37.125738 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m16:17:37.126018 [info ] [Thread-4 (]: 4 of 24 START test dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp  [RUN]
[0m16:17:37.126299 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:17:37.126760 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7'
[0m16:17:37.127146 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:17:37.127459 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699'
[0m16:17:37.130718 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:17:37.131128 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:17:37.167314 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:17:37.159368 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699
[0m16:17:37.172601 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:17:37.172954 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:17:37.181402 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699"
[0m16:17:37.181774 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:17:37.184513 [warn ] [Thread-1 (]: [[33mWARNING[0m]: Installed package 'elementary' is overriding the built-in
materialization 'test'. Overrides of built-in materializations from installed
packages will be deprecated in future versions of dbt. For more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m16:17:37.186938 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:17:37.186673 [warn ] [Thread-2 (]: [[33mWARNING[0m]: Installed package 'elementary' is overriding the built-in
materialization 'test'. Overrides of built-in materializations from installed
packages will be deprecated in future versions of dbt. For more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m16:17:37.187279 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0b9d08b8-672b-406f-b801-9721de1ba7ca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e972e0>]}
[0m16:17:37.187512 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699
[0m16:17:37.189336 [warn ] [Thread-3 (]: [[33mWARNING[0m]: Installed package 'elementary' is overriding the built-in
materialization 'test'. Overrides of built-in materializations from installed
packages will be deprecated in future versions of dbt. For more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m16:17:37.189605 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0b9d08b8-672b-406f-b801-9721de1ba7ca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ebb4f0>]}
[0m16:17:37.239860 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0b9d08b8-672b-406f-b801-9721de1ba7ca', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f11de0>]}
[0m16:17:37.312704 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:17:37.314379 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699"
[0m16:17:37.314937 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:17:37.317308 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:17:37.318908 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699"
[0m16:17:37.319143 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699: BEGIN
[0m16:17:37.319376 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:17:37.319622 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:17:37.319851 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:17:37.320057 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m16:17:37.320270 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:17:37.320500 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: BEGIN
[0m16:17:37.320794 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:17:37.321035 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: BEGIN
[0m16:17:37.321277 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:17:37.321564 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:37.351232 [debug] [Thread-1 (]: SQL status: BEGIN in 0.030 seconds
[0m16:17:37.351600 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:17:37.351843 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        "Event Type" as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by "Event Type"

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m16:17:37.352556 [debug] [Thread-3 (]: SQL status: BEGIN in 0.031 seconds
[0m16:17:37.352901 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:17:37.353175 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','missing_timestamp','malformed_timestamp','missing_user_id','missing_episode_id','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m16:17:37.353609 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m16:17:37.353867 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:17:37.354112 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m16:17:37.356185 [debug] [Thread-4 (]: SQL status: BEGIN in 0.036 seconds
[0m16:17:37.356421 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699"
[0m16:17:37.356658 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "podcast_analytics"."public"."fact_user_events"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not "Event Timestamp" >= '2025-03-01'::timestamp
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m16:17:37.357451 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:17:37.367178 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m16:17:37.370562 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699"
[0m16:17:37.376544 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.023 seconds
[0m16:17:37.385025 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: ROLLBACK
[0m16:17:37.385302 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699"} */

    
    with test_results as (
      

with meet_condition as(
  select *
  from "podcast_analytics"."public"."fact_user_events"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not "Event Timestamp" >= '2025-03-01'::timestamp
)

select *
from validation_errors


    )
    select * from test_results  limit 5 
  
  
[0m16:17:37.385548 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.031 seconds
[0m16:17:37.388136 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: ROLLBACK
[0m16:17:37.391026 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m16:17:37.391304 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: Close
[0m16:17:37.391649 [debug] [Thread-4 (]: SQL status: SELECT 5 in 0.003 seconds
[0m16:17:37.392196 [info ] [Thread-1 (]: 1 of 24 PASS accepted_values_fact_user_events__Event_Type___play__pause__seek__complete  [[32mPASS[0m in 0.27s]
[0m16:17:37.392499 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m16:17:37.396097 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699: ROLLBACK
[0m16:17:37.396358 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: Close
[0m16:17:37.396712 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:17:37.397107 [info ] [Thread-2 (]: 2 of 24 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.27s]
[0m16:17:37.398066 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:17:37.397726 [info ] [Thread-3 (]: 3 of 24 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [[32mPASS[0m in 0.27s]
[0m16:17:37.398488 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699: Close
[0m16:17:37.398866 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:17:37.399145 [info ] [Thread-1 (]: 5 of 24 START test not_null_dim_episodes__Duration_seconds_ .................... [RUN]
[0m16:17:37.399525 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:17:37.399850 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:17:37.400190 [error] [Thread-4 (]: 4 of 24 FAIL 4860 dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp  [[31mFAIL 4860[0m in 0.27s]
[0m16:17:37.400599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8, now test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444)
[0m16:17:37.400934 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:17:37.401183 [info ] [Thread-2 (]: 6 of 24 START test not_null_dim_episodes__Episode_ID_ .......................... [RUN]
[0m16:17:37.401643 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699
[0m16:17:37.401902 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:17:37.402139 [info ] [Thread-3 (]: 7 of 24 START test not_null_dim_episodes__Podcast_ID_ .......................... [RUN]
[0m16:17:37.402700 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc)
[0m16:17:37.403014 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:17:37.407863 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:17:37.408266 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7)
[0m16:17:37.408580 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:17:37.408812 [info ] [Thread-4 (]: 8 of 24 START test not_null_dim_users__User_ID_ ................................ [RUN]
[0m16:17:37.409144 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:17:37.412137 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:17:37.412513 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699, now test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba)
[0m16:17:37.416418 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:17:37.416660 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:17:37.417025 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:17:37.421224 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:17:37.421514 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:17:37.424863 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:17:37.425199 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:17:37.467263 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:17:37.471788 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:17:37.472173 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:17:37.472504 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:17:37.472821 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: BEGIN
[0m16:17:37.473108 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:17:37.477279 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:17:37.477578 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:17:37.477795 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:37.478016 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: BEGIN
[0m16:17:37.478269 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: BEGIN
[0m16:17:37.478601 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:17:37.478792 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:17:37.479001 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:17:37.479207 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: BEGIN
[0m16:17:37.479661 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:17:37.495155 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m16:17:37.495722 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:17:37.495998 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Episode ID"
from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.498962 [debug] [Thread-3 (]: SQL status: BEGIN in 0.020 seconds
[0m16:17:37.499275 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:17:37.499548 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:17:37.499768 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Podcast ID"
from "podcast_analytics"."public"."dim_episodes"
where "Podcast ID" is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.503000 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: ROLLBACK
[0m16:17:37.503329 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m16:17:37.503802 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:17:37.504106 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Duration (seconds)"
from "podcast_analytics"."public"."dim_episodes"
where "Duration (seconds)" is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.504443 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: Close
[0m16:17:37.504718 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m16:17:37.505170 [info ] [Thread-2 (]: 6 of 24 PASS not_null_dim_episodes__Episode_ID_ ................................ [[32mPASS[0m in 0.10s]
[0m16:17:37.505438 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:17:37.505753 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:17:37.505982 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "User ID"
from "podcast_analytics"."public"."dim_users"
where "User ID" is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.506236 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:17:37.506575 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:17:37.506791 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:17:37.507060 [info ] [Thread-2 (]: 9 of 24 START test not_null_fact_user_events__Episode_ID_ ...................... [RUN]
[0m16:17:37.509952 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: ROLLBACK
[0m16:17:37.513666 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: ROLLBACK
[0m16:17:37.513898 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:17:37.514246 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc, now test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae)
[0m16:17:37.517562 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: ROLLBACK
[0m16:17:37.517842 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: Close
[0m16:17:37.518137 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: Close
[0m16:17:37.518432 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:17:37.518899 [info ] [Thread-3 (]: 7 of 24 PASS not_null_dim_episodes__Podcast_ID_ ................................ [[32mPASS[0m in 0.11s]
[0m16:17:37.519231 [info ] [Thread-1 (]: 5 of 24 PASS not_null_dim_episodes__Duration_seconds_ .......................... [[32mPASS[0m in 0.12s]
[0m16:17:37.522705 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:17:37.522961 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: Close
[0m16:17:37.523350 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:17:37.523832 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:17:37.524348 [info ] [Thread-4 (]: 8 of 24 PASS not_null_dim_users__User_ID_ ...................................... [[32mPASS[0m in 0.11s]
[0m16:17:37.524796 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:17:37.525083 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:17:37.525311 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd
[0m16:17:37.525655 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:17:37.525887 [info ] [Thread-3 (]: 10 of 24 START test not_null_fact_user_events__Event_ID_ ....................... [RUN]
[0m16:17:37.530711 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:17:37.530995 [info ] [Thread-1 (]: 11 of 24 START test not_null_fact_user_events__Event_Timestamp_ ................ [RUN]
[0m16:17:37.531289 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:17:37.531718 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7, now test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c)
[0m16:17:37.532113 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444, now test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd)
[0m16:17:37.532408 [info ] [Thread-4 (]: 12 of 24 START test not_null_fact_user_events__User_ID_ ........................ [RUN]
[0m16:17:37.532810 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:17:37.533099 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:17:37.533346 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd
[0m16:17:37.533609 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba, now test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2)
[0m16:17:37.536836 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:17:37.537197 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: BEGIN
[0m16:17:37.540307 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"
[0m16:17:37.540596 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:17:37.540902 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:17:37.541273 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:17:37.545289 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:17:37.549952 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:17:37.550240 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd
[0m16:17:37.555068 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"
[0m16:17:37.555653 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:17:37.555925 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:17:37.556253 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: BEGIN
[0m16:17:37.556495 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"
[0m16:17:37.560624 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:17:37.560928 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:17:37.561173 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd: BEGIN
[0m16:17:37.561603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:37.561918 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:17:37.562131 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: BEGIN
[0m16:17:37.562340 [debug] [Thread-2 (]: SQL status: BEGIN in 0.021 seconds
[0m16:17:37.562548 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:17:37.562841 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:17:37.563252 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Episode ID"
from "podcast_analytics"."public"."fact_user_events"
where "Episode ID" is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.566888 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:17:37.570546 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: ROLLBACK
[0m16:17:37.571413 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: Close
[0m16:17:37.572020 [info ] [Thread-2 (]: 9 of 24 PASS not_null_fact_user_events__Episode_ID_ ............................ [[32mPASS[0m in 0.06s]
[0m16:17:37.572498 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:17:37.572790 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:17:37.573070 [info ] [Thread-2 (]: 13 of 24 START test not_null_stg_episodes_episode_id ........................... [RUN]
[0m16:17:37.573340 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae, now test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422)
[0m16:17:37.573555 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:17:37.576975 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:17:37.577637 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:17:37.581868 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:17:37.582180 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m16:17:37.582404 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m16:17:37.582819 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:17:37.583132 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:17:37.583431 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "User ID"
from "podcast_analytics"."public"."fact_user_events"
where "User ID" is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.583708 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:17:37.583915 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m16:17:37.584142 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Event ID"
from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.584454 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m16:17:37.584755 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"
[0m16:17:37.585081 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:17:37.585398 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Event Timestamp"
from "podcast_analytics"."public"."fact_user_events"
where "Event Timestamp" is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.587304 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:17:37.590937 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: ROLLBACK
[0m16:17:37.591219 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m16:17:37.591508 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m16:17:37.594609 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: ROLLBACK
[0m16:17:37.594879 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: Close
[0m16:17:37.598180 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd: ROLLBACK
[0m16:17:37.598798 [info ] [Thread-4 (]: 12 of 24 PASS not_null_fact_user_events__User_ID_ .............................. [[32mPASS[0m in 0.07s]
[0m16:17:37.599343 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:17:37.599597 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: Close
[0m16:17:37.599841 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:17:37.600127 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd: Close
[0m16:17:37.600542 [info ] [Thread-4 (]: 14 of 24 START test not_null_stg_episodes_podcast_id ........................... [RUN]
[0m16:17:37.600923 [info ] [Thread-3 (]: 10 of 24 PASS not_null_fact_user_events__Event_ID_ ............................. [[32mPASS[0m in 0.07s]
[0m16:17:37.601310 [info ] [Thread-1 (]: 11 of 24 PASS not_null_fact_user_events__Event_Timestamp_ ...................... [[32mPASS[0m in 0.07s]
[0m16:17:37.601584 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2, now test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1)
[0m16:17:37.601993 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:17:37.602326 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd
[0m16:17:37.602558 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:17:37.602805 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:17:37.603045 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:17:37.606711 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:17:37.607039 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m16:17:37.607340 [info ] [Thread-3 (]: 15 of 24 START test not_null_stg_user_events_episode_id ........................ [RUN]
[0m16:17:37.607670 [info ] [Thread-1 (]: 16 of 24 START test not_null_stg_user_events_event_id .......................... [RUN]
[0m16:17:37.608056 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:17:37.608340 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c, now test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110)
[0m16:17:37.608620 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd, now test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7)
[0m16:17:37.608884 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.609109 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:17:37.609340 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:17:37.609553 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:17:37.614354 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:17:37.614633 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:17:37.617685 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:17:37.621267 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:17:37.624752 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m16:17:37.625155 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:17:37.625468 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:17:37.625757 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: BEGIN
[0m16:17:37.630120 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:17:37.630467 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:17:37.630721 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m16:17:37.631011 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:17:37.635590 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:17:37.636145 [info ] [Thread-2 (]: 13 of 24 PASS not_null_stg_episodes_episode_id ................................. [[32mPASS[0m in 0.06s]
[0m16:17:37.636473 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:17:37.636984 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:17:37.637244 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: BEGIN
[0m16:17:37.637510 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:17:37.637747 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:17:37.637990 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:17:37.638421 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m16:17:37.638224 [info ] [Thread-2 (]: 17 of 24 START test not_null_stg_user_events_event_ts .......................... [RUN]
[0m16:17:37.638842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:37.639184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502)
[0m16:17:37.639549 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:17:37.643269 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:17:37.643909 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:17:37.649589 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:17:37.650222 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:17:37.650460 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: BEGIN
[0m16:17:37.650663 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:17:37.651265 [debug] [Thread-4 (]: SQL status: BEGIN in 0.020 seconds
[0m16:17:37.651626 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:17:37.652030 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select podcast_id
from "podcast_analytics"."public"."stg_episodes"
where podcast_id is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.654238 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m16:17:37.654535 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:17:37.654763 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_user_events"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.656772 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:17:37.660153 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: ROLLBACK
[0m16:17:37.660438 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m16:17:37.660786 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:17:37.661015 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.661298 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: Close
[0m16:17:37.661726 [info ] [Thread-4 (]: 14 of 24 PASS not_null_stg_episodes_podcast_id ................................. [[32mPASS[0m in 0.06s]
[0m16:17:37.662110 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:17:37.662384 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:17:37.662677 [info ] [Thread-4 (]: 18 of 24 START test not_null_stg_user_events_user_id ........................... [RUN]
[0m16:17:37.662998 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1, now test.podcast_analytics.not_null_stg_user_events_user_id.82058db005)
[0m16:17:37.663314 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:17:37.667014 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:17:37.667385 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.012 seconds
[0m16:17:37.670796 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: ROLLBACK
[0m16:17:37.671172 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m16:17:37.671471 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:17:37.671735 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:17:37.672018 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: Close
[0m16:17:37.672263 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_ts
from "podcast_analytics"."public"."stg_user_events"
where event_ts is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.676948 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:17:37.677421 [info ] [Thread-3 (]: 15 of 24 PASS not_null_stg_user_events_episode_id .............................. [[32mPASS[0m in 0.07s]
[0m16:17:37.677984 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:17:37.678267 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:17:37.678766 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:17:37.678552 [info ] [Thread-3 (]: 19 of 24 START test not_null_stg_users_user_id ................................. [RUN]
[0m16:17:37.679094 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: BEGIN
[0m16:17:37.679395 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m16:17:37.679646 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:17:37.679865 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:17:37.683582 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:17:37.684211 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:17:37.728136 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.050 seconds
[0m16:17:37.730235 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:17:37.730646 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.069 seconds
[0m16:17:37.733858 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: ROLLBACK
[0m16:17:37.734171 [debug] [Thread-4 (]: SQL status: BEGIN in 0.054 seconds
[0m16:17:37.737211 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m16:17:37.737596 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:17:37.737906 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:17:37.738157 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: Close
[0m16:17:37.738460 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m16:17:37.738711 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_user_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.738927 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m16:17:37.739505 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:17:37.739304 [info ] [Thread-2 (]: 17 of 24 PASS not_null_stg_user_events_event_ts ................................ [[32mPASS[0m in 0.10s]
[0m16:17:37.740048 [info ] [Thread-1 (]: 16 of 24 PASS not_null_stg_user_events_event_id ................................ [[32mPASS[0m in 0.13s]
[0m16:17:37.740550 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:17:37.740921 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:17:37.741223 [debug] [Thread-2 (]: Began running node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:17:37.741565 [debug] [Thread-1 (]: Began running node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:17:37.741867 [info ] [Thread-2 (]: 20 of 24 START test relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_  [RUN]
[0m16:17:37.742446 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502, now test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f)
[0m16:17:37.742742 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:17:37.742153 [info ] [Thread-1 (]: 21 of 24 START test relationships_fact_user_events__User_ID____User_ID___ref_dim_users_  [RUN]
[0m16:17:37.746924 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:17:37.747223 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:17:37.747519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24)
[0m16:17:37.751233 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: ROLLBACK
[0m16:17:37.751595 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:17:37.755437 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:17:37.755747 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:17:37.755994 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: Close
[0m16:17:37.761776 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:17:37.762132 [debug] [Thread-3 (]: SQL status: BEGIN in 0.023 seconds
[0m16:17:37.762824 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:17:37.762608 [info ] [Thread-4 (]: 18 of 24 PASS not_null_stg_user_events_user_id ................................. [[32mPASS[0m in 0.10s]
[0m16:17:37.763245 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:17:37.767886 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:17:37.768344 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:17:37.768665 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:17:37.768988 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.769356 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:17:37.769649 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: BEGIN
[0m16:17:37.769889 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:17:37.770166 [info ] [Thread-4 (]: 22 of 24 START test unique_dim_episodes__Episode_ID_ ........................... [RUN]
[0m16:17:37.770419 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:17:37.770635 [debug] [Thread-1 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: BEGIN
[0m16:17:37.770899 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_user_id.82058db005, now test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de)
[0m16:17:37.771191 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:17:37.771402 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:17:37.775983 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:17:37.776272 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m16:17:37.780425 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m16:17:37.780829 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:17:37.785294 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:17:37.785619 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m16:17:37.786293 [info ] [Thread-3 (]: 19 of 24 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.11s]
[0m16:17:37.786700 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:17:37.786953 [debug] [Thread-3 (]: Began running node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:17:37.787270 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m16:17:37.787523 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m16:17:37.787755 [info ] [Thread-3 (]: 23 of 24 START test unique_dim_users__User_ID_ ................................. [RUN]
[0m16:17:37.788035 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:17:37.788310 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:17:37.788599 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:17:37.788963 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77, now test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a)
[0m16:17:37.789260 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: BEGIN
[0m16:17:37.789556 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select "Episode ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "Episode ID" is not null
),

parent as (
    select "Episode ID" as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.789838 [debug] [Thread-1 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select "User ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "User ID" is not null
),

parent as (
    select "User ID" as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:17:37.790146 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:17:37.790389 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:17:37.794199 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:17:37.794548 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:17:37.794818 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:17:37.798480 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: ROLLBACK
[0m16:17:37.801756 [debug] [Thread-1 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: ROLLBACK
[0m16:17:37.802189 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:17:37.806602 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:17:37.806866 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: Close
[0m16:17:37.807114 [debug] [Thread-1 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: Close
[0m16:17:37.807631 [info ] [Thread-2 (]: 20 of 24 PASS relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_  [[32mPASS[0m in 0.07s]
[0m16:17:37.807982 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:17:37.808233 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:17:37.808584 [info ] [Thread-1 (]: 21 of 24 PASS relationships_fact_user_events__User_ID____User_ID___ref_dim_users_  [[32mPASS[0m in 0.06s]
[0m16:17:37.808897 [info ] [Thread-2 (]: 24 of 24 START test unique_fact_user_events__Event_ID_ ......................... [RUN]
[0m16:17:37.809471 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:17:37.809808 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:17:37.810082 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f, now test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a)
[0m16:17:37.810303 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: BEGIN
[0m16:17:37.810580 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:17:37.810897 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:17:37.815061 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:17:37.815872 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:17:37.820105 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:17:37.820413 [debug] [Thread-4 (]: SQL status: BEGIN in 0.030 seconds
[0m16:17:37.820799 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:17:37.821127 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    "Episode ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is not null
group by "Episode ID"
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:17:37.821433 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:17:37.821708 [debug] [Thread-2 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: BEGIN
[0m16:17:37.821907 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:17:37.824383 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:17:37.827981 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: ROLLBACK
[0m16:17:37.828784 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: Close
[0m16:17:37.829191 [info ] [Thread-4 (]: 22 of 24 PASS unique_dim_episodes__Episode_ID_ ................................. [[32mPASS[0m in 0.06s]
[0m16:17:37.829529 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:17:37.839471 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m16:17:37.839851 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:17:37.840086 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    "User ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where "User ID" is not null
group by "User ID"
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:17:37.841694 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m16:17:37.841958 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:17:37.842187 [debug] [Thread-2 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    "Event ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is not null
group by "Event ID"
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:17:37.842799 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:17:37.845797 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: ROLLBACK
[0m16:17:37.846742 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: Close
[0m16:17:37.847327 [info ] [Thread-3 (]: 23 of 24 PASS unique_dim_users__User_ID_ ....................................... [[32mPASS[0m in 0.06s]
[0m16:17:37.847702 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:17:37.848262 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m16:17:37.851073 [debug] [Thread-2 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: ROLLBACK
[0m16:17:37.852560 [debug] [Thread-2 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: Close
[0m16:17:37.853181 [info ] [Thread-2 (]: 24 of 24 PASS unique_fact_user_events__Event_ID_ ............................... [[32mPASS[0m in 0.04s]
[0m16:17:37.853554 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:17:37.854623 [info ] [MainThread]: 
[0m16:17:37.854920 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:37.855136 [debug] [MainThread]: On master: BEGIN
[0m16:17:37.855325 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:17:37.868491 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m16:17:37.868915 [debug] [MainThread]: On master: COMMIT
[0m16:17:37.869323 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:37.869936 [debug] [MainThread]: On master: COMMIT
[0m16:17:37.871299 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:17:37.887247 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:37.887618 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
    select artifacts_model, metadata_hash from "podcast_analytics"."public_public"."dbt_artifacts_hashes"
    order by metadata_hash
    
  
[0m16:17:37.891679 [debug] [MainThread]: SQL status: SELECT 172 in 0.004 seconds
[0m16:17:37.893344 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m16:17:37.907443 [debug] [MainThread]: Elementary: [dbt_models] Flattening the artifacts.
[0m16:17:37.931194 [debug] [MainThread]: Elementary: [dbt_models] Flattened 39 artifacts.
[0m16:17:37.934565 [debug] [MainThread]: Elementary: [dbt_models] Comparing the artifacts state.
[0m16:17:37.935078 [debug] [MainThread]: Elementary: [dbt_models] Artifacts did not change.
[0m16:17:37.935791 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:
[0m16:17:37.936190 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.023119 (1 runs)
[0m16:17:37.936559 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.028365 (1 runs)
[0m16:17:37.939135 [debug] [MainThread]: Elementary: [dbt_tests] Flattening the artifacts.
[0m16:17:37.969658 [debug] [MainThread]: Elementary: [dbt_tests] Flattened 24 artifacts.
[0m16:17:37.970475 [debug] [MainThread]: Elementary: [dbt_tests] Comparing the artifacts state.
[0m16:17:37.970896 [debug] [MainThread]: Elementary: [dbt_tests] Artifacts changed.
[0m16:17:37.975043 [debug] [MainThread]: Elementary: Deleting from and inserting to: "podcast_analytics"."public_public"."dbt_tests"
[0m16:17:37.990440 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:37.990695 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
  
    

  create temporary table "dbt_tests__tmp_20250705151737978458161737984512"
  
  
    as
  
  (
    
        SELECT
        
            
                metadata_hash
            
        
        FROM "podcast_analytics"."public_public"."dbt_tests"
        WHERE 1 = 0
    
  );
  
  
[0m16:17:37.997861 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m16:17:38.008575 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.008826 [debug] [MainThread]: On master: BEGIN
[0m16:17:38.009715 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:17:38.009907 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.010094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_tests__tmp_20250705151737978458161737984512'
        
      order by ordinal_position

  
[0m16:17:38.018243 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m16:17:38.020188 [debug] [MainThread]: Elementary: Inserting 1 rows to table "dbt_tests__tmp_20250705151737978458161737984512"
[0m16:17:38.038604 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:17:38.039211 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.039419 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "dbt_tests__tmp_20250705151737978458161737984512"
         (metadata_hash) values
    ('36d0629f4480f2d759ec8ad256fbdef6')
  
[0m16:17:38.040614 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.001 seconds
[0m16:17:38.042524 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.042734 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
  
    

  create temporary table "dbt_tests__tmp_20250705151738041654161738042004"
  
  
    as
  
  (
    
        SELECT
        
            *
        
        FROM "podcast_analytics"."public_public"."dbt_tests"
        WHERE 1 = 0
    
  );
  
  
[0m16:17:38.044825 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m16:17:38.048122 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.048366 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_tests__tmp_20250705151738041654161738042004'
        
      order by ordinal_position

  
[0m16:17:38.051377 [debug] [MainThread]: SQL status: SELECT 28 in 0.003 seconds
[0m16:17:38.052674 [debug] [MainThread]: Elementary: Inserting 1 rows to table "dbt_tests__tmp_20250705151738041654161738042004"
[0m16:17:38.061400 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:17:38.061903 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.062138 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "dbt_tests__tmp_20250705151738041654161738042004"
         (unique_id,database_name,schema_name,name,short_name,alias,test_column_name,severity,warn_if,error_if,test_params,test_namespace,test_original_name,tags,model_tags,model_owners,meta,depends_on_macros,depends_on_nodes,parent_model_unique_id,description,package_name,type,original_path,path,generated_at,metadata_hash,quality_dimension) values
    ('test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699','podcast_analytics','public','dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp','accepted_range','dbt_utils_accepted_range_fact__ab95ce5efc2942df5577b5b2fa1f8d29','"Event Timestamp"','ERROR','!= 0','!= 0','{"min_value": "''2025-03-01''::timestamp", "inclusive": true, "column_name": "\"Event Timestamp\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','dbt_utils','accepted_range','[]','[]','[]','{}','["macro.dbt.get_where_subquery", "macro.dbt_utils.test_accepted_range"]','["model.podcast_analytics.fact_user_events"]','model.podcast_analytics.fact_user_events','Asserts that a column''s values fall inside an expected range.','podcast_analytics','generic','models/schema.yml','dbt_utils_accepted_range_fact__ab95ce5efc2942df5577b5b2fa1f8d29.sql','2025-07-05 15:17:37','d2fa8b1ebdc64760fab1d8d225715ad7','validity')
  
[0m16:17:38.063383 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.001 seconds
[0m16:17:38.067078 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.067387 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
        begin transaction;
        
            delete from "podcast_analytics"."public_public"."dbt_tests"
            where
            metadata_hash is null
            or metadata_hash in (select metadata_hash from "dbt_tests__tmp_20250705151737978458161737984512");
        
        
            insert into "podcast_analytics"."public_public"."dbt_tests" select * from "dbt_tests__tmp_20250705151738041654161738042004";
        
        commit;
    
  
[0m16:17:38.069380 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:17:38.074061 [debug] [MainThread]: Applying DROP to: "dbt_tests__tmp_20250705151737978458161737984512"
[0m16:17:38.076326 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.076551 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
drop table if exists "dbt_tests__tmp_20250705151737978458161737984512" cascade
[0m16:17:38.078581 [debug] [MainThread]: SQL status: DROP TABLE in 0.002 seconds
[0m16:17:38.080913 [debug] [MainThread]: Applying DROP to: "dbt_tests__tmp_20250705151738041654161738042004"
[0m16:17:38.081363 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.081570 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
drop table if exists "dbt_tests__tmp_20250705151738041654161738042004" cascade
[0m16:17:38.083110 [debug] [MainThread]: SQL status: DROP TABLE in 0.001 seconds
[0m16:17:38.083678 [debug] [MainThread]: Elementary: Finished deleting from and inserting to: "podcast_analytics"."public_public"."dbt_tests"
[0m16:17:38.084499 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:
[0m16:17:38.084886 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00.029998 (1 runs)
[0m16:17:38.085276 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.get_columns_in_relation: 0:00:00.021927 (2 runs)
[0m16:17:38.085636 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.000399 (2 runs)
[0m16:17:38.086039 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.015689 (2 runs)
[0m16:17:38.086403 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.get_insert_rows_queries: 0:00:00.019641 (2 runs)
[0m16:17:38.086753 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.run_insert_rows_query: 0:00:00.004953 (2 runs)
[0m16:17:38.087109 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows: 0:00:00.055669 (2 runs)
[0m16:17:38.087477 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.145267 (1 runs)
[0m16:17:38.089994 [debug] [MainThread]: Elementary: [dbt_sources] Flattening the artifacts.
[0m16:17:38.099378 [debug] [MainThread]: Elementary: [dbt_sources] Flattened 3 artifacts.
[0m16:17:38.100134 [debug] [MainThread]: Elementary: [dbt_sources] Comparing the artifacts state.
[0m16:17:38.100530 [debug] [MainThread]: Elementary: [dbt_sources] Artifacts did not change.
[0m16:17:38.101122 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:
[0m16:17:38.101493 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.008849 (1 runs)
[0m16:17:38.101855 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.011114 (1 runs)
[0m16:17:38.104210 [debug] [MainThread]: Elementary: [dbt_snapshots] Flattening the artifacts.
[0m16:17:38.104916 [debug] [MainThread]: Elementary: [dbt_snapshots] Flattened 0 artifacts.
[0m16:17:38.105609 [debug] [MainThread]: Elementary: [dbt_snapshots] Comparing the artifacts state.
[0m16:17:38.105979 [debug] [MainThread]: Elementary: [dbt_snapshots] Artifacts did not change.
[0m16:17:38.106521 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:
[0m16:17:38.106935 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00.000223 (1 runs)
[0m16:17:38.107291 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.002294 (1 runs)
[0m16:17:38.109536 [debug] [MainThread]: Elementary: [dbt_metrics] Flattening the artifacts.
[0m16:17:38.110226 [debug] [MainThread]: Elementary: [dbt_metrics] Flattened 0 artifacts.
[0m16:17:38.110868 [debug] [MainThread]: Elementary: [dbt_metrics] Comparing the artifacts state.
[0m16:17:38.111282 [debug] [MainThread]: Elementary: [dbt_metrics] Artifacts did not change.
[0m16:17:38.111827 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:
[0m16:17:38.112190 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00.000150 (1 runs)
[0m16:17:38.112586 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.002280 (1 runs)
[0m16:17:38.114885 [debug] [MainThread]: Elementary: [dbt_exposures] Flattening the artifacts.
[0m16:17:38.115579 [debug] [MainThread]: Elementary: [dbt_exposures] Flattened 0 artifacts.
[0m16:17:38.116214 [debug] [MainThread]: Elementary: [dbt_exposures] Comparing the artifacts state.
[0m16:17:38.116732 [debug] [MainThread]: Elementary: [dbt_exposures] Artifacts did not change.
[0m16:17:38.117270 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:
[0m16:17:38.117631 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00.000149 (1 runs)
[0m16:17:38.118030 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.002372 (1 runs)
[0m16:17:38.120262 [debug] [MainThread]: Elementary: [dbt_seeds] Flattening the artifacts.
[0m16:17:38.127353 [debug] [MainThread]: Elementary: [dbt_seeds] Flattened 2 artifacts.
[0m16:17:38.128021 [debug] [MainThread]: Elementary: [dbt_seeds] Comparing the artifacts state.
[0m16:17:38.128447 [debug] [MainThread]: Elementary: [dbt_seeds] Artifacts did not change.
[0m16:17:38.128989 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:
[0m16:17:38.129351 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00.006595 (1 runs)
[0m16:17:38.129747 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.008708 (1 runs)
[0m16:17:38.132137 [debug] [MainThread]: Elementary: [dbt_columns] Flattening the artifacts.
[0m16:17:38.214315 [debug] [MainThread]: Elementary: [dbt_columns] Flattened 104 artifacts.
[0m16:17:38.215285 [debug] [MainThread]: Elementary: [dbt_columns] Comparing the artifacts state.
[0m16:17:38.215927 [debug] [MainThread]: Elementary: [dbt_columns] Artifacts did not change.
[0m16:17:38.216538 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:
[0m16:17:38.216930 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:00.081566 (1 runs)
[0m16:17:38.217349 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:00.084367 (1 runs)
[0m16:17:38.217767 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m16:17:38.220030 [debug] [MainThread]: Elementary: Uploading run results.
[0m16:17:38.220535 [debug] [MainThread]: Elementary: [dbt_run_results] Flattening the artifacts.
[0m16:17:38.241045 [debug] [MainThread]: Elementary: [dbt_run_results] Flattened 24 artifacts.
[0m16:17:38.243799 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.244044 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_run_results'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:17:38.254297 [debug] [MainThread]: SQL status: SELECT 22 in 0.010 seconds
[0m16:17:38.255598 [debug] [MainThread]: Elementary: Inserting 24 rows to table "podcast_analytics"."public_public"."dbt_run_results"
[0m16:17:38.403811 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:17:38.404515 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.405291 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."dbt_run_results"
         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values
    ('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'accepted_values_fact_user_events__Event_Type___play__pause__seek__complete',NULL,'pass','test',0.26694798469543457,'2025-07-05T15:17:37.182127Z','2025-07-05T15:17:37.384933Z','2025-07-05T15:17:37.127628Z','2025-07-05T15:17:37.172860Z',1,False,'
    
    

with all_values as (

    select
        "Event Type" as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by "Event Type"

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'accepted_values_stg_user_events_event_type__play__pause__seek__complete',NULL,'pass','test',0.27135372161865234,'2025-07-05T15:17:37.184908Z','2025-07-05T15:17:37.390947Z','2025-07-05T15:17:37.131374Z','2025-07-05T15:17:37.181668Z',1,False,'
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue',NULL,'pass','test',0.2710230350494385,'2025-07-05T15:17:37.187672Z','2025-07-05T15:17:37.388055Z','2025-07-05T15:17:37.167847Z','2025-07-05T15:17:37.186840Z',1,False,'
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    ''missing_event_type'',''invalid_event_type'',''missing_timestamp'',''malformed_timestamp'',''missing_user_id'',''missing_episode_id'',''other_issue''
)


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699','test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp','Got 4860 results, configured to fail if != 0','fail','test',0.2727491855621338,'2025-07-05T15:17:37.202421Z','2025-07-05T15:17:37.395990Z','2025-07-05T15:17:37.173293Z','2025-07-05T15:17:37.187447Z',1,False,'

with meet_condition as(
  select *
  from "podcast_analytics"."public"."fact_user_events"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don''t meet the rule.
    or not "Event Timestamp" >= ''2025-03-01''::timestamp
)

select *
from validation_errors

',4860,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'not_null_dim_episodes__Episode_ID_',NULL,'pass','test',0.10244917869567871,'2025-07-05T15:17:37.425472Z','2025-07-05T15:17:37.502907Z','2025-07-05T15:17:37.409320Z','2025-07-05T15:17:37.421442Z',1,False,'
    
    



select "Episode ID"
from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'not_null_dim_episodes__Podcast_ID_',NULL,'pass','test',0.11065411567687988,'2025-07-05T15:17:37.467669Z','2025-07-05T15:17:37.509881Z','2025-07-05T15:17:37.412742Z','2025-07-05T15:17:37.425101Z',1,False,'
    
    



select "Podcast ID"
from "podcast_analytics"."public"."dim_episodes"
where "Podcast ID" is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'not_null_dim_episodes__Duration_seconds_',NULL,'pass','test',0.11866426467895508,'2025-07-05T15:17:37.417344Z','2025-07-05T15:17:37.513590Z','2025-07-05T15:17:37.403302Z','2025-07-05T15:17:37.416598Z',1,False,'
    
    



select "Duration (seconds)"
from "podcast_analytics"."public"."dim_episodes"
where "Duration (seconds)" is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'not_null_dim_users__User_ID_',NULL,'pass','test',0.11184000968933105,'2025-07-05T15:17:37.473264Z','2025-07-05T15:17:37.517475Z','2025-07-05T15:17:37.421737Z','2025-07-05T15:17:37.472423Z',1,False,'
    
    



select "User ID"
from "podcast_analytics"."public"."dim_users"
where "User ID" is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'not_null_fact_user_events__Episode_ID_',NULL,'pass','test',0.05774521827697754,'2025-07-05T15:17:37.526118Z','2025-07-05T15:17:37.570451Z','2025-07-05T15:17:37.519508Z','2025-07-05T15:17:37.525017Z',1,False,'
    
    



select "Episode ID"
from "podcast_analytics"."public"."fact_user_events"
where "Episode ID" is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'not_null_fact_user_events__User_ID_',NULL,'pass','test',0.06512308120727539,'2025-07-05T15:17:37.556662Z','2025-07-05T15:17:37.590849Z','2025-07-05T15:17:37.541472Z','2025-07-05T15:17:37.555816Z',1,False,'
    
    



select "User ID"
from "podcast_analytics"."public"."fact_user_events"
where "User ID" is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'not_null_fact_user_events__Event_ID_',NULL,'pass','test',0.06923699378967285,'2025-07-05T15:17:37.545660Z','2025-07-05T15:17:37.594529Z','2025-07-05T15:17:37.533779Z','2025-07-05T15:17:37.541195Z',1,False,'
    
    



select "Event ID"
from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'not_null_fact_user_events__Event_Timestamp_',NULL,'pass','test',0.06920981407165527,'2025-07-05T15:17:37.550659Z','2025-07-05T15:17:37.598103Z','2025-07-05T15:17:37.537423Z','2025-07-05T15:17:37.550165Z',1,False,'
    
    



select "Event Timestamp"
from "podcast_analytics"."public"."fact_user_events"
where "Event Timestamp" is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'not_null_stg_episodes_episode_id',NULL,'pass','test',0.0627741813659668,'2025-07-05T15:17:37.577921Z','2025-07-05T15:17:37.624652Z','2025-07-05T15:17:37.573704Z','2025-07-05T15:17:37.577558Z',1,False,'
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'not_null_stg_episodes_podcast_id',NULL,'pass','test',0.06010103225708008,'2025-07-05T15:17:37.609737Z','2025-07-05T15:17:37.660052Z','2025-07-05T15:17:37.603248Z','2025-07-05T15:17:37.609041Z',1,False,'
    
    



select podcast_id
from "podcast_analytics"."public"."stg_episodes"
where podcast_id is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'not_null_stg_user_events_episode_id',NULL,'pass','test',0.06905484199523926,'2025-07-05T15:17:37.625981Z','2025-07-05T15:17:37.670694Z','2025-07-05T15:17:37.614815Z','2025-07-05T15:17:37.625395Z',1,False,'
    
    



select episode_id
from "podcast_analytics"."public"."stg_user_events"
where episode_id is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'not_null_stg_user_events_event_ts',NULL,'pass','test',0.10009407997131348,'2025-07-05T15:17:37.644161Z','2025-07-05T15:17:37.733767Z','2025-07-05T15:17:37.639746Z','2025-07-05T15:17:37.643759Z',1,False,'
    
    



select event_ts
from "podcast_analytics"."public"."stg_user_events"
where event_ts is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'not_null_stg_user_events_event_id',NULL,'pass','test',0.13138413429260254,'2025-07-05T15:17:37.631300Z','2025-07-05T15:17:37.737133Z','2025-07-05T15:17:37.617905Z','2025-07-05T15:17:37.630379Z',1,False,'
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'not_null_stg_user_events_user_id',NULL,'pass','test',0.09962797164916992,'2025-07-05T15:17:37.672461Z','2025-07-05T15:17:37.751131Z','2025-07-05T15:17:37.663480Z','2025-07-05T15:17:37.671663Z',1,False,'
    
    



select user_id
from "podcast_analytics"."public"."stg_user_events"
where user_id is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'not_null_stg_users_user_id',NULL,'pass','test',0.10682296752929688,'2025-07-05T15:17:37.684390Z','2025-07-05T15:17:37.780319Z','2025-07-05T15:17:37.680120Z','2025-07-05T15:17:37.684131Z',1,False,'
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_',NULL,'pass','test',0.06517386436462402,'2025-07-05T15:17:37.756281Z','2025-07-05T15:17:37.798365Z','2025-07-05T15:17:37.742991Z','2025-07-05T15:17:37.755633Z',1,False,'
    
    

with child as (
    select "Episode ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "Episode ID" is not null
),

parent as (
    select "Episode ID" as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'relationships_fact_user_events__User_ID____User_ID___ref_dim_users_',NULL,'pass','test',0.061070919036865234,'2025-07-05T15:17:37.763465Z','2025-07-05T15:17:37.801661Z','2025-07-05T15:17:37.751827Z','2025-07-05T15:17:37.762744Z',1,False,'
    
    

with child as (
    select "User ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "User ID" is not null
),

parent as (
    select "User ID" as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'unique_dim_episodes__Episode_ID_',NULL,'pass','test',0.058277130126953125,'2025-07-05T15:17:37.781084Z','2025-07-05T15:17:37.827773Z','2025-07-05T15:17:37.771689Z','2025-07-05T15:17:37.780743Z',1,False,'
    
    

select
    "Episode ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is not null
group by "Episode ID"
having count(*) > 1


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'unique_dim_users__User_ID_',NULL,'pass','test',0.058321237564086914,'2025-07-05T15:17:37.802493Z','2025-07-05T15:17:37.845694Z','2025-07-05T15:17:37.790725Z','2025-07-05T15:17:37.802079Z',1,False,'
    
    

select
    "User ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where "User ID" is not null
group by "User ID"
having count(*) > 1


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','0b9d08b8-672b-406f-b801-9721de1ba7ca','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'unique_fact_user_events__Event_ID_',NULL,'pass','test',0.043044090270996094,'2025-07-05T15:17:37.816066Z','2025-07-05T15:17:37.850983Z','2025-07-05T15:17:37.811059Z','2025-07-05T15:17:37.815793Z',1,False,'
    
    

select
    "Event ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is not null
group by "Event ID"
having count(*) > 1


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}')
  
[0m16:17:38.415917 [debug] [MainThread]: SQL status: INSERT 0 24 in 0.010 seconds
[0m16:17:38.416903 [debug] [MainThread]: On master: COMMIT
[0m16:17:38.417135 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.417340 [debug] [MainThread]: On master: COMMIT
[0m16:17:38.419340 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:17:38.420398 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:
[0m16:17:38.420809 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.019883 (1 runs)
[0m16:17:38.421203 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.013552 (1 runs)
[0m16:17:38.421658 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.000229 (1 runs)
[0m16:17:38.422046 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.144209 (24 runs)
[0m16:17:38.422427 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.147520 (1 runs)
[0m16:17:38.422808 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.012364 (1 runs)
[0m16:17:38.423193 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.commit: 0:00:00.002838 (1 runs)
[0m16:17:38.423604 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:00.178062 (1 runs)
[0m16:17:38.423969 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:00.199731 (1 runs)
[0m16:17:38.424346 [debug] [MainThread]: Elementary: Uploaded run results successfully.
[0m16:17:38.429119 [debug] [MainThread]: Elementary: Handling test results.
[0m16:17:38.445192 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.445434 [debug] [MainThread]: On master: BEGIN
[0m16:17:38.447473 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:17:38.447660 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.447851 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'test_result_rows'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:17:38.454162 [debug] [MainThread]: SQL status: SELECT 4 in 0.006 seconds
[0m16:17:38.455211 [debug] [MainThread]: Elementary: Inserting 5 rows to table "podcast_analytics"."public_public"."test_result_rows"
[0m16:17:38.469209 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:17:38.469776 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.470036 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."test_result_rows"
         (elementary_test_results_id,result_row,detected_at,created_at) values
    ('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699','{"event id": "00079a1f16d4f976c0a3c1a94eb98f8a", "event timestamp": "2024-03-20T15:53:21", "user id": "user_79", "episode id": "ep_10", "event type": "pause", "duration": null}',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699','{"event id": "00218ce34b5b728c21bdb1e1b596810c", "event timestamp": "2024-01-07T12:23:23", "user id": "user_42", "episode id": "ep_42", "event type": "complete", "duration": 4448}',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699','{"event id": "0023e48526d356681c1d4d03ae5abebb", "event timestamp": "2024-03-18T21:38:08", "user id": "user_75", "episode id": "ep_46", "event type": "seek", "duration": null}',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699','{"event id": "002e523b0d4c98ae551f050c1721b4bc", "event timestamp": "2024-04-13T15:21:08", "user id": "user_10", "episode id": "ep_15", "event type": "complete", "duration": 2346}',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699','{"event id": "002fb22b10545efb61c6d043ff803727", "event timestamp": "2024-01-19T15:07:18", "user id": "user_47", "episode id": "ep_32", "event type": "complete", "duration": 1761}',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
)
  
[0m16:17:38.473984 [debug] [MainThread]: SQL status: INSERT 0 5 in 0.004 seconds
[0m16:17:38.474807 [debug] [MainThread]: On master: COMMIT
[0m16:17:38.475006 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.475182 [debug] [MainThread]: On master: COMMIT
[0m16:17:38.476936 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:17:38.479849 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.480050 [debug] [MainThread]: On master: BEGIN
[0m16:17:38.481039 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:17:38.481226 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.481454 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'elementary_test_results'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:17:38.487094 [debug] [MainThread]: SQL status: SELECT 28 in 0.005 seconds
[0m16:17:38.488306 [debug] [MainThread]: Elementary: Inserting 24 rows to table "podcast_analytics"."public_public"."elementary_test_results"
[0m16:17:38.677907 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:17:38.678664 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.679622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."elementary_test_results"
         (id,data_issue_id,test_execution_id,test_unique_id,model_unique_id,invocation_id,detected_at,created_at,database_name,schema_name,table_name,column_name,test_type,test_sub_type,test_results_description,owners,tags,test_results_query,other,test_name,test_params,severity,status,failures,test_short_name,test_alias,result_rows,failed_row_count) values
    ('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','model.podcast_analytics.fact_user_events','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event Type"','dbt_test','generic',NULL,'[]','[]','
    
    

with all_values as (

    select
        "Event Type" as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by "Event Type"

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',NULL,'accepted_values_fact_user_events__Event_Type___play__pause__seek__complete','{"values": ["play", "pause", "seek", "complete"], "column_name": "\"Event Type\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'accepted_values','accepted_values_fact_user_even_fbc631ab6baad050aa8d81cbe6f1af99',NULL,NULL),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','model.podcast_analytics.stg_user_events','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','event_type','dbt_test','generic',NULL,'[]','[]','
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',NULL,'accepted_values_stg_user_events_event_type__play__pause__seek__complete','{"values": ["play", "pause", "seek", "complete"], "column_name": "event_type", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'accepted_values','accepted_values_stg_user_event_94634d24690dcf7d4e511df98c6e0582',NULL,NULL),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','model.podcast_analytics.stg_user_events_invalid','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events_invalid','issue_type','dbt_test','generic',NULL,'[]','[]','
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    ''missing_event_type'',''invalid_event_type'',''missing_timestamp'',''malformed_timestamp'',''missing_user_id'',''missing_episode_id'',''other_issue''
)


',NULL,'accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue','{"values": ["missing_event_type", "invalid_event_type", "missing_timestamp", "malformed_timestamp", "missing_user_id", "missing_episode_id", "other_issue"], "column_name": "issue_type", "model": "{{ get_where_subquery(ref(''stg_user_events_invalid'')) }}"}','ERROR','pass',0,'accepted_values','accepted_values_stg_user_event_43bb633c97e04e462eb7fee334f302ba',NULL,NULL),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699','test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp.22c2445699','model.podcast_analytics.fact_user_events','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event Timestamp"','dbt_test','generic','Got 4860 results, configured to fail if != 0','[]','[]','

with meet_condition as(
  select *
  from "podcast_analytics"."public"."fact_user_events"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don''t meet the rule.
    or not "Event Timestamp" >= ''2025-03-01''::timestamp
)

select *
from validation_errors

',NULL,'dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp','{"min_value": "''2025-03-01''::timestamp", "inclusive": true, "column_name": "\"Event Timestamp\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','fail',4860,'accepted_range','dbt_utils_accepted_range_fact__ab95ce5efc2942df5577b5b2fa1f8d29',NULL,4860),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','model.podcast_analytics.dim_episodes','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Episode ID"
from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is null


',NULL,'not_null_dim_episodes__Episode_ID_','{"column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_episodes__Episode_ID_',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','model.podcast_analytics.dim_episodes','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Podcast ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Podcast ID"
from "podcast_analytics"."public"."dim_episodes"
where "Podcast ID" is null


',NULL,'not_null_dim_episodes__Podcast_ID_','{"column_name": "\"Podcast ID\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_episodes__Podcast_ID_',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','model.podcast_analytics.dim_episodes','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Duration (seconds)"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Duration (seconds)"
from "podcast_analytics"."public"."dim_episodes"
where "Duration (seconds)" is null


',NULL,'not_null_dim_episodes__Duration_seconds_','{"column_name": "\"Duration (seconds)\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_episodes__Duration_seconds_',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','model.podcast_analytics.dim_users','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_users','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "User ID"
from "podcast_analytics"."public"."dim_users"
where "User ID" is null


',NULL,'not_null_dim_users__User_ID_','{"column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''dim_users'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_users__User_ID_',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','model.podcast_analytics.fact_user_events','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Episode ID"
from "podcast_analytics"."public"."fact_user_events"
where "Episode ID" is null


',NULL,'not_null_fact_user_events__Episode_ID_','{"column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__Episode_ID_',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','model.podcast_analytics.fact_user_events','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "User ID"
from "podcast_analytics"."public"."fact_user_events"
where "User ID" is null


',NULL,'not_null_fact_user_events__User_ID_','{"column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__User_ID_',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','model.podcast_analytics.fact_user_events','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Event ID"
from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is null


',NULL,'not_null_fact_user_events__Event_ID_','{"column_name": "\"Event ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__Event_ID_',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','model.podcast_analytics.fact_user_events','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event Timestamp"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Event Timestamp"
from "podcast_analytics"."public"."fact_user_events"
where "Event Timestamp" is null


',NULL,'not_null_fact_user_events__Event_Timestamp_','{"column_name": "\"Event Timestamp\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__Event_Timestamp_',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','model.podcast_analytics.stg_episodes','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_episodes','episode_id','dbt_test','generic',NULL,'[]','[]','
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null


',NULL,'not_null_stg_episodes_episode_id','{"column_name": "episode_id", "model": "{{ get_where_subquery(ref(''stg_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_episodes_episode_id',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','model.podcast_analytics.stg_episodes','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_episodes','podcast_id','dbt_test','generic',NULL,'[]','[]','
    
    



select podcast_id
from "podcast_analytics"."public"."stg_episodes"
where podcast_id is null


',NULL,'not_null_stg_episodes_podcast_id','{"column_name": "podcast_id", "model": "{{ get_where_subquery(ref(''stg_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_episodes_podcast_id',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','model.podcast_analytics.stg_user_events','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','episode_id','dbt_test','generic',NULL,'[]','[]','
    
    



select episode_id
from "podcast_analytics"."public"."stg_user_events"
where episode_id is null


',NULL,'not_null_stg_user_events_episode_id','{"column_name": "episode_id", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_episode_id',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','model.podcast_analytics.stg_user_events','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','event_ts','dbt_test','generic',NULL,'[]','[]','
    
    



select event_ts
from "podcast_analytics"."public"."stg_user_events"
where event_ts is null


',NULL,'not_null_stg_user_events_event_ts','{"column_name": "event_ts", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_event_ts',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','model.podcast_analytics.stg_user_events','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','event_id','dbt_test','generic',NULL,'[]','[]','
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null


',NULL,'not_null_stg_user_events_event_id','{"column_name": "event_id", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_event_id',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_user_events_user_id.82058db005',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','model.podcast_analytics.stg_user_events','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','user_id','dbt_test','generic',NULL,'[]','[]','
    
    



select user_id
from "podcast_analytics"."public"."stg_user_events"
where user_id is null


',NULL,'not_null_stg_user_events_user_id','{"column_name": "user_id", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_user_id',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','model.podcast_analytics.stg_users','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_users','user_id','dbt_test','generic',NULL,'[]','[]','
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null


',NULL,'not_null_stg_users_user_id','{"column_name": "user_id", "model": "{{ get_where_subquery(ref(''stg_users'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_users_user_id',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','model.podcast_analytics.fact_user_events','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    

with child as (
    select "Episode ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "Episode ID" is not null
),

parent as (
    select "Episode ID" as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',NULL,'relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_','{"to": "ref(''dim_episodes'')", "field": "\"Episode ID\"", "column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'relationships','relationships_fact_user_events_a5d0f4791bd5f2dd7a1079d5e9d2dc3a',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','model.podcast_analytics.fact_user_events','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    

with child as (
    select "User ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "User ID" is not null
),

parent as (
    select "User ID" as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',NULL,'relationships_fact_user_events__User_ID____User_ID___ref_dim_users_','{"to": "ref(''dim_users'')", "field": "\"User ID\"", "column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'relationships','relationships_fact_user_events_18a41013c7410998f321251d32b88faf',NULL,0),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','model.podcast_analytics.dim_episodes','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    

select
    "Episode ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is not null
group by "Episode ID"
having count(*) > 1


',NULL,'unique_dim_episodes__Episode_ID_','{"column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'unique','unique_dim_episodes__Episode_ID_',NULL,NULL),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','model.podcast_analytics.dim_users','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_users','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    

select
    "User ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where "User ID" is not null
group by "User ID"
having count(*) > 1


',NULL,'unique_dim_users__User_ID_','{"column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''dim_users'')) }}"}','ERROR','pass',0,'unique','unique_dim_users__User_ID_',NULL,NULL),('0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a',NULL,'0b9d08b8-672b-406f-b801-9721de1ba7ca.test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','model.podcast_analytics.fact_user_events','0b9d08b8-672b-406f-b801-9721de1ba7ca',cast('2025-07-05 15:17:37' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event ID"','dbt_test','generic',NULL,'[]','[]','
    
    

select
    "Event ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is not null
group by "Event ID"
having count(*) > 1


',NULL,'unique_fact_user_events__Event_ID_','{"column_name": "\"Event ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'unique','unique_fact_user_events__Event_ID_',NULL,NULL)
  
[0m16:17:38.687746 [debug] [MainThread]: SQL status: INSERT 0 24 in 0.007 seconds
[0m16:17:38.688978 [debug] [MainThread]: On master: COMMIT
[0m16:17:38.689208 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.689399 [debug] [MainThread]: On master: COMMIT
[0m16:17:38.692069 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:17:38.692798 [debug] [MainThread]: Elementary: Handled test results successfully.
[0m16:17:38.701051 [debug] [MainThread]: Elementary: Uploading dbt invocation.
[0m16:17:38.730027 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.730282 [debug] [MainThread]: On master: BEGIN
[0m16:17:38.732759 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:17:38.732991 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.733197 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_invocations'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:17:38.744158 [debug] [MainThread]: SQL status: SELECT 35 in 0.011 seconds
[0m16:17:38.745561 [debug] [MainThread]: Elementary: Inserting 1 rows to table "podcast_analytics"."public_public"."dbt_invocations"
[0m16:17:38.756250 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:17:38.756784 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.757009 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."dbt_invocations"
         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values
    ('0b9d08b8-672b-406f-b801-9721de1ba7ca',NULL,NULL,NULL,'2025-07-05 15:17:36','2025-07-05 15:17:38','2025-07-05 15:17:38',
    current_timestamp::timestamp
,'test','1.10.3','0.18.2',False,'{}','{}','local','podcast_analytics','public','podcast_analytics',4,'[]',NULL,NULL,'podcast_analytics',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'{"user": "podcast"}')
  
[0m16:17:38.760528 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.003 seconds
[0m16:17:38.761381 [debug] [MainThread]: On master: COMMIT
[0m16:17:38.761603 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:38.761789 [debug] [MainThread]: On master: COMMIT
[0m16:17:38.765135 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m16:17:38.765887 [debug] [MainThread]: Elementary: Uploaded dbt invocation successfully.
[0m16:17:38.769226 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m16:17:38.770059 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]
[0m16:17:38.770363 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-end.0 ........................................ [[32mOK[0m in 0.90s]
[0m16:17:38.770573 [debug] [MainThread]: On master: Close
[0m16:17:38.770821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:38.770982 [debug] [MainThread]: Connection 'test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24' was properly closed.
[0m16:17:38.771132 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a' was properly closed.
[0m16:17:38.771280 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a' was properly closed.
[0m16:17:38.771420 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de' was properly closed.
[0m16:17:38.771641 [info ] [MainThread]: 
[0m16:17:38.771830 [info ] [MainThread]: Finished running 2 project hooks, 24 data tests in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m16:17:38.773686 [debug] [MainThread]: Command end result
[0m16:17:38.857765 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m16:17:38.859078 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m16:17:38.863391 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m16:17:38.863622 [info ] [MainThread]: 
[0m16:17:38.863848 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:17:38.864086 [info ] [MainThread]: 
[0m16:17:38.864345 [error] [MainThread]: [31mFailure in test dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2025_03_01_timestamp (models/schema.yml)[0m
[0m16:17:38.864580 [error] [MainThread]:   Got 4860 results, configured to fail if != 0
[0m16:17:38.864773 [info ] [MainThread]: 
[0m16:17:38.865040 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/schema.yml/dbt_utils_accepted_range_fact__ab95ce5efc2942df5577b5b2fa1f8d29.sql
[0m16:17:38.865251 [info ] [MainThread]: 
[0m16:17:38.865449 [info ] [MainThread]: Done. PASS=25 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=26
[0m16:17:38.865804 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageMaterializationOverrideDeprecation: 24 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:17:38.868101 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.8136482, "process_in_blocks": "0", "process_kernel_time": 0.251522, "process_mem_max_rss": "148537344", "process_out_blocks": "0", "process_user_time": 3.01231}
[0m16:17:38.868372 [debug] [MainThread]: Command `dbt test` failed at 16:17:38.868325 after 2.81 seconds
[0m16:17:38.868611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075cb4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9ace0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9ae90>]}
[0m16:17:38.868843 [debug] [MainThread]: Flushing usage events
[0m16:17:39.236084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:20:55.738577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105947460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10689bf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10689b820>]}


============================== 16:20:55.741712 | 5c3892a4-25ff-4c38-aba8-fbdf2305a62d ==============================
[0m16:20:55.741712 [info ] [MainThread]: Running with dbt=1.10.3
[0m16:20:55.742082 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/samydoreau/global-assignment', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir /Users/samydoreau/global-assignment', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:20:55.863600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c3892a4-25ff-4c38-aba8-fbdf2305a62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d40850>]}
[0m16:20:55.894894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c3892a4-25ff-4c38-aba8-fbdf2305a62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106899c00>]}
[0m16:20:55.895546 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:20:55.965307 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m16:20:56.163898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:20:56.164664 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/schema.yml
[0m16:20:56.428397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c3892a4-25ff-4c38-aba8-fbdf2305a62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dec4f0>]}
[0m16:20:56.556821 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m16:20:56.558563 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m16:20:56.577884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c3892a4-25ff-4c38-aba8-fbdf2305a62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ddb8b0>]}
[0m16:20:56.578238 [info ] [MainThread]: Found 39 models, 2 seeds, 2 operations, 24 data tests, 3 sources, 1248 macros
[0m16:20:56.578453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c3892a4-25ff-4c38-aba8-fbdf2305a62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd8ee0>]}
[0m16:20:56.580038 [info ] [MainThread]: 
[0m16:20:56.580246 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m16:20:56.580415 [info ] [MainThread]: 
[0m16:20:56.580712 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:56.584276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m16:20:56.584775 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public_public'
[0m16:20:56.621498 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public_public"
[0m16:20:56.621816 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m16:20:56.622025 [debug] [ThreadPool]: On list_podcast_analytics_public_public: BEGIN
[0m16:20:56.622214 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m16:20:56.622393 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:56.622563 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:56.665211 [debug] [ThreadPool]: SQL status: BEGIN in 0.043 seconds
[0m16:20:56.665533 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public_public"
[0m16:20:56.665742 [debug] [ThreadPool]: On list_podcast_analytics_public_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public_public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public_public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public_public'
  
[0m16:20:56.667289 [debug] [ThreadPool]: SQL status: BEGIN in 0.045 seconds
[0m16:20:56.667625 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m16:20:56.667839 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m16:20:56.674944 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.007 seconds
[0m16:20:56.675933 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m16:20:56.676155 [debug] [ThreadPool]: SQL status: SELECT 29 in 0.010 seconds
[0m16:20:56.677156 [debug] [ThreadPool]: On list_podcast_analytics_public_public: ROLLBACK
[0m16:20:56.677378 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m16:20:56.679039 [debug] [ThreadPool]: On list_podcast_analytics_public_public: Close
[0m16:20:56.685794 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:56.686041 [debug] [MainThread]: On master: BEGIN
[0m16:20:56.686210 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:56.698681 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:20:56.698996 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:56.699255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:56.720369 [debug] [MainThread]: SQL status: SELECT 55 in 0.021 seconds
[0m16:20:56.724663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c3892a4-25ff-4c38-aba8-fbdf2305a62d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ddabf0>]}
[0m16:20:56.725005 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:56.725908 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:56.726133 [debug] [MainThread]: On master: BEGIN
[0m16:20:56.727424 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:20:56.727620 [debug] [MainThread]: On master: COMMIT
[0m16:20:56.727802 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:56.727974 [debug] [MainThread]: On master: COMMIT
[0m16:20:56.728641 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m16:20:56.748933 [debug] [MainThread]: Elementary: Materialization override is enabled.
[0m16:20:56.766623 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:56.766916 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    select count(*) from pg_namespace where nspname = 'public_public__tests'
  
[0m16:20:56.768168 [debug] [MainThread]: SQL status: SELECT 1 in 0.001 seconds
[0m16:20:56.769568 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-start-0"
[0m16:20:56.772877 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-start.0 ................................... [RUN]
[0m16:20:56.773200 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-start.0 ...................................... [[32mOK[0m in 0.04s]
[0m16:20:56.773404 [info ] [MainThread]: 
[0m16:20:56.773601 [debug] [MainThread]: On master: Close
[0m16:20:56.775563 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:20:56.775813 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:20:56.776276 [debug] [Thread-3 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:20:56.776083 [info ] [Thread-1 (]: 1 of 24 START test accepted_values_fact_user_events__Event_Type___play__pause__seek__complete  [RUN]
[0m16:20:56.776559 [debug] [Thread-4 (]: Began running node test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc
[0m16:20:56.776784 [info ] [Thread-2 (]: 2 of 24 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m16:20:56.776990 [info ] [Thread-3 (]: 3 of 24 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [RUN]
[0m16:20:56.777339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8)
[0m16:20:56.777565 [info ] [Thread-4 (]: 4 of 24 START test dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp  [RUN]
[0m16:20:56.777824 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m16:20:56.778123 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7'
[0m16:20:56.778359 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:20:56.778618 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc'
[0m16:20:56.778825 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:20:56.779040 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:20:56.782519 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:20:56.782900 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc
[0m16:20:56.786816 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:20:56.791475 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:20:56.795121 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc"
[0m16:20:56.795650 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:20:56.798076 [warn ] [Thread-1 (]: [[33mWARNING[0m]: Installed package 'elementary' is overriding the built-in
materialization 'test'. Overrides of built-in materializations from installed
packages will be deprecated in future versions of dbt. For more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m16:20:56.798525 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:20:56.798761 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:20:56.798941 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5c3892a4-25ff-4c38-aba8-fbdf2305a62d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108267190>]}
[0m16:20:56.799148 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc
[0m16:20:56.800912 [warn ] [Thread-2 (]: [[33mWARNING[0m]: Installed package 'elementary' is overriding the built-in
materialization 'test'. Overrides of built-in materializations from installed
packages will be deprecated in future versions of dbt. For more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m16:20:56.802692 [warn ] [Thread-3 (]: [[33mWARNING[0m]: Installed package 'elementary' is overriding the built-in
materialization 'test'. Overrides of built-in materializations from installed
packages will be deprecated in future versions of dbt. For more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m16:20:56.805028 [warn ] [Thread-4 (]: [[33mWARNING[0m]: Installed package 'elementary' is overriding the built-in
materialization 'test'. Overrides of built-in materializations from installed
packages will be deprecated in future versions of dbt. For more information:
https://docs.getdbt.com/reference/global-configs/legacy-behaviors
[0m16:20:56.824353 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5c3892a4-25ff-4c38-aba8-fbdf2305a62d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10828c160>]}
[0m16:20:56.849598 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5c3892a4-25ff-4c38-aba8-fbdf2305a62d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082e6140>]}
[0m16:20:56.880952 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5c3892a4-25ff-4c38-aba8-fbdf2305a62d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108320310>]}
[0m16:20:56.881168 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:20:56.883674 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:20:56.885969 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:20:56.888351 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc"
[0m16:20:56.888942 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:20:56.889247 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: BEGIN
[0m16:20:56.889488 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:56.890014 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc"
[0m16:20:56.890276 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc: BEGIN
[0m16:20:56.890512 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:20:56.890842 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:20:56.891074 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:20:56.891313 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m16:20:56.891556 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: BEGIN
[0m16:20:56.891866 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:20:56.892091 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:20:56.917645 [debug] [Thread-1 (]: SQL status: BEGIN in 0.028 seconds
[0m16:20:56.917970 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"
[0m16:20:56.918215 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        "Event Type" as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by "Event Type"

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m16:20:56.921221 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:20:56.936382 [debug] [Thread-4 (]: SQL status: BEGIN in 0.045 seconds
[0m16:20:56.936713 [debug] [Thread-2 (]: SQL status: BEGIN in 0.045 seconds
[0m16:20:56.937002 [debug] [Thread-3 (]: SQL status: BEGIN in 0.045 seconds
[0m16:20:56.946496 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: ROLLBACK
[0m16:20:56.946830 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc"
[0m16:20:56.947061 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m16:20:56.947282 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m16:20:56.947631 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  

with meet_condition as(
  select *
  from "podcast_analytics"."public"."fact_user_events"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.
    or not "Event Timestamp" >= '2024-01-01'::timestamp
)

select *
from validation_errors


  
  
      
    ) dbt_internal_test
[0m16:20:56.947951 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m16:20:56.948222 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','missing_timestamp','malformed_timestamp','missing_user_id','missing_episode_id','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m16:20:56.949138 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8: Close
[0m16:20:56.949510 [info ] [Thread-1 (]: 1 of 24 PASS accepted_values_fact_user_events__Event_Type___play__pause__seek__complete  [[32mPASS[0m in 0.17s]
[0m16:20:56.949840 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8
[0m16:20:56.950061 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:20:56.950276 [info ] [Thread-1 (]: 5 of 24 START test not_null_dim_episodes__Duration_seconds_ .................... [RUN]
[0m16:20:56.950581 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8, now test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444)
[0m16:20:56.950843 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:20:56.955279 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:20:56.957132 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:20:56.962289 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:20:56.962686 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.014 seconds
[0m16:20:56.966169 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc: ROLLBACK
[0m16:20:56.966699 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:20:56.967002 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: BEGIN
[0m16:20:56.967223 [debug] [Thread-4 (]: On test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc: Close
[0m16:20:56.967463 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:56.967887 [info ] [Thread-4 (]: 4 of 24 PASS dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp  [[32mPASS[0m in 0.19s]
[0m16:20:56.968402 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc
[0m16:20:56.968668 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:20:56.968918 [info ] [Thread-4 (]: 6 of 24 START test not_null_dim_episodes__Episode_ID_ .......................... [RUN]
[0m16:20:56.969204 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc, now test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc)
[0m16:20:56.969486 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:20:56.972783 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:20:56.973264 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:20:57.012042 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.063 seconds
[0m16:20:57.013111 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:20:57.013396 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.065 seconds
[0m16:20:57.016558 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: ROLLBACK
[0m16:20:57.016888 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m16:20:57.019845 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m16:20:57.020221 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"
[0m16:20:57.020482 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:20:57.020855 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Duration (seconds)"
from "podcast_analytics"."public"."dim_episodes"
where "Duration (seconds)" is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.021202 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: Close
[0m16:20:57.021421 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: BEGIN
[0m16:20:57.021629 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m16:20:57.021907 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:20:57.022246 [info ] [Thread-3 (]: 3 of 24 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [[32mPASS[0m in 0.24s]
[0m16:20:57.022700 [info ] [Thread-2 (]: 2 of 24 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.24s]
[0m16:20:57.023243 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m16:20:57.023671 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m16:20:57.023947 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:20:57.024265 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:20:57.024540 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:20:57.024859 [info ] [Thread-3 (]: 7 of 24 START test not_null_dim_episodes__Podcast_ID_ .......................... [RUN]
[0m16:20:57.028349 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: ROLLBACK
[0m16:20:57.028694 [info ] [Thread-2 (]: 8 of 24 START test not_null_dim_users__User_ID_ ................................ [RUN]
[0m16:20:57.029070 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7)
[0m16:20:57.029506 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba)
[0m16:20:57.029845 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:20:57.030159 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444: Close
[0m16:20:57.030418 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:20:57.033911 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:20:57.034546 [info ] [Thread-1 (]: 5 of 24 PASS not_null_dim_episodes__Duration_seconds_ .......................... [[32mPASS[0m in 0.08s]
[0m16:20:57.038188 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:20:57.038585 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m16:20:57.039208 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444
[0m16:20:57.039586 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"
[0m16:20:57.039906 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:20:57.040212 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:20:57.040481 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Episode ID"
from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.040740 [info ] [Thread-1 (]: 9 of 24 START test not_null_fact_user_events__Episode_ID_ ...................... [RUN]
[0m16:20:57.040965 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:20:57.045084 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:20:57.045455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444, now test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae)
[0m16:20:57.050322 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:20:57.050632 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:20:57.050949 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:20:57.054310 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: ROLLBACK
[0m16:20:57.057666 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:20:57.058035 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:20:57.058420 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:20:57.058731 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: BEGIN
[0m16:20:57.059021 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: BEGIN
[0m16:20:57.059252 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc: Close
[0m16:20:57.059517 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:20:57.059735 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:20:57.059963 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:20:57.064927 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:20:57.065334 [info ] [Thread-4 (]: 6 of 24 PASS not_null_dim_episodes__Episode_ID_ ................................ [[32mPASS[0m in 0.10s]
[0m16:20:57.065892 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc
[0m16:20:57.066164 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:20:57.066468 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:20:57.066703 [info ] [Thread-4 (]: 10 of 24 START test not_null_fact_user_events__Event_ID_ ....................... [RUN]
[0m16:20:57.066950 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: BEGIN
[0m16:20:57.067191 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc, now test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c)
[0m16:20:57.067414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:57.067630 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:20:57.071106 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:20:57.071634 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:20:57.077139 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:20:57.077714 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:20:57.077944 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: BEGIN
[0m16:20:57.078222 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:20:57.086206 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m16:20:57.086553 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"
[0m16:20:57.086895 [debug] [Thread-2 (]: SQL status: BEGIN in 0.027 seconds
[0m16:20:57.087197 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Episode ID"
from "podcast_analytics"."public"."fact_user_events"
where "Episode ID" is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.087494 [debug] [Thread-3 (]: SQL status: BEGIN in 0.027 seconds
[0m16:20:57.087843 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"
[0m16:20:57.088208 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"
[0m16:20:57.088476 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "User ID"
from "podcast_analytics"."public"."dim_users"
where "User ID" is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.088781 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Podcast ID"
from "podcast_analytics"."public"."dim_episodes"
where "Podcast ID" is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.090507 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m16:20:57.090809 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:20:57.091098 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"
[0m16:20:57.091328 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m16:20:57.094784 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: ROLLBACK
[0m16:20:57.095079 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Event ID"
from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.095301 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.006 seconds
[0m16:20:57.098219 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: ROLLBACK
[0m16:20:57.101344 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: ROLLBACK
[0m16:20:57.101630 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae: Close
[0m16:20:57.101928 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:20:57.102440 [info ] [Thread-1 (]: 9 of 24 PASS not_null_fact_user_events__Episode_ID_ ............................ [[32mPASS[0m in 0.06s]
[0m16:20:57.105681 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: ROLLBACK
[0m16:20:57.105894 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7: Close
[0m16:20:57.106134 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba: Close
[0m16:20:57.106591 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae
[0m16:20:57.107076 [info ] [Thread-3 (]: 7 of 24 PASS not_null_dim_episodes__Podcast_ID_ ................................ [[32mPASS[0m in 0.08s]
[0m16:20:57.107536 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd
[0m16:20:57.107888 [info ] [Thread-2 (]: 8 of 24 PASS not_null_dim_users__User_ID_ ...................................... [[32mPASS[0m in 0.08s]
[0m16:20:57.108194 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c: Close
[0m16:20:57.108524 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7
[0m16:20:57.108787 [info ] [Thread-1 (]: 11 of 24 START test not_null_fact_user_events__Event_Timestamp_ ................ [RUN]
[0m16:20:57.109121 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba
[0m16:20:57.109463 [info ] [Thread-4 (]: 10 of 24 PASS not_null_fact_user_events__Event_ID_ ............................. [[32mPASS[0m in 0.04s]
[0m16:20:57.109772 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:20:57.110079 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae, now test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd)
[0m16:20:57.110359 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:20:57.110652 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c
[0m16:20:57.110889 [info ] [Thread-3 (]: 12 of 24 START test not_null_fact_user_events__User_ID_ ........................ [RUN]
[0m16:20:57.111130 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd
[0m16:20:57.111341 [info ] [Thread-2 (]: 13 of 24 START test not_null_stg_episodes_episode_id ........................... [RUN]
[0m16:20:57.111583 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:20:57.111815 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7, now test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2)
[0m16:20:57.115304 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"
[0m16:20:57.115715 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba, now test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422)
[0m16:20:57.116025 [info ] [Thread-4 (]: 14 of 24 START test not_null_stg_episodes_podcast_id ........................... [RUN]
[0m16:20:57.116338 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:20:57.116708 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:20:57.117031 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c, now test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1)
[0m16:20:57.120429 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:20:57.124214 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:20:57.124546 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd
[0m16:20:57.124855 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:20:57.129297 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"
[0m16:20:57.133114 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:20:57.133552 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:20:57.133775 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:20:57.138231 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:20:57.138523 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"
[0m16:20:57.143007 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:20:57.143300 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:20:57.143611 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd: BEGIN
[0m16:20:57.147537 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:20:57.147792 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:20:57.148041 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:57.148299 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:20:57.148512 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: BEGIN
[0m16:20:57.148856 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m16:20:57.149059 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:20:57.149258 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:20:57.149465 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:20:57.149671 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: BEGIN
[0m16:20:57.150145 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:20:57.161548 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m16:20:57.161884 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"
[0m16:20:57.162111 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "Event Timestamp"
from "podcast_analytics"."public"."fact_user_events"
where "Event Timestamp" is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.164897 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:20:57.165247 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m16:20:57.168627 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd: ROLLBACK
[0m16:20:57.169002 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m16:20:57.169301 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.170790 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd: Close
[0m16:20:57.171339 [info ] [Thread-1 (]: 11 of 24 PASS not_null_fact_user_events__Event_Timestamp_ ...................... [[32mPASS[0m in 0.06s]
[0m16:20:57.171733 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd
[0m16:20:57.171975 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:20:57.172195 [info ] [Thread-1 (]: 15 of 24 START test not_null_stg_user_events_episode_id ........................ [RUN]
[0m16:20:57.172453 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd, now test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110)
[0m16:20:57.172670 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:20:57.176171 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:20:57.176560 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:20:57.176878 [debug] [Thread-4 (]: SQL status: BEGIN in 0.027 seconds
[0m16:20:57.177138 [debug] [Thread-3 (]: SQL status: BEGIN in 0.028 seconds
[0m16:20:57.180505 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m16:20:57.180830 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"
[0m16:20:57.181099 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:20:57.181310 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"
[0m16:20:57.181613 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select podcast_id
from "podcast_analytics"."public"."stg_episodes"
where podcast_id is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.185869 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:20:57.186134 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m16:20:57.186429 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select "User ID"
from "podcast_analytics"."public"."fact_user_events"
where "User ID" is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.186964 [info ] [Thread-2 (]: 13 of 24 PASS not_null_stg_episodes_episode_id ................................. [[32mPASS[0m in 0.07s]
[0m16:20:57.187361 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m16:20:57.187648 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:20:57.187933 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:20:57.188238 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: BEGIN
[0m16:20:57.188486 [info ] [Thread-2 (]: 16 of 24 START test not_null_stg_user_events_event_id .......................... [RUN]
[0m16:20:57.188789 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:57.189103 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7)
[0m16:20:57.189671 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:20:57.193355 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:20:57.193707 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:20:57.193982 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:20:57.197266 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: ROLLBACK
[0m16:20:57.200295 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: ROLLBACK
[0m16:20:57.200683 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:20:57.205319 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:20:57.205597 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2: Close
[0m16:20:57.205874 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m16:20:57.206095 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1: Close
[0m16:20:57.206988 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"
[0m16:20:57.206755 [info ] [Thread-3 (]: 12 of 24 PASS not_null_fact_user_events__User_ID_ .............................. [[32mPASS[0m in 0.09s]
[0m16:20:57.207466 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:20:57.207807 [info ] [Thread-4 (]: 14 of 24 PASS not_null_stg_episodes_podcast_id ................................. [[32mPASS[0m in 0.09s]
[0m16:20:57.208119 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_user_events"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.208478 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2
[0m16:20:57.208720 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m16:20:57.209225 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1
[0m16:20:57.209609 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:20:57.209937 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:20:57.210253 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:20:57.210492 [info ] [Thread-3 (]: 17 of 24 START test not_null_stg_user_events_event_ts .......................... [RUN]
[0m16:20:57.210876 [info ] [Thread-4 (]: 18 of 24 START test not_null_stg_user_events_user_id ........................... [RUN]
[0m16:20:57.211164 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2, now test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502)
[0m16:20:57.211413 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1, now test.podcast_analytics.not_null_stg_user_events_user_id.82058db005)
[0m16:20:57.211717 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:20:57.211996 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:20:57.215435 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:20:57.218593 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:20:57.218902 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.009 seconds
[0m16:20:57.223228 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: ROLLBACK
[0m16:20:57.223672 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:20:57.228196 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:20:57.228457 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:20:57.228690 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110: Close
[0m16:20:57.228912 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m16:20:57.233433 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:20:57.233892 [info ] [Thread-1 (]: 15 of 24 PASS not_null_stg_user_events_episode_id .............................. [[32mPASS[0m in 0.06s]
[0m16:20:57.234239 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m16:20:57.234533 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:20:57.234986 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110
[0m16:20:57.235252 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.235480 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:20:57.235682 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: BEGIN
[0m16:20:57.235903 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:20:57.236204 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: BEGIN
[0m16:20:57.236435 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:20:57.236655 [info ] [Thread-1 (]: 19 of 24 START test not_null_stg_users_user_id ................................. [RUN]
[0m16:20:57.236931 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:20:57.237281 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m16:20:57.237612 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:20:57.283885 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:20:57.284232 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.048 seconds
[0m16:20:57.284540 [debug] [Thread-4 (]: SQL status: BEGIN in 0.048 seconds
[0m16:20:57.288189 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m16:20:57.288516 [debug] [Thread-3 (]: SQL status: BEGIN in 0.052 seconds
[0m16:20:57.288779 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"
[0m16:20:57.289089 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:20:57.289327 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"
[0m16:20:57.289578 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_user_id.82058db005"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_user_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.293874 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:20:57.294088 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m16:20:57.294332 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_ts
from "podcast_analytics"."public"."stg_user_events"
where event_ts is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.294925 [info ] [Thread-2 (]: 16 of 24 PASS not_null_stg_user_events_event_id ................................ [[32mPASS[0m in 0.11s]
[0m16:20:57.295374 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m16:20:57.295621 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:20:57.295880 [debug] [Thread-2 (]: Began running node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:20:57.296136 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m16:20:57.296366 [info ] [Thread-2 (]: 20 of 24 START test relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_  [RUN]
[0m16:20:57.296592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:57.296844 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f)
[0m16:20:57.297258 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:20:57.300974 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:20:57.301301 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:20:57.304821 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: ROLLBACK
[0m16:20:57.305292 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:20:57.310981 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:20:57.311272 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_user_id.82058db005: Close
[0m16:20:57.311854 [info ] [Thread-4 (]: 18 of 24 PASS not_null_stg_user_events_user_id ................................. [[32mPASS[0m in 0.10s]
[0m16:20:57.312216 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_user_id.82058db005
[0m16:20:57.312502 [debug] [Thread-4 (]: Began running node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:20:57.312772 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:20:57.313014 [info ] [Thread-4 (]: 21 of 24 START test relationships_fact_user_events__User_ID____User_ID___ref_dim_users_  [RUN]
[0m16:20:57.313273 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: BEGIN
[0m16:20:57.313520 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_user_id.82058db005, now test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24)
[0m16:20:57.313737 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:20:57.313949 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:20:57.317820 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:20:57.318132 [debug] [Thread-1 (]: SQL status: BEGIN in 0.021 seconds
[0m16:20:57.318489 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m16:20:57.318736 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.319056 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:20:57.324697 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:20:57.325006 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m16:20:57.325300 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.030 seconds
[0m16:20:57.328655 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m16:20:57.331509 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: ROLLBACK
[0m16:20:57.331873 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m16:20:57.332206 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:20:57.332470 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m16:20:57.332807 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"
[0m16:20:57.333089 [debug] [Thread-4 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: BEGIN
[0m16:20:57.333382 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502: Close
[0m16:20:57.333725 [info ] [Thread-1 (]: 19 of 24 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.10s]
[0m16:20:57.334042 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select "Episode ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "Episode ID" is not null
),

parent as (
    select "Episode ID" as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.334284 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:20:57.334643 [info ] [Thread-3 (]: 17 of 24 PASS not_null_stg_user_events_event_ts ................................ [[32mPASS[0m in 0.12s]
[0m16:20:57.335011 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m16:20:57.335471 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502
[0m16:20:57.335764 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:20:57.336076 [debug] [Thread-3 (]: Began running node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:20:57.336346 [info ] [Thread-1 (]: 22 of 24 START test unique_dim_episodes__Episode_ID_ ........................... [RUN]
[0m16:20:57.336680 [info ] [Thread-3 (]: 23 of 24 START test unique_dim_users__User_ID_ ................................. [RUN]
[0m16:20:57.337007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77, now test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de)
[0m16:20:57.337272 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502, now test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a)
[0m16:20:57.337912 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:20:57.337568 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:20:57.342273 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:20:57.342612 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m16:20:57.347003 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:20:57.350676 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: ROLLBACK
[0m16:20:57.351180 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:20:57.355213 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:20:57.355519 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f: Close
[0m16:20:57.355819 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:20:57.361372 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:20:57.356488 [info ] [Thread-2 (]: 20 of 24 PASS relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_  [[32mPASS[0m in 0.06s]
[0m16:20:57.361820 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m16:20:57.362177 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:20:57.362645 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f
[0m16:20:57.362907 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"
[0m16:20:57.363160 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: BEGIN
[0m16:20:57.363406 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:20:57.363656 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:20:57.363936 [debug] [Thread-4 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select "User ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "User ID" is not null
),

parent as (
    select "User ID" as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m16:20:57.364158 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:20:57.364381 [info ] [Thread-2 (]: 24 of 24 START test unique_fact_user_events__Event_ID_ ......................... [RUN]
[0m16:20:57.364646 [debug] [Thread-1 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: BEGIN
[0m16:20:57.365055 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f, now test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a)
[0m16:20:57.365275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:20:57.365503 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:20:57.369165 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:20:57.369453 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.005 seconds
[0m16:20:57.373864 [debug] [Thread-4 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: ROLLBACK
[0m16:20:57.374418 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:20:57.378646 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:20:57.378947 [debug] [Thread-4 (]: On test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24: Close
[0m16:20:57.379583 [info ] [Thread-4 (]: 21 of 24 PASS relationships_fact_user_events__User_ID____User_ID___ref_dim_users_  [[32mPASS[0m in 0.07s]
[0m16:20:57.379959 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24
[0m16:20:57.380269 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:20:57.380636 [debug] [Thread-2 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: BEGIN
[0m16:20:57.380861 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:20:57.384613 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m16:20:57.384866 [debug] [Thread-3 (]: SQL status: BEGIN in 0.021 seconds
[0m16:20:57.385110 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"
[0m16:20:57.385402 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"
[0m16:20:57.385713 [debug] [Thread-1 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    "Episode ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is not null
group by "Episode ID"
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:20:57.385994 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    "User ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where "User ID" is not null
group by "User ID"
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:20:57.389705 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m16:20:57.390082 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:20:57.393860 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: ROLLBACK
[0m16:20:57.396782 [debug] [Thread-1 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: ROLLBACK
[0m16:20:57.398008 [debug] [Thread-1 (]: On test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de: Close
[0m16:20:57.398317 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a: Close
[0m16:20:57.399035 [info ] [Thread-3 (]: 23 of 24 PASS unique_dim_users__User_ID_ ....................................... [[32mPASS[0m in 0.06s]
[0m16:20:57.399418 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a
[0m16:20:57.399857 [info ] [Thread-1 (]: 22 of 24 PASS unique_dim_episodes__Episode_ID_ ................................. [[32mPASS[0m in 0.06s]
[0m16:20:57.400285 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de
[0m16:20:57.407815 [debug] [Thread-2 (]: SQL status: BEGIN in 0.027 seconds
[0m16:20:57.408303 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"
[0m16:20:57.408613 [debug] [Thread-2 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    "Event ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is not null
group by "Event ID"
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:20:57.413062 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m16:20:57.416257 [debug] [Thread-2 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: ROLLBACK
[0m16:20:57.417168 [debug] [Thread-2 (]: On test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a: Close
[0m16:20:57.417569 [info ] [Thread-2 (]: 24 of 24 PASS unique_fact_user_events__Event_ID_ ............................... [[32mPASS[0m in 0.05s]
[0m16:20:57.417932 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a
[0m16:20:57.418781 [info ] [MainThread]: 
[0m16:20:57.419024 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:57.419206 [debug] [MainThread]: On master: BEGIN
[0m16:20:57.419364 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:57.431770 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m16:20:57.432132 [debug] [MainThread]: On master: COMMIT
[0m16:20:57.432318 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:57.432482 [debug] [MainThread]: On master: COMMIT
[0m16:20:57.433148 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m16:20:57.451685 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:57.452059 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
    select artifacts_model, metadata_hash from "podcast_analytics"."public_public"."dbt_artifacts_hashes"
    order by metadata_hash
    
  
[0m16:20:57.460025 [debug] [MainThread]: SQL status: SELECT 172 in 0.008 seconds
[0m16:20:57.461927 [debug] [MainThread]: Elementary: Uploading dbt artifacts.
[0m16:20:57.475963 [debug] [MainThread]: Elementary: [dbt_models] Flattening the artifacts.
[0m16:20:57.499823 [debug] [MainThread]: Elementary: [dbt_models] Flattened 39 artifacts.
[0m16:20:57.503392 [debug] [MainThread]: Elementary: [dbt_models] Comparing the artifacts state.
[0m16:20:57.503961 [debug] [MainThread]: Elementary: [dbt_models] Artifacts did not change.
[0m16:20:57.504629 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_models]:
[0m16:20:57.505186 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_models].artifacts_flatten: 0:00:00.023137 (1 runs)
[0m16:20:57.505628 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_models]: 0:00:00.028701 (1 runs)
[0m16:20:57.508110 [debug] [MainThread]: Elementary: [dbt_tests] Flattening the artifacts.
[0m16:20:57.541193 [debug] [MainThread]: Elementary: [dbt_tests] Flattened 24 artifacts.
[0m16:20:57.542144 [debug] [MainThread]: Elementary: [dbt_tests] Comparing the artifacts state.
[0m16:20:57.542780 [debug] [MainThread]: Elementary: [dbt_tests] Artifacts changed.
[0m16:20:57.547203 [debug] [MainThread]: Elementary: Deleting from and inserting to: "podcast_analytics"."public_public"."dbt_tests"
[0m16:20:57.563516 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:57.563836 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
  
    

  create temporary table "dbt_tests__tmp_20250705152057550865162057557169"
  
  
    as
  
  (
    
        SELECT
        
            
                metadata_hash
            
        
        FROM "podcast_analytics"."public_public"."dbt_tests"
        WHERE 1 = 0
    
  );
  
  
[0m16:20:57.571091 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m16:20:57.582278 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:57.582577 [debug] [MainThread]: On master: BEGIN
[0m16:20:57.583617 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m16:20:57.583885 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:57.584102 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_tests__tmp_20250705152057550865162057557169'
        
      order by ordinal_position

  
[0m16:20:57.594514 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m16:20:57.596859 [debug] [MainThread]: Elementary: Inserting 1 rows to table "dbt_tests__tmp_20250705152057550865162057557169"
[0m16:20:57.616103 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:20:57.616827 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:57.617056 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "dbt_tests__tmp_20250705152057550865162057557169"
         (metadata_hash) values
    ('d2fa8b1ebdc64760fab1d8d225715ad7')
  
[0m16:20:57.618466 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.001 seconds
[0m16:20:57.620507 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:57.620739 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
  
    

  create temporary table "dbt_tests__tmp_20250705152057619572162057619938"
  
  
    as
  
  (
    
        SELECT
        
            *
        
        FROM "podcast_analytics"."public_public"."dbt_tests"
        WHERE 1 = 0
    
  );
  
  
[0m16:20:57.622810 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m16:20:57.625802 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:57.626048 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'dbt_tests__tmp_20250705152057619572162057619938'
        
      order by ordinal_position

  
[0m16:20:57.633870 [debug] [MainThread]: SQL status: SELECT 28 in 0.008 seconds
[0m16:20:57.635665 [debug] [MainThread]: Elementary: Inserting 1 rows to table "dbt_tests__tmp_20250705152057619572162057619938"
[0m16:20:57.645853 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:20:57.646474 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:57.646725 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "dbt_tests__tmp_20250705152057619572162057619938"
         (unique_id,database_name,schema_name,name,short_name,alias,test_column_name,severity,warn_if,error_if,test_params,test_namespace,test_original_name,tags,model_tags,model_owners,meta,depends_on_macros,depends_on_nodes,parent_model_unique_id,description,package_name,type,original_path,path,generated_at,metadata_hash,quality_dimension) values
    ('test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc','podcast_analytics','public','dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp','accepted_range','dbt_utils_accepted_range_fact__202e3c950344b775f03de0d8ae40ac14','"Event Timestamp"','ERROR','!= 0','!= 0','{"min_value": "''2024-01-01''::timestamp", "inclusive": true, "column_name": "\"Event Timestamp\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','dbt_utils','accepted_range','[]','[]','[]','{}','["macro.dbt.get_where_subquery", "macro.dbt_utils.test_accepted_range"]','["model.podcast_analytics.fact_user_events"]','model.podcast_analytics.fact_user_events','Asserts that a column''s values fall inside an expected range.','podcast_analytics','generic','models/schema.yml','dbt_utils_accepted_range_fact__202e3c950344b775f03de0d8ae40ac14.sql','2025-07-05 15:20:57','b72fa71eda6c1dce7981cc76591c4af4','validity')
  
[0m16:20:57.648081 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.001 seconds
[0m16:20:57.651527 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:57.651767 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
        begin transaction;
        
            delete from "podcast_analytics"."public_public"."dbt_tests"
            where
            metadata_hash is null
            or metadata_hash in (select metadata_hash from "dbt_tests__tmp_20250705152057550865162057557169");
        
        
            insert into "podcast_analytics"."public_public"."dbt_tests" select * from "dbt_tests__tmp_20250705152057619572162057619938";
        
        commit;
    
  
[0m16:20:57.654243 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:20:57.658985 [debug] [MainThread]: Applying DROP to: "dbt_tests__tmp_20250705152057550865162057557169"
[0m16:20:57.661238 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:57.661459 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
drop table if exists "dbt_tests__tmp_20250705152057550865162057557169" cascade
[0m16:20:57.663354 [debug] [MainThread]: SQL status: DROP TABLE in 0.002 seconds
[0m16:20:57.665610 [debug] [MainThread]: Applying DROP to: "dbt_tests__tmp_20250705152057619572162057619938"
[0m16:20:57.666066 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:57.666263 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
drop table if exists "dbt_tests__tmp_20250705152057619572162057619938" cascade
[0m16:20:57.667854 [debug] [MainThread]: SQL status: DROP TABLE in 0.001 seconds
[0m16:20:57.668432 [debug] [MainThread]: Elementary: Finished deleting from and inserting to: "podcast_analytics"."public_public"."dbt_tests"
[0m16:20:57.669141 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_tests]:
[0m16:20:57.669531 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].artifacts_flatten: 0:00:00.032507 (1 runs)
[0m16:20:57.669896 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.get_columns_in_relation: 0:00:00.030093 (2 runs)
[0m16:20:57.670336 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.000458 (2 runs)
[0m16:20:57.670724 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.016345 (2 runs)
[0m16:20:57.671080 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.get_insert_rows_queries: 0:00:00.021630 (2 runs)
[0m16:20:57.671436 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows.run_insert_rows_query: 0:00:00.005142 (2 runs)
[0m16:20:57.671925 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests].insert_rows: 0:00:00.066540 (2 runs)
[0m16:20:57.672322 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_tests]: 0:00:00.160931 (1 runs)
[0m16:20:57.674839 [debug] [MainThread]: Elementary: [dbt_sources] Flattening the artifacts.
[0m16:20:57.683608 [debug] [MainThread]: Elementary: [dbt_sources] Flattened 3 artifacts.
[0m16:20:57.684344 [debug] [MainThread]: Elementary: [dbt_sources] Comparing the artifacts state.
[0m16:20:57.684745 [debug] [MainThread]: Elementary: [dbt_sources] Artifacts did not change.
[0m16:20:57.685688 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_sources]:
[0m16:20:57.686066 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_sources].artifacts_flatten: 0:00:00.008167 (1 runs)
[0m16:20:57.686421 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_sources]: 0:00:00.010837 (1 runs)
[0m16:20:57.688790 [debug] [MainThread]: Elementary: [dbt_snapshots] Flattening the artifacts.
[0m16:20:57.689515 [debug] [MainThread]: Elementary: [dbt_snapshots] Flattened 0 artifacts.
[0m16:20:57.690226 [debug] [MainThread]: Elementary: [dbt_snapshots] Comparing the artifacts state.
[0m16:20:57.690602 [debug] [MainThread]: Elementary: [dbt_snapshots] Artifacts did not change.
[0m16:20:57.691157 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_snapshots]:
[0m16:20:57.691573 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_snapshots].artifacts_flatten: 0:00:00.000224 (1 runs)
[0m16:20:57.691930 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_snapshots]: 0:00:00.002357 (1 runs)
[0m16:20:57.694217 [debug] [MainThread]: Elementary: [dbt_metrics] Flattening the artifacts.
[0m16:20:57.694922 [debug] [MainThread]: Elementary: [dbt_metrics] Flattened 0 artifacts.
[0m16:20:57.695572 [debug] [MainThread]: Elementary: [dbt_metrics] Comparing the artifacts state.
[0m16:20:57.695988 [debug] [MainThread]: Elementary: [dbt_metrics] Artifacts did not change.
[0m16:20:57.696531 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_metrics]:
[0m16:20:57.696897 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_metrics].artifacts_flatten: 0:00:00.000151 (1 runs)
[0m16:20:57.697295 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_metrics]: 0:00:00.002301 (1 runs)
[0m16:20:57.699546 [debug] [MainThread]: Elementary: [dbt_exposures] Flattening the artifacts.
[0m16:20:57.700239 [debug] [MainThread]: Elementary: [dbt_exposures] Flattened 0 artifacts.
[0m16:20:57.700899 [debug] [MainThread]: Elementary: [dbt_exposures] Comparing the artifacts state.
[0m16:20:57.701315 [debug] [MainThread]: Elementary: [dbt_exposures] Artifacts did not change.
[0m16:20:57.701855 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_exposures]:
[0m16:20:57.702223 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_exposures].artifacts_flatten: 0:00:00.000155 (1 runs)
[0m16:20:57.702622 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_exposures]: 0:00:00.002296 (1 runs)
[0m16:20:57.704859 [debug] [MainThread]: Elementary: [dbt_seeds] Flattening the artifacts.
[0m16:20:57.712108 [debug] [MainThread]: Elementary: [dbt_seeds] Flattened 2 artifacts.
[0m16:20:57.712782 [debug] [MainThread]: Elementary: [dbt_seeds] Comparing the artifacts state.
[0m16:20:57.713213 [debug] [MainThread]: Elementary: [dbt_seeds] Artifacts did not change.
[0m16:20:57.713764 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_seeds]:
[0m16:20:57.714129 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_seeds].artifacts_flatten: 0:00:00.006729 (1 runs)
[0m16:20:57.714530 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_seeds]: 0:00:00.008890 (1 runs)
[0m16:20:57.716903 [debug] [MainThread]: Elementary: [dbt_columns] Flattening the artifacts.
[0m16:20:57.799463 [debug] [MainThread]: Elementary: [dbt_columns] Flattened 104 artifacts.
[0m16:20:57.800223 [debug] [MainThread]: Elementary: [dbt_columns] Comparing the artifacts state.
[0m16:20:57.800778 [debug] [MainThread]: Elementary: [dbt_columns] Artifacts did not change.
[0m16:20:57.801331 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_columns]:
[0m16:20:57.801710 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns].artifacts_flatten: 0:00:00.081964 (1 runs)
[0m16:20:57.802113 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_columns]: 0:00:00.084408 (1 runs)
[0m16:20:57.802515 [debug] [MainThread]: Elementary: Uploaded dbt artifacts.
[0m16:20:57.804692 [debug] [MainThread]: Elementary: Uploading run results.
[0m16:20:57.805211 [debug] [MainThread]: Elementary: [dbt_run_results] Flattening the artifacts.
[0m16:20:57.825018 [debug] [MainThread]: Elementary: [dbt_run_results] Flattened 24 artifacts.
[0m16:20:57.827771 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:57.828010 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_run_results'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:20:57.838251 [debug] [MainThread]: SQL status: SELECT 22 in 0.010 seconds
[0m16:20:57.839561 [debug] [MainThread]: Elementary: Inserting 24 rows to table "podcast_analytics"."public_public"."dbt_run_results"
[0m16:20:58.025563 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:20:58.026251 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:58.027014 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."dbt_run_results"
         (model_execution_id,unique_id,invocation_id,generated_at,created_at,name,message,status,resource_type,execution_time,execute_started_at,execute_completed_at,compile_started_at,compile_completed_at,rows_affected,full_refresh,compiled_code,failures,query_id,thread_id,materialization,adapter_response) values
    ('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'accepted_values_fact_user_events__Event_Type___play__pause__seek__complete',NULL,'pass','test',0.17214417457580566,'2025-07-05T15:20:56.795909Z','2025-07-05T15:20:56.946395Z','2025-07-05T15:20:56.779255Z','2025-07-05T15:20:56.795532Z',1,False,'
    
    

with all_values as (

    select
        "Event Type" as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by "Event Type"

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc','test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp',NULL,'pass','test',0.18921422958374023,'2025-07-05T15:20:56.803041Z','2025-07-05T15:20:56.966055Z','2025-07-05T15:20:56.791839Z','2025-07-05T15:20:56.799081Z',1,False,'

with meet_condition as(
  select *
  from "podcast_analytics"."public"."fact_user_events"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don''t meet the rule.
    or not "Event Timestamp" >= ''2024-01-01''::timestamp
)

select *
from validation_errors

',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue',NULL,'pass','test',0.24412298202514648,'2025-07-05T15:20:56.801141Z','2025-07-05T15:20:57.016454Z','2025-07-05T15:20:56.787124Z','2025-07-05T15:20:56.798691Z',1,False,'
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    ''missing_event_type'',''invalid_event_type'',''missing_timestamp'',''malformed_timestamp'',''missing_user_id'',''missing_episode_id'',''other_issue''
)


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'accepted_values_stg_user_events_event_type__play__pause__seek__complete',NULL,'pass','test',0.24482202529907227,'2025-07-05T15:20:56.799317Z','2025-07-05T15:20:57.019749Z','2025-07-05T15:20:56.783125Z','2025-07-05T15:20:56.798449Z',1,False,'
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'not_null_dim_episodes__Duration_seconds_',NULL,'pass','test',0.0839071273803711,'2025-07-05T15:20:56.957549Z','2025-07-05T15:20:57.028254Z','2025-07-05T15:20:56.950994Z','2025-07-05T15:20:56.957018Z',1,False,'
    
    



select "Duration (seconds)"
from "podcast_analytics"."public"."dim_episodes"
where "Duration (seconds)" is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'not_null_dim_episodes__Episode_ID_',NULL,'pass','test',0.09611701965332031,'2025-07-05T15:20:56.973424Z','2025-07-05T15:20:57.054222Z','2025-07-05T15:20:56.969669Z','2025-07-05T15:20:56.973197Z',1,False,'
    
    



select "Episode ID"
from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'not_null_fact_user_events__Episode_ID_',NULL,'pass','test',0.056970834732055664,'2025-07-05T15:20:57.060157Z','2025-07-05T15:20:57.094680Z','2025-07-05T15:20:57.054567Z','2025-07-05T15:20:57.059431Z',1,False,'
    
    



select "Episode ID"
from "podcast_analytics"."public"."fact_user_events"
where "Episode ID" is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'not_null_dim_episodes__Podcast_ID_',NULL,'pass','test',0.07797598838806152,'2025-07-05T15:20:57.041135Z','2025-07-05T15:20:57.101232Z','2025-07-05T15:20:57.030607Z','2025-07-05T15:20:57.040132Z',1,False,'
    
    



select "Podcast ID"
from "podcast_analytics"."public"."dim_episodes"
where "Podcast ID" is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'not_null_dim_users__User_ID_',NULL,'pass','test',0.07842111587524414,'2025-07-05T15:20:57.045652Z','2025-07-05T15:20:57.098155Z','2025-07-05T15:20:57.034844Z','2025-07-05T15:20:57.040908Z',1,False,'
    
    



select "User ID"
from "podcast_analytics"."public"."dim_users"
where "User ID" is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'not_null_fact_user_events__Event_ID_',NULL,'pass','test',0.04226088523864746,'2025-07-05T15:20:57.071803Z','2025-07-05T15:20:57.105605Z','2025-07-05T15:20:57.067858Z','2025-07-05T15:20:57.071562Z',1,False,'
    
    



select "Event ID"
from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'not_null_fact_user_events__Event_Timestamp_',NULL,'pass','test',0.06122088432312012,'2025-07-05T15:20:57.125181Z','2025-07-05T15:20:57.168523Z','2025-07-05T15:20:57.112055Z','2025-07-05T15:20:57.124433Z',1,False,'
    
    



select "Event Timestamp"
from "podcast_analytics"."public"."fact_user_events"
where "Event Timestamp" is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'not_null_stg_episodes_episode_id',NULL,'pass','test',0.07126998901367188,'2025-07-05T15:20:57.138799Z','2025-07-05T15:20:57.180416Z','2025-07-05T15:20:57.120680Z','2025-07-05T15:20:57.133714Z',1,False,'
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'not_null_fact_user_events__User_ID_',NULL,'pass','test',0.09488916397094727,'2025-07-05T15:20:57.134030Z','2025-07-05T15:20:57.197175Z','2025-07-05T15:20:57.117213Z','2025-07-05T15:20:57.133472Z',1,False,'
    
    



select "User ID"
from "podcast_analytics"."public"."fact_user_events"
where "User ID" is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'not_null_stg_episodes_podcast_id',NULL,'pass','test',0.09073805809020996,'2025-07-05T15:20:57.143857Z','2025-07-05T15:20:57.200204Z','2025-07-05T15:20:57.129620Z','2025-07-05T15:20:57.143230Z',1,False,'
    
    



select podcast_id
from "podcast_analytics"."public"."stg_episodes"
where podcast_id is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'not_null_stg_user_events_episode_id',NULL,'pass','test',0.061399221420288086,'2025-07-05T15:20:57.181801Z','2025-07-05T15:20:57.223131Z','2025-07-05T15:20:57.172812Z','2025-07-05T15:20:57.181018Z',1,False,'
    
    



select episode_id
from "podcast_analytics"."public"."stg_user_events"
where episode_id is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'not_null_stg_user_events_event_id',NULL,'pass','test',0.10578799247741699,'2025-07-05T15:20:57.200921Z','2025-07-05T15:20:57.288041Z','2025-07-05T15:20:57.189845Z','2025-07-05T15:20:57.200581Z',1,False,'
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'not_null_stg_user_events_user_id',NULL,'pass','test',0.10039973258972168,'2025-07-05T15:20:57.229172Z','2025-07-05T15:20:57.304715Z','2025-07-05T15:20:57.215680Z','2025-07-05T15:20:57.228370Z',1,False,'
    
    



select user_id
from "podcast_analytics"."public"."stg_user_events"
where user_id is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'not_null_stg_users_user_id',NULL,'pass','test',0.09641909599304199,'2025-07-05T15:20:57.289777Z','2025-07-05T15:20:57.328565Z','2025-07-05T15:20:57.237837Z','2025-07-05T15:20:57.289015Z',1,False,'
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'not_null_stg_user_events_event_ts',NULL,'pass','test',0.12345218658447266,'2025-07-05T15:20:57.224037Z','2025-07-05T15:20:57.331439Z','2025-07-05T15:20:57.212181Z','2025-07-05T15:20:57.223556Z',1,False,'
    
    



select event_ts
from "podcast_analytics"."public"."stg_user_events"
where event_ts is null


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_',NULL,'pass','test',0.05959296226501465,'2025-07-05T15:20:57.305528Z','2025-07-05T15:20:57.350564Z','2025-07-05T15:20:57.297471Z','2025-07-05T15:20:57.305167Z',1,False,'
    
    

with child as (
    select "Episode ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "Episode ID" is not null
),

parent as (
    select "Episode ID" as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'relationships_fact_user_events__User_ID____User_ID___ref_dim_users_',NULL,'pass','test',0.06601285934448242,'2025-07-05T15:20:57.319273Z','2025-07-05T15:20:57.373731Z','2025-07-05T15:20:57.314233Z','2025-07-05T15:20:57.318937Z',1,False,'
    
    

with child as (
    select "User ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "User ID" is not null
),

parent as (
    select "User ID" as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',0,NULL,'Thread-4 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'unique_dim_users__User_ID_',NULL,'pass','test',0.061698198318481445,'2025-07-05T15:20:57.351359Z','2025-07-05T15:20:57.393748Z','2025-07-05T15:20:57.338123Z','2025-07-05T15:20:57.351102Z',1,False,'
    
    

select
    "User ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where "User ID" is not null
group by "User ID"
having count(*) > 1


',0,NULL,'Thread-3 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'unique_dim_episodes__Episode_ID_',NULL,'pass','test',0.06281089782714844,'2025-07-05T15:20:57.356647Z','2025-07-05T15:20:57.396691Z','2025-07-05T15:20:57.342880Z','2025-07-05T15:20:57.355713Z',1,False,'
    
    

select
    "Episode ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is not null
group by "Episode ID"
having count(*) > 1


',0,NULL,'Thread-1 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}'),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','5c3892a4-25ff-4c38-aba8-fbdf2305a62d','2025-07-05 15:20:57',
    current_timestamp::timestamp
,'unique_fact_user_events__Event_ID_',NULL,'pass','test',0.05246090888977051,'2025-07-05T15:20:57.374593Z','2025-07-05T15:20:57.416173Z','2025-07-05T15:20:57.365731Z','2025-07-05T15:20:57.374335Z',1,False,'
    
    

select
    "Event ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is not null
group by "Event ID"
having count(*) > 1


',0,NULL,'Thread-2 (worker)','test','{"_message": "SELECT 1", "code": "SELECT", "rows_affected": 1}')
  
[0m16:20:58.037427 [debug] [MainThread]: SQL status: INSERT 0 24 in 0.010 seconds
[0m16:20:58.038366 [debug] [MainThread]: On master: COMMIT
[0m16:20:58.038583 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:58.038778 [debug] [MainThread]: On master: COMMIT
[0m16:20:58.040544 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:20:58.041792 [debug] [MainThread]: Elementary: Measured durations for context - upload_artifacts_to_table[dbt_run_results]:
[0m16:20:58.042342 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].artifacts_flatten: 0:00:00.019238 (1 runs)
[0m16:20:58.042751 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_columns_in_relation: 0:00:00.013637 (1 runs)
[0m16:20:58.043227 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.base_query_calc: 0:00:00.000232 (1 runs)
[0m16:20:58.043621 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries.render_row_to_sql: 0:00:00.181970 (24 runs)
[0m16:20:58.044017 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.get_insert_rows_queries: 0:00:00.185308 (1 runs)
[0m16:20:58.044399 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.run_insert_rows_query: 0:00:00.012095 (1 runs)
[0m16:20:58.044779 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows.commit: 0:00:00.002586 (1 runs)
[0m16:20:58.045191 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results].insert_rows: 0:00:00.215394 (1 runs)
[0m16:20:58.045556 [debug] [MainThread]: Elementary:     upload_artifacts_to_table[dbt_run_results]: 0:00:00.236272 (1 runs)
[0m16:20:58.045932 [debug] [MainThread]: Elementary: Uploaded run results successfully.
[0m16:20:58.051074 [debug] [MainThread]: Elementary: Handling test results.
[0m16:20:58.067591 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:58.067860 [debug] [MainThread]: On master: BEGIN
[0m16:20:58.070124 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:20:58.070310 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:58.070499 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'elementary_test_results'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:20:58.079146 [debug] [MainThread]: SQL status: SELECT 28 in 0.008 seconds
[0m16:20:58.080557 [debug] [MainThread]: Elementary: Inserting 24 rows to table "podcast_analytics"."public_public"."elementary_test_results"
[0m16:20:58.270434 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:20:58.270998 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:58.271948 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."elementary_test_results"
         (id,data_issue_id,test_execution_id,test_unique_id,model_unique_id,invocation_id,detected_at,created_at,database_name,schema_name,table_name,column_name,test_type,test_sub_type,test_results_description,owners,tags,test_results_query,other,test_name,test_params,severity,status,failures,test_short_name,test_alias,result_rows,failed_row_count) values
    ('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','test.podcast_analytics.accepted_values_fact_user_events__Event_Type___play__pause__seek__complete.6d73a91de8','model.podcast_analytics.fact_user_events','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:56' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event Type"','dbt_test','generic',NULL,'[]','[]','
    
    

with all_values as (

    select
        "Event Type" as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by "Event Type"

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',NULL,'accepted_values_fact_user_events__Event_Type___play__pause__seek__complete','{"values": ["play", "pause", "seek", "complete"], "column_name": "\"Event Type\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'accepted_values','accepted_values_fact_user_even_fbc631ab6baad050aa8d81cbe6f1af99',NULL,NULL),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc','test.podcast_analytics.dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp.ade1a713cc','model.podcast_analytics.fact_user_events','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:56' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event Timestamp"','dbt_test','generic',NULL,'[]','[]','

with meet_condition as(
  select *
  from "podcast_analytics"."public"."fact_user_events"
),

validation_errors as (
  select *
  from meet_condition
  where
    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds
    1 = 2
    -- records with a value >= min_value are permitted. The `not` flips this to find records that don''t meet the rule.
    or not "Event Timestamp" >= ''2024-01-01''::timestamp
)

select *
from validation_errors

',NULL,'dbt_utils_accepted_range_fact_user_events__Event_Timestamp___True___2024_01_01_timestamp','{"min_value": "''2024-01-01''::timestamp", "inclusive": true, "column_name": "\"Event Timestamp\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'accepted_range','dbt_utils_accepted_range_fact__202e3c950344b775f03de0d8ae40ac14',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7','model.podcast_analytics.stg_user_events_invalid','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:56' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events_invalid','issue_type','dbt_test','generic',NULL,'[]','[]','
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    ''missing_event_type'',''invalid_event_type'',''missing_timestamp'',''malformed_timestamp'',''missing_user_id'',''missing_episode_id'',''other_issue''
)


',NULL,'accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue','{"values": ["missing_event_type", "invalid_event_type", "missing_timestamp", "malformed_timestamp", "missing_user_id", "missing_episode_id", "other_issue"], "column_name": "issue_type", "model": "{{ get_where_subquery(ref(''stg_user_events_invalid'')) }}"}','ERROR','pass',0,'accepted_values','accepted_values_stg_user_event_43bb633c97e04e462eb7fee334f302ba',NULL,NULL),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8','model.podcast_analytics.stg_user_events','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:56' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','event_type','dbt_test','generic',NULL,'[]','[]','
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    ''play'',''pause'',''seek'',''complete''
)


',NULL,'accepted_values_stg_user_events_event_type__play__pause__seek__complete','{"values": ["play", "pause", "seek", "complete"], "column_name": "event_type", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'accepted_values','accepted_values_stg_user_event_94634d24690dcf7d4e511df98c6e0582',NULL,NULL),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','test.podcast_analytics.not_null_dim_episodes__Duration_seconds_.4f701a1444','model.podcast_analytics.dim_episodes','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:56' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Duration (seconds)"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Duration (seconds)"
from "podcast_analytics"."public"."dim_episodes"
where "Duration (seconds)" is null


',NULL,'not_null_dim_episodes__Duration_seconds_','{"column_name": "\"Duration (seconds)\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_episodes__Duration_seconds_',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','test.podcast_analytics.not_null_dim_episodes__Episode_ID_.69cdc054cc','model.podcast_analytics.dim_episodes','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:56' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Episode ID"
from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is null


',NULL,'not_null_dim_episodes__Episode_ID_','{"column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_episodes__Episode_ID_',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','test.podcast_analytics.not_null_fact_user_events__Episode_ID_.cea0b221ae','model.podcast_analytics.fact_user_events','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Episode ID"
from "podcast_analytics"."public"."fact_user_events"
where "Episode ID" is null


',NULL,'not_null_fact_user_events__Episode_ID_','{"column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__Episode_ID_',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','test.podcast_analytics.not_null_dim_episodes__Podcast_ID_.4123be45d7','model.podcast_analytics.dim_episodes','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Podcast ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Podcast ID"
from "podcast_analytics"."public"."dim_episodes"
where "Podcast ID" is null


',NULL,'not_null_dim_episodes__Podcast_ID_','{"column_name": "\"Podcast ID\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_episodes__Podcast_ID_',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','test.podcast_analytics.not_null_dim_users__User_ID_.9ea795e2ba','model.podcast_analytics.dim_users','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_users','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "User ID"
from "podcast_analytics"."public"."dim_users"
where "User ID" is null


',NULL,'not_null_dim_users__User_ID_','{"column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''dim_users'')) }}"}','ERROR','pass',0,'not_null','not_null_dim_users__User_ID_',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','test.podcast_analytics.not_null_fact_user_events__Event_ID_.5955dbde8c','model.podcast_analytics.fact_user_events','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Event ID"
from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is null


',NULL,'not_null_fact_user_events__Event_ID_','{"column_name": "\"Event ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__Event_ID_',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','test.podcast_analytics.not_null_fact_user_events__Event_Timestamp_.f4b8a02abd','model.podcast_analytics.fact_user_events','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event Timestamp"','dbt_test','generic',NULL,'[]','[]','
    
    



select "Event Timestamp"
from "podcast_analytics"."public"."fact_user_events"
where "Event Timestamp" is null


',NULL,'not_null_fact_user_events__Event_Timestamp_','{"column_name": "\"Event Timestamp\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__Event_Timestamp_',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422','model.podcast_analytics.stg_episodes','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_episodes','episode_id','dbt_test','generic',NULL,'[]','[]','
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null


',NULL,'not_null_stg_episodes_episode_id','{"column_name": "episode_id", "model": "{{ get_where_subquery(ref(''stg_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_episodes_episode_id',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','test.podcast_analytics.not_null_fact_user_events__User_ID_.0f66c9c6f2','model.podcast_analytics.fact_user_events','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    



select "User ID"
from "podcast_analytics"."public"."fact_user_events"
where "User ID" is null


',NULL,'not_null_fact_user_events__User_ID_','{"column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_fact_user_events__User_ID_',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','test.podcast_analytics.not_null_stg_episodes_podcast_id.b8f1e6adf1','model.podcast_analytics.stg_episodes','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_episodes','podcast_id','dbt_test','generic',NULL,'[]','[]','
    
    



select podcast_id
from "podcast_analytics"."public"."stg_episodes"
where podcast_id is null


',NULL,'not_null_stg_episodes_podcast_id','{"column_name": "podcast_id", "model": "{{ get_where_subquery(ref(''stg_episodes'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_episodes_podcast_id',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','test.podcast_analytics.not_null_stg_user_events_episode_id.0cba29d110','model.podcast_analytics.stg_user_events','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','episode_id','dbt_test','generic',NULL,'[]','[]','
    
    



select episode_id
from "podcast_analytics"."public"."stg_user_events"
where episode_id is null


',NULL,'not_null_stg_user_events_episode_id','{"column_name": "episode_id", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_episode_id',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7','model.podcast_analytics.stg_user_events','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','event_id','dbt_test','generic',NULL,'[]','[]','
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null


',NULL,'not_null_stg_user_events_event_id','{"column_name": "event_id", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_event_id',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_user_events_user_id.82058db005',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','test.podcast_analytics.not_null_stg_user_events_user_id.82058db005','model.podcast_analytics.stg_user_events','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','user_id','dbt_test','generic',NULL,'[]','[]','
    
    



select user_id
from "podcast_analytics"."public"."stg_user_events"
where user_id is null


',NULL,'not_null_stg_user_events_user_id','{"column_name": "user_id", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_user_id',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77','model.podcast_analytics.stg_users','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_users','user_id','dbt_test','generic',NULL,'[]','[]','
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null


',NULL,'not_null_stg_users_user_id','{"column_name": "user_id", "model": "{{ get_where_subquery(ref(''stg_users'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_users_user_id',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','test.podcast_analytics.not_null_stg_user_events_event_ts.d250702502','model.podcast_analytics.stg_user_events','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','stg_user_events','event_ts','dbt_test','generic',NULL,'[]','[]','
    
    



select event_ts
from "podcast_analytics"."public"."stg_user_events"
where event_ts is null


',NULL,'not_null_stg_user_events_event_ts','{"column_name": "event_ts", "model": "{{ get_where_subquery(ref(''stg_user_events'')) }}"}','ERROR','pass',0,'not_null','not_null_stg_user_events_event_ts',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','test.podcast_analytics.relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_.05f0f2770f','model.podcast_analytics.fact_user_events','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    

with child as (
    select "Episode ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "Episode ID" is not null
),

parent as (
    select "Episode ID" as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',NULL,'relationships_fact_user_events__Episode_ID____Episode_ID___ref_dim_episodes_','{"to": "ref(''dim_episodes'')", "field": "\"Episode ID\"", "column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'relationships','relationships_fact_user_events_a5d0f4791bd5f2dd7a1079d5e9d2dc3a',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24','model.podcast_analytics.fact_user_events','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    

with child as (
    select "User ID" as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where "User ID" is not null
),

parent as (
    select "User ID" as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null


',NULL,'relationships_fact_user_events__User_ID____User_ID___ref_dim_users_','{"to": "ref(''dim_users'')", "field": "\"User ID\"", "column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'relationships','relationships_fact_user_events_18a41013c7410998f321251d32b88faf',NULL,0),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a','model.podcast_analytics.dim_users','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_users','"User ID"','dbt_test','generic',NULL,'[]','[]','
    
    

select
    "User ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where "User ID" is not null
group by "User ID"
having count(*) > 1


',NULL,'unique_dim_users__User_ID_','{"column_name": "\"User ID\"", "model": "{{ get_where_subquery(ref(''dim_users'')) }}"}','ERROR','pass',0,'unique','unique_dim_users__User_ID_',NULL,NULL),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de','model.podcast_analytics.dim_episodes','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','dim_episodes','"Episode ID"','dbt_test','generic',NULL,'[]','[]','
    
    

select
    "Episode ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where "Episode ID" is not null
group by "Episode ID"
having count(*) > 1


',NULL,'unique_dim_episodes__Episode_ID_','{"column_name": "\"Episode ID\"", "model": "{{ get_where_subquery(ref(''dim_episodes'')) }}"}','ERROR','pass',0,'unique','unique_dim_episodes__Episode_ID_',NULL,NULL),('5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a',NULL,'5c3892a4-25ff-4c38-aba8-fbdf2305a62d.test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a','model.podcast_analytics.fact_user_events','5c3892a4-25ff-4c38-aba8-fbdf2305a62d',cast('2025-07-05 15:20:57' as timestamp),
    current_timestamp::timestamp
,'podcast_analytics','public','fact_user_events','"Event ID"','dbt_test','generic',NULL,'[]','[]','
    
    

select
    "Event ID" as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."fact_user_events"
where "Event ID" is not null
group by "Event ID"
having count(*) > 1


',NULL,'unique_fact_user_events__Event_ID_','{"column_name": "\"Event ID\"", "model": "{{ get_where_subquery(ref(''fact_user_events'')) }}"}','ERROR','pass',0,'unique','unique_fact_user_events__Event_ID_',NULL,NULL)
  
[0m16:20:58.280099 [debug] [MainThread]: SQL status: INSERT 0 24 in 0.007 seconds
[0m16:20:58.280965 [debug] [MainThread]: On master: COMMIT
[0m16:20:58.281174 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:58.281367 [debug] [MainThread]: On master: COMMIT
[0m16:20:58.284210 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m16:20:58.284978 [debug] [MainThread]: Elementary: Handled test results successfully.
[0m16:20:58.292547 [debug] [MainThread]: Elementary: Uploading dbt invocation.
[0m16:20:58.321259 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:58.321530 [debug] [MainThread]: On master: BEGIN
[0m16:20:58.323641 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m16:20:58.323828 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:58.324019 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "podcast_analytics".INFORMATION_SCHEMA.columns
      where table_name = 'dbt_invocations'
        
        and table_schema = 'public_public'
        
      order by ordinal_position

  
[0m16:20:58.334905 [debug] [MainThread]: SQL status: SELECT 35 in 0.011 seconds
[0m16:20:58.336263 [debug] [MainThread]: Elementary: Inserting 1 rows to table "podcast_analytics"."public_public"."dbt_invocations"
[0m16:20:58.346727 [debug] [MainThread]: Elementary: [1/1] Running insert query.
[0m16:20:58.347229 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:58.347453 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */

    
       insert into "podcast_analytics"."public_public"."dbt_invocations"
         (invocation_id,job_id,job_name,job_run_id,run_started_at,run_completed_at,generated_at,created_at,command,dbt_version,elementary_version,full_refresh,invocation_vars,vars,target_name,target_database,target_schema,target_profile_name,threads,selected,yaml_selector,project_id,project_name,env,env_id,cause_category,cause,pull_request_id,git_sha,orchestrator,dbt_user,job_url,job_run_url,account_id,target_adapter_specific_fields) values
    ('5c3892a4-25ff-4c38-aba8-fbdf2305a62d',NULL,NULL,NULL,'2025-07-05 15:20:55','2025-07-05 15:20:58','2025-07-05 15:20:58',
    current_timestamp::timestamp
,'test','1.10.3','0.18.2',False,'{}','{}','local','podcast_analytics','public','podcast_analytics',4,'[]',NULL,NULL,'podcast_analytics',NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,NULL,'{"user": "podcast"}')
  
[0m16:20:58.349466 [debug] [MainThread]: SQL status: INSERT 0 1 in 0.002 seconds
[0m16:20:58.350293 [debug] [MainThread]: On master: COMMIT
[0m16:20:58.350487 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:58.350679 [debug] [MainThread]: On master: COMMIT
[0m16:20:58.352825 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m16:20:58.353557 [debug] [MainThread]: Elementary: Uploaded dbt invocation successfully.
[0m16:20:58.356757 [debug] [MainThread]: Writing injected SQL for node "operation.elementary.elementary-on-run-end-0"
[0m16:20:58.357589 [info ] [MainThread]: 1 of 1 START hook: elementary.on-run-end.0 ..................................... [RUN]
[0m16:20:58.357878 [info ] [MainThread]: 1 of 1 OK hook: elementary.on-run-end.0 ........................................ [[32mOK[0m in 0.92s]
[0m16:20:58.358083 [debug] [MainThread]: On master: Close
[0m16:20:58.358316 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:58.358470 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_dim_episodes__Episode_ID_.a184ffe2de' was properly closed.
[0m16:20:58.358617 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_fact_user_events__Event_ID_.064d3b537a' was properly closed.
[0m16:20:58.358760 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_dim_users__User_ID_.c2fdea249a' was properly closed.
[0m16:20:58.358900 [debug] [MainThread]: Connection 'test.podcast_analytics.relationships_fact_user_events__User_ID____User_ID___ref_dim_users_.93d4384a24' was properly closed.
[0m16:20:58.359110 [info ] [MainThread]: 
[0m16:20:58.359289 [info ] [MainThread]: Finished running 2 project hooks, 24 data tests in 0 hours 0 minutes and 1.78 seconds (1.78s).
[0m16:20:58.361099 [debug] [MainThread]: Command end result
[0m16:20:58.405603 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m16:20:58.407073 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m16:20:58.411556 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m16:20:58.411848 [info ] [MainThread]: 
[0m16:20:58.412092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:58.412299 [info ] [MainThread]: 
[0m16:20:58.412516 [info ] [MainThread]: Done. PASS=26 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=26
[0m16:20:58.412871 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- PackageMaterializationOverrideDeprecation: 24 occurrences
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:20:58.414990 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.721929, "process_in_blocks": "0", "process_kernel_time": 0.258911, "process_mem_max_rss": "147947520", "process_out_blocks": "0", "process_user_time": 2.985459}
[0m16:20:58.415258 [debug] [MainThread]: Command `dbt test` succeeded at 16:20:58.415213 after 2.72 seconds
[0m16:20:58.415488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105947460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ebe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ea680>]}
[0m16:20:58.415717 [debug] [MainThread]: Flushing usage events
[0m16:20:58.882630 [debug] [MainThread]: An error was encountered while trying to flush usage events
