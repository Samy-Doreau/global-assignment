[0m11:54:57.568264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118092bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189115e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118911040>]}


============================== 11:54:57.576279 | 78f1d618-9675-41c4-bf99-eb1fda776019 ==============================
[0m11:54:57.576279 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:54:57.577737 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m11:54:57.701282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '78f1d618-9675-41c4-bf99-eb1fda776019', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1180c52b0>]}
[0m11:54:57.717868 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-8c2v5wyx'
[0m11:54:57.718257 [error] [MainThread]: Encountered an error:
">=1.0" is not a valid semantic version.
[0m11:54:57.721251 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 237, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 461, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/task/deps.py", line 215, in run
    self.lock()
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/deps/resolver.py", line 121, in resolve_packages
    pending = PackageListing.from_contracts(packages)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/deps/resolver.py", line 91, in from_contracts
    self.update_from(src)
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/deps/resolver.py", line 83, in update_from
    pkg = RegistryUnpinnedPackage.from_contract(contract)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/deps/registry.py", line 83, in from_contract
    versions = [semver.VersionSpecifier.from_version_string(v) for v in raw_version]
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt_common/semver.py", line 99, in from_version_string
    raise dbt_common.exceptions.base.SemverError(
dbt_common.exceptions.base.SemverError: ">=1.0" is not a valid semantic version.

[0m11:54:57.723714 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.22037521, "process_in_blocks": "0", "process_kernel_time": 0.222466, "process_mem_max_rss": "103383040", "process_out_blocks": "0", "process_user_time": 1.166542}
[0m11:54:57.724093 [debug] [MainThread]: Command `dbt deps` failed at 11:54:57.724024 after 0.22 seconds
[0m11:54:57.724524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1189112b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10766d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118119970>]}
[0m11:54:57.725753 [debug] [MainThread]: Flushing usage events
[0m11:54:58.147527 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:55:39.547813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050dbaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540cfb0>]}


============================== 11:55:39.551850 | 2888fc73-76b8-49f2-ae13-007a37703012 ==============================
[0m11:55:39.551850 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:55:39.552343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m11:55:39.567376 [info ] [MainThread]: dbt version: 1.10.3
[0m11:55:39.568148 [info ] [MainThread]: python version: 3.12.3
[0m11:55:39.568807 [info ] [MainThread]: python path: /Users/samydoreau/global-assignment/venv/bin/python3.12
[0m11:55:39.569298 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit
[0m11:55:39.582046 [error] [MainThread]: Encountered an error:
Parsing Error
  Env var required but not provided: 'POSTGRES_USER'
[0m11:55:39.584541 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.09305971, "process_in_blocks": "0", "process_kernel_time": 0.142727, "process_mem_max_rss": "104120320", "process_out_blocks": "0", "process_user_time": 0.865572}
[0m11:55:39.585017 [debug] [MainThread]: Command `dbt debug` failed at 11:55:39.584937 after 0.09 seconds
[0m11:55:39.585353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105131760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10546aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540d220>]}
[0m11:55:39.585695 [debug] [MainThread]: Flushing usage events
[0m11:55:39.970145 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:56:54.283488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10738dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf5880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf51f0>]}


============================== 11:56:54.289700 | 353c0836-dc5c-4882-a024-781939cca586 ==============================
[0m11:56:54.289700 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:56:54.290224 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug --profiles-dir ..', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:56:54.303137 [info ] [MainThread]: dbt version: 1.10.3
[0m11:56:54.303706 [info ] [MainThread]: python version: 3.12.3
[0m11:56:54.304057 [info ] [MainThread]: python path: /Users/samydoreau/global-assignment/venv/bin/python3.12
[0m11:56:54.304261 [info ] [MainThread]: os info: macOS-15.5-arm64-arm-64bit
[0m11:56:54.405473 [info ] [MainThread]: Using profiles dir at ..
[0m11:56:54.406588 [info ] [MainThread]: Using profiles.yml file at ../profiles.yml
[0m11:56:54.407583 [info ] [MainThread]: Using dbt_project.yml file at /Users/samydoreau/global-assignment/dbt/dbt_project.yml
[0m11:56:54.409384 [info ] [MainThread]: adapter type: postgres
[0m11:56:54.409856 [info ] [MainThread]: adapter version: 1.9.0
[0m11:56:54.525226 [info ] [MainThread]: Configuration:
[0m11:56:54.526057 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:56:54.526423 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:56:54.526675 [info ] [MainThread]: Required dependencies:
[0m11:56:54.527018 [debug] [MainThread]: Executing "git --help"
[0m11:56:54.549980 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:56:54.550844 [debug] [MainThread]: STDERR: "b''"
[0m11:56:54.551147 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:56:54.551424 [info ] [MainThread]: Connection:
[0m11:56:54.551679 [info ] [MainThread]:   host: localhost
[0m11:56:54.551891 [info ] [MainThread]:   port: 5432
[0m11:56:54.552094 [info ] [MainThread]:   user: podcast
[0m11:56:54.552288 [info ] [MainThread]:   database: podcast_analytics
[0m11:56:54.552488 [info ] [MainThread]:   schema: public
[0m11:56:54.552684 [info ] [MainThread]:   connect_timeout: 10
[0m11:56:54.552883 [info ] [MainThread]:   role: None
[0m11:56:54.553081 [info ] [MainThread]:   search_path: None
[0m11:56:54.553278 [info ] [MainThread]:   keepalives_idle: 0
[0m11:56:54.553472 [info ] [MainThread]:   sslmode: None
[0m11:56:54.553861 [info ] [MainThread]:   sslcert: None
[0m11:56:54.554144 [info ] [MainThread]:   sslkey: None
[0m11:56:54.554484 [info ] [MainThread]:   sslrootcert: None
[0m11:56:54.554900 [info ] [MainThread]:   application_name: dbt
[0m11:56:54.555185 [info ] [MainThread]:   retries: 1
[0m11:56:54.555958 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m11:56:54.641207 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m11:56:54.690715 [debug] [MainThread]: Using postgres connection "debug"
[0m11:56:54.691282 [debug] [MainThread]: On debug: select 1 as id
[0m11:56:54.691613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:56:54.822424 [debug] [MainThread]: SQL status: SELECT 1 in 0.131 seconds
[0m11:56:54.823362 [debug] [MainThread]: On debug: Close
[0m11:56:54.823906 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:56:54.824227 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:56:54.827100 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.6103903, "process_in_blocks": "0", "process_kernel_time": 0.218588, "process_mem_max_rss": "118161408", "process_out_blocks": "0", "process_user_time": 0.994296}
[0m11:56:54.827587 [debug] [MainThread]: Command `dbt debug` succeeded at 11:56:54.827509 after 0.61 seconds
[0m11:56:54.827868 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:56:54.828161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203e3740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120026b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120024c20>]}
[0m11:56:54.828499 [debug] [MainThread]: Flushing usage events
[0m11:56:55.213428 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:57:04.968394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a88fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bad9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bad340>]}


============================== 11:57:04.971311 | bfc4cac2-543a-403f-94e8-338ea98ecfbb ==============================
[0m11:57:04.971311 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:57:04.971660 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '..', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m11:57:05.031770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfc4cac2-543a-403f-94e8-338ea98ecfbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10665f470>]}
[0m11:57:05.042028 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-mkvro295'
[0m11:57:05.042275 [error] [MainThread]: Encountered an error:
">=1.0" is not a valid semantic version.
[0m11:57:05.044540 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 237, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 461, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/task/deps.py", line 215, in run
    self.lock()
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/deps/resolver.py", line 121, in resolve_packages
    pending = PackageListing.from_contracts(packages)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/deps/resolver.py", line 91, in from_contracts
    self.update_from(src)
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/deps/resolver.py", line 83, in update_from
    pkg = RegistryUnpinnedPackage.from_contract(contract)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/deps/registry.py", line 83, in from_contract
    versions = [semver.VersionSpecifier.from_version_string(v) for v in raw_version]
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt_common/semver.py", line 99, in from_version_string
    raise dbt_common.exceptions.base.SemverError(
dbt_common.exceptions.base.SemverError: ">=1.0" is not a valid semantic version.

[0m11:57:05.046142 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.12658554, "process_in_blocks": "0", "process_kernel_time": 0.09941, "process_mem_max_rss": "109608960", "process_out_blocks": "0", "process_user_time": 0.690448}
[0m11:57:05.046430 [debug] [MainThread]: Command `dbt deps` failed at 11:57:05.046384 after 0.13 seconds
[0m11:57:05.046646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045cf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c63020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108839220>]}
[0m11:57:05.046879 [debug] [MainThread]: Flushing usage events
[0m11:57:05.405514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:09.956594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105854770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fd8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fd250>]}


============================== 11:58:09.960137 | cc56f8f2-de50-4260-80f2-9333fe2ffeea ==============================
[0m11:58:09.960137 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:58:09.960641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '..', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m11:58:10.028221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc56f8f2-de50-4260-80f2-9333fe2ffeea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051fd760>]}
[0m11:58:10.039281 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-es38azcd'
[0m11:58:10.039558 [error] [MainThread]: Encountered an error:
">=1.1.1, <2.0.0" is not a valid semantic version.
[0m11:58:10.041990 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 237, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 461, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/task/deps.py", line 215, in run
    self.lock()
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/deps/resolver.py", line 121, in resolve_packages
    pending = PackageListing.from_contracts(packages)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/deps/resolver.py", line 91, in from_contracts
    self.update_from(src)
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/deps/resolver.py", line 83, in update_from
    pkg = RegistryUnpinnedPackage.from_contract(contract)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/deps/registry.py", line 83, in from_contract
    versions = [semver.VersionSpecifier.from_version_string(v) for v in raw_version]
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt_common/semver.py", line 99, in from_version_string
    raise dbt_common.exceptions.base.SemverError(
dbt_common.exceptions.base.SemverError: ">=1.1.1, <2.0.0" is not a valid semantic version.

[0m11:58:10.043874 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.13108195, "process_in_blocks": "0", "process_kernel_time": 0.116139, "process_mem_max_rss": "109592576", "process_out_blocks": "0", "process_user_time": 0.727964}
[0m11:58:10.044196 [debug] [MainThread]: Command `dbt deps` failed at 11:58:10.044142 after 0.13 seconds
[0m11:58:10.044440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062fd520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103357320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10639e630>]}
[0m11:58:10.044662 [debug] [MainThread]: Flushing usage events
[0m11:58:10.427369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:58:55.469527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076be1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1380f5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1380f5340>]}


============================== 11:58:55.472762 | f02abaf5-1d65-42f5-9cbb-d27a9b575b5b ==============================
[0m11:58:55.472762 [info ] [MainThread]: Running with dbt=1.10.3
[0m11:58:55.473156 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'profiles_dir': '..', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir ..', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:58:55.633208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f02abaf5-1d65-42f5-9cbb-d27a9b575b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c53260>]}
[0m11:58:55.645669 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-580luvi6'
[0m11:58:55.646073 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m11:58:55.746039 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m11:58:55.747231 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m11:58:55.808074 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m11:58:55.813547 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package dbt-labs/dbt_utils
  Requested range: >=1.4.0, <2.0.0
  Compatible versions: ['0.0.1', '0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.1.6', '0.1.7', '0.1.8', '0.1.9', '0.1.10', '0.1.11', '0.1.12', '0.1.13', '0.1.14', '0.1.15', '0.1.16', '0.1.17', '0.1.18', '0.1.19', '0.1.20', '0.1.21', '0.1.22', '0.1.23', '0.1.24', '0.1.25', '0.2.0', '0.2.1', '0.2.2', '0.2.3', '0.2.4', '0.2.5', '0.3.0', '0.4.0', '0.4.1', '0.5.0', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.8.6', '0.9.0', '0.9.1', '0.9.2', '0.9.5', '0.9.6', '1.0.0', '1.1.0', '1.1.1', '1.2.0', '1.3.0']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m11:58:55.816972 [error] [MainThread]: Traceback (most recent call last):
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 237, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 461, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/task/deps.py", line 215, in run
    self.lock()
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/deps/resolver.py", line 131, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/samydoreau/global-assignment/venv/lib/python3.12/site-packages/dbt/deps/registry.py", line 124, in resolved
    raise PackageVersionNotFoundError(
dbt.exceptions.PackageVersionNotFoundError: Could not find a matching compatible version for package dbt-labs/dbt_utils
  Requested range: >=1.4.0, <2.0.0
  Compatible versions: ['0.0.1', '0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.1.6', '0.1.7', '0.1.8', '0.1.9', '0.1.10', '0.1.11', '0.1.12', '0.1.13', '0.1.14', '0.1.15', '0.1.16', '0.1.17', '0.1.18', '0.1.19', '0.1.20', '0.1.21', '0.1.22', '0.1.23', '0.1.24', '0.1.25', '0.2.0', '0.2.1', '0.2.2', '0.2.3', '0.2.4', '0.2.5', '0.3.0', '0.4.0', '0.4.1', '0.5.0', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.8.6', '0.9.0', '0.9.1', '0.9.2', '0.9.5', '0.9.6', '1.0.0', '1.1.0', '1.1.1', '1.2.0', '1.3.0']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'

[0m11:58:55.819783 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.39463574, "process_in_blocks": "0", "process_kernel_time": 0.17615, "process_mem_max_rss": "110133248", "process_out_blocks": "0", "process_user_time": 1.028869}
[0m11:58:55.821195 [debug] [MainThread]: Command `dbt deps` failed at 11:58:55.820897 after 0.40 seconds
[0m11:58:55.821908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cb7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138157710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1381aa8d0>]}
[0m11:58:55.822563 [debug] [MainThread]: Flushing usage events
[0m11:58:56.231263 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:17.779277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103942cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf5880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf51f0>]}


============================== 12:00:17.782105 | aa9dd808-2980-486a-9f10-483f6de0f92e ==============================
[0m12:00:17.782105 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:00:17.782451 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir ..', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:00:17.845139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa9dd808-2980-486a-9f10-483f6de0f92e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca7fb0>]}
[0m12:00:17.857118 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-kvwluki3'
[0m12:00:17.857534 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:00:17.948281 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:00:17.948770 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:00:18.004040 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:00:18.010993 [info ] [MainThread]: Updating lock file in file path: /Users/samydoreau/global-assignment/dbt/package-lock.yml
[0m12:00:18.012077 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-8nt4vfgv'
[0m12:00:18.013444 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:00:18.242220 [info ] [MainThread]: Installed from version 1.3.0
[0m12:00:18.242533 [info ] [MainThread]: Up to date!
[0m12:00:18.242765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'aa9dd808-2980-486a-9f10-483f6de0f92e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10796ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ee6210>]}
[0m12:00:18.244618 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.50614214, "process_in_blocks": "0", "process_kernel_time": 0.137898, "process_mem_max_rss": "111919104", "process_out_blocks": "0", "process_user_time": 0.742044}
[0m12:00:18.244951 [debug] [MainThread]: Command `dbt deps` succeeded at 12:00:18.244894 after 0.51 seconds
[0m12:00:18.245172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107939760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103942cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b23500>]}
[0m12:00:18.245379 [debug] [MainThread]: Flushing usage events
[0m12:00:18.641005 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:00:20.642558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ccc260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df5b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df54c0>]}


============================== 12:00:20.646214 | a0ac8e94-14d7-4439-9a71-956789f2f04f ==============================
[0m12:00:20.646214 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:00:20.646763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --profiles-dir ..', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:00:20.889453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0ac8e94-14d7-4439-9a71-956789f2f04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0ed640>]}
[0m12:00:20.932330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a0ac8e94-14d7-4439-9a71-956789f2f04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c34ad0>]}
[0m12:00:20.933392 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:00:21.047726 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m12:00:21.048547 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:00:21.049392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a0ac8e94-14d7-4439-9a71-956789f2f04f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ee570>]}
[0m12:00:21.922031 [error] [MainThread]: Encountered an error:
Compilation Error in model stg_user_events (models/staging/stg_user_events.sql)
  unexpected char '"' at 431
    line 18
      "data ->> 'type'
[0m12:00:21.925249 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 1.3352959, "process_in_blocks": "0", "process_kernel_time": 0.255585, "process_mem_max_rss": "110329856", "process_out_blocks": "0", "process_user_time": 2.028181}
[0m12:00:21.926272 [debug] [MainThread]: Command `dbt seed` failed at 12:00:21.926098 after 1.34 seconds
[0m12:00:21.927348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ccc260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9f0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa5f0b0>]}
[0m12:00:21.928585 [debug] [MainThread]: Flushing usage events
[0m12:00:22.439434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:50.398801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193b7a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b809880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8091f0>]}


============================== 12:10:50.402247 | a466d180-49b5-481d-86bc-9f4829ddaaf5 ==============================
[0m12:10:50.402247 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:10:50.402825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir ..', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:10:50.498803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a466d180-49b5-481d-86bc-9f4829ddaaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b7b6ae0>]}
[0m12:10:50.539133 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-7layy7sr'
[0m12:10:50.539606 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:10:50.623409 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:10:50.624217 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:10:50.676066 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:10:50.678336 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:10:50.897900 [info ] [MainThread]: Installed from version 1.3.0
[0m12:10:50.898264 [info ] [MainThread]: Up to date!
[0m12:10:50.898531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a466d180-49b5-481d-86bc-9f4829ddaaf5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a728080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b89d550>]}
[0m12:10:50.900978 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.55341005, "process_in_blocks": "0", "process_kernel_time": 0.220849, "process_mem_max_rss": "110018560", "process_out_blocks": "0", "process_user_time": 0.981178}
[0m12:10:50.901324 [debug] [MainThread]: Command `dbt deps` succeeded at 12:10:50.901262 after 0.55 seconds
[0m12:10:50.901564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b879e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b809820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8095b0>]}
[0m12:10:50.901787 [debug] [MainThread]: Flushing usage events
[0m12:10:51.288093 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:52.681233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113ee3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df5640>]}


============================== 12:10:52.683882 | 818fa54f-1830-40e6-b8c9-d63d72fbe137 ==============================
[0m12:10:52.683882 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:10:52.684269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m12:10:52.805501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '818fa54f-1830-40e6-b8c9-d63d72fbe137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110870d40>]}
[0m12:10:52.841089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '818fa54f-1830-40e6-b8c9-d63d72fbe137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107100bc0>]}
[0m12:10:52.842653 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:10:52.917815 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m12:10:52.918656 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:10:52.918982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '818fa54f-1830-40e6-b8c9-d63d72fbe137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125bbef0>]}
[0m12:10:53.993022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '818fa54f-1830-40e6-b8c9-d63d72fbe137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113199d90>]}
[0m12:10:54.243366 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m12:10:54.254511 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m12:10:54.309597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '818fa54f-1830-40e6-b8c9-d63d72fbe137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113329d90>]}
[0m12:10:54.310626 [info ] [MainThread]: Found 6 models, 2 seeds, 7 data tests, 3 sources, 549 macros
[0m12:10:54.311260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '818fa54f-1830-40e6-b8c9-d63d72fbe137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d0a9c0>]}
[0m12:10:54.320322 [info ] [MainThread]: 
[0m12:10:54.321162 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m12:10:54.322150 [info ] [MainThread]: 
[0m12:10:54.324831 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:10:54.336707 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m12:10:54.411493 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m12:10:54.413464 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m12:10:54.415985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:54.546662 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.131 seconds
[0m12:10:54.549774 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m12:10:54.552437 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m12:10:54.566640 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m12:10:54.567428 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m12:10:54.569183 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:54.615423 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m12:10:54.616586 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m12:10:54.617119 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:10:54.642066 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.024 seconds
[0m12:10:54.643768 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m12:10:54.644930 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m12:10:54.651711 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:54.652128 [debug] [MainThread]: On master: BEGIN
[0m12:10:54.652384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:10:54.673431 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m12:10:54.674320 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:54.675007 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:10:54.685862 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m12:10:54.687120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '818fa54f-1830-40e6-b8c9-d63d72fbe137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131996a0>]}
[0m12:10:54.687708 [debug] [MainThread]: On master: ROLLBACK
[0m12:10:54.688597 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:54.688891 [debug] [MainThread]: On master: BEGIN
[0m12:10:54.690075 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:10:54.690370 [debug] [MainThread]: On master: COMMIT
[0m12:10:54.690645 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:54.691023 [debug] [MainThread]: On master: COMMIT
[0m12:10:54.692071 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:10:54.692573 [debug] [MainThread]: On master: Close
[0m12:10:54.699338 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m12:10:54.700152 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m12:10:54.700847 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m12:10:54.701565 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m12:10:54.702279 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m12:10:54.702806 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m12:10:54.703293 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m12:10:54.703738 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m12:10:54.704232 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m12:10:54.704845 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m12:10:54.784670 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m12:10:54.787724 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m12:10:54.788362 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m12:10:54.788832 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m12:10:54.789223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:54.789616 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:10:54.805687 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m12:10:54.806420 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m12:10:54.806829 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */

    create table "podcast_analytics"."public"."raw_episodes" ("episode_id" text,"podcast_id" text,"title" text,"release_date" date,"duration_seconds" integer)
  
[0m12:10:54.807228 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m12:10:54.807552 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m12:10:54.808396 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */

    create table "podcast_analytics"."public"."raw_users" ("user_id" text,"signup_date" date,"country" text)
  
[0m12:10:54.827971 [debug] [Thread-2 (]: SQL status: CREATE TABLE in 0.019 seconds
[0m12:10:54.828605 [debug] [Thread-1 (]: SQL status: CREATE TABLE in 0.021 seconds
[0m12:10:55.038721 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m12:10:55.048004 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m12:10:55.049117 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m12:10:55.050796 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m12:10:55.055195 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.004 seconds
[0m12:10:55.055601 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.004 seconds
[0m12:10:55.060584 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m12:10:55.061267 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m12:10:55.088170 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m12:10:55.089381 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m12:10:55.089845 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m12:10:55.090197 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m12:10:55.090518 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m12:10:55.090831 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m12:10:55.093113 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m12:10:55.093405 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m12:10:55.094695 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m12:10:55.095210 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m12:10:55.098146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '818fa54f-1830-40e6-b8c9-d63d72fbe137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10702e450>]}
[0m12:10:55.098541 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '818fa54f-1830-40e6-b8c9-d63d72fbe137', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dccce0>]}
[0m12:10:55.099028 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.39s]
[0m12:10:55.099805 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.39s]
[0m12:10:55.100365 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m12:10:55.100747 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m12:10:55.101945 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:55.102225 [debug] [MainThread]: On master: BEGIN
[0m12:10:55.102454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:10:55.124394 [debug] [MainThread]: SQL status: BEGIN in 0.022 seconds
[0m12:10:55.126124 [debug] [MainThread]: On master: COMMIT
[0m12:10:55.126810 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:55.127553 [debug] [MainThread]: On master: COMMIT
[0m12:10:55.129038 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:10:55.129650 [debug] [MainThread]: On master: Close
[0m12:10:55.130400 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:55.130943 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m12:10:55.131334 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m12:10:55.131784 [info ] [MainThread]: 
[0m12:10:55.132427 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m12:10:55.133395 [debug] [MainThread]: Command end result
[0m12:10:55.233475 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m12:10:55.235021 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m12:10:55.238913 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m12:10:55.239191 [info ] [MainThread]: 
[0m12:10:55.239501 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:10:55.239745 [info ] [MainThread]: 
[0m12:10:55.240017 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:10:55.242119 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 2.6026213, "process_in_blocks": "0", "process_kernel_time": 0.275887, "process_mem_max_rss": "134463488", "process_out_blocks": "0", "process_user_time": 2.582937}
[0m12:10:55.242482 [debug] [MainThread]: Command `dbt seed` succeeded at 12:10:55.242424 after 2.60 seconds
[0m12:10:55.242774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111728170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133a26f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133a12b0>]}
[0m12:10:55.243056 [debug] [MainThread]: Flushing usage events
[0m12:10:55.612248 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:10:56.861131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062f8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f5490>]}


============================== 12:10:56.864269 | 303e52e2-dccc-4bbd-83df-65c833c91e75 ==============================
[0m12:10:56.864269 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:10:56.865099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'profiles_dir': '..', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ..', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:10:56.970296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '303e52e2-dccc-4bbd-83df-65c833c91e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074cf410>]}
[0m12:10:57.003319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '303e52e2-dccc-4bbd-83df-65c833c91e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fada30>]}
[0m12:10:57.004072 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:10:57.069271 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m12:10:57.153249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:10:57.153615 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:10:57.187279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '303e52e2-dccc-4bbd-83df-65c833c91e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5b740>]}
[0m12:10:57.243933 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m12:10:57.245377 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m12:10:57.256165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '303e52e2-dccc-4bbd-83df-65c833c91e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103ff080>]}
[0m12:10:57.455974 [info ] [MainThread]: Found 6 models, 2 seeds, 7 data tests, 3 sources, 549 macros
[0m12:10:57.458418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '303e52e2-dccc-4bbd-83df-65c833c91e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103b7080>]}
[0m12:10:57.462977 [info ] [MainThread]: 
[0m12:10:57.464506 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m12:10:57.466272 [info ] [MainThread]: 
[0m12:10:57.468092 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:10:57.478077 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m12:10:57.523177 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m12:10:57.523687 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m12:10:57.524025 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:10:57.562840 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.039 seconds
[0m12:10:57.564576 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m12:10:57.566864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m12:10:57.571059 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m12:10:57.571398 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m12:10:57.571612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:10:57.589290 [debug] [ThreadPool]: SQL status: BEGIN in 0.018 seconds
[0m12:10:57.589942 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m12:10:57.590551 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:10:57.595200 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m12:10:57.598003 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m12:10:57.599368 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m12:10:57.604223 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:57.604619 [debug] [MainThread]: On master: BEGIN
[0m12:10:57.604854 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:10:57.613631 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:10:57.614347 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:57.614758 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:10:57.620242 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m12:10:57.621170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '303e52e2-dccc-4bbd-83df-65c833c91e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a0bec0>]}
[0m12:10:57.621565 [debug] [MainThread]: On master: ROLLBACK
[0m12:10:57.622197 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:57.622419 [debug] [MainThread]: On master: BEGIN
[0m12:10:57.623167 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:10:57.623375 [debug] [MainThread]: On master: COMMIT
[0m12:10:57.623722 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:57.623940 [debug] [MainThread]: On master: COMMIT
[0m12:10:57.624438 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:10:57.624642 [debug] [MainThread]: On master: Close
[0m12:10:57.626479 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m12:10:57.626794 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m12:10:57.627347 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_users
[0m12:10:57.627134 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_episodes ................................ [RUN]
[0m12:10:57.627792 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_user_events ............................. [RUN]
[0m12:10:57.628131 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_users ................................... [RUN]
[0m12:10:57.628443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m12:10:57.628749 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m12:10:57.629030 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m12:10:57.629280 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m12:10:57.629505 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m12:10:57.629722 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_users
[0m12:10:57.635973 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m12:10:57.645337 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m12:10:57.647574 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m12:10:57.649193 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m12:10:57.649508 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m12:10:57.656507 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_users
[0m12:10:57.672155 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m12:10:57.675382 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m12:10:57.677478 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m12:10:57.678269 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m12:10:57.678557 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m12:10:57.678829 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m12:10:57.679057 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m12:10:57.679304 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m12:10:57.679535 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: BEGIN
[0m12:10:57.679778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:10:57.680022 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:10:57.680595 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:10:57.693000 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m12:10:57.693319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m12:10:57.693619 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m12:10:57.693924 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m12:10:57.694192 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."raw"."users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source;
  );
[0m12:10:57.694426 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m12:10:57.694687 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."raw"."episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source;
  );
[0m12:10:57.694989 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m12:10:57.695318 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
with source as (
    select data
    from "podcast_analytics"."raw"."raw_event_files"
),

filtered as (
    select * from source
    where data ->> 'type' in ('play', 'pause', 'seek', 'complete')
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'ts' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        (data ->> 'ts')::timestamp as event_ts,
        data ->> 'type'         as event_type,
        (data ->> 'duration')::integer as duration
    from filtered
)
select * from typed;
  );
[0m12:10:57.695639 [debug] [Thread-3 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 15: from source;
                    ^

[0m12:10:57.695916 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 17: from source;
                    ^

[0m12:10:57.696229 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: ROLLBACK
[0m12:10:57.696558 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: ROLLBACK
[0m12:10:57.697044 [debug] [Thread-2 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 28: select * from typed;
                            ^

[0m12:10:57.698056 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: Close
[0m12:10:57.698999 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m12:10:57.699302 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: ROLLBACK
[0m12:10:57.701703 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m12:10:57.709768 [debug] [Thread-1 (]: Database Error in model stg_episodes (models/1.staging/stg_episodes.sql)
  syntax error at or near ";"
  LINE 17: from source;
                      ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_episodes.sql
[0m12:10:57.710891 [debug] [Thread-2 (]: Database Error in model stg_user_events (models/1.staging/stg_user_events.sql)
  syntax error at or near ";"
  LINE 28: select * from typed;
                              ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_user_events.sql
[0m12:10:57.712686 [debug] [Thread-3 (]: Database Error in model stg_users (models/1.staging/stg_users.sql)
  syntax error at or near ";"
  LINE 15: from source;
                      ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_users.sql
[0m12:10:57.713235 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '303e52e2-dccc-4bbd-83df-65c833c91e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107f8c50>]}
[0m12:10:57.713576 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '303e52e2-dccc-4bbd-83df-65c833c91e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114837080>]}
[0m12:10:57.714103 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '303e52e2-dccc-4bbd-83df-65c833c91e75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f5190>]}
[0m12:10:57.714687 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_episodes ....................... [[31mERROR[0m in 0.08s]
[0m12:10:57.715583 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_user_events .................... [[31mERROR[0m in 0.08s]
[0m12:10:57.716085 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_users .......................... [[31mERROR[0m in 0.08s]
[0m12:10:57.716599 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m12:10:57.716974 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m12:10:57.717325 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_users
[0m12:10:57.717678 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.stg_episodes' to be skipped because of status 'error'.  Reason: Database Error in model stg_episodes (models/1.staging/stg_episodes.sql)
  syntax error at or near ";"
  LINE 17: from source;
                      ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_episodes.sql.
[0m12:10:57.718527 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.stg_user_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_user_events (models/1.staging/stg_user_events.sql)
  syntax error at or near ";"
  LINE 28: select * from typed;
                              ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_user_events.sql.
[0m12:10:57.718875 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.stg_users' to be skipped because of status 'error'.  Reason: Database Error in model stg_users (models/1.staging/stg_users.sql)
  syntax error at or near ";"
  LINE 15: from source;
                      ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_users.sql.
[0m12:10:57.719213 [debug] [Thread-4 (]: Began running node model.podcast_analytics.int_user_sessions
[0m12:10:57.719494 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m12:10:57.719820 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.int_user_sessions .................................. [[33mSKIP[0m]
[0m12:10:57.720115 [info ] [Thread-1 (]: 5 of 6 SKIP relation public.mart_top_episodes .................................. [[33mSKIP[0m]
[0m12:10:57.720898 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m12:10:57.721199 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m12:10:57.721599 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m12:10:57.721898 [info ] [Thread-1 (]: 6 of 6 SKIP relation public.mart_user_session_metrics .......................... [[33mSKIP[0m]
[0m12:10:57.722185 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m12:10:57.723014 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:57.723244 [debug] [MainThread]: On master: BEGIN
[0m12:10:57.723449 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:10:57.734052 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m12:10:57.734592 [debug] [MainThread]: On master: COMMIT
[0m12:10:57.734934 [debug] [MainThread]: Using postgres connection "master"
[0m12:10:57.735140 [debug] [MainThread]: On master: COMMIT
[0m12:10:57.736183 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:10:57.736560 [debug] [MainThread]: On master: Close
[0m12:10:57.736883 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:10:57.737085 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_episodes' was properly closed.
[0m12:10:57.737715 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_user_events' was properly closed.
[0m12:10:57.737977 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_users' was properly closed.
[0m12:10:57.738282 [info ] [MainThread]: 
[0m12:10:57.738602 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m12:10:57.739219 [debug] [MainThread]: Command end result
[0m12:10:57.759188 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m12:10:57.760707 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m12:10:57.766489 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m12:10:57.767134 [info ] [MainThread]: 
[0m12:10:57.767597 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m12:10:57.767918 [info ] [MainThread]: 
[0m12:10:57.768276 [error] [MainThread]: [31mFailure in model stg_episodes (models/1.staging/stg_episodes.sql)[0m
[0m12:10:57.768726 [error] [MainThread]:   Database Error in model stg_episodes (models/1.staging/stg_episodes.sql)
  syntax error at or near ";"
  LINE 17: from source;
                      ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_episodes.sql
[0m12:10:57.769167 [info ] [MainThread]: 
[0m12:10:57.769413 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/1.staging/stg_episodes.sql
[0m12:10:57.769622 [info ] [MainThread]: 
[0m12:10:57.769855 [error] [MainThread]: [31mFailure in model stg_user_events (models/1.staging/stg_user_events.sql)[0m
[0m12:10:57.770094 [error] [MainThread]:   Database Error in model stg_user_events (models/1.staging/stg_user_events.sql)
  syntax error at or near ";"
  LINE 28: select * from typed;
                              ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_user_events.sql
[0m12:10:57.770302 [info ] [MainThread]: 
[0m12:10:57.770535 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/1.staging/stg_user_events.sql
[0m12:10:57.770743 [info ] [MainThread]: 
[0m12:10:57.770988 [error] [MainThread]: [31mFailure in model stg_users (models/1.staging/stg_users.sql)[0m
[0m12:10:57.771229 [error] [MainThread]:   Database Error in model stg_users (models/1.staging/stg_users.sql)
  syntax error at or near ";"
  LINE 15: from source;
                      ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_users.sql
[0m12:10:57.771442 [info ] [MainThread]: 
[0m12:10:57.771679 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/1.staging/stg_users.sql
[0m12:10:57.771884 [info ] [MainThread]: 
[0m12:10:57.772115 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=3 NO-OP=0 TOTAL=6
[0m12:10:57.774783 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.95577544, "process_in_blocks": "0", "process_kernel_time": 0.197929, "process_mem_max_rss": "120700928", "process_out_blocks": "0", "process_user_time": 1.425613}
[0m12:10:57.775236 [debug] [MainThread]: Command `dbt run` failed at 12:10:57.775173 after 0.96 seconds
[0m12:10:57.775570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c30170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103b7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103b7f80>]}
[0m12:10:57.775860 [debug] [MainThread]: Flushing usage events
[0m12:10:58.134317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:35.345181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1227005f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232098b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123209280>]}


============================== 12:11:35.353474 | 914a240a-881c-4666-b3a7-b1c0ea09ac8f ==============================
[0m12:11:35.353474 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:11:35.354137 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir ..', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:11:35.506991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '914a240a-881c-4666-b3a7-b1c0ea09ac8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122f15970>]}
[0m12:11:35.566594 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-xlfqpoyw'
[0m12:11:35.567227 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:11:35.661424 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:11:35.662277 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:11:35.718534 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:11:35.721570 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:11:35.972116 [info ] [MainThread]: Installed from version 1.3.0
[0m12:11:35.972540 [info ] [MainThread]: Up to date!
[0m12:11:35.972861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '914a240a-881c-4666-b3a7-b1c0ea09ac8f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12318a480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x122ce7230>]}
[0m12:11:35.975292 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7215447, "process_in_blocks": "0", "process_kernel_time": 0.295965, "process_mem_max_rss": "109805568", "process_out_blocks": "0", "process_user_time": 1.375058}
[0m12:11:35.975692 [debug] [MainThread]: Command `dbt deps` succeeded at 12:11:35.975612 after 0.72 seconds
[0m12:11:35.975973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10468b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1232098b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123209280>]}
[0m12:11:35.976241 [debug] [MainThread]: Flushing usage events
[0m12:11:36.399573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:37.613787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ce180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f5bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f5550>]}


============================== 12:11:37.617501 | b22df26c-2d14-4fee-9f9d-95bd042dba4b ==============================
[0m12:11:37.617501 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:11:37.617964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed --profiles-dir ..', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:11:37.737255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b22df26c-2d14-4fee-9f9d-95bd042dba4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11018b2f0>]}
[0m12:11:37.776543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b22df26c-2d14-4fee-9f9d-95bd042dba4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11049fdd0>]}
[0m12:11:37.777625 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:11:37.855379 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m12:11:37.953911 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 6 files changed.
[0m12:11:37.954533 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/1.staging/stg_users.sql
[0m12:11:37.954830 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/3.marts/mart_top_episodes.sql
[0m12:11:37.955094 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/3.marts/mart_user_session_metrics.sql
[0m12:11:37.955370 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/1.staging/stg_user_events.sql
[0m12:11:37.955636 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/1.staging/stg_episodes.sql
[0m12:11:37.955880 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/2.intermediate/int_user_sessions.sql
[0m12:11:38.220199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b22df26c-2d14-4fee-9f9d-95bd042dba4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f46780>]}
[0m12:11:38.276358 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m12:11:38.278623 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m12:11:38.412502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b22df26c-2d14-4fee-9f9d-95bd042dba4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c0290>]}
[0m12:11:38.413125 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m12:11:38.413443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b22df26c-2d14-4fee-9f9d-95bd042dba4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e38c0>]}
[0m12:11:38.415123 [info ] [MainThread]: 
[0m12:11:38.415566 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m12:11:38.416040 [info ] [MainThread]: 
[0m12:11:38.417109 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:11:38.421218 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m12:11:38.679401 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m12:11:38.681805 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m12:11:38.683719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:38.785459 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.102 seconds
[0m12:11:38.786547 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m12:11:38.787728 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m12:11:38.791767 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m12:11:38.792043 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m12:11:38.792264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:38.804074 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:11:38.804544 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m12:11:38.804834 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:11:38.812209 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m12:11:38.813321 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m12:11:38.814116 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m12:11:38.818913 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:38.819255 [debug] [MainThread]: On master: BEGIN
[0m12:11:38.819495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:38.833119 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m12:11:38.833956 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:38.834367 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:11:38.838775 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m12:11:38.839812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b22df26c-2d14-4fee-9f9d-95bd042dba4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc6b10>]}
[0m12:11:38.840246 [debug] [MainThread]: On master: ROLLBACK
[0m12:11:38.840901 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:38.841157 [debug] [MainThread]: On master: BEGIN
[0m12:11:38.842006 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:11:38.842259 [debug] [MainThread]: On master: COMMIT
[0m12:11:38.842495 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:38.842722 [debug] [MainThread]: On master: COMMIT
[0m12:11:38.843204 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:11:38.843443 [debug] [MainThread]: On master: Close
[0m12:11:38.846161 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m12:11:38.846522 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m12:11:38.846933 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m12:11:38.847360 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m12:11:38.847737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m12:11:38.848085 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m12:11:38.848368 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m12:11:38.848644 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m12:11:38.848932 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m12:11:38.849708 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m12:11:38.887886 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m12:11:38.890564 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m12:11:38.890968 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m12:11:38.891278 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m12:11:38.891558 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:11:38.891829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:38.902029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:11:38.902471 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m12:11:38.902779 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m12:11:38.907186 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m12:11:38.907564 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m12:11:38.907859 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m12:11:38.908704 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.006 seconds
[0m12:11:38.917619 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.009 seconds
[0m12:11:38.990714 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m12:11:39.010370 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m12:11:39.012859 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m12:11:39.014080 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m12:11:39.016647 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.003 seconds
[0m12:11:39.020827 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m12:11:39.021197 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.007 seconds
[0m12:11:39.021827 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m12:11:39.039003 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m12:11:39.039654 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m12:11:39.040022 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m12:11:39.040307 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m12:11:39.040582 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m12:11:39.040841 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m12:11:39.047974 [debug] [Thread-2 (]: SQL status: COMMIT in 0.007 seconds
[0m12:11:39.052206 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m12:11:39.054617 [debug] [Thread-1 (]: SQL status: COMMIT in 0.013 seconds
[0m12:11:39.056180 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m12:11:39.056929 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b22df26c-2d14-4fee-9f9d-95bd042dba4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f863f0>]}
[0m12:11:39.057426 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.21s]
[0m12:11:39.057940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b22df26c-2d14-4fee-9f9d-95bd042dba4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105058ad0>]}
[0m12:11:39.058596 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m12:11:39.059016 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.21s]
[0m12:11:39.064853 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m12:11:39.070743 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:39.071327 [debug] [MainThread]: On master: BEGIN
[0m12:11:39.071687 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:11:39.084423 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m12:11:39.085422 [debug] [MainThread]: On master: COMMIT
[0m12:11:39.085859 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:39.086146 [debug] [MainThread]: On master: COMMIT
[0m12:11:39.087193 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m12:11:39.087655 [debug] [MainThread]: On master: Close
[0m12:11:39.088233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:39.088605 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m12:11:39.088856 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m12:11:39.089136 [info ] [MainThread]: 
[0m12:11:39.089423 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m12:11:39.090033 [debug] [MainThread]: Command end result
[0m12:11:39.111944 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m12:11:39.113829 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m12:11:39.119559 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m12:11:39.119903 [info ] [MainThread]: 
[0m12:11:39.120228 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:11:39.120479 [info ] [MainThread]: 
[0m12:11:39.120736 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:11:39.122954 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.5501403, "process_in_blocks": "0", "process_kernel_time": 0.23609, "process_mem_max_rss": "129892352", "process_out_blocks": "0", "process_user_time": 1.815361}
[0m12:11:39.123327 [debug] [MainThread]: Command `dbt seed` succeeded at 12:11:39.123267 after 1.55 seconds
[0m12:11:39.123637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f5880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107967410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ce180>]}
[0m12:11:39.123951 [debug] [MainThread]: Flushing usage events
[0m12:11:39.479839 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:11:40.688650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab13a0>]}


============================== 12:11:40.691387 | f1ba3394-5eee-45e3-aa01-54d2db9a4f60 ==============================
[0m12:11:40.691387 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:11:40.691818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ..', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:11:40.790325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1ba3394-5eee-45e3-aa01-54d2db9a4f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090810a0>]}
[0m12:11:40.827060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1ba3394-5eee-45e3-aa01-54d2db9a4f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10913e720>]}
[0m12:11:40.827887 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:11:40.898396 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m12:11:40.979950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:11:40.980321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:11:41.014491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1ba3394-5eee-45e3-aa01-54d2db9a4f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a70a40>]}
[0m12:11:41.070541 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m12:11:41.071956 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m12:11:41.079899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1ba3394-5eee-45e3-aa01-54d2db9a4f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109afed80>]}
[0m12:11:41.080260 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m12:11:41.080495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1ba3394-5eee-45e3-aa01-54d2db9a4f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097edee0>]}
[0m12:11:41.081617 [info ] [MainThread]: 
[0m12:11:41.081860 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m12:11:41.082047 [info ] [MainThread]: 
[0m12:11:41.082363 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:11:41.084946 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m12:11:41.110945 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m12:11:41.111305 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m12:11:41.111527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:11:41.137238 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.026 seconds
[0m12:11:41.138246 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m12:11:41.139295 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m12:11:41.143322 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m12:11:41.143727 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m12:11:41.143963 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:11:41.155568 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m12:11:41.155972 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m12:11:41.156217 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:11:41.159696 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m12:11:41.160593 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m12:11:41.161352 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m12:11:41.165959 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:41.166264 [debug] [MainThread]: On master: BEGIN
[0m12:11:41.166469 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:11:41.182228 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m12:11:41.182570 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:41.182876 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:11:41.188175 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m12:11:41.189403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1ba3394-5eee-45e3-aa01-54d2db9a4f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e5ca10>]}
[0m12:11:41.189774 [debug] [MainThread]: On master: ROLLBACK
[0m12:11:41.190541 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:41.190754 [debug] [MainThread]: On master: BEGIN
[0m12:11:41.191554 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:11:41.191770 [debug] [MainThread]: On master: COMMIT
[0m12:11:41.191972 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:41.192154 [debug] [MainThread]: On master: COMMIT
[0m12:11:41.192635 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:11:41.192906 [debug] [MainThread]: On master: Close
[0m12:11:41.194814 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m12:11:41.195115 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m12:11:41.195385 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_users
[0m12:11:41.195733 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_episodes ................................ [RUN]
[0m12:11:41.196072 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_user_events ............................. [RUN]
[0m12:11:41.196377 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_users ................................... [RUN]
[0m12:11:41.196723 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m12:11:41.197068 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m12:11:41.197367 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m12:11:41.197615 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m12:11:41.197844 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m12:11:41.198066 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_users
[0m12:11:41.204176 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m12:11:41.213027 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m12:11:41.214548 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m12:11:41.215164 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m12:11:41.215424 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m12:11:41.215669 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_users
[0m12:11:41.236124 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m12:11:41.238279 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m12:11:41.241175 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m12:11:41.241800 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m12:11:41.242082 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m12:11:41.242362 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m12:11:41.242578 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m12:11:41.242804 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m12:11:41.243025 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: BEGIN
[0m12:11:41.243248 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:11:41.243464 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:11:41.243674 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:11:41.279142 [debug] [Thread-2 (]: SQL status: BEGIN in 0.036 seconds
[0m12:11:41.279536 [debug] [Thread-3 (]: SQL status: BEGIN in 0.036 seconds
[0m12:11:41.279857 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m12:11:41.280108 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m12:11:41.280383 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
with source as (
    select data
    from "podcast_analytics"."raw"."raw_event_files"
),

filtered as (
    select * from source
    where data ->> 'type' in ('play', 'pause', 'seek', 'complete')
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'ts' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        (data ->> 'ts')::timestamp as event_ts,
        data ->> 'type'         as event_type,
        (data ->> 'duration')::integer as duration
    from filtered
)
select * from typed
  );
[0m12:11:41.280696 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."raw"."users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m12:11:41.281466 [debug] [Thread-1 (]: SQL status: BEGIN in 0.038 seconds
[0m12:11:41.281713 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m12:11:41.281957 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."raw"."episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m12:11:41.282273 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "raw.raw_event_files" does not exist
LINE 10:     from "podcast_analytics"."raw"."raw_event_files"
                  ^

[0m12:11:41.282556 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: ROLLBACK
[0m12:11:41.282888 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.users" does not exist
LINE 9:     select * from "podcast_analytics"."raw"."users"
                          ^

[0m12:11:41.283638 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.episodes" does not exist
LINE 9:     select * from "podcast_analytics"."raw"."episodes"
                          ^

[0m12:11:41.286065 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m12:11:41.286415 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: ROLLBACK
[0m12:11:41.286686 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: ROLLBACK
[0m12:11:41.289486 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: Close
[0m12:11:41.289926 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m12:11:41.298399 [debug] [Thread-3 (]: Database Error in model stg_users (models/1.staging/stg_users.sql)
  relation "raw.users" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."users"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_users.sql
[0m12:11:41.299378 [debug] [Thread-1 (]: Database Error in model stg_episodes (models/1.staging/stg_episodes.sql)
  relation "raw.episodes" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."episodes"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_episodes.sql
[0m12:11:41.302115 [debug] [Thread-2 (]: Database Error in model stg_user_events (models/1.staging/stg_user_events.sql)
  relation "raw.raw_event_files" does not exist
  LINE 10:     from "podcast_analytics"."raw"."raw_event_files"
                    ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_user_events.sql
[0m12:11:41.303095 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1ba3394-5eee-45e3-aa01-54d2db9a4f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f3d9d0>]}
[0m12:11:41.303375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1ba3394-5eee-45e3-aa01-54d2db9a4f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ee88f0>]}
[0m12:11:41.303630 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1ba3394-5eee-45e3-aa01-54d2db9a4f60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d88bc0>]}
[0m12:11:41.304105 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_users .......................... [[31mERROR[0m in 0.10s]
[0m12:11:41.304669 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_episodes ....................... [[31mERROR[0m in 0.11s]
[0m12:11:41.305106 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_user_events .................... [[31mERROR[0m in 0.11s]
[0m12:11:41.305518 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_users
[0m12:11:41.305889 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m12:11:41.306244 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m12:11:41.306614 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.stg_users' to be skipped because of status 'error'.  Reason: Database Error in model stg_users (models/1.staging/stg_users.sql)
  relation "raw.users" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."users"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_users.sql.
[0m12:11:41.307550 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.stg_episodes' to be skipped because of status 'error'.  Reason: Database Error in model stg_episodes (models/1.staging/stg_episodes.sql)
  relation "raw.episodes" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."episodes"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_episodes.sql.
[0m12:11:41.307908 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.stg_user_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_user_events (models/1.staging/stg_user_events.sql)
  relation "raw.raw_event_files" does not exist
  LINE 10:     from "podcast_analytics"."raw"."raw_event_files"
                    ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_user_events.sql.
[0m12:11:41.308472 [debug] [Thread-4 (]: Began running node model.podcast_analytics.int_user_sessions
[0m12:11:41.308731 [debug] [Thread-3 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m12:11:41.309084 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.int_user_sessions .................................. [[33mSKIP[0m]
[0m12:11:41.309409 [info ] [Thread-3 (]: 5 of 6 SKIP relation public.mart_top_episodes .................................. [[33mSKIP[0m]
[0m12:11:41.310656 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m12:11:41.311006 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m12:11:41.311559 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m12:11:41.311936 [info ] [Thread-2 (]: 6 of 6 SKIP relation public.mart_user_session_metrics .......................... [[33mSKIP[0m]
[0m12:11:41.312395 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m12:11:41.313606 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:41.313842 [debug] [MainThread]: On master: BEGIN
[0m12:11:41.314049 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:11:41.337090 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m12:11:41.337436 [debug] [MainThread]: On master: COMMIT
[0m12:11:41.337681 [debug] [MainThread]: Using postgres connection "master"
[0m12:11:41.338189 [debug] [MainThread]: On master: COMMIT
[0m12:11:41.338932 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:11:41.339203 [debug] [MainThread]: On master: Close
[0m12:11:41.339529 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:11:41.339730 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_episodes' was properly closed.
[0m12:11:41.339933 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_user_events' was properly closed.
[0m12:11:41.340185 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_users' was properly closed.
[0m12:11:41.340470 [info ] [MainThread]: 
[0m12:11:41.340762 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m12:11:41.341448 [debug] [MainThread]: Command end result
[0m12:11:41.359833 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m12:11:41.361274 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m12:11:41.365350 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m12:11:41.365636 [info ] [MainThread]: 
[0m12:11:41.365906 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m12:11:41.366134 [info ] [MainThread]: 
[0m12:11:41.366405 [error] [MainThread]: [31mFailure in model stg_users (models/1.staging/stg_users.sql)[0m
[0m12:11:41.366664 [error] [MainThread]:   Database Error in model stg_users (models/1.staging/stg_users.sql)
  relation "raw.users" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."users"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_users.sql
[0m12:11:41.367011 [info ] [MainThread]: 
[0m12:11:41.367614 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/1.staging/stg_users.sql
[0m12:11:41.367933 [info ] [MainThread]: 
[0m12:11:41.368248 [error] [MainThread]: [31mFailure in model stg_episodes (models/1.staging/stg_episodes.sql)[0m
[0m12:11:41.368615 [error] [MainThread]:   Database Error in model stg_episodes (models/1.staging/stg_episodes.sql)
  relation "raw.episodes" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."episodes"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_episodes.sql
[0m12:11:41.368955 [info ] [MainThread]: 
[0m12:11:41.369303 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/1.staging/stg_episodes.sql
[0m12:11:41.369559 [info ] [MainThread]: 
[0m12:11:41.369832 [error] [MainThread]: [31mFailure in model stg_user_events (models/1.staging/stg_user_events.sql)[0m
[0m12:11:41.370086 [error] [MainThread]:   Database Error in model stg_user_events (models/1.staging/stg_user_events.sql)
  relation "raw.raw_event_files" does not exist
  LINE 10:     from "podcast_analytics"."raw"."raw_event_files"
                    ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_user_events.sql
[0m12:11:41.370350 [info ] [MainThread]: 
[0m12:11:41.371056 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/1.staging/stg_user_events.sql
[0m12:11:41.371352 [info ] [MainThread]: 
[0m12:11:41.371725 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=3 NO-OP=0 TOTAL=6
[0m12:11:41.373777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7290867, "process_in_blocks": "0", "process_kernel_time": 0.174142, "process_mem_max_rss": "130318336", "process_out_blocks": "0", "process_user_time": 1.314211}
[0m12:11:41.374134 [debug] [MainThread]: Command `dbt run` failed at 12:11:41.374078 after 0.73 seconds
[0m12:11:41.374440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a09e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e406e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109714d10>]}
[0m12:11:41.374714 [debug] [MainThread]: Flushing usage events
[0m12:11:41.733177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:14:39.103084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106042b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fd2e0>]}


============================== 12:14:39.106302 | d597373b-69f5-406b-90e3-f5f7767a2d92 ==============================
[0m12:14:39.106302 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:14:39.106692 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir ..', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:14:39.173751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd597373b-69f5-406b-90e3-f5f7767a2d92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104709f40>]}
[0m12:14:39.209929 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-90yxnh74'
[0m12:14:39.210302 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:14:39.303618 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:14:39.304179 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:14:39.356768 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:14:39.358806 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:14:39.651670 [info ] [MainThread]: Installed from version 1.3.0
[0m12:14:39.652346 [info ] [MainThread]: Up to date!
[0m12:14:39.652662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd597373b-69f5-406b-90e3-f5f7767a2d92', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107342e40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107342840>]}
[0m12:14:39.655210 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5923703, "process_in_blocks": "0", "process_kernel_time": 0.182718, "process_mem_max_rss": "110804992", "process_out_blocks": "0", "process_user_time": 0.830574}
[0m12:14:39.655786 [debug] [MainThread]: Command `dbt deps` succeeded at 12:14:39.655707 after 0.59 seconds
[0m12:14:39.656094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fd8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10727a360>]}
[0m12:14:39.656389 [debug] [MainThread]: Flushing usage events
[0m12:14:40.051231 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:14:41.250071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b41e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a5340>]}


============================== 12:14:41.254430 | ce6b8103-ba6e-4a14-b195-f3ddddc7a0d4 ==============================
[0m12:14:41.254430 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:14:41.255142 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --profiles-dir ..', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:14:41.380670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce6b8103-ba6e-4a14-b195-f3ddddc7a0d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107188e30>]}
[0m12:14:41.410345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce6b8103-ba6e-4a14-b195-f3ddddc7a0d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d89e0>]}
[0m12:14:41.411675 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:14:41.479702 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m12:14:41.585584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:14:41.586540 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/schema.yml
[0m12:14:41.882554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce6b8103-ba6e-4a14-b195-f3ddddc7a0d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f92840>]}
[0m12:14:41.966091 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m12:14:41.968394 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m12:14:41.978215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce6b8103-ba6e-4a14-b195-f3ddddc7a0d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10833f620>]}
[0m12:14:41.978552 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m12:14:41.978775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce6b8103-ba6e-4a14-b195-f3ddddc7a0d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108257800>]}
[0m12:14:41.979796 [info ] [MainThread]: 
[0m12:14:41.980023 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m12:14:41.980197 [info ] [MainThread]: 
[0m12:14:41.980481 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:14:41.982361 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m12:14:42.013241 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m12:14:42.013556 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m12:14:42.013747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:42.074349 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.061 seconds
[0m12:14:42.075488 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m12:14:42.076745 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m12:14:42.080485 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m12:14:42.080861 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m12:14:42.081067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:14:42.088400 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m12:14:42.088744 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m12:14:42.088951 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:14:42.091473 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.002 seconds
[0m12:14:42.092201 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m12:14:42.092629 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m12:14:42.096253 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:42.096575 [debug] [MainThread]: On master: BEGIN
[0m12:14:42.096771 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:14:42.106439 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m12:14:42.106777 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:42.107038 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:14:42.110151 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m12:14:42.110920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce6b8103-ba6e-4a14-b195-f3ddddc7a0d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084b4a70>]}
[0m12:14:42.111244 [debug] [MainThread]: On master: ROLLBACK
[0m12:14:42.112028 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:42.112274 [debug] [MainThread]: On master: BEGIN
[0m12:14:42.113360 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m12:14:42.113582 [debug] [MainThread]: On master: COMMIT
[0m12:14:42.113772 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:42.113948 [debug] [MainThread]: On master: COMMIT
[0m12:14:42.114554 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:14:42.114750 [debug] [MainThread]: On master: Close
[0m12:14:42.117886 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m12:14:42.118178 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m12:14:42.118537 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m12:14:42.118847 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m12:14:42.119148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m12:14:42.119481 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m12:14:42.119768 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m12:14:42.120002 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m12:14:42.120239 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m12:14:42.120463 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m12:14:42.149953 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m12:14:42.153311 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m12:14:42.153669 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m12:14:42.153941 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m12:14:42.154184 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:42.154401 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:14:42.164538 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m12:14:42.164878 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m12:14:42.165184 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m12:14:42.165442 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m12:14:42.165692 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m12:14:42.165948 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m12:14:42.170204 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m12:14:42.170546 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m12:14:42.238852 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m12:14:42.242446 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m12:14:42.242788 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m12:14:42.243057 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m12:14:42.244982 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.002 seconds
[0m12:14:42.248282 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m12:14:42.248535 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.005 seconds
[0m12:14:42.249020 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m12:14:42.257109 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m12:14:42.257395 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m12:14:42.258311 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m12:14:42.258545 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m12:14:42.258778 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m12:14:42.259064 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m12:14:42.262720 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m12:14:42.263010 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m12:14:42.264189 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m12:14:42.264599 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m12:14:42.266311 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce6b8103-ba6e-4a14-b195-f3ddddc7a0d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064809e0>]}
[0m12:14:42.267572 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce6b8103-ba6e-4a14-b195-f3ddddc7a0d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108536390>]}
[0m12:14:42.268200 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.15s]
[0m12:14:42.268610 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.15s]
[0m12:14:42.269059 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m12:14:42.269400 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m12:14:42.270431 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:42.270654 [debug] [MainThread]: On master: BEGIN
[0m12:14:42.270836 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:14:42.279966 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m12:14:42.280336 [debug] [MainThread]: On master: COMMIT
[0m12:14:42.280553 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:42.280740 [debug] [MainThread]: On master: COMMIT
[0m12:14:42.281164 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:14:42.281384 [debug] [MainThread]: On master: Close
[0m12:14:42.281660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:42.281841 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m12:14:42.282012 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m12:14:42.282217 [info ] [MainThread]: 
[0m12:14:42.282431 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m12:14:42.282886 [debug] [MainThread]: Command end result
[0m12:14:42.300294 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m12:14:42.302326 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m12:14:42.306012 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m12:14:42.306240 [info ] [MainThread]: 
[0m12:14:42.306484 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:14:42.306668 [info ] [MainThread]: 
[0m12:14:42.306867 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m12:14:42.308571 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.1113012, "process_in_blocks": "0", "process_kernel_time": 0.202345, "process_mem_max_rss": "136462336", "process_out_blocks": "0", "process_user_time": 1.613885}
[0m12:14:42.308849 [debug] [MainThread]: Command `dbt seed` succeeded at 12:14:42.308805 after 1.11 seconds
[0m12:14:42.309080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a56a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106483890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106482870>]}
[0m12:14:42.309307 [debug] [MainThread]: Flushing usage events
[0m12:14:42.656689 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:14:43.551092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107169d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d1af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d1490>]}


============================== 12:14:43.554023 | 0630fee4-693d-4580-8544-78bfec51a440 ==============================
[0m12:14:43.554023 [info ] [MainThread]: Running with dbt=1.10.3
[0m12:14:43.554410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'profiles_dir': '..', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m12:14:43.667124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0630fee4-693d-4580-8544-78bfec51a440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d18b0>]}
[0m12:14:43.695350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0630fee4-693d-4580-8544-78bfec51a440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107806660>]}
[0m12:14:43.695971 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m12:14:43.750244 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m12:14:43.818063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:14:43.818369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:14:43.843662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0630fee4-693d-4580-8544-78bfec51a440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0ff20>]}
[0m12:14:43.888547 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m12:14:43.889779 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m12:14:43.896741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0630fee4-693d-4580-8544-78bfec51a440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083d42f0>]}
[0m12:14:43.897035 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m12:14:43.897246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0630fee4-693d-4580-8544-78bfec51a440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107804aa0>]}
[0m12:14:43.898240 [info ] [MainThread]: 
[0m12:14:43.898462 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m12:14:43.898634 [info ] [MainThread]: 
[0m12:14:43.898916 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:14:43.900824 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m12:14:43.923309 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m12:14:43.923604 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m12:14:43.923788 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:14:43.943940 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m12:14:43.944771 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m12:14:43.945610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m12:14:43.948685 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m12:14:43.948910 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m12:14:43.949085 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:14:43.965040 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m12:14:43.965262 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m12:14:43.965454 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m12:14:43.977378 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.012 seconds
[0m12:14:43.978131 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m12:14:43.978631 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m12:14:43.981252 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:43.981447 [debug] [MainThread]: On master: BEGIN
[0m12:14:43.981607 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:14:43.987669 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:14:43.987961 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:43.988189 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:14:43.990949 [debug] [MainThread]: SQL status: SELECT 0 in 0.003 seconds
[0m12:14:43.991636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0630fee4-693d-4580-8544-78bfec51a440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a96a0>]}
[0m12:14:43.991926 [debug] [MainThread]: On master: ROLLBACK
[0m12:14:43.992292 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:43.992455 [debug] [MainThread]: On master: BEGIN
[0m12:14:43.992926 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m12:14:43.993109 [debug] [MainThread]: On master: COMMIT
[0m12:14:43.993275 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:43.993426 [debug] [MainThread]: On master: COMMIT
[0m12:14:43.993738 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:14:43.993905 [debug] [MainThread]: On master: Close
[0m12:14:43.995272 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m12:14:43.995516 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m12:14:43.995990 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_users
[0m12:14:43.995815 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_episodes ................................ [RUN]
[0m12:14:43.996317 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_user_events ............................. [RUN]
[0m12:14:43.996594 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_users ................................... [RUN]
[0m12:14:43.996855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m12:14:43.997110 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m12:14:43.997337 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m12:14:43.997533 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m12:14:43.997716 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m12:14:43.997896 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_users
[0m12:14:44.002148 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m12:14:44.009412 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m12:14:44.010589 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m12:14:44.011269 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_users
[0m12:14:44.011478 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m12:14:44.011683 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m12:14:44.028559 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m12:14:44.031316 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m12:14:44.032920 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m12:14:44.033555 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m12:14:44.033783 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m12:14:44.034005 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: BEGIN
[0m12:14:44.034222 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m12:14:44.034438 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m12:14:44.034709 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m12:14:44.034988 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m12:14:44.035372 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m12:14:44.035698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:14:44.043972 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m12:14:44.044270 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m12:14:44.044500 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m12:14:44.044740 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m12:14:44.044970 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m12:14:44.045183 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m12:14:44.045400 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."raw"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m12:14:44.045657 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
with source as (
    select data
    from "podcast_analytics"."raw"."raw_event_files"
),

filtered as (
    select * from source
    where data ->> 'type' in ('play', 'pause', 'seek', 'complete')
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'ts' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        (data ->> 'ts')::timestamp as event_ts,
        data ->> 'type'         as event_type,
        (data ->> 'duration')::integer as duration
    from filtered
)
select * from typed
  );
[0m12:14:44.045902 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."raw"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m12:14:44.046592 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.raw_users" does not exist
LINE 9:     select * from "podcast_analytics"."raw"."raw_users"
                          ^

[0m12:14:44.046805 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "raw.raw_event_files" does not exist
LINE 10:     from "podcast_analytics"."raw"."raw_event_files"
                  ^

[0m12:14:44.047009 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.raw_episodes" does not exist
LINE 9:     select * from "podcast_analytics"."raw"."raw_episodes"
                          ^

[0m12:14:44.047229 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: ROLLBACK
[0m12:14:44.047421 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: ROLLBACK
[0m12:14:44.047605 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: ROLLBACK
[0m12:14:44.048084 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m12:14:44.048344 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: Close
[0m12:14:44.048594 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m12:14:44.055776 [debug] [Thread-1 (]: Database Error in model stg_episodes (models/1.staging/stg_episodes.sql)
  relation "raw.raw_episodes" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."raw_episodes"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_episodes.sql
[0m12:14:44.056664 [debug] [Thread-2 (]: Database Error in model stg_user_events (models/1.staging/stg_user_events.sql)
  relation "raw.raw_event_files" does not exist
  LINE 10:     from "podcast_analytics"."raw"."raw_event_files"
                    ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_user_events.sql
[0m12:14:44.057829 [debug] [Thread-3 (]: Database Error in model stg_users (models/1.staging/stg_users.sql)
  relation "raw.raw_users" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."raw_users"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_users.sql
[0m12:14:44.058581 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0630fee4-693d-4580-8544-78bfec51a440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b5100>]}
[0m12:14:44.058784 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0630fee4-693d-4580-8544-78bfec51a440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a19100>]}
[0m12:14:44.058974 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0630fee4-693d-4580-8544-78bfec51a440', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089eaea0>]}
[0m12:14:44.059347 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_episodes ....................... [[31mERROR[0m in 0.06s]
[0m12:14:44.059724 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_user_events .................... [[31mERROR[0m in 0.06s]
[0m12:14:44.060039 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_users .......................... [[31mERROR[0m in 0.06s]
[0m12:14:44.060367 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m12:14:44.060660 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m12:14:44.060939 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_users
[0m12:14:44.061225 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.stg_episodes' to be skipped because of status 'error'.  Reason: Database Error in model stg_episodes (models/1.staging/stg_episodes.sql)
  relation "raw.raw_episodes" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."raw_episodes"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_episodes.sql.
[0m12:14:44.061880 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.stg_user_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_user_events (models/1.staging/stg_user_events.sql)
  relation "raw.raw_event_files" does not exist
  LINE 10:     from "podcast_analytics"."raw"."raw_event_files"
                    ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_user_events.sql.
[0m12:14:44.062167 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.stg_users' to be skipped because of status 'error'.  Reason: Database Error in model stg_users (models/1.staging/stg_users.sql)
  relation "raw.raw_users" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."raw_users"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_users.sql.
[0m12:14:44.062438 [debug] [Thread-4 (]: Began running node model.podcast_analytics.int_user_sessions
[0m12:14:44.062646 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m12:14:44.062912 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.int_user_sessions .................................. [[33mSKIP[0m]
[0m12:14:44.063149 [info ] [Thread-1 (]: 5 of 6 SKIP relation public.mart_top_episodes .................................. [[33mSKIP[0m]
[0m12:14:44.063374 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m12:14:44.063577 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m12:14:44.063847 [debug] [Thread-3 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m12:14:44.064112 [info ] [Thread-3 (]: 6 of 6 SKIP relation public.mart_user_session_metrics .......................... [[33mSKIP[0m]
[0m12:14:44.064341 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m12:14:44.065439 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:44.065630 [debug] [MainThread]: On master: BEGIN
[0m12:14:44.065798 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:14:44.072245 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m12:14:44.072560 [debug] [MainThread]: On master: COMMIT
[0m12:14:44.072786 [debug] [MainThread]: Using postgres connection "master"
[0m12:14:44.073348 [debug] [MainThread]: On master: COMMIT
[0m12:14:44.073946 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m12:14:44.074147 [debug] [MainThread]: On master: Close
[0m12:14:44.074429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:14:44.074600 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_episodes' was properly closed.
[0m12:14:44.074755 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_user_events' was properly closed.
[0m12:14:44.074903 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_users' was properly closed.
[0m12:14:44.075164 [info ] [MainThread]: 
[0m12:14:44.075373 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m12:14:44.075887 [debug] [MainThread]: Command end result
[0m12:14:44.089806 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m12:14:44.090971 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m12:14:44.094062 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m12:14:44.094273 [info ] [MainThread]: 
[0m12:14:44.094492 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m12:14:44.094674 [info ] [MainThread]: 
[0m12:14:44.094899 [error] [MainThread]: [31mFailure in model stg_episodes (models/1.staging/stg_episodes.sql)[0m
[0m12:14:44.095109 [error] [MainThread]:   Database Error in model stg_episodes (models/1.staging/stg_episodes.sql)
  relation "raw.raw_episodes" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."raw_episodes"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_episodes.sql
[0m12:14:44.095278 [info ] [MainThread]: 
[0m12:14:44.095474 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/1.staging/stg_episodes.sql
[0m12:14:44.095643 [info ] [MainThread]: 
[0m12:14:44.095837 [error] [MainThread]: [31mFailure in model stg_user_events (models/1.staging/stg_user_events.sql)[0m
[0m12:14:44.096039 [error] [MainThread]:   Database Error in model stg_user_events (models/1.staging/stg_user_events.sql)
  relation "raw.raw_event_files" does not exist
  LINE 10:     from "podcast_analytics"."raw"."raw_event_files"
                    ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_user_events.sql
[0m12:14:44.096204 [info ] [MainThread]: 
[0m12:14:44.096390 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/1.staging/stg_user_events.sql
[0m12:14:44.096552 [info ] [MainThread]: 
[0m12:14:44.096740 [error] [MainThread]: [31mFailure in model stg_users (models/1.staging/stg_users.sql)[0m
[0m12:14:44.096935 [error] [MainThread]:   Database Error in model stg_users (models/1.staging/stg_users.sql)
  relation "raw.raw_users" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."raw_users"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_users.sql
[0m12:14:44.097098 [info ] [MainThread]: 
[0m12:14:44.097280 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/1.staging/stg_users.sql
[0m12:14:44.097444 [info ] [MainThread]: 
[0m12:14:44.097629 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=3 NO-OP=0 TOTAL=6
[0m12:14:44.099711 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5872206, "process_in_blocks": "0", "process_kernel_time": 0.13386, "process_mem_max_rss": "132464640", "process_out_blocks": "0", "process_user_time": 1.054926}
[0m12:14:44.100042 [debug] [MainThread]: Command `dbt run` failed at 12:14:44.099994 after 0.59 seconds
[0m12:14:44.100302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089368a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089375c0>]}
[0m12:14:44.100532 [debug] [MainThread]: Flushing usage events
[0m12:14:44.450137 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:32.090940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096838f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d0b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098fd2b0>]}


============================== 13:34:32.094571 | b0116e2a-cbcc-475e-9964-936a9b786240 ==============================
[0m13:34:32.094571 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:34:32.094979 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m13:34:32.154944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0116e2a-cbcc-475e-9964-936a9b786240', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108453d70>]}
[0m13:34:32.185525 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-9clvf_v_'
[0m13:34:32.185874 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:34:32.278867 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:34:32.279532 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:34:32.330999 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:34:32.332718 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:34:32.577008 [info ] [MainThread]: Installed from version 1.3.0
[0m13:34:32.577291 [info ] [MainThread]: Up to date!
[0m13:34:32.577505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b0116e2a-cbcc-475e-9964-936a9b786240', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bad9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bad0d0>]}
[0m13:34:32.579557 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.52808315, "process_in_blocks": "0", "process_kernel_time": 0.154208, "process_mem_max_rss": "109133824", "process_out_blocks": "0", "process_user_time": 0.667198}
[0m13:34:32.579898 [debug] [MainThread]: Command `dbt deps` succeeded at 13:34:32.579844 after 0.53 seconds
[0m13:34:32.580578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ed3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109acb7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096838f0>]}
[0m13:34:32.580837 [debug] [MainThread]: Flushing usage events
[0m13:34:32.981360 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:34.190902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f5ce00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138f9310>]}


============================== 13:34:34.193928 | 892941ed-3714-499a-a163-d3c95a7552fb ==============================
[0m13:34:34.193928 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:34:34.194270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --profiles-dir ..', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:34:34.381868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '892941ed-3714-499a-a163-d3c95a7552fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e2fe60>]}
[0m13:34:34.413580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '892941ed-3714-499a-a163-d3c95a7552fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134ba0c0>]}
[0m13:34:34.414465 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:34:34.481089 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:34:34.578081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:34:34.578371 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:34:34.612125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '892941ed-3714-499a-a163-d3c95a7552fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ecb3b0>]}
[0m13:34:34.659449 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:34:34.661384 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:34:34.670375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '892941ed-3714-499a-a163-d3c95a7552fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145108c0>]}
[0m13:34:34.670699 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:34:34.670889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '892941ed-3714-499a-a163-d3c95a7552fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100de630>]}
[0m13:34:34.672098 [info ] [MainThread]: 
[0m13:34:34.672690 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:34:34.673035 [info ] [MainThread]: 
[0m13:34:34.673664 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:34:34.675941 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:34:34.711946 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:34:34.712805 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:34:34.713021 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:34.839290 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.126 seconds
[0m13:34:34.840601 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:34:34.841647 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:34:34.844445 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:34:34.844679 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:34:34.844874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:34.856893 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:34:34.857455 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:34:34.857672 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:34:34.868027 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m13:34:34.868978 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:34:34.869756 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:34:34.874488 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:34.874782 [debug] [MainThread]: On master: BEGIN
[0m13:34:34.874944 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:34.887170 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:34:34.887479 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:34.887689 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:34:34.904922 [debug] [MainThread]: SQL status: SELECT 0 in 0.017 seconds
[0m13:34:34.906447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '892941ed-3714-499a-a163-d3c95a7552fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ec8470>]}
[0m13:34:34.907356 [debug] [MainThread]: On master: ROLLBACK
[0m13:34:34.908452 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:34.908907 [debug] [MainThread]: On master: BEGIN
[0m13:34:34.909999 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:34:34.910208 [debug] [MainThread]: On master: COMMIT
[0m13:34:34.910366 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:34.910508 [debug] [MainThread]: On master: COMMIT
[0m13:34:34.910863 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:34.911018 [debug] [MainThread]: On master: Close
[0m13:34:34.913699 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m13:34:34.913942 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m13:34:34.914279 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m13:34:34.914619 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m13:34:34.914922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m13:34:34.915184 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m13:34:34.915382 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m13:34:34.915559 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m13:34:34.915750 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m13:34:34.915921 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m13:34:34.939311 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:34:34.940112 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:34:34.940394 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m13:34:34.940635 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m13:34:34.941241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:34.941669 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:34:34.952524 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:34:34.952875 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:34:34.953095 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m13:34:34.953282 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m13:34:34.953460 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:34:34.953684 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m13:34:34.965286 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.011 seconds
[0m13:34:34.965679 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.012 seconds
[0m13:34:35.041841 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:34:35.051355 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:34:35.051732 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m13:34:35.051972 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m13:34:35.055364 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.003 seconds
[0m13:34:35.062448 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m13:34:35.062730 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.011 seconds
[0m13:34:35.063207 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m13:34:35.070237 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:34:35.070448 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:34:35.070674 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:34:35.070862 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:34:35.071037 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:34:35.071206 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:34:35.085028 [debug] [Thread-1 (]: SQL status: COMMIT in 0.014 seconds
[0m13:34:35.085568 [debug] [Thread-2 (]: SQL status: COMMIT in 0.014 seconds
[0m13:34:35.086945 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m13:34:35.087339 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m13:34:35.090993 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '892941ed-3714-499a-a163-d3c95a7552fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106022840>]}
[0m13:34:35.091612 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '892941ed-3714-499a-a163-d3c95a7552fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fd0a40>]}
[0m13:34:35.092428 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.17s]
[0m13:34:35.093115 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.17s]
[0m13:34:35.093618 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m13:34:35.093925 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m13:34:35.094926 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:35.095107 [debug] [MainThread]: On master: BEGIN
[0m13:34:35.095256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:34:35.109238 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m13:34:35.110077 [debug] [MainThread]: On master: COMMIT
[0m13:34:35.110435 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:35.110671 [debug] [MainThread]: On master: COMMIT
[0m13:34:35.111843 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:34:35.112295 [debug] [MainThread]: On master: Close
[0m13:34:35.112633 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:35.112915 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m13:34:35.113227 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m13:34:35.113554 [info ] [MainThread]: 
[0m13:34:35.113938 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.44 seconds (0.44s).
[0m13:34:35.114621 [debug] [MainThread]: Command end result
[0m13:34:35.178145 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:34:35.179241 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:34:35.181880 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:34:35.182084 [info ] [MainThread]: 
[0m13:34:35.182286 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:34:35.182436 [info ] [MainThread]: 
[0m13:34:35.182600 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:34:35.184007 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.037992, "process_in_blocks": "0", "process_kernel_time": 0.208007, "process_mem_max_rss": "125812736", "process_out_blocks": "0", "process_user_time": 1.252233}
[0m13:34:35.184252 [debug] [MainThread]: Command `dbt seed` succeeded at 13:34:35.184214 after 1.04 seconds
[0m13:34:35.184446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bcb140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c4ab40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c49fd0>]}
[0m13:34:35.184634 [debug] [MainThread]: Flushing usage events
[0m13:34:35.545008 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:34:36.625611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1258f3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1269e99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1269e92b0>]}


============================== 13:34:36.627843 | 6489c4b2-6dd9-4f89-9c23-acb32d5f6d8f ==============================
[0m13:34:36.627843 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:34:36.628235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir ..', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:34:36.711991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6489c4b2-6dd9-4f89-9c23-acb32d5f6d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1268d41a0>]}
[0m13:34:36.736851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6489c4b2-6dd9-4f89-9c23-acb32d5f6d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121f8d520>]}
[0m13:34:36.737450 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:34:36.790444 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:34:36.854016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:34:36.854292 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:34:36.878435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6489c4b2-6dd9-4f89-9c23-acb32d5f6d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12756a8d0>]}
[0m13:34:36.920922 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:34:36.922101 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:34:36.931534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6489c4b2-6dd9-4f89-9c23-acb32d5f6d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12756ab10>]}
[0m13:34:36.931816 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:34:36.931997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6489c4b2-6dd9-4f89-9c23-acb32d5f6d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126f1d760>]}
[0m13:34:36.932882 [info ] [MainThread]: 
[0m13:34:36.933067 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:34:36.933211 [info ] [MainThread]: 
[0m13:34:36.933453 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:34:36.935169 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:34:36.958441 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:34:36.958759 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:34:36.958934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:34:36.999381 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.040 seconds
[0m13:34:37.000138 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:34:37.001284 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:34:37.004026 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:34:37.004237 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:34:37.004391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:34:37.017180 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m13:34:37.017481 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:34:37.017675 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:34:37.021711 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m13:34:37.022401 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:34:37.023611 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:34:37.027265 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:37.027466 [debug] [MainThread]: On master: BEGIN
[0m13:34:37.027610 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:34:37.037327 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:34:37.037575 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:37.037794 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:34:37.047011 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m13:34:37.047695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6489c4b2-6dd9-4f89-9c23-acb32d5f6d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1279d7620>]}
[0m13:34:37.047962 [debug] [MainThread]: On master: ROLLBACK
[0m13:34:37.048384 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:37.048531 [debug] [MainThread]: On master: BEGIN
[0m13:34:37.049124 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:34:37.049312 [debug] [MainThread]: On master: COMMIT
[0m13:34:37.049468 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:37.049608 [debug] [MainThread]: On master: COMMIT
[0m13:34:37.049925 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:37.050078 [debug] [MainThread]: On master: Close
[0m13:34:37.051273 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m13:34:37.051477 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m13:34:37.051658 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_users
[0m13:34:37.051935 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_episodes ................................ [RUN]
[0m13:34:37.052196 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_user_events ............................. [RUN]
[0m13:34:37.052561 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_users ................................... [RUN]
[0m13:34:37.052814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m13:34:37.053043 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m13:34:37.053251 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m13:34:37.053427 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m13:34:37.053665 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m13:34:37.053834 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_users
[0m13:34:37.057685 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m13:34:37.064659 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m13:34:37.065766 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m13:34:37.066447 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_users
[0m13:34:37.066635 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m13:34:37.066813 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m13:34:37.086164 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m13:34:37.088495 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m13:34:37.090321 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m13:34:37.091492 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:34:37.091727 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: BEGIN
[0m13:34:37.091931 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:34:37.092268 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:34:37.092483 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m13:34:37.092679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:34:37.092936 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:34:37.093119 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m13:34:37.093283 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:34:37.103581 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:34:37.104074 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:34:37.104339 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."raw"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m13:34:37.104930 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m13:34:37.105202 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m13:34:37.105746 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:34:37.106248 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.raw_episodes" does not exist
LINE 9:     select * from "podcast_analytics"."raw"."raw_episodes"
                          ^

[0m13:34:37.106587 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:34:37.106887 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
with source as (
    select data
    from "podcast_analytics"."raw"."raw_event_files"
),

filtered as (
    select * from source
    where data ->> 'type' in ('play', 'pause', 'seek', 'complete')
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'ts' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        (data ->> 'ts')::timestamp as event_ts,
        data ->> 'type'         as event_type,
        (data ->> 'duration')::integer as duration
    from filtered
)
select * from typed
  );
[0m13:34:37.107136 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: ROLLBACK
[0m13:34:37.107325 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."raw"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m13:34:37.108202 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m13:34:37.108384 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.raw_users" does not exist
LINE 9:     select * from "podcast_analytics"."raw"."raw_users"
                          ^

[0m13:34:37.108628 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: ROLLBACK
[0m13:34:37.109688 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "raw.raw_event_files" does not exist
LINE 10:     from "podcast_analytics"."raw"."raw_event_files"
                  ^

[0m13:34:37.110454 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: Close
[0m13:34:37.110728 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: ROLLBACK
[0m13:34:37.112010 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m13:34:37.118079 [debug] [Thread-3 (]: Database Error in model stg_users (models/1.staging/stg_users.sql)
  relation "raw.raw_users" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."raw_users"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_users.sql
[0m13:34:37.119062 [debug] [Thread-2 (]: Database Error in model stg_user_events (models/1.staging/stg_user_events.sql)
  relation "raw.raw_event_files" does not exist
  LINE 10:     from "podcast_analytics"."raw"."raw_event_files"
                    ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_user_events.sql
[0m13:34:37.119678 [debug] [Thread-1 (]: Database Error in model stg_episodes (models/1.staging/stg_episodes.sql)
  relation "raw.raw_episodes" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."raw_episodes"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_episodes.sql
[0m13:34:37.120742 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6489c4b2-6dd9-4f89-9c23-acb32d5f6d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15007f9e0>]}
[0m13:34:37.121262 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6489c4b2-6dd9-4f89-9c23-acb32d5f6d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15007d100>]}
[0m13:34:37.121657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6489c4b2-6dd9-4f89-9c23-acb32d5f6d8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x127f265a0>]}
[0m13:34:37.122270 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_users .......................... [[31mERROR[0m in 0.07s]
[0m13:34:37.123060 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_user_events .................... [[31mERROR[0m in 0.07s]
[0m13:34:37.123466 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_episodes ....................... [[31mERROR[0m in 0.07s]
[0m13:34:37.124099 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_users
[0m13:34:37.124578 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m13:34:37.125069 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m13:34:37.125377 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.stg_users' to be skipped because of status 'error'.  Reason: Database Error in model stg_users (models/1.staging/stg_users.sql)
  relation "raw.raw_users" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."raw_users"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_users.sql.
[0m13:34:37.125971 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.stg_user_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_user_events (models/1.staging/stg_user_events.sql)
  relation "raw.raw_event_files" does not exist
  LINE 10:     from "podcast_analytics"."raw"."raw_event_files"
                    ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_user_events.sql.
[0m13:34:37.126224 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.stg_episodes' to be skipped because of status 'error'.  Reason: Database Error in model stg_episodes (models/1.staging/stg_episodes.sql)
  relation "raw.raw_episodes" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."raw_episodes"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_episodes.sql.
[0m13:34:37.126612 [debug] [Thread-4 (]: Began running node model.podcast_analytics.int_user_sessions
[0m13:34:37.126830 [debug] [Thread-3 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m13:34:37.127015 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.int_user_sessions .................................. [[33mSKIP[0m]
[0m13:34:37.127311 [info ] [Thread-3 (]: 5 of 6 SKIP relation public.mart_top_episodes .................................. [[33mSKIP[0m]
[0m13:34:37.127867 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m13:34:37.128152 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m13:34:37.128569 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m13:34:37.129167 [info ] [Thread-1 (]: 6 of 6 SKIP relation public.mart_user_session_metrics .......................... [[33mSKIP[0m]
[0m13:34:37.129621 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m13:34:37.135130 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:37.135566 [debug] [MainThread]: On master: BEGIN
[0m13:34:37.135918 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:34:37.146856 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:34:37.147242 [debug] [MainThread]: On master: COMMIT
[0m13:34:37.147423 [debug] [MainThread]: Using postgres connection "master"
[0m13:34:37.147572 [debug] [MainThread]: On master: COMMIT
[0m13:34:37.148062 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:34:37.148445 [debug] [MainThread]: On master: Close
[0m13:34:37.148677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:37.148817 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_episodes' was properly closed.
[0m13:34:37.148953 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_user_events' was properly closed.
[0m13:34:37.149080 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_users' was properly closed.
[0m13:34:37.149275 [info ] [MainThread]: 
[0m13:34:37.149460 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m13:34:37.149911 [debug] [MainThread]: Command end result
[0m13:34:37.163588 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:34:37.164594 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:34:37.167528 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:34:37.167725 [info ] [MainThread]: 
[0m13:34:37.167924 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m13:34:37.168091 [info ] [MainThread]: 
[0m13:34:37.168293 [error] [MainThread]: [31mFailure in model stg_users (models/1.staging/stg_users.sql)[0m
[0m13:34:37.168486 [error] [MainThread]:   Database Error in model stg_users (models/1.staging/stg_users.sql)
  relation "raw.raw_users" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."raw_users"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_users.sql
[0m13:34:37.168639 [info ] [MainThread]: 
[0m13:34:37.168819 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/1.staging/stg_users.sql
[0m13:34:37.168977 [info ] [MainThread]: 
[0m13:34:37.169151 [error] [MainThread]: [31mFailure in model stg_user_events (models/1.staging/stg_user_events.sql)[0m
[0m13:34:37.169333 [error] [MainThread]:   Database Error in model stg_user_events (models/1.staging/stg_user_events.sql)
  relation "raw.raw_event_files" does not exist
  LINE 10:     from "podcast_analytics"."raw"."raw_event_files"
                    ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_user_events.sql
[0m13:34:37.169489 [info ] [MainThread]: 
[0m13:34:37.169658 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/1.staging/stg_user_events.sql
[0m13:34:37.169803 [info ] [MainThread]: 
[0m13:34:37.169977 [error] [MainThread]: [31mFailure in model stg_episodes (models/1.staging/stg_episodes.sql)[0m
[0m13:34:37.170154 [error] [MainThread]:   Database Error in model stg_episodes (models/1.staging/stg_episodes.sql)
  relation "raw.raw_episodes" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."raw_episodes"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_episodes.sql
[0m13:34:37.170305 [info ] [MainThread]: 
[0m13:34:37.170471 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/1.staging/stg_episodes.sql
[0m13:34:37.170617 [info ] [MainThread]: 
[0m13:34:37.170782 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=3 NO-OP=0 TOTAL=6
[0m13:34:37.172197 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5784039, "process_in_blocks": "0", "process_kernel_time": 0.145728, "process_mem_max_rss": "126664704", "process_out_blocks": "0", "process_user_time": 1.036682}
[0m13:34:37.172452 [debug] [MainThread]: Command `dbt run` failed at 13:34:37.172413 after 0.58 seconds
[0m13:34:37.172670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1269e9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125dadc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12698b0e0>]}
[0m13:34:37.173338 [debug] [MainThread]: Flushing usage events
[0m13:34:37.532106 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:37:03.122361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106661430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706d100>]}


============================== 13:37:03.125161 | 9dc322a2-3388-4ec5-9ad5-50bd8948fff6 ==============================
[0m13:37:03.125161 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:37:03.125474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m13:37:03.193606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dc322a2-3388-4ec5-9ad5-50bd8948fff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107046a50>]}
[0m13:37:03.225788 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-vij6p8cl'
[0m13:37:03.226082 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:37:03.308046 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:37:03.308488 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:37:03.403896 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:37:03.406219 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:37:03.654804 [info ] [MainThread]: Installed from version 1.3.0
[0m13:37:03.655113 [info ] [MainThread]: Up to date!
[0m13:37:03.655857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9dc322a2-3388-4ec5-9ad5-50bd8948fff6', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071cba70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071cbb90>]}
[0m13:37:03.663279 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.57496685, "process_in_blocks": "0", "process_kernel_time": 0.141073, "process_mem_max_rss": "111378432", "process_out_blocks": "0", "process_user_time": 0.651592}
[0m13:37:03.663962 [debug] [MainThread]: Command `dbt deps` succeeded at 13:37:03.663830 after 0.58 seconds
[0m13:37:03.664280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c546e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eab500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b7d520>]}
[0m13:37:03.664588 [debug] [MainThread]: Flushing usage events
[0m13:37:04.062589 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:37:05.277671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107933800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10840d820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10840d100>]}


============================== 13:37:05.280271 | ff1cb298-b0a6-48bd-8e69-7f96e8240edf ==============================
[0m13:37:05.280271 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:37:05.280637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '..', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m13:37:05.441432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ff1cb298-b0a6-48bd-8e69-7f96e8240edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084cd760>]}
[0m13:37:05.492844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ff1cb298-b0a6-48bd-8e69-7f96e8240edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f2f620>]}
[0m13:37:05.493656 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:37:05.556973 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:37:05.688416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:37:05.689185 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/schema.yml
[0m13:37:05.976903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff1cb298-b0a6-48bd-8e69-7f96e8240edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10989b650>]}
[0m13:37:06.078485 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:37:06.080729 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:37:06.090941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff1cb298-b0a6-48bd-8e69-7f96e8240edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097cd370>]}
[0m13:37:06.091527 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:37:06.091777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff1cb298-b0a6-48bd-8e69-7f96e8240edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ab5f40>]}
[0m13:37:06.092717 [info ] [MainThread]: 
[0m13:37:06.092904 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:37:06.093050 [info ] [MainThread]: 
[0m13:37:06.093297 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:37:06.094960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:37:06.128391 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:37:06.128737 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:37:06.128930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:06.186194 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.057 seconds
[0m13:37:06.187124 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:37:06.188101 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:37:06.192886 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:37:06.193200 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:37:06.193391 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:37:06.201793 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:37:06.202178 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:37:06.202424 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:37:06.207515 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.005 seconds
[0m13:37:06.208378 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:37:06.208981 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:37:06.212152 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:06.212421 [debug] [MainThread]: On master: BEGIN
[0m13:37:06.212631 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:37:06.221178 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:37:06.221503 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:06.221736 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:37:06.228915 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m13:37:06.229701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff1cb298-b0a6-48bd-8e69-7f96e8240edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c54e00>]}
[0m13:37:06.229972 [debug] [MainThread]: On master: ROLLBACK
[0m13:37:06.230418 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:06.230579 [debug] [MainThread]: On master: BEGIN
[0m13:37:06.231376 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:37:06.231961 [debug] [MainThread]: On master: COMMIT
[0m13:37:06.232233 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:06.232404 [debug] [MainThread]: On master: COMMIT
[0m13:37:06.232888 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:37:06.233058 [debug] [MainThread]: On master: Close
[0m13:37:06.235232 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m13:37:06.235563 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m13:37:06.235935 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m13:37:06.236219 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m13:37:06.236494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m13:37:06.236888 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m13:37:06.237226 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m13:37:06.237459 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m13:37:06.237659 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m13:37:06.237838 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m13:37:06.263148 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:37:06.265175 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:37:06.265377 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m13:37:06.265573 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m13:37:06.265750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:06.265913 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:37:06.279706 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m13:37:06.280045 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:37:06.280241 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m13:37:06.280447 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m13:37:06.280635 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:37:06.280894 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m13:37:06.287649 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.007 seconds
[0m13:37:06.287931 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.007 seconds
[0m13:37:06.339042 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:37:06.350401 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m13:37:06.366965 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:37:06.367370 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m13:37:06.367850 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.010 seconds
[0m13:37:06.371119 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m13:37:06.371409 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.004 seconds
[0m13:37:06.372061 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m13:37:06.380055 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:37:06.380965 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:37:06.381241 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:37:06.381454 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:37:06.381659 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:37:06.381852 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:37:06.385363 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:37:06.386058 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m13:37:06.388588 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m13:37:06.390147 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m13:37:06.394035 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff1cb298-b0a6-48bd-8e69-7f96e8240edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097638f0>]}
[0m13:37:06.394334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff1cb298-b0a6-48bd-8e69-7f96e8240edf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e22600>]}
[0m13:37:06.394681 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.15s]
[0m13:37:06.395152 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.16s]
[0m13:37:06.395492 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m13:37:06.395759 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m13:37:06.396664 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:06.396854 [debug] [MainThread]: On master: BEGIN
[0m13:37:06.397016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:37:06.412392 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m13:37:06.412689 [debug] [MainThread]: On master: COMMIT
[0m13:37:06.412866 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:06.413015 [debug] [MainThread]: On master: COMMIT
[0m13:37:06.413456 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:37:06.413610 [debug] [MainThread]: On master: Close
[0m13:37:06.413841 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:06.413984 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m13:37:06.414116 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m13:37:06.414291 [info ] [MainThread]: 
[0m13:37:06.414553 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m13:37:06.415102 [debug] [MainThread]: Command end result
[0m13:37:06.433443 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:37:06.435117 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:37:06.438951 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:37:06.439212 [info ] [MainThread]: 
[0m13:37:06.439665 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:37:06.439932 [info ] [MainThread]: 
[0m13:37:06.440229 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:37:06.441768 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.2028824, "process_in_blocks": "0", "process_kernel_time": 0.199057, "process_mem_max_rss": "135544832", "process_out_blocks": "0", "process_user_time": 1.459536}
[0m13:37:06.442034 [debug] [MainThread]: Command `dbt seed` succeeded at 13:37:06.441993 after 1.20 seconds
[0m13:37:06.442249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10840d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080858b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10823b2c0>]}
[0m13:37:06.442633 [debug] [MainThread]: Flushing usage events
[0m13:37:06.806216 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:37:07.815971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10445bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f5b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f5460>]}


============================== 13:37:07.818290 | 3ad7ba34-50a7-47aa-8a6d-124b6f755472 ==============================
[0m13:37:07.818290 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:37:07.818684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '..', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ..', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:37:07.976294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ad7ba34-50a7-47aa-8a6d-124b6f755472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a75c0>]}
[0m13:37:08.046892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ad7ba34-50a7-47aa-8a6d-124b6f755472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054a42f0>]}
[0m13:37:08.048050 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:37:08.327482 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:37:09.058405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:37:09.058887 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:37:09.086029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ad7ba34-50a7-47aa-8a6d-124b6f755472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b38500>]}
[0m13:37:09.140779 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:37:09.142537 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:37:09.150705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ad7ba34-50a7-47aa-8a6d-124b6f755472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106354d70>]}
[0m13:37:09.151007 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:37:09.151200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ad7ba34-50a7-47aa-8a6d-124b6f755472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d89b0>]}
[0m13:37:09.152810 [info ] [MainThread]: 
[0m13:37:09.153061 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:37:09.153222 [info ] [MainThread]: 
[0m13:37:09.153648 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:37:09.155351 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:37:09.180635 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:37:09.180941 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:37:09.181164 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:37:09.214673 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m13:37:09.215366 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:37:09.216094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:37:09.218817 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:37:09.219005 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:37:09.219149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:37:09.228013 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:37:09.228323 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:37:09.228581 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:37:09.231552 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m13:37:09.232198 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:37:09.232847 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:37:09.235176 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:09.235378 [debug] [MainThread]: On master: BEGIN
[0m13:37:09.235525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:37:09.242841 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:37:09.243050 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:09.243250 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:37:09.245765 [debug] [MainThread]: SQL status: SELECT 0 in 0.002 seconds
[0m13:37:09.246315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ad7ba34-50a7-47aa-8a6d-124b6f755472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068cd880>]}
[0m13:37:09.246553 [debug] [MainThread]: On master: ROLLBACK
[0m13:37:09.246878 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:09.247029 [debug] [MainThread]: On master: BEGIN
[0m13:37:09.247639 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:37:09.247783 [debug] [MainThread]: On master: COMMIT
[0m13:37:09.247925 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:09.248054 [debug] [MainThread]: On master: COMMIT
[0m13:37:09.248312 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:37:09.248452 [debug] [MainThread]: On master: Close
[0m13:37:09.249680 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m13:37:09.249869 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m13:37:09.250060 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_users
[0m13:37:09.250338 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_episodes ................................ [RUN]
[0m13:37:09.250582 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_user_events ............................. [RUN]
[0m13:37:09.250825 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_users ................................... [RUN]
[0m13:37:09.251050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m13:37:09.251270 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m13:37:09.251486 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m13:37:09.251661 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m13:37:09.251828 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m13:37:09.251999 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_users
[0m13:37:09.255057 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m13:37:09.267599 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m13:37:09.271602 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m13:37:09.272754 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m13:37:09.273027 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_users
[0m13:37:09.279061 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m13:37:09.311303 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m13:37:09.314924 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m13:37:09.316494 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m13:37:09.317051 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:37:09.317284 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:37:09.317496 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:37:09.317667 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m13:37:09.317838 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: BEGIN
[0m13:37:09.318003 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m13:37:09.318199 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:37:09.318403 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:37:09.318580 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:37:09.325453 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:37:09.325848 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:37:09.326068 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."raw"."episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m13:37:09.326369 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m13:37:09.326569 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:37:09.326760 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "raw.episodes" does not exist
LINE 9:     select * from "podcast_analytics"."raw"."episodes"
                          ^

[0m13:37:09.326953 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."raw"."users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m13:37:09.327154 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: ROLLBACK
[0m13:37:09.327667 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m13:37:09.327850 [debug] [Thread-3 (]: Postgres adapter: Postgres error: relation "raw.users" does not exist
LINE 9:     select * from "podcast_analytics"."raw"."users"
                          ^

[0m13:37:09.328050 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: ROLLBACK
[0m13:37:09.328841 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: Close
[0m13:37:09.329640 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m13:37:09.329892 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:37:09.330158 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
with source as (
    select data
    from "podcast_analytics"."raw"."event_files"
),

filtered as (
    select * from source
    where data ->> 'type' in ('play', 'pause', 'seek', 'complete')
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'ts' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        (data ->> 'ts')::timestamp as event_ts,
        data ->> 'type'         as event_type,
        (data ->> 'duration')::integer as duration
    from filtered
)
select * from typed
  );
[0m13:37:09.330805 [debug] [Thread-2 (]: Postgres adapter: Postgres error: relation "raw.event_files" does not exist
LINE 10:     from "podcast_analytics"."raw"."event_files"
                  ^

[0m13:37:09.331042 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: ROLLBACK
[0m13:37:09.331457 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m13:37:09.335438 [debug] [Thread-3 (]: Database Error in model stg_users (models/1.staging/stg_users.sql)
  relation "raw.users" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."users"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_users.sql
[0m13:37:09.336475 [debug] [Thread-1 (]: Database Error in model stg_episodes (models/1.staging/stg_episodes.sql)
  relation "raw.episodes" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."episodes"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_episodes.sql
[0m13:37:09.337164 [debug] [Thread-2 (]: Database Error in model stg_user_events (models/1.staging/stg_user_events.sql)
  relation "raw.event_files" does not exist
  LINE 10:     from "podcast_analytics"."raw"."event_files"
                    ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_user_events.sql
[0m13:37:09.337735 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ad7ba34-50a7-47aa-8a6d-124b6f755472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042c0c50>]}
[0m13:37:09.337895 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ad7ba34-50a7-47aa-8a6d-124b6f755472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681ec90>]}
[0m13:37:09.338063 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ad7ba34-50a7-47aa-8a6d-124b6f755472', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10681e360>]}
[0m13:37:09.338380 [error] [Thread-3 (]: 3 of 6 ERROR creating sql view model public.stg_users .......................... [[31mERROR[0m in 0.08s]
[0m13:37:09.338672 [error] [Thread-1 (]: 1 of 6 ERROR creating sql view model public.stg_episodes ....................... [[31mERROR[0m in 0.09s]
[0m13:37:09.338953 [error] [Thread-2 (]: 2 of 6 ERROR creating sql view model public.stg_user_events .................... [[31mERROR[0m in 0.09s]
[0m13:37:09.339224 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_users
[0m13:37:09.339465 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m13:37:09.339699 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m13:37:09.339934 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.stg_users' to be skipped because of status 'error'.  Reason: Database Error in model stg_users (models/1.staging/stg_users.sql)
  relation "raw.users" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."users"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_users.sql.
[0m13:37:09.340506 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.stg_episodes' to be skipped because of status 'error'.  Reason: Database Error in model stg_episodes (models/1.staging/stg_episodes.sql)
  relation "raw.episodes" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."episodes"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_episodes.sql.
[0m13:37:09.340735 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.stg_user_events' to be skipped because of status 'error'.  Reason: Database Error in model stg_user_events (models/1.staging/stg_user_events.sql)
  relation "raw.event_files" does not exist
  LINE 10:     from "podcast_analytics"."raw"."event_files"
                    ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_user_events.sql.
[0m13:37:09.341042 [debug] [Thread-4 (]: Began running node model.podcast_analytics.int_user_sessions
[0m13:37:09.341249 [debug] [Thread-3 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m13:37:09.341476 [info ] [Thread-4 (]: 4 of 6 SKIP relation public.int_user_sessions .................................. [[33mSKIP[0m]
[0m13:37:09.341757 [info ] [Thread-3 (]: 5 of 6 SKIP relation public.mart_top_episodes .................................. [[33mSKIP[0m]
[0m13:37:09.341984 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m13:37:09.342171 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m13:37:09.342404 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m13:37:09.342607 [info ] [Thread-2 (]: 6 of 6 SKIP relation public.mart_user_session_metrics .......................... [[33mSKIP[0m]
[0m13:37:09.342786 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m13:37:09.343309 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:09.343461 [debug] [MainThread]: On master: BEGIN
[0m13:37:09.343595 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:37:09.351763 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:37:09.352021 [debug] [MainThread]: On master: COMMIT
[0m13:37:09.352192 [debug] [MainThread]: Using postgres connection "master"
[0m13:37:09.352392 [debug] [MainThread]: On master: COMMIT
[0m13:37:09.352697 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:37:09.352858 [debug] [MainThread]: On master: Close
[0m13:37:09.353090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:37:09.353244 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_episodes' was properly closed.
[0m13:37:09.353388 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_user_events' was properly closed.
[0m13:37:09.353534 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_users' was properly closed.
[0m13:37:09.353747 [info ] [MainThread]: 
[0m13:37:09.353937 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m13:37:09.354404 [debug] [MainThread]: Command end result
[0m13:37:09.366965 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:37:09.367894 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:37:09.370558 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:37:09.370732 [info ] [MainThread]: 
[0m13:37:09.370912 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m13:37:09.371062 [info ] [MainThread]: 
[0m13:37:09.371251 [error] [MainThread]: [31mFailure in model stg_users (models/1.staging/stg_users.sql)[0m
[0m13:37:09.371426 [error] [MainThread]:   Database Error in model stg_users (models/1.staging/stg_users.sql)
  relation "raw.users" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."users"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_users.sql
[0m13:37:09.371566 [info ] [MainThread]: 
[0m13:37:09.371720 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/1.staging/stg_users.sql
[0m13:37:09.371863 [info ] [MainThread]: 
[0m13:37:09.372026 [error] [MainThread]: [31mFailure in model stg_episodes (models/1.staging/stg_episodes.sql)[0m
[0m13:37:09.372191 [error] [MainThread]:   Database Error in model stg_episodes (models/1.staging/stg_episodes.sql)
  relation "raw.episodes" does not exist
  LINE 9:     select * from "podcast_analytics"."raw"."episodes"
                            ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_episodes.sql
[0m13:37:09.372325 [info ] [MainThread]: 
[0m13:37:09.372477 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/1.staging/stg_episodes.sql
[0m13:37:09.372610 [info ] [MainThread]: 
[0m13:37:09.372767 [error] [MainThread]: [31mFailure in model stg_user_events (models/1.staging/stg_user_events.sql)[0m
[0m13:37:09.372927 [error] [MainThread]:   Database Error in model stg_user_events (models/1.staging/stg_user_events.sql)
  relation "raw.event_files" does not exist
  LINE 10:     from "podcast_analytics"."raw"."event_files"
                    ^
  compiled code at target/run/podcast_analytics/models/1.staging/stg_user_events.sql
[0m13:37:09.373062 [info ] [MainThread]: 
[0m13:37:09.373216 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/1.staging/stg_user_events.sql
[0m13:37:09.373354 [info ] [MainThread]: 
[0m13:37:09.373527 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=3 NO-OP=0 TOTAL=6
[0m13:37:09.375105 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5951662, "process_in_blocks": "0", "process_kernel_time": 0.182489, "process_mem_max_rss": "105267200", "process_out_blocks": "0", "process_user_time": 1.124727}
[0m13:37:09.375440 [debug] [MainThread]: Command `dbt run` failed at 13:37:09.375386 after 1.60 seconds
[0m13:37:09.375690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ed2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068442f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106844fe0>]}
[0m13:37:09.375899 [debug] [MainThread]: Flushing usage events
[0m13:37:09.736164 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:57.072752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10433cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061b5c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfd0a0>]}


============================== 13:39:57.075479 | a0d0117a-e350-4851-b3d9-27032f4c7fb5 ==============================
[0m13:39:57.075479 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:39:57.075792 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir ..', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:39:57.132322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a0d0117a-e350-4851-b3d9-27032f4c7fb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e4cb0>]}
[0m13:39:57.161701 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-tyrxhf43'
[0m13:39:57.161994 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:39:57.258947 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:39:57.259403 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:39:57.310964 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:39:57.312720 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:39:57.541879 [info ] [MainThread]: Installed from version 1.3.0
[0m13:39:57.542188 [info ] [MainThread]: Up to date!
[0m13:39:57.542432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a0d0117a-e350-4851-b3d9-27032f4c7fb5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cfd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d01880>]}
[0m13:39:57.544491 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.50899005, "process_in_blocks": "0", "process_kernel_time": 0.166108, "process_mem_max_rss": "111853568", "process_out_blocks": "0", "process_user_time": 0.700737}
[0m13:39:57.544774 [debug] [MainThread]: Command `dbt deps` succeeded at 13:39:57.544725 after 0.51 seconds
[0m13:39:57.544970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cda840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8a030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c8a4b0>]}
[0m13:39:57.545157 [debug] [MainThread]: Flushing usage events
[0m13:39:57.929865 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:39:58.978849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f5a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f5340>]}


============================== 13:39:58.980975 | b050742d-1f51-47ca-8c12-3eff1ca98ac5 ==============================
[0m13:39:58.980975 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:39:58.981335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '..', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed --profiles-dir ..', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:39:59.071825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b050742d-1f51-47ca-8c12-3eff1ca98ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105184410>]}
[0m13:39:59.101375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b050742d-1f51-47ca-8c12-3eff1ca98ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051063c0>]}
[0m13:39:59.102816 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:39:59.160122 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:39:59.240070 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:39:59.240701 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/schema.yml
[0m13:39:59.638469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b050742d-1f51-47ca-8c12-3eff1ca98ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f6a20>]}
[0m13:39:59.729270 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:39:59.730854 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:39:59.744091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b050742d-1f51-47ca-8c12-3eff1ca98ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b7a10>]}
[0m13:39:59.744482 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:39:59.744693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b050742d-1f51-47ca-8c12-3eff1ca98ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10084bd10>]}
[0m13:39:59.746105 [info ] [MainThread]: 
[0m13:39:59.746403 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:39:59.746609 [info ] [MainThread]: 
[0m13:39:59.746947 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:39:59.748941 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:39:59.802881 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:39:59.803260 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:39:59.803467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:59.951774 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.148 seconds
[0m13:39:59.953341 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:39:59.955066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:39:59.960693 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:39:59.961023 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:39:59.961197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:59.973275 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:39:59.974257 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:39:59.974489 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:39:59.988093 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.013 seconds
[0m13:39:59.989286 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:39:59.990359 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:39:59.993365 [debug] [MainThread]: Using postgres connection "master"
[0m13:39:59.993750 [debug] [MainThread]: On master: BEGIN
[0m13:39:59.994636 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:00.013364 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m13:40:00.013756 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:00.014076 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:40:00.041608 [debug] [MainThread]: SQL status: SELECT 0 in 0.027 seconds
[0m13:40:00.043697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b050742d-1f51-47ca-8c12-3eff1ca98ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075d7770>]}
[0m13:40:00.047731 [debug] [MainThread]: On master: ROLLBACK
[0m13:40:00.059946 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:00.060998 [debug] [MainThread]: On master: BEGIN
[0m13:40:00.063946 [debug] [MainThread]: SQL status: BEGIN in 0.002 seconds
[0m13:40:00.064601 [debug] [MainThread]: On master: COMMIT
[0m13:40:00.064862 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:00.065065 [debug] [MainThread]: On master: COMMIT
[0m13:40:00.067991 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:40:00.068626 [debug] [MainThread]: On master: Close
[0m13:40:00.164162 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m13:40:00.175946 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m13:40:00.177272 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m13:40:00.178207 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m13:40:00.178969 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m13:40:00.185223 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m13:40:00.192647 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m13:40:00.200734 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m13:40:00.207782 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:40:00.208101 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m13:40:00.208319 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m13:40:00.208545 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m13:40:00.209708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:00.212820 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:40:00.213041 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m13:40:00.213218 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:40:00.256610 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m13:40:00.258920 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:40:00.259803 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m13:40:00.281961 [debug] [Thread-2 (]: SQL status: BEGIN in 0.068 seconds
[0m13:40:00.282868 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:40:00.283360 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m13:40:00.294087 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.010 seconds
[0m13:40:00.304584 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.043 seconds
[0m13:40:00.400501 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:40:00.405541 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:40:00.406284 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m13:40:00.406842 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m13:40:00.410029 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.003 seconds
[0m13:40:00.410665 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.003 seconds
[0m13:40:00.414161 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m13:40:00.414752 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m13:40:00.433355 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:40:00.434249 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:40:00.434472 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:40:00.434904 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:40:00.436366 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:40:00.437316 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:40:00.442954 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m13:40:00.443243 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:40:00.444332 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m13:40:00.444688 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m13:40:00.446404 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b050742d-1f51-47ca-8c12-3eff1ca98ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1034225d0>]}
[0m13:40:00.446828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b050742d-1f51-47ca-8c12-3eff1ca98ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a61d30>]}
[0m13:40:00.447181 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.24s]
[0m13:40:00.447698 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.27s]
[0m13:40:00.448061 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m13:40:00.448347 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m13:40:00.449281 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:00.449467 [debug] [MainThread]: On master: BEGIN
[0m13:40:00.449630 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:00.467229 [debug] [MainThread]: SQL status: BEGIN in 0.017 seconds
[0m13:40:00.467583 [debug] [MainThread]: On master: COMMIT
[0m13:40:00.467849 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:00.468023 [debug] [MainThread]: On master: COMMIT
[0m13:40:00.468514 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:40:00.468682 [debug] [MainThread]: On master: Close
[0m13:40:00.469030 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:00.469743 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m13:40:00.469998 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m13:40:00.470588 [info ] [MainThread]: 
[0m13:40:00.471229 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m13:40:00.472962 [debug] [MainThread]: Command end result
[0m13:40:00.492446 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:40:00.494917 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:40:00.498551 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:40:00.498817 [info ] [MainThread]: 
[0m13:40:00.499088 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:40:00.499295 [info ] [MainThread]: 
[0m13:40:00.499554 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:40:00.501343 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.5552019, "process_in_blocks": "0", "process_kernel_time": 0.213339, "process_mem_max_rss": "132431872", "process_out_blocks": "0", "process_user_time": 1.493476}
[0m13:40:00.502184 [debug] [MainThread]: Command `dbt seed` succeeded at 13:40:00.501919 after 1.56 seconds
[0m13:40:00.503878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105350170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b1940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f5940>]}
[0m13:40:00.504839 [debug] [MainThread]: Flushing usage events
[0m13:40:00.872843 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:40:02.232615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129f5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129f5640>]}


============================== 13:40:02.248333 | 625aa768-5880-4d18-90f6-282fabd78b68 ==============================
[0m13:40:02.248333 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:40:02.249023 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ..', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:40:02.386206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '625aa768-5880-4d18-90f6-282fabd78b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112af0a40>]}
[0m13:40:02.419072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '625aa768-5880-4d18-90f6-282fabd78b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e5c4a0>]}
[0m13:40:02.419741 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:40:02.493477 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:40:02.576375 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:40:02.576712 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:40:02.610303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '625aa768-5880-4d18-90f6-282fabd78b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113445550>]}
[0m13:40:02.665622 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:40:02.667556 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:40:02.679501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '625aa768-5880-4d18-90f6-282fabd78b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136fd340>]}
[0m13:40:02.679918 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:40:02.680138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '625aa768-5880-4d18-90f6-282fabd78b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f230e0>]}
[0m13:40:02.681281 [info ] [MainThread]: 
[0m13:40:02.681510 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:40:02.681670 [info ] [MainThread]: 
[0m13:40:02.682001 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:40:02.684242 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:40:02.712986 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:40:02.713358 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:40:02.713557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:40:02.767276 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.054 seconds
[0m13:40:02.769457 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:40:02.774386 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:40:02.778701 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:40:02.779077 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:40:02.782046 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:40:02.792632 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:40:02.793191 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:40:02.793914 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:40:02.804663 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.009 seconds
[0m13:40:02.806590 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:40:02.807527 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:40:02.811181 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:02.811466 [debug] [MainThread]: On master: BEGIN
[0m13:40:02.811638 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:40:02.819170 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:40:02.819532 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:02.819820 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:40:02.826337 [debug] [MainThread]: SQL status: SELECT 0 in 0.006 seconds
[0m13:40:02.827309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '625aa768-5880-4d18-90f6-282fabd78b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e61070>]}
[0m13:40:02.827638 [debug] [MainThread]: On master: ROLLBACK
[0m13:40:02.828357 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:02.828528 [debug] [MainThread]: On master: BEGIN
[0m13:40:02.829499 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:40:02.829718 [debug] [MainThread]: On master: COMMIT
[0m13:40:02.829892 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:02.830050 [debug] [MainThread]: On master: COMMIT
[0m13:40:02.830578 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:40:02.830753 [debug] [MainThread]: On master: Close
[0m13:40:02.832728 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m13:40:02.832992 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m13:40:02.833183 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_users
[0m13:40:02.833539 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_episodes ................................ [RUN]
[0m13:40:02.834233 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_user_events ............................. [RUN]
[0m13:40:02.835138 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_users ................................... [RUN]
[0m13:40:02.835804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m13:40:02.836194 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m13:40:02.836469 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m13:40:02.836733 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m13:40:02.837606 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m13:40:02.838155 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_users
[0m13:40:02.843908 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m13:40:02.851604 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m13:40:02.853044 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m13:40:02.854355 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_users
[0m13:40:02.866771 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m13:40:02.867098 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m13:40:02.878980 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m13:40:02.882508 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m13:40:02.884471 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m13:40:02.885286 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:40:02.885545 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:40:02.885777 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: BEGIN
[0m13:40:02.887725 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:40:02.889092 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m13:40:02.889885 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:40:02.890387 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m13:40:02.890663 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:02.890938 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:40:02.901612 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m13:40:02.902048 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:40:02.902236 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:40:02.902486 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:40:02.902688 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m13:40:02.902921 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

filtered as (
    select * from source
    where data ->> 'type' in ('play', 'pause', 'seek', 'complete')
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'ts' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        (data ->> 'ts')::timestamp as event_ts,
        data ->> 'type'         as event_type,
        (data ->> 'duration')::integer as duration
    from filtered
)
select * from typed
  );
[0m13:40:02.903151 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m13:40:02.903343 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:40:02.905166 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m13:40:02.913130 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:40:02.913411 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:40:02.913590 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m13:40:02.916994 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:40:02.918569 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:40:02.920392 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:40:02.921057 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:40:02.921797 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m13:40:02.922375 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m13:40:02.926767 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:02.927163 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:40:02.927389 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:40:02.935563 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m13:40:02.936522 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m13:40:02.938047 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: COMMIT
[0m13:40:02.938595 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:40:02.938943 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:40:02.939189 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:40:02.939432 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m13:40:02.939660 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m13:40:02.939871 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: COMMIT
[0m13:40:02.941932 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:40:02.942157 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m13:40:02.945380 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m13:40:02.945771 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m13:40:02.947265 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m13:40:02.950059 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:40:02.951421 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m13:40:02.951924 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:40:02.952132 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m13:40:02.952537 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:40:02.953514 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m13:40:02.956070 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m13:40:02.956684 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:40:02.958287 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m13:40:02.958493 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:40:02.958698 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:40:02.959731 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m13:40:02.961337 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: Close
[0m13:40:02.961929 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '625aa768-5880-4d18-90f6-282fabd78b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079366c0>]}
[0m13:40:02.962239 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '625aa768-5880-4d18-90f6-282fabd78b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cc22d0>]}
[0m13:40:02.962941 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '625aa768-5880-4d18-90f6-282fabd78b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c4a600>]}
[0m13:40:02.963998 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m13:40:02.964563 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.13s]
[0m13:40:02.965006 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.13s]
[0m13:40:02.965440 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m13:40:02.965711 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m13:40:02.965966 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_users
[0m13:40:02.966460 [debug] [Thread-4 (]: Began running node model.podcast_analytics.int_user_sessions
[0m13:40:02.966675 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m13:40:02.966912 [info ] [Thread-4 (]: 4 of 6 START sql view model public.int_user_sessions ........................... [RUN]
[0m13:40:02.967271 [info ] [Thread-1 (]: 5 of 6 START sql view model public.mart_top_episodes ........................... [RUN]
[0m13:40:02.967717 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.int_user_sessions'
[0m13:40:02.967932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.mart_top_episodes)
[0m13:40:02.968130 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m13:40:02.968319 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m13:40:02.975666 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m13:40:02.981607 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m13:40:02.982627 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m13:40:02.984951 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m13:40:02.985327 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m13:40:02.989074 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m13:40:02.990421 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:40:02.990713 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m13:40:02.991284 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:40:02.991689 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:40:02.991872 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m13:40:02.992035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:40:03.006349 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m13:40:03.007449 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:40:03.008209 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

flagged as (
    select
        *,
        case
            when lag(event_ts) over (partition by user_id order by event_ts) is null
              or datediff('minute', lag(event_ts) over (partition by user_id order by event_ts), event_ts) > 30
            then 1 else 0 end as new_session_flag
    from events
),

numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

agg as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        min(event_ts) as session_start,
        max(event_ts) as session_end,
        datediff('second', min(event_ts), max(event_ts)) as session_duration
    from numbered
    group by user_id, session_number
)
select * from agg
  );
[0m13:40:03.008991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:40:03.009510 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:40:03.009991 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m13:40:03.011002 [debug] [Thread-4 (]: Postgres adapter: Postgres error: function datediff(unknown, timestamp without time zone, timestamp without time zone) does not exist
LINE 17:               or datediff('minute', lag(event_ts) over (part...
                          ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m13:40:03.011355 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: ROLLBACK
[0m13:40:03.014100 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: Close
[0m13:40:03.023883 [debug] [Thread-4 (]: Database Error in model int_user_sessions (models/2.intermediate/int_user_sessions.sql)
  function datediff(unknown, timestamp without time zone, timestamp without time zone) does not exist
  LINE 17:               or datediff('minute', lag(event_ts) over (part...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/podcast_analytics/models/2.intermediate/int_user_sessions.sql
[0m13:40:03.024418 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '625aa768-5880-4d18-90f6-282fabd78b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c527b0>]}
[0m13:40:03.025256 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model public.int_user_sessions .................. [[31mERROR[0m in 0.06s]
[0m13:40:03.026256 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m13:40:03.026712 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m13:40:03.027233 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.int_user_sessions' to be skipped because of status 'error'.  Reason: Database Error in model int_user_sessions (models/2.intermediate/int_user_sessions.sql)
  function datediff(unknown, timestamp without time zone, timestamp without time zone) does not exist
  LINE 17:               or datediff('minute', lag(event_ts) over (part...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/podcast_analytics/models/2.intermediate/int_user_sessions.sql.
[0m13:40:03.029247 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:40:03.030966 [debug] [Thread-3 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m13:40:03.031539 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m13:40:03.032057 [info ] [Thread-3 (]: 6 of 6 SKIP relation public.mart_user_session_metrics .......................... [[33mSKIP[0m]
[0m13:40:03.032553 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m13:40:03.033457 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:40:03.034499 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m13:40:03.034868 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:40:03.035058 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m13:40:03.036534 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:40:03.041599 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m13:40:03.042743 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:40:03.042966 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m13:40:03.045630 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:40:03.046601 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m13:40:03.047236 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '625aa768-5880-4d18-90f6-282fabd78b68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bae3f0>]}
[0m13:40:03.047643 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m13:40:03.048456 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m13:40:03.049724 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:03.049928 [debug] [MainThread]: On master: BEGIN
[0m13:40:03.050081 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:40:03.060104 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:40:03.060758 [debug] [MainThread]: On master: COMMIT
[0m13:40:03.060984 [debug] [MainThread]: Using postgres connection "master"
[0m13:40:03.061163 [debug] [MainThread]: On master: COMMIT
[0m13:40:03.061817 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:40:03.061987 [debug] [MainThread]: On master: Close
[0m13:40:03.062238 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:40:03.062383 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m13:40:03.062590 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_user_events' was properly closed.
[0m13:40:03.062755 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_users' was properly closed.
[0m13:40:03.062897 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m13:40:03.063134 [info ] [MainThread]: 
[0m13:40:03.063335 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m13:40:03.063909 [debug] [MainThread]: Command end result
[0m13:40:03.140675 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:40:03.142830 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:40:03.146340 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:40:03.146616 [info ] [MainThread]: 
[0m13:40:03.146845 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:40:03.147024 [info ] [MainThread]: 
[0m13:40:03.147232 [error] [MainThread]: [31mFailure in model int_user_sessions (models/2.intermediate/int_user_sessions.sql)[0m
[0m13:40:03.147438 [error] [MainThread]:   Database Error in model int_user_sessions (models/2.intermediate/int_user_sessions.sql)
  function datediff(unknown, timestamp without time zone, timestamp without time zone) does not exist
  LINE 17:               or datediff('minute', lag(event_ts) over (part...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled code at target/run/podcast_analytics/models/2.intermediate/int_user_sessions.sql
[0m13:40:03.147599 [info ] [MainThread]: 
[0m13:40:03.147773 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/2.intermediate/int_user_sessions.sql
[0m13:40:03.147933 [info ] [MainThread]: 
[0m13:40:03.148109 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=6
[0m13:40:03.150296 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.0037749, "process_in_blocks": "0", "process_kernel_time": 0.21307, "process_mem_max_rss": "129204224", "process_out_blocks": "0", "process_user_time": 1.446937}
[0m13:40:03.150830 [debug] [MainThread]: Command `dbt run` failed at 13:40:03.150774 after 1.00 seconds
[0m13:40:03.151095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d50470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d50980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d50590>]}
[0m13:40:03.151334 [debug] [MainThread]: Flushing usage events
[0m13:40:03.611784 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:26.969013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058c95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106449fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b50a0>]}


============================== 13:41:26.971602 | 448e9566-d79b-4613-8ea8-91f1051a619d ==============================
[0m13:41:26.971602 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:41:26.971923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '..', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir ..', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:41:27.027106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '448e9566-d79b-4613-8ea8-91f1051a619d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3c350>]}
[0m13:41:27.056159 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-h8zkjybc'
[0m13:41:27.056453 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:41:27.149378 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:41:27.149847 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:41:27.208169 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:41:27.210160 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:41:27.484701 [info ] [MainThread]: Installed from version 1.3.0
[0m13:41:27.486849 [info ] [MainThread]: Up to date!
[0m13:41:27.487167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '448e9566-d79b-4613-8ea8-91f1051a619d', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10696bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10530cad0>]}
[0m13:41:27.492310 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.559247, "process_in_blocks": "0", "process_kernel_time": 0.151942, "process_mem_max_rss": "110739456", "process_out_blocks": "0", "process_user_time": 0.675898}
[0m13:41:27.494191 [debug] [MainThread]: Command `dbt deps` succeeded at 13:41:27.493414 after 0.56 seconds
[0m13:41:27.495485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106040170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068896a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b5af30>]}
[0m13:41:27.496056 [debug] [MainThread]: Flushing usage events
[0m13:41:27.896793 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:29.065854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104604b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c8d3a0>]}


============================== 13:41:29.068334 | c559e8c2-3ca6-4953-affc-75b8ed2adee2 ==============================
[0m13:41:29.068334 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:41:29.068727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed --profiles-dir ..', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:41:29.170119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c559e8c2-3ca6-4953-affc-75b8ed2adee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fa24b0>]}
[0m13:41:29.195513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c559e8c2-3ca6-4953-affc-75b8ed2adee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd0a40>]}
[0m13:41:29.196856 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:41:29.254219 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:41:29.333627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:41:29.334115 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/2.intermediate/int_user_sessions.sql
[0m13:41:29.476765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c559e8c2-3ca6-4953-affc-75b8ed2adee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6bb90>]}
[0m13:41:29.538963 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:41:29.541330 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:41:29.595472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c559e8c2-3ca6-4953-affc-75b8ed2adee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105966de0>]}
[0m13:41:29.596635 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:41:29.597456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c559e8c2-3ca6-4953-affc-75b8ed2adee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b6da30>]}
[0m13:41:29.601153 [info ] [MainThread]: 
[0m13:41:29.602848 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:41:29.603561 [info ] [MainThread]: 
[0m13:41:29.604104 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:41:29.606436 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:41:29.644990 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:41:29.645572 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:41:29.645853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:29.706791 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.061 seconds
[0m13:41:29.710851 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:41:29.729497 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:41:29.750008 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:41:29.761521 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:41:29.762463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:29.788189 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m13:41:29.788694 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:41:29.788949 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:41:29.796654 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m13:41:29.800156 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:41:29.803023 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:41:29.817957 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:29.823589 [debug] [MainThread]: On master: BEGIN
[0m13:41:29.825344 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:29.901491 [debug] [MainThread]: SQL status: BEGIN in 0.075 seconds
[0m13:41:29.905059 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:29.905533 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:41:29.916609 [debug] [MainThread]: SQL status: SELECT 4 in 0.010 seconds
[0m13:41:29.919125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c559e8c2-3ca6-4953-affc-75b8ed2adee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060483e0>]}
[0m13:41:29.919687 [debug] [MainThread]: On master: ROLLBACK
[0m13:41:29.921117 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:29.921617 [debug] [MainThread]: On master: BEGIN
[0m13:41:29.923491 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:41:29.924001 [debug] [MainThread]: On master: COMMIT
[0m13:41:29.924281 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:29.924503 [debug] [MainThread]: On master: COMMIT
[0m13:41:29.926900 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m13:41:29.928736 [debug] [MainThread]: On master: Close
[0m13:41:29.969182 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m13:41:29.969854 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m13:41:29.970284 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m13:41:29.971204 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m13:41:29.971801 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m13:41:29.980679 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m13:41:29.982827 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m13:41:29.984475 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m13:41:29.985170 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m13:41:29.985983 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m13:41:30.107099 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:41:30.109167 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:41:30.109914 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m13:41:30.110623 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m13:41:30.112709 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:41:30.113327 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:30.138732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m13:41:30.139407 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:41:30.139713 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m13:41:30.145722 [debug] [Thread-2 (]: SQL status: BEGIN in 0.033 seconds
[0m13:41:30.146605 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.006 seconds
[0m13:41:30.147118 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:41:30.160894 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m13:41:30.176600 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.015 seconds
[0m13:41:30.449139 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:41:30.466399 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:41:30.466746 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m13:41:30.467076 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m13:41:30.469508 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.002 seconds
[0m13:41:30.470165 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.002 seconds
[0m13:41:30.474786 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m13:41:30.475836 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m13:41:30.486733 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:41:30.488163 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:41:30.488939 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:41:30.489365 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:41:30.489667 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:41:30.489935 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:41:30.495836 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:41:30.496393 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m13:41:30.498528 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m13:41:30.499277 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m13:41:30.503379 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c559e8c2-3ca6-4953-affc-75b8ed2adee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b9fe00>]}
[0m13:41:30.503718 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c559e8c2-3ca6-4953-affc-75b8ed2adee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100754320>]}
[0m13:41:30.504211 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.53s]
[0m13:41:30.504517 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.52s]
[0m13:41:30.505168 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m13:41:30.505551 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m13:41:30.507096 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:30.507434 [debug] [MainThread]: On master: BEGIN
[0m13:41:30.507659 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:41:30.520044 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:41:30.520505 [debug] [MainThread]: On master: COMMIT
[0m13:41:30.520788 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:30.521021 [debug] [MainThread]: On master: COMMIT
[0m13:41:30.521780 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:41:30.522034 [debug] [MainThread]: On master: Close
[0m13:41:30.522786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:30.523790 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m13:41:30.525130 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m13:41:30.526264 [info ] [MainThread]: 
[0m13:41:30.528906 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m13:41:30.530485 [debug] [MainThread]: Command end result
[0m13:41:30.563113 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:41:30.566531 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:41:30.572420 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:41:30.572757 [info ] [MainThread]: 
[0m13:41:30.573251 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:41:30.574249 [info ] [MainThread]: 
[0m13:41:30.575060 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:41:30.581695 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.5494604, "process_in_blocks": "0", "process_kernel_time": 0.211628, "process_mem_max_rss": "129892352", "process_out_blocks": "0", "process_user_time": 1.504643}
[0m13:41:30.583189 [debug] [MainThread]: Command `dbt seed` succeeded at 13:41:30.582679 after 1.55 seconds
[0m13:41:30.583948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f77980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac4a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac4c50>]}
[0m13:41:30.584615 [debug] [MainThread]: Flushing usage events
[0m13:41:30.981952 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:41:32.853060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf53d0>]}


============================== 13:41:32.856462 | 9afcfcc9-a600-4782-b90c-cbc579c78be6 ==============================
[0m13:41:32.856462 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:41:32.857007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ..', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:41:33.084887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9afcfcc9-a600-4782-b90c-cbc579c78be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bfe630>]}
[0m13:41:33.161796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9afcfcc9-a600-4782-b90c-cbc579c78be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10728f200>]}
[0m13:41:33.163276 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:41:33.292339 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:41:33.435636 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:41:33.436520 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:41:33.476792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9afcfcc9-a600-4782-b90c-cbc579c78be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10886b200>]}
[0m13:41:33.580721 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:41:33.582813 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:41:33.598480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9afcfcc9-a600-4782-b90c-cbc579c78be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cd5c40>]}
[0m13:41:33.599069 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:41:33.599879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9afcfcc9-a600-4782-b90c-cbc579c78be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d1e7e0>]}
[0m13:41:33.601928 [info ] [MainThread]: 
[0m13:41:33.602346 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:41:33.602575 [info ] [MainThread]: 
[0m13:41:33.602969 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:41:33.606698 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:41:33.682490 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:41:33.683800 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:41:33.684083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:41:33.741538 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.057 seconds
[0m13:41:33.743221 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:41:33.745353 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:41:33.751685 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:41:33.752197 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:41:33.752455 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:41:33.768182 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m13:41:33.770086 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:41:33.770923 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:41:33.774807 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m13:41:33.776351 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:41:33.780339 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:41:33.790002 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:33.790437 [debug] [MainThread]: On master: BEGIN
[0m13:41:33.790656 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:41:33.804139 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m13:41:33.804661 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:33.804986 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:41:33.812410 [debug] [MainThread]: SQL status: SELECT 4 in 0.007 seconds
[0m13:41:33.815103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9afcfcc9-a600-4782-b90c-cbc579c78be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d0ec30>]}
[0m13:41:33.815565 [debug] [MainThread]: On master: ROLLBACK
[0m13:41:33.816678 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:33.816920 [debug] [MainThread]: On master: BEGIN
[0m13:41:33.818205 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:41:33.818468 [debug] [MainThread]: On master: COMMIT
[0m13:41:33.818710 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:33.818909 [debug] [MainThread]: On master: COMMIT
[0m13:41:33.819495 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:41:33.819747 [debug] [MainThread]: On master: Close
[0m13:41:33.822149 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m13:41:33.822451 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m13:41:33.822671 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_users
[0m13:41:33.823055 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_episodes ................................ [RUN]
[0m13:41:33.823423 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_user_events ............................. [RUN]
[0m13:41:33.823785 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_users ................................... [RUN]
[0m13:41:33.824142 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m13:41:33.824463 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m13:41:33.824749 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m13:41:33.825016 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m13:41:33.825267 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m13:41:33.825539 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_users
[0m13:41:33.832141 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m13:41:33.851752 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m13:41:33.852341 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m13:41:33.853443 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_users
[0m13:41:33.853735 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m13:41:33.853959 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m13:41:33.881359 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m13:41:33.884830 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m13:41:33.886840 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m13:41:33.887616 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:41:33.887935 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:41:33.888213 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:41:33.888469 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: BEGIN
[0m13:41:33.888785 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m13:41:33.889282 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m13:41:33.889532 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:41:33.889808 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:41:33.890608 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:33.905995 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m13:41:33.906940 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:41:33.907434 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m13:41:33.912644 [debug] [Thread-2 (]: SQL status: BEGIN in 0.022 seconds
[0m13:41:33.914547 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m13:41:33.915179 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:41:33.915954 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:41:33.916442 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

filtered as (
    select * from source
    where data ->> 'type' in ('play', 'pause', 'seek', 'complete')
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'ts' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        (data ->> 'ts')::timestamp as event_ts,
        data ->> 'type'         as event_type,
        (data ->> 'duration')::integer as duration
    from filtered
)
select * from typed
  );
[0m13:41:33.916942 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:41:33.917533 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m13:41:33.923951 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:41:33.924285 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:41:33.927647 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:41:33.928590 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:41:33.929811 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m13:41:33.931192 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m13:41:33.934862 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:41:33.935586 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m13:41:33.937059 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:41:33.937333 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:41:33.937561 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:41:33.939658 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:41:33.941337 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:41:33.943296 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:41:33.943689 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m13:41:33.943947 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:41:33.944194 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m13:41:33.945832 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:41:33.946423 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:41:33.946740 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:41:33.960639 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: COMMIT
[0m13:41:33.962651 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m13:41:33.963751 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m13:41:33.964053 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:41:33.964296 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:41:33.964533 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:41:33.964760 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: COMMIT
[0m13:41:33.964996 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m13:41:33.965202 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m13:41:33.966974 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:41:33.967227 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m13:41:33.967459 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m13:41:33.971359 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m13:41:33.974040 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m13:41:33.975757 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m13:41:33.979501 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:41:33.980434 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:41:33.980998 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:41:33.981252 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m13:41:33.981506 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m13:41:33.981746 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m13:41:33.989147 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.007 seconds
[0m13:41:33.990217 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m13:41:33.990729 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m13:41:33.992696 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: Close
[0m13:41:33.993620 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m13:41:33.994473 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m13:41:33.999972 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9afcfcc9-a600-4782-b90c-cbc579c78be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ca2d0>]}
[0m13:41:34.000686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9afcfcc9-a600-4782-b90c-cbc579c78be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090417c0>]}
[0m13:41:34.001221 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9afcfcc9-a600-4782-b90c-cbc579c78be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd0b00>]}
[0m13:41:34.003049 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.17s]
[0m13:41:34.001991 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.17s]
[0m13:41:34.003733 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_users
[0m13:41:34.005719 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.17s]
[0m13:41:34.009593 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m13:41:34.007787 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m13:41:34.011083 [debug] [Thread-4 (]: Began running node model.podcast_analytics.int_user_sessions
[0m13:41:34.011620 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m13:41:34.015892 [info ] [Thread-4 (]: 4 of 6 START sql view model public.int_user_sessions ........................... [RUN]
[0m13:41:34.016900 [info ] [Thread-1 (]: 5 of 6 START sql view model public.mart_top_episodes ........................... [RUN]
[0m13:41:34.018134 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.int_user_sessions'
[0m13:41:34.023007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.mart_top_episodes)
[0m13:41:34.024519 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m13:41:34.025382 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m13:41:34.038218 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m13:41:34.040268 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m13:41:34.043800 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m13:41:34.045683 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:41:34.046676 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m13:41:34.047902 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:41:34.054505 [debug] [Thread-4 (]: Compilation Error in model int_user_sessions (models/2.intermediate/int_user_sessions.sql)
  'dict object' has no attribute 'datediff'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:41:34.055016 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9afcfcc9-a600-4782-b90c-cbc579c78be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10902afc0>]}
[0m13:41:34.055497 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model public.int_user_sessions .................. [[31mERROR[0m in 0.04s]
[0m13:41:34.055846 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m13:41:34.056216 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.int_user_sessions' to be skipped because of status 'error'.  Reason: Compilation Error in model int_user_sessions (models/2.intermediate/int_user_sessions.sql)
  'dict object' has no attribute 'datediff'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:41:34.057258 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m13:41:34.057783 [info ] [Thread-2 (]: 6 of 6 SKIP relation public.mart_user_session_metrics .......................... [[33mSKIP[0m]
[0m13:41:34.058065 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m13:41:34.067097 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:41:34.067675 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:41:34.068043 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m13:41:34.071681 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:41:34.075190 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:41:34.075550 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m13:41:34.079209 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:41:34.082779 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m13:41:34.083398 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:41:34.083939 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m13:41:34.085960 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:41:34.091200 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m13:41:34.092272 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:41:34.092667 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m13:41:34.093890 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:41:34.095423 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m13:41:34.096401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9afcfcc9-a600-4782-b90c-cbc579c78be6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10915b710>]}
[0m13:41:34.097587 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.07s]
[0m13:41:34.098712 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m13:41:34.100241 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:34.100501 [debug] [MainThread]: On master: BEGIN
[0m13:41:34.100693 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:41:34.110278 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:41:34.114028 [debug] [MainThread]: On master: COMMIT
[0m13:41:34.114965 [debug] [MainThread]: Using postgres connection "master"
[0m13:41:34.115602 [debug] [MainThread]: On master: COMMIT
[0m13:41:34.117513 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:41:34.117825 [debug] [MainThread]: On master: Close
[0m13:41:34.118129 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:41:34.118323 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m13:41:34.118508 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_user_events' was properly closed.
[0m13:41:34.118736 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_users' was properly closed.
[0m13:41:34.118930 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m13:41:34.119240 [info ] [MainThread]: 
[0m13:41:34.119496 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m13:41:34.120186 [debug] [MainThread]: Command end result
[0m13:41:34.194990 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:41:34.197344 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:41:34.201120 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:41:34.201411 [info ] [MainThread]: 
[0m13:41:34.201676 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:41:34.201890 [info ] [MainThread]: 
[0m13:41:34.202139 [error] [MainThread]: [31mFailure in model int_user_sessions (models/2.intermediate/int_user_sessions.sql)[0m
[0m13:41:34.202562 [error] [MainThread]:   Compilation Error in model int_user_sessions (models/2.intermediate/int_user_sessions.sql)
  'dict object' has no attribute 'datediff'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:41:34.203156 [info ] [MainThread]: 
[0m13:41:34.203379 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=6
[0m13:41:34.205463 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4483129, "process_in_blocks": "0", "process_kernel_time": 0.275776, "process_mem_max_rss": "127156224", "process_out_blocks": "0", "process_user_time": 1.615137}
[0m13:41:34.205831 [debug] [MainThread]: Command `dbt run` failed at 13:41:34.205775 after 1.45 seconds
[0m13:41:34.206109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b0890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092740b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109274ce0>]}
[0m13:41:34.206365 [debug] [MainThread]: Flushing usage events
[0m13:41:34.650936 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:42:53.134995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d76780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffd970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffd370>]}


============================== 13:42:53.138130 | b7dccc47-8eb2-4192-ae33-63caeffdba12 ==============================
[0m13:42:53.138130 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:42:53.138512 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps --profiles-dir ..', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:42:53.207868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b7dccc47-8eb2-4192-ae33-63caeffdba12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f8a720>]}
[0m13:42:53.247748 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-i0g1zywj'
[0m13:42:53.248574 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:42:53.351479 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:42:53.352105 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:42:53.408400 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:42:53.410452 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:42:53.658928 [info ] [MainThread]: Installed from version 1.3.0
[0m13:42:53.659318 [info ] [MainThread]: Up to date!
[0m13:42:53.659595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b7dccc47-8eb2-4192-ae33-63caeffdba12', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1281a3e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fda0f0>]}
[0m13:42:53.661531 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5649329, "process_in_blocks": "0", "process_kernel_time": 0.351311, "process_mem_max_rss": "110362624", "process_out_blocks": "0", "process_user_time": 1.21864}
[0m13:42:53.661928 [debug] [MainThread]: Command `dbt deps` succeeded at 13:42:53.661860 after 0.57 seconds
[0m13:42:53.662171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1280cb200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1280cb530>]}
[0m13:42:53.662392 [debug] [MainThread]: Flushing usage events
[0m13:42:54.084262 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:42:54.959295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f92c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118e9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118e9430>]}


============================== 13:42:54.961528 | 220ba9ea-b852-425c-af0b-0eb4bd476ccd ==============================
[0m13:42:54.961528 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:42:54.961864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m13:42:55.055250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '220ba9ea-b852-425c-af0b-0eb4bd476ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119a5f40>]}
[0m13:42:55.083248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '220ba9ea-b852-425c-af0b-0eb4bd476ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11192a690>]}
[0m13:42:55.084685 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:42:55.140583 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:42:55.214538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:42:55.215072 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/2.intermediate/int_user_sessions.sql
[0m13:42:55.345193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '220ba9ea-b852-425c-af0b-0eb4bd476ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e6fda0>]}
[0m13:42:55.388871 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:42:55.390695 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:42:55.401665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '220ba9ea-b852-425c-af0b-0eb4bd476ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ea3380>]}
[0m13:42:55.402044 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:42:55.402260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '220ba9ea-b852-425c-af0b-0eb4bd476ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e6f770>]}
[0m13:42:55.403263 [info ] [MainThread]: 
[0m13:42:55.403474 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:42:55.403640 [info ] [MainThread]: 
[0m13:42:55.403923 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:42:55.405799 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:42:55.438124 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:42:55.438447 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:42:55.438636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:55.484825 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.046 seconds
[0m13:42:55.485632 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:42:55.486463 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:42:55.489442 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:42:55.489632 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:42:55.489781 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:42:55.499056 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m13:42:55.499458 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:42:55.499673 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:42:55.504397 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.005 seconds
[0m13:42:55.505098 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:42:55.505965 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:42:55.508696 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:55.508895 [debug] [MainThread]: On master: BEGIN
[0m13:42:55.509044 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:42:55.515749 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:42:55.515973 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:55.516207 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:42:55.519957 [debug] [MainThread]: SQL status: SELECT 4 in 0.004 seconds
[0m13:42:55.521015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '220ba9ea-b852-425c-af0b-0eb4bd476ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e8c8c0>]}
[0m13:42:55.521329 [debug] [MainThread]: On master: ROLLBACK
[0m13:42:55.521751 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:55.521904 [debug] [MainThread]: On master: BEGIN
[0m13:42:55.522439 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:42:55.522599 [debug] [MainThread]: On master: COMMIT
[0m13:42:55.522746 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:55.522887 [debug] [MainThread]: On master: COMMIT
[0m13:42:55.523222 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:42:55.523411 [debug] [MainThread]: On master: Close
[0m13:42:55.525233 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m13:42:55.525431 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m13:42:55.525712 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m13:42:55.525969 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m13:42:55.526202 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m13:42:55.526428 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m13:42:55.526608 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m13:42:55.526780 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m13:42:55.526958 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m13:42:55.527131 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m13:42:55.547732 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:42:55.550784 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:42:55.551262 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m13:42:55.551502 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m13:42:55.551695 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:42:55.551881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:42:55.559839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m13:42:55.560316 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:42:55.560579 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m13:42:55.561447 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m13:42:55.561653 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:42:55.561850 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m13:42:55.564446 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m13:42:55.571795 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.010 seconds
[0m13:42:55.676686 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:42:55.694976 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m13:42:55.698541 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:42:55.699736 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m13:42:55.704474 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.005 seconds
[0m13:42:55.709311 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m13:42:55.709617 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.010 seconds
[0m13:42:55.710316 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m13:42:55.718422 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:42:55.718825 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:42:55.719069 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:42:55.720150 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:42:55.720382 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:42:55.720583 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:42:55.722790 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m13:42:55.723744 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m13:42:55.723967 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m13:42:55.724353 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m13:42:55.725534 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '220ba9ea-b852-425c-af0b-0eb4bd476ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059225d0>]}
[0m13:42:55.725729 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '220ba9ea-b852-425c-af0b-0eb4bd476ccd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110e7560>]}
[0m13:42:55.726041 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.20s]
[0m13:42:55.726332 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.20s]
[0m13:42:55.726686 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m13:42:55.726977 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m13:42:55.727744 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:55.727924 [debug] [MainThread]: On master: BEGIN
[0m13:42:55.728086 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:42:55.740053 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:42:55.740396 [debug] [MainThread]: On master: COMMIT
[0m13:42:55.740585 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:55.740757 [debug] [MainThread]: On master: COMMIT
[0m13:42:55.741411 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:42:55.741584 [debug] [MainThread]: On master: Close
[0m13:42:55.741837 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:42:55.742001 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m13:42:55.742153 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m13:42:55.742348 [info ] [MainThread]: 
[0m13:42:55.742589 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m13:42:55.743056 [debug] [MainThread]: Command end result
[0m13:42:55.757378 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:42:55.759666 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:42:55.762661 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:42:55.762871 [info ] [MainThread]: 
[0m13:42:55.763266 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:42:55.763495 [info ] [MainThread]: 
[0m13:42:55.763704 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:42:55.767481 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.8578898, "process_in_blocks": "0", "process_kernel_time": 0.158138, "process_mem_max_rss": "134021120", "process_out_blocks": "0", "process_user_time": 1.206805}
[0m13:42:55.768139 [debug] [MainThread]: Command `dbt seed` succeeded at 13:42:55.768072 after 0.86 seconds
[0m13:42:55.768547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f31760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112565bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112565d60>]}
[0m13:42:55.768955 [debug] [MainThread]: Flushing usage events
[0m13:42:56.124807 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:42:58.099214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f800b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106001070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106001850>]}


============================== 13:42:58.103310 | 077154bb-c2e1-4b10-b182-ea2769a9a639 ==============================
[0m13:42:58.103310 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:42:58.104159 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ..', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:42:58.336737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '077154bb-c2e1-4b10-b182-ea2769a9a639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a5d90>]}
[0m13:42:58.406768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '077154bb-c2e1-4b10-b182-ea2769a9a639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044e30b0>]}
[0m13:42:58.407615 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:42:58.495675 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:42:58.664717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:42:58.665390 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:42:58.709340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '077154bb-c2e1-4b10-b182-ea2769a9a639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc13d0>]}
[0m13:42:58.881138 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:42:58.886303 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:42:58.907240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '077154bb-c2e1-4b10-b182-ea2769a9a639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb4cb0>]}
[0m13:42:58.909671 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:42:58.910158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '077154bb-c2e1-4b10-b182-ea2769a9a639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc0a70>]}
[0m13:42:58.912303 [info ] [MainThread]: 
[0m13:42:58.912790 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:42:58.913266 [info ] [MainThread]: 
[0m13:42:58.914011 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:42:58.920761 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:42:58.988231 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:42:58.988971 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:42:58.989416 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:59.047540 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.058 seconds
[0m13:42:59.056166 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:42:59.064591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:42:59.075628 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:42:59.076455 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:42:59.077152 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:42:59.123038 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m13:42:59.123755 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:42:59.124932 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:42:59.137283 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.012 seconds
[0m13:42:59.138816 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:42:59.139802 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:42:59.143613 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:59.143908 [debug] [MainThread]: On master: BEGIN
[0m13:42:59.144106 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:42:59.155407 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:42:59.155774 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:59.156063 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:42:59.160932 [debug] [MainThread]: SQL status: SELECT 4 in 0.005 seconds
[0m13:42:59.162721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '077154bb-c2e1-4b10-b182-ea2769a9a639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dfd580>]}
[0m13:42:59.163345 [debug] [MainThread]: On master: ROLLBACK
[0m13:42:59.165008 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:59.165433 [debug] [MainThread]: On master: BEGIN
[0m13:42:59.169016 [debug] [MainThread]: SQL status: BEGIN in 0.003 seconds
[0m13:42:59.169368 [debug] [MainThread]: On master: COMMIT
[0m13:42:59.169597 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:59.169781 [debug] [MainThread]: On master: COMMIT
[0m13:42:59.170326 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:42:59.170613 [debug] [MainThread]: On master: Close
[0m13:42:59.173316 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m13:42:59.173821 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m13:42:59.174143 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_users
[0m13:42:59.174744 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_episodes ................................ [RUN]
[0m13:42:59.175283 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_user_events ............................. [RUN]
[0m13:42:59.175572 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_users ................................... [RUN]
[0m13:42:59.175889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m13:42:59.176181 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m13:42:59.176437 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m13:42:59.176663 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m13:42:59.176869 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m13:42:59.177069 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_users
[0m13:42:59.184994 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m13:42:59.200197 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m13:42:59.204995 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m13:42:59.210062 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m13:42:59.212787 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_users
[0m13:42:59.226381 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m13:42:59.246949 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m13:42:59.252527 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m13:42:59.258625 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m13:42:59.260559 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:42:59.261483 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m13:42:59.262085 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:42:59.263424 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:42:59.271362 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:42:59.271980 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m13:42:59.272494 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: BEGIN
[0m13:42:59.272986 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:42:59.273597 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:42:59.290047 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m13:42:59.290794 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:42:59.291399 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m13:42:59.295468 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:42:59.302955 [debug] [Thread-2 (]: SQL status: BEGIN in 0.030 seconds
[0m13:42:59.304946 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:42:59.305388 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:42:59.305680 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m13:42:59.305971 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

filtered as (
    select * from source
    where data ->> 'type' in ('play', 'pause', 'seek', 'complete')
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'ts' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        (data ->> 'ts')::timestamp as event_ts,
        data ->> 'type'         as event_type,
        (data ->> 'duration')::integer as duration
    from filtered
)
select * from typed
  );
[0m13:42:59.306676 [debug] [Thread-3 (]: SQL status: BEGIN in 0.033 seconds
[0m13:42:59.306918 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:42:59.307159 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m13:42:59.307620 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:42:59.310779 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:42:59.311128 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:42:59.311366 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:42:59.311695 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m13:42:59.314755 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:42:59.323544 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:42:59.323926 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:42:59.326904 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m13:42:59.331638 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m13:42:59.343093 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m13:42:59.344310 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:42:59.344842 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:42:59.345514 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m13:42:59.345886 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:42:59.348203 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:42:59.354385 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:42:59.354880 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m13:42:59.355189 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:42:59.355732 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m13:42:59.364842 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m13:42:59.370734 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:42:59.371117 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:42:59.371368 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:42:59.371637 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m13:42:59.372779 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: COMMIT
[0m13:42:59.373705 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m13:42:59.374029 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:42:59.374283 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:42:59.374514 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: COMMIT
[0m13:42:59.375151 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m13:42:59.377054 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:42:59.379142 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m13:42:59.379434 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m13:42:59.379701 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m13:42:59.387765 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m13:42:59.388421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '077154bb-c2e1-4b10-b182-ea2769a9a639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1031224b0>]}
[0m13:42:59.390932 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m13:42:59.391628 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:42:59.392175 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.20s]
[0m13:42:59.392908 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:42:59.393172 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m13:42:59.393533 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m13:42:59.393788 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m13:42:59.396491 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:42:59.398448 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: Close
[0m13:42:59.399223 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m13:42:59.399798 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '077154bb-c2e1-4b10-b182-ea2769a9a639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c4440>]}
[0m13:42:59.402358 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m13:42:59.403814 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.22s]
[0m13:42:59.405696 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '077154bb-c2e1-4b10-b182-ea2769a9a639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c4a40>]}
[0m13:42:59.407425 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_users
[0m13:42:59.413795 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.23s]
[0m13:42:59.415141 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m13:42:59.417482 [debug] [Thread-4 (]: Began running node model.podcast_analytics.int_user_sessions
[0m13:42:59.418119 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m13:42:59.419073 [info ] [Thread-4 (]: 4 of 6 START sql view model public.int_user_sessions ........................... [RUN]
[0m13:42:59.420443 [info ] [Thread-1 (]: 5 of 6 START sql view model public.mart_top_episodes ........................... [RUN]
[0m13:42:59.420974 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.int_user_sessions'
[0m13:42:59.421297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.mart_top_episodes)
[0m13:42:59.421572 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m13:42:59.421808 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m13:42:59.428122 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m13:42:59.431337 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m13:42:59.439291 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m13:42:59.440610 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:42:59.442630 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m13:42:59.444107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:42:59.449583 [debug] [Thread-4 (]: Compilation Error in model int_user_sessions (models/2.intermediate/int_user_sessions.sql)
  'dict object' has no attribute 'datediff'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:42:59.450886 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '077154bb-c2e1-4b10-b182-ea2769a9a639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747cec0>]}
[0m13:42:59.452329 [error] [Thread-4 (]: 4 of 6 ERROR creating sql view model public.int_user_sessions .................. [[31mERROR[0m in 0.03s]
[0m13:42:59.453249 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m13:42:59.453853 [debug] [Thread-7 (]: Marking all children of 'model.podcast_analytics.int_user_sessions' to be skipped because of status 'error'.  Reason: Compilation Error in model int_user_sessions (models/2.intermediate/int_user_sessions.sql)
  'dict object' has no attribute 'datediff'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m13:42:59.455808 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m13:42:59.456599 [info ] [Thread-2 (]: 6 of 6 SKIP relation public.mart_user_session_metrics .......................... [[33mSKIP[0m]
[0m13:42:59.457321 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m13:42:59.458412 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m13:42:59.459916 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:42:59.460410 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m13:42:59.466532 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:42:59.471470 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:42:59.472729 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m13:42:59.474848 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:42:59.477648 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m13:42:59.478288 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:42:59.479357 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m13:42:59.482581 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:42:59.485766 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m13:42:59.487127 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:42:59.487464 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m13:42:59.488564 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:42:59.489719 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m13:42:59.490604 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '077154bb-c2e1-4b10-b182-ea2769a9a639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074de120>]}
[0m13:42:59.492420 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.07s]
[0m13:42:59.493423 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m13:42:59.499354 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:59.501411 [debug] [MainThread]: On master: BEGIN
[0m13:42:59.504285 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:42:59.522966 [debug] [MainThread]: SQL status: BEGIN in 0.019 seconds
[0m13:42:59.524050 [debug] [MainThread]: On master: COMMIT
[0m13:42:59.525824 [debug] [MainThread]: Using postgres connection "master"
[0m13:42:59.527606 [debug] [MainThread]: On master: COMMIT
[0m13:42:59.530817 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:42:59.531534 [debug] [MainThread]: On master: Close
[0m13:42:59.532385 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:42:59.532729 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m13:42:59.532947 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_user_events' was properly closed.
[0m13:42:59.533131 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_users' was properly closed.
[0m13:42:59.533515 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m13:42:59.534069 [info ] [MainThread]: 
[0m13:42:59.534993 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m13:42:59.536916 [debug] [MainThread]: Command end result
[0m13:42:59.643962 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:42:59.646360 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:42:59.650220 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:42:59.650911 [info ] [MainThread]: 
[0m13:42:59.651656 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:42:59.652246 [info ] [MainThread]: 
[0m13:42:59.652918 [error] [MainThread]: [31mFailure in model int_user_sessions (models/2.intermediate/int_user_sessions.sql)[0m
[0m13:42:59.653421 [error] [MainThread]:   Compilation Error in model int_user_sessions (models/2.intermediate/int_user_sessions.sql)
  'dict object' has no attribute 'datediff'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:42:59.653714 [info ] [MainThread]: 
[0m13:42:59.653968 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=6
[0m13:42:59.656248 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6052912, "process_in_blocks": "0", "process_kernel_time": 0.305025, "process_mem_max_rss": "126484480", "process_out_blocks": "0", "process_user_time": 1.878137}
[0m13:42:59.656769 [debug] [MainThread]: Command `dbt run` failed at 13:42:59.656627 after 1.61 seconds
[0m13:42:59.657988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107279790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075441a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107544ce0>]}
[0m13:42:59.658635 [debug] [MainThread]: Flushing usage events
[0m13:43:04.146150 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:15.592396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10623e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dfd790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dfd160>]}


============================== 13:44:15.599033 | 7fb5e192-2086-454b-9dbd-cd8152de9016 ==============================
[0m13:44:15.599033 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:44:15.600129 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '..', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir ..', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:44:15.740659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fb5e192-2086-454b-9dbd-cd8152de9016', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107623320>]}
[0m13:44:15.795095 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-4q9tf646'
[0m13:44:15.795792 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:44:15.895028 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:44:15.895938 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:44:15.953330 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:44:15.958892 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:44:16.196963 [info ] [MainThread]: Installed from version 1.3.0
[0m13:44:16.197468 [info ] [MainThread]: Up to date!
[0m13:44:16.197811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7fb5e192-2086-454b-9dbd-cd8152de9016', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e78260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb12e0>]}
[0m13:44:16.200380 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6780145, "process_in_blocks": "0", "process_kernel_time": 0.396116, "process_mem_max_rss": "108363776", "process_out_blocks": "0", "process_user_time": 1.384205}
[0m13:44:16.200865 [debug] [MainThread]: Command `dbt deps` succeeded at 13:44:16.200794 after 0.68 seconds
[0m13:44:16.201161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bc170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ecb380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ecb770>]}
[0m13:44:16.201717 [debug] [MainThread]: Flushing usage events
[0m13:44:16.596887 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:18.427643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051cb560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f5af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058f54c0>]}


============================== 13:44:18.430658 | 37f365c4-5536-4537-9c6f-b6449a5a95d4 ==============================
[0m13:44:18.430658 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:44:18.431458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --profiles-dir ..', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:44:18.637985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37f365c4-5536-4537-9c6f-b6449a5a95d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106629850>]}
[0m13:44:18.706891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37f365c4-5536-4537-9c6f-b6449a5a95d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046efaa0>]}
[0m13:44:18.709254 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:44:19.022623 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:44:19.146605 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:44:19.147727 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/2.intermediate/int_user_sessions.sql
[0m13:44:21.131223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37f365c4-5536-4537-9c6f-b6449a5a95d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e6bd10>]}
[0m13:44:21.232022 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:44:21.242897 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:44:21.325224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37f365c4-5536-4537-9c6f-b6449a5a95d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9c590>]}
[0m13:44:21.325764 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:44:21.326070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f365c4-5536-4537-9c6f-b6449a5a95d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb7140>]}
[0m13:44:21.333368 [info ] [MainThread]: 
[0m13:44:21.335939 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:44:21.336219 [info ] [MainThread]: 
[0m13:44:21.338425 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:44:21.369982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:44:21.531496 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:44:21.535081 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:44:21.535931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:21.677150 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.141 seconds
[0m13:44:21.679586 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:44:21.684473 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:44:21.696863 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:44:21.697456 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:44:21.697723 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:21.735681 [debug] [ThreadPool]: SQL status: BEGIN in 0.038 seconds
[0m13:44:21.736219 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:44:21.736853 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:44:21.742998 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m13:44:21.744168 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:44:21.744926 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:44:21.756319 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:21.756889 [debug] [MainThread]: On master: BEGIN
[0m13:44:21.757167 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:21.773113 [debug] [MainThread]: SQL status: BEGIN in 0.016 seconds
[0m13:44:21.773902 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:21.774928 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:44:21.786353 [debug] [MainThread]: SQL status: SELECT 4 in 0.011 seconds
[0m13:44:21.790366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37f365c4-5536-4537-9c6f-b6449a5a95d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cf4d10>]}
[0m13:44:21.790957 [debug] [MainThread]: On master: ROLLBACK
[0m13:44:21.793158 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:21.794482 [debug] [MainThread]: On master: BEGIN
[0m13:44:21.816782 [debug] [MainThread]: SQL status: BEGIN in 0.021 seconds
[0m13:44:21.821140 [debug] [MainThread]: On master: COMMIT
[0m13:44:21.821757 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:21.822051 [debug] [MainThread]: On master: COMMIT
[0m13:44:21.823891 [debug] [MainThread]: SQL status: COMMIT in 0.002 seconds
[0m13:44:21.826160 [debug] [MainThread]: On master: Close
[0m13:44:21.835928 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m13:44:21.836653 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m13:44:21.838448 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m13:44:21.841522 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m13:44:21.843429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m13:44:21.845357 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m13:44:21.846711 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m13:44:21.851401 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m13:44:21.854273 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m13:44:21.855820 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m13:44:21.942679 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:44:21.943988 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m13:44:21.945228 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:44:21.961945 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:44:21.964044 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m13:44:21.965211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:21.977545 [debug] [Thread-2 (]: SQL status: BEGIN in 0.032 seconds
[0m13:44:21.978257 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:44:21.978621 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m13:44:21.988882 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.009 seconds
[0m13:44:21.989879 [debug] [Thread-1 (]: SQL status: BEGIN in 0.025 seconds
[0m13:44:22.018891 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:44:22.109491 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m13:44:22.129971 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:44:22.130423 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m13:44:22.133938 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.003 seconds
[0m13:44:22.139333 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m13:44:22.139826 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.011 seconds
[0m13:44:22.175850 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:44:22.187477 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:44:22.188310 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:44:22.189063 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m13:44:22.189845 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:44:22.194106 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.004 seconds
[0m13:44:22.194776 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m13:44:22.196351 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:44:22.196691 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m13:44:22.197046 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:44:22.198622 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m13:44:22.198922 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:44:22.200416 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f365c4-5536-4537-9c6f-b6449a5a95d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471ca10>]}
[0m13:44:22.200843 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.35s]
[0m13:44:22.201295 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m13:44:22.202335 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:44:22.202801 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m13:44:22.203160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37f365c4-5536-4537-9c6f-b6449a5a95d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac20c0>]}
[0m13:44:22.203506 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.36s]
[0m13:44:22.203862 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m13:44:22.205119 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:22.205411 [debug] [MainThread]: On master: BEGIN
[0m13:44:22.205648 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:22.217244 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m13:44:22.217673 [debug] [MainThread]: On master: COMMIT
[0m13:44:22.217918 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:22.218130 [debug] [MainThread]: On master: COMMIT
[0m13:44:22.219132 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:44:22.219367 [debug] [MainThread]: On master: Close
[0m13:44:22.219686 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:22.219894 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m13:44:22.220088 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m13:44:22.220325 [info ] [MainThread]: 
[0m13:44:22.220573 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m13:44:22.221378 [debug] [MainThread]: Command end result
[0m13:44:22.249055 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:44:22.250775 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:44:22.257433 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:44:22.257821 [info ] [MainThread]: 
[0m13:44:22.258188 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:44:22.258436 [info ] [MainThread]: 
[0m13:44:22.258766 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:44:22.262930 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 3.8825798, "process_in_blocks": "0", "process_kernel_time": 0.388315, "process_mem_max_rss": "126959616", "process_out_blocks": "0", "process_user_time": 2.104708}
[0m13:44:22.267832 [debug] [MainThread]: Command `dbt seed` succeeded at 13:44:22.267428 after 3.89 seconds
[0m13:44:22.269968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a5cd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bca270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bc81d0>]}
[0m13:44:22.272144 [debug] [MainThread]: Flushing usage events
[0m13:44:22.632996 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:27.950206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058692e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f5520>]}


============================== 13:44:27.952964 | 0cfca06c-994f-4e76-bcd3-58abe1944c72 ==============================
[0m13:44:27.952964 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:44:27.953359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m13:44:28.287824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0cfca06c-994f-4e76-bcd3-58abe1944c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d59d0>]}
[0m13:44:28.320205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0cfca06c-994f-4e76-bcd3-58abe1944c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a43e0>]}
[0m13:44:28.321141 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:44:28.386859 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:44:28.483403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:28.483791 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:28.517554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0cfca06c-994f-4e76-bcd3-58abe1944c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f05f0>]}
[0m13:44:28.573991 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:44:28.576609 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:44:28.593174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0cfca06c-994f-4e76-bcd3-58abe1944c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10712d6d0>]}
[0m13:44:28.593669 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:44:28.593961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cfca06c-994f-4e76-bcd3-58abe1944c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065e38c0>]}
[0m13:44:28.595335 [info ] [MainThread]: 
[0m13:44:28.595659 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:44:28.595899 [info ] [MainThread]: 
[0m13:44:28.596260 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:44:28.598611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:44:28.634071 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:44:28.634510 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:44:28.634754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:28.681044 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.046 seconds
[0m13:44:28.682157 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:44:28.683297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:44:28.686741 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:44:28.686969 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:44:28.687148 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:44:28.694496 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:44:28.694852 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:44:28.695088 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:44:28.698390 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.003 seconds
[0m13:44:28.699191 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:44:28.699607 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:44:28.702661 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:28.702876 [debug] [MainThread]: On master: BEGIN
[0m13:44:28.703049 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:28.718484 [debug] [MainThread]: SQL status: BEGIN in 0.015 seconds
[0m13:44:28.718824 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:28.719086 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:44:28.728879 [debug] [MainThread]: SQL status: SELECT 4 in 0.009 seconds
[0m13:44:28.730167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0cfca06c-994f-4e76-bcd3-58abe1944c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717d340>]}
[0m13:44:28.730498 [debug] [MainThread]: On master: ROLLBACK
[0m13:44:28.731424 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:28.731698 [debug] [MainThread]: On master: BEGIN
[0m13:44:28.732379 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:44:28.732582 [debug] [MainThread]: On master: COMMIT
[0m13:44:28.732779 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:28.732958 [debug] [MainThread]: On master: COMMIT
[0m13:44:28.733566 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:44:28.733778 [debug] [MainThread]: On master: Close
[0m13:44:28.735866 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m13:44:28.736114 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m13:44:28.736359 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_users
[0m13:44:28.736704 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_episodes ................................ [RUN]
[0m13:44:28.737153 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_user_events ............................. [RUN]
[0m13:44:28.737490 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_users ................................... [RUN]
[0m13:44:28.737881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m13:44:28.738183 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m13:44:28.738452 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m13:44:28.738675 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m13:44:28.738934 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m13:44:28.739152 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_users
[0m13:44:28.745007 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m13:44:28.753701 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m13:44:28.755196 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m13:44:28.755839 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m13:44:28.756130 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m13:44:28.772073 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_users
[0m13:44:28.830315 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m13:44:28.832071 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m13:44:28.832735 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m13:44:28.833801 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:44:28.834138 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:44:28.834517 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:44:28.834793 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m13:44:28.835055 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: BEGIN
[0m13:44:28.835415 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m13:44:28.835664 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:44:28.835897 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:44:28.836125 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:28.847828 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:44:28.848313 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:44:28.848691 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m13:44:28.849033 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m13:44:28.849343 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m13:44:28.849592 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:44:28.849821 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:44:28.850063 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m13:44:28.850336 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

filtered as (
    select * from source
    where data ->> 'type' in ('play', 'pause', 'seek', 'complete')
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'ts' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        (data ->> 'ts')::timestamp as event_ts,
        data ->> 'type'         as event_type,
        (data ->> 'duration')::integer as duration
    from filtered
)
select * from typed
  );
[0m13:44:28.852481 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:44:28.858538 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:44:28.859071 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m13:44:28.859354 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:44:28.859659 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m13:44:28.862405 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:44:28.864493 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:44:28.864822 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m13:44:28.865114 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m13:44:28.865627 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:28.867217 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:44:28.867455 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:44:28.867656 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:44:28.867880 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m13:44:28.869708 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:44:28.871407 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:44:28.871809 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:44:28.872196 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m13:44:28.873693 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:44:28.880886 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m13:44:28.885224 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m13:44:28.885509 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.012 seconds
[0m13:44:28.886624 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: COMMIT
[0m13:44:28.886927 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:44:28.887841 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m13:44:28.888081 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:44:28.888337 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m13:44:28.888616 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:44:28.888912 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: COMMIT
[0m13:44:28.889181 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m13:44:28.890705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:44:28.891372 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m13:44:28.891985 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m13:44:28.898279 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m13:44:28.900565 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m13:44:28.902814 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m13:44:28.905906 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:44:28.906476 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:44:28.907064 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:44:28.907884 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m13:44:28.908359 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m13:44:28.908874 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m13:44:28.912047 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:44:28.912392 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:44:28.912626 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:44:28.914266 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: Close
[0m13:44:28.915050 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m13:44:28.915726 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m13:44:28.917433 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfca06c-994f-4e76-bcd3-58abe1944c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d09b0>]}
[0m13:44:28.917888 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfca06c-994f-4e76-bcd3-58abe1944c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10768f9e0>]}
[0m13:44:28.918392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfca06c-994f-4e76-bcd3-58abe1944c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069fd010>]}
[0m13:44:28.919231 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.18s]
[0m13:44:28.919704 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.18s]
[0m13:44:28.920066 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.18s]
[0m13:44:28.920466 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_users
[0m13:44:28.920812 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m13:44:28.921132 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m13:44:28.921589 [debug] [Thread-4 (]: Began running node model.podcast_analytics.int_user_sessions
[0m13:44:28.921824 [debug] [Thread-3 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m13:44:28.922155 [info ] [Thread-4 (]: 4 of 6 START sql view model public.int_user_sessions ........................... [RUN]
[0m13:44:28.922492 [info ] [Thread-3 (]: 5 of 6 START sql view model public.mart_top_episodes ........................... [RUN]
[0m13:44:28.922877 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.int_user_sessions'
[0m13:44:28.923572 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_users, now model.podcast_analytics.mart_top_episodes)
[0m13:44:28.924246 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m13:44:28.924778 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m13:44:28.928814 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m13:44:28.932090 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m13:44:28.933011 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m13:44:28.933259 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m13:44:28.935435 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m13:44:28.937376 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m13:44:28.937992 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:44:28.938274 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:44:28.938519 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m13:44:28.938758 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m13:44:28.939005 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:44:28.939313 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:44:28.949840 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m13:44:28.950275 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m13:44:28.950599 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:44:28.950849 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:44:28.951113 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m13:44:28.951430 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end
    from numbered
    group by user_id, session_number
),

final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        extract(epoch from (session_end - session_start)) as session_duration
    from agg
)

select * from final
  );
[0m13:44:28.954235 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:44:28.956696 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:44:28.957008 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m13:44:28.958683 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:44:28.959158 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:44:28.961418 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:44:28.963334 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m13:44:28.963661 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m13:44:28.963975 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:44:28.964301 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m13:44:28.965431 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:28.966392 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m13:44:28.966647 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m13:44:28.966894 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:44:28.968460 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m13:44:28.968709 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m13:44:28.969222 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:44:28.969495 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m13:44:28.970137 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:44:28.970371 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m13:44:28.971139 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m13:44:28.974166 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m13:44:28.975417 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:44:28.976153 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfca06c-994f-4e76-bcd3-58abe1944c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107826240>]}
[0m13:44:28.976659 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m13:44:28.977283 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m13:44:28.977868 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m13:44:28.978344 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:44:28.979124 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: Close
[0m13:44:28.979446 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfca06c-994f-4e76-bcd3-58abe1944c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107826090>]}
[0m13:44:28.979809 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.int_user_sessions ...................... [[32mCREATE VIEW[0m in 0.06s]
[0m13:44:28.980302 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m13:44:28.980759 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m13:44:28.981166 [info ] [Thread-1 (]: 6 of 6 START sql view model public.mart_user_session_metrics ................... [RUN]
[0m13:44:28.981448 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.mart_user_session_metrics)
[0m13:44:28.981685 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m13:44:29.042549 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m13:44:29.044030 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m13:44:29.046324 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m13:44:29.046890 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:44:29.047130 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m13:44:29.047339 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:29.059344 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m13:44:29.059723 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:44:29.059979 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  create view "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
    
    
  as (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
[0m13:44:29.063593 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:44:29.065648 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:44:29.065939 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m13:44:29.067069 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:44:29.068012 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m13:44:29.068535 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:44:29.068777 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m13:44:29.070121 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:44:29.071503 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m13:44:29.072013 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:44:29.072260 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop view if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m13:44:29.073077 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:44:29.074233 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m13:44:29.074816 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0cfca06c-994f-4e76-bcd3-58abe1944c72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107790860>]}
[0m13:44:29.075675 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.mart_user_session_metrics .............. [[32mCREATE VIEW[0m in 0.09s]
[0m13:44:29.076189 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m13:44:29.077200 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:29.077793 [debug] [MainThread]: On master: BEGIN
[0m13:44:29.078250 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:29.086651 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:44:29.086997 [debug] [MainThread]: On master: COMMIT
[0m13:44:29.087221 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:29.087414 [debug] [MainThread]: On master: COMMIT
[0m13:44:29.087898 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:44:29.088144 [debug] [MainThread]: On master: Close
[0m13:44:29.088545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:29.088736 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m13:44:29.088909 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_user_events' was properly closed.
[0m13:44:29.089074 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m13:44:29.089235 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m13:44:29.089491 [info ] [MainThread]: 
[0m13:44:29.089796 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.49 seconds (0.49s).
[0m13:44:29.090929 [debug] [MainThread]: Command end result
[0m13:44:29.109048 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:44:29.111375 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:44:29.115029 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:44:29.115266 [info ] [MainThread]: 
[0m13:44:29.115553 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:44:29.115794 [info ] [MainThread]: 
[0m13:44:29.116019 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m13:44:29.118153 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2080573, "process_in_blocks": "0", "process_kernel_time": 0.349853, "process_mem_max_rss": "127762432", "process_out_blocks": "0", "process_user_time": 1.971334}
[0m13:44:29.118458 [debug] [MainThread]: Command `dbt run` succeeded at 13:44:29.118410 after 1.21 seconds
[0m13:44:29.118715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105505430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107749b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774a6f0>]}
[0m13:44:29.118980 [debug] [MainThread]: Flushing usage events
[0m13:44:29.562048 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:44:33.481488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c92270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143eda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143ed340>]}


============================== 13:44:33.487433 | 2e0d0474-47a6-486c-a67d-785085a7e12a ==============================
[0m13:44:33.487433 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:44:33.488768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m13:44:34.541736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e0d0474-47a6-486c-a67d-785085a7e12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114993ef0>]}
[0m13:44:35.001174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e0d0474-47a6-486c-a67d-785085a7e12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144d09e0>]}
[0m13:44:35.003999 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:44:35.541042 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:44:35.641477 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:35.642070 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:35.674772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e0d0474-47a6-486c-a67d-785085a7e12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149a4470>]}
[0m13:44:35.732248 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:44:35.734382 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:44:35.756282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e0d0474-47a6-486c-a67d-785085a7e12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11581aed0>]}
[0m13:44:35.756733 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:44:35.756998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e0d0474-47a6-486c-a67d-785085a7e12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156f4ef0>]}
[0m13:44:35.758313 [info ] [MainThread]: 
[0m13:44:35.758618 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:44:35.758873 [info ] [MainThread]: 
[0m13:44:35.759226 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:44:35.761902 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m13:44:35.806018 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:44:35.806438 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:44:35.806674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:35.856850 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m13:44:35.857352 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:44:35.857628 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:44:35.872005 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.014 seconds
[0m13:44:35.873202 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:44:35.873822 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:44:35.880128 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:35.880820 [debug] [MainThread]: On master: BEGIN
[0m13:44:35.881058 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:35.889633 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:44:35.890075 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:35.890375 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:44:35.900964 [debug] [MainThread]: SQL status: SELECT 6 in 0.010 seconds
[0m13:44:35.903838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e0d0474-47a6-486c-a67d-785085a7e12a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144d1580>]}
[0m13:44:35.904366 [debug] [MainThread]: On master: ROLLBACK
[0m13:44:35.905236 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:35.905483 [debug] [MainThread]: On master: BEGIN
[0m13:44:35.906561 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:44:35.906791 [debug] [MainThread]: On master: COMMIT
[0m13:44:35.906998 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:35.907193 [debug] [MainThread]: On master: COMMIT
[0m13:44:35.907648 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:44:35.907884 [debug] [MainThread]: On master: Close
[0m13:44:35.910253 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m13:44:35.911611 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m13:44:35.913764 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m13:44:35.913187 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m13:44:35.914196 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m13:44:35.914547 [info ] [Thread-2 (]: 2 of 7 START test not_null_stg_episodes_episode_id ............................. [RUN]
[0m13:44:35.914839 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_user_events_event_id ............................ [RUN]
[0m13:44:35.915232 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m13:44:35.915782 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422'
[0m13:44:35.915498 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_users_user_id ................................... [RUN]
[0m13:44:35.916137 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7'
[0m13:44:35.916384 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m13:44:35.916628 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m13:44:35.916922 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77'
[0m13:44:35.917152 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m13:44:35.930762 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m13:44:35.936091 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m13:44:35.936429 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m13:44:35.939863 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m13:44:35.942210 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m13:44:35.942907 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m13:44:35.943143 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m13:44:35.943404 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m13:44:35.954895 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m13:44:35.955271 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m13:44:35.956941 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m13:44:35.958383 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m13:44:35.960002 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m13:44:35.961132 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m13:44:35.961498 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m13:44:35.961804 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m13:44:35.962073 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:44:35.962352 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m13:44:35.962633 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m13:44:35.962878 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m13:44:35.963229 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m13:44:35.963457 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:44:35.963696 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m13:44:35.964183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:35.964691 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:44:35.989602 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m13:44:35.990636 [debug] [Thread-1 (]: SQL status: BEGIN in 0.026 seconds
[0m13:44:35.991020 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m13:44:35.991366 [debug] [Thread-3 (]: SQL status: BEGIN in 0.029 seconds
[0m13:44:35.991781 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m13:44:35.992266 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m13:44:35.992550 [debug] [Thread-4 (]: SQL status: BEGIN in 0.028 seconds
[0m13:44:35.993966 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m13:44:35.995127 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m13:44:35.995744 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m13:44:35.996143 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m13:44:35.996696 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m13:44:36.000330 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:44:36.005058 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m13:44:36.005543 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.007 seconds
[0m13:44:36.007586 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m13:44:36.008150 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m13:44:36.009452 [info ] [Thread-2 (]: 2 of 7 PASS not_null_stg_episodes_episode_id ................................... [[32mPASS[0m in 0.09s]
[0m13:44:36.011459 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m13:44:36.012774 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m13:44:36.013297 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m13:44:36.016648 [info ] [Thread-4 (]: 4 of 7 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.10s]
[0m13:44:36.013761 [info ] [Thread-2 (]: 5 of 7 START test unique_stg_episodes_episode_id ............................... [RUN]
[0m13:44:36.018639 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m13:44:36.021162 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m13:44:36.022546 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m13:44:36.023277 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m13:44:36.024651 [info ] [Thread-4 (]: 6 of 7 START test unique_stg_user_events_event_id .............................. [RUN]
[0m13:44:36.033052 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.035 seconds
[0m13:44:36.035010 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.037 seconds
[0m13:44:36.040979 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m13:44:36.041439 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m13:44:36.042478 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m13:44:36.043659 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m13:44:36.046112 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m13:44:36.047009 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m13:44:36.051524 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m13:44:36.052002 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m13:44:36.052286 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m13:44:36.053855 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m13:44:36.054449 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.14s]
[0m13:44:36.054955 [info ] [Thread-3 (]: 3 of 7 PASS not_null_stg_user_events_event_id .................................. [[32mPASS[0m in 0.14s]
[0m13:44:36.056610 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m13:44:36.057751 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m13:44:36.058736 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m13:44:36.059342 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m13:44:36.064528 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m13:44:36.064973 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m13:44:36.065347 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: BEGIN
[0m13:44:36.065926 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_users_user_id ..................................... [RUN]
[0m13:44:36.066281 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:44:36.066691 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m13:44:36.067112 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m13:44:36.067436 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m13:44:36.067682 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: BEGIN
[0m13:44:36.070498 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m13:44:36.070816 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:44:36.072409 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m13:44:36.084526 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m13:44:36.088850 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m13:44:36.090636 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m13:44:36.091209 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m13:44:36.091681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:36.092168 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m13:44:36.093079 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:44:36.096406 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:44:36.098822 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: ROLLBACK
[0m13:44:36.102478 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: Close
[0m13:44:36.103443 [debug] [Thread-4 (]: SQL status: BEGIN in 0.033 seconds
[0m13:44:36.104408 [info ] [Thread-2 (]: 5 of 7 PASS unique_stg_episodes_episode_id ..................................... [[32mPASS[0m in 0.08s]
[0m13:44:36.105798 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m13:44:36.107650 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m13:44:36.108399 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_user_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:44:36.110189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:44:36.111095 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m13:44:36.111846 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:44:36.115862 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.006 seconds
[0m13:44:36.117480 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:44:36.120441 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: ROLLBACK
[0m13:44:36.126768 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m13:44:36.277636 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: Close
[0m13:44:36.236591 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m13:44:36.308906 [info ] [Thread-4 (]: 6 of 7 PASS unique_stg_user_events_event_id .................................... [[32mPASS[0m in 0.27s]
[0m13:44:36.310415 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m13:44:36.311665 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.24s]
[0m13:44:36.312675 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m13:44:36.313889 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:36.314185 [debug] [MainThread]: On master: BEGIN
[0m13:44:36.314413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:44:36.324303 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:44:36.324792 [debug] [MainThread]: On master: COMMIT
[0m13:44:36.325223 [debug] [MainThread]: Using postgres connection "master"
[0m13:44:36.325478 [debug] [MainThread]: On master: COMMIT
[0m13:44:36.329208 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m13:44:36.329868 [debug] [MainThread]: On master: Close
[0m13:44:36.331196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:36.331461 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m13:44:36.333028 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16' was properly closed.
[0m13:44:36.333730 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7' was properly closed.
[0m13:44:36.334253 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m13:44:36.334690 [info ] [MainThread]: 
[0m13:44:36.335105 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m13:44:36.336105 [debug] [MainThread]: Command end result
[0m13:44:36.354577 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:44:36.358346 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:44:36.374809 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:44:36.375336 [info ] [MainThread]: 
[0m13:44:36.375642 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:44:36.376101 [info ] [MainThread]: 
[0m13:44:36.378884 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m13:44:36.389253 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 3.2377276, "process_in_blocks": "0", "process_kernel_time": 0.381397, "process_mem_max_rss": "105857024", "process_out_blocks": "0", "process_user_time": 1.942276}
[0m13:44:36.390666 [debug] [MainThread]: Command `dbt test` succeeded at 13:44:36.390595 after 3.24 seconds
[0m13:44:36.391804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1143ed760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10489f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c23d70>]}
[0m13:44:36.394390 [debug] [MainThread]: Flushing usage events
[0m13:44:36.766280 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:42.283239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bb3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071dda30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071dd2e0>]}


============================== 13:51:42.285987 | 5179b367-e9c2-4253-94a6-3ab7c1089a60 ==============================
[0m13:51:42.285987 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:51:42.286392 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m13:51:42.370641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5179b367-e9c2-4253-94a6-3ab7c1089a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106514aa0>]}
[0m13:51:42.393782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5179b367-e9c2-4253-94a6-3ab7c1089a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107272f90>]}
[0m13:51:42.394479 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:51:42.443846 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:51:42.516773 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:51:42.517028 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:51:42.539930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5179b367-e9c2-4253-94a6-3ab7c1089a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cfd010>]}
[0m13:51:42.579187 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:51:42.580808 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:51:42.592966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5179b367-e9c2-4253-94a6-3ab7c1089a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10774c2f0>]}
[0m13:51:42.593252 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:51:42.593435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5179b367-e9c2-4253-94a6-3ab7c1089a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10768f8c0>]}
[0m13:51:42.594234 [info ] [MainThread]: 
[0m13:51:42.594416 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:51:42.594560 [info ] [MainThread]: 
[0m13:51:42.594794 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:51:42.596291 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:51:42.622412 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:51:42.622685 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:51:42.622956 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:42.641266 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.018 seconds
[0m13:51:42.641949 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:51:42.642670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:51:42.645157 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:51:42.645327 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:51:42.645467 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:42.652973 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m13:51:42.653132 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:51:42.653379 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:51:42.657666 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m13:51:42.658297 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:51:42.658788 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:51:42.661360 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:42.661555 [debug] [MainThread]: On master: BEGIN
[0m13:51:42.661700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:51:42.670291 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:51:42.670471 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:42.670673 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:51:42.676782 [debug] [MainThread]: SQL status: SELECT 6 in 0.006 seconds
[0m13:51:42.677721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5179b367-e9c2-4253-94a6-3ab7c1089a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba8f50>]}
[0m13:51:42.677935 [debug] [MainThread]: On master: ROLLBACK
[0m13:51:42.678437 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:42.678577 [debug] [MainThread]: On master: BEGIN
[0m13:51:42.679304 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:51:42.679443 [debug] [MainThread]: On master: COMMIT
[0m13:51:42.679575 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:42.679706 [debug] [MainThread]: On master: COMMIT
[0m13:51:42.680156 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:51:42.680295 [debug] [MainThread]: On master: Close
[0m13:51:42.681788 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m13:51:42.681971 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m13:51:42.682217 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m13:51:42.682446 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m13:51:42.682658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m13:51:42.682881 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m13:51:42.683058 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m13:51:42.683224 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m13:51:42.683395 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m13:51:42.683561 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m13:51:42.695986 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:51:42.697160 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m13:51:42.698678 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:51:42.698845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:42.699020 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m13:51:42.699256 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:51:42.707787 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m13:51:42.708112 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m13:51:42.708309 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:51:42.708565 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:51:42.708762 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m13:51:42.708942 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m13:51:42.712598 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m13:51:42.712789 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m13:51:42.756496 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:51:42.767682 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:51:42.767954 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m13:51:42.768161 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m13:51:42.774254 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.006 seconds
[0m13:51:42.774582 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.006 seconds
[0m13:51:42.777013 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m13:51:42.777347 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m13:51:42.793138 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:51:42.793688 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:51:42.795335 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:51:42.795594 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:51:42.795791 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:51:42.796031 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:51:42.803899 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m13:51:42.827568 [debug] [Thread-1 (]: SQL status: COMMIT in 0.008 seconds
[0m13:51:42.828489 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m13:51:42.828831 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m13:51:42.830296 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5179b367-e9c2-4253-94a6-3ab7c1089a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e53380>]}
[0m13:51:42.830484 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5179b367-e9c2-4253-94a6-3ab7c1089a60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064b8b90>]}
[0m13:51:42.830744 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.15s]
[0m13:51:42.831056 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.15s]
[0m13:51:42.831347 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m13:51:42.831575 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m13:51:42.832190 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:42.832347 [debug] [MainThread]: On master: BEGIN
[0m13:51:42.832484 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:51:42.840293 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:51:42.840629 [debug] [MainThread]: On master: COMMIT
[0m13:51:42.840814 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:42.840962 [debug] [MainThread]: On master: COMMIT
[0m13:51:42.841433 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:51:42.841589 [debug] [MainThread]: On master: Close
[0m13:51:42.841820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:42.841956 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m13:51:42.842084 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m13:51:42.842247 [info ] [MainThread]: 
[0m13:51:42.842410 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m13:51:42.842767 [debug] [MainThread]: Command end result
[0m13:51:42.853910 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:51:42.854871 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:51:42.857957 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:51:42.858167 [info ] [MainThread]: 
[0m13:51:42.858357 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:51:42.858504 [info ] [MainThread]: 
[0m13:51:42.858660 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:51:42.860274 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.61052257, "process_in_blocks": "0", "process_kernel_time": 0.145376, "process_mem_max_rss": "130711552", "process_out_blocks": "0", "process_user_time": 0.990535}
[0m13:51:42.860513 [debug] [MainThread]: Command `dbt seed` succeeded at 13:51:42.860477 after 0.61 seconds
[0m13:51:42.860699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106738170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df6e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e5340>]}
[0m13:51:42.860877 [debug] [MainThread]: Flushing usage events
[0m13:51:43.243363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:44.150864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671a8d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc5070>]}


============================== 13:51:44.152811 | d3f3a999-2d7b-4cb9-ab55-5b5cf7cc338f ==============================
[0m13:51:44.152811 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:51:44.153127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'profiles_dir': '..', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir ..', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:51:44.201698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3f3a999-2d7b-4cb9-ab55-5b5cf7cc338f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e63800>]}
[0m13:51:44.228042 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-lxk85_l0'
[0m13:51:44.228369 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:51:44.318968 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:51:44.319552 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:51:44.370611 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:51:44.372529 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:51:44.591383 [info ] [MainThread]: Installed from version 1.3.0
[0m13:51:44.591667 [info ] [MainThread]: Up to date!
[0m13:51:44.591882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd3f3a999-2d7b-4cb9-ab55-5b5cf7cc338f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e32240>]}
[0m13:51:44.593562 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.47038576, "process_in_blocks": "0", "process_kernel_time": 0.107889, "process_mem_max_rss": "112066560", "process_out_blocks": "0", "process_user_time": 0.6566}
[0m13:51:44.593879 [debug] [MainThread]: Command `dbt deps` succeeded at 13:51:44.593826 after 0.47 seconds
[0m13:51:44.594081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c916a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026ab290>]}
[0m13:51:44.594264 [debug] [MainThread]: Flushing usage events
[0m13:51:44.936106 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:45.706341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042e1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104911c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049114c0>]}


============================== 13:51:45.708427 | df4b238a-6e96-4d4b-84b8-f5c378447571 ==============================
[0m13:51:45.708427 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:51:45.708739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'profiles_dir': '..', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir ..', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:51:45.780788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df4b238a-6e96-4d4b-84b8-f5c378447571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c40aa0>]}
[0m13:51:45.804708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df4b238a-6e96-4d4b-84b8-f5c378447571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102430b90>]}
[0m13:51:45.805334 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:51:45.850996 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:51:45.909823 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:51:45.910092 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:51:45.933379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df4b238a-6e96-4d4b-84b8-f5c378447571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105529c10>]}
[0m13:51:45.970323 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:51:45.971277 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:51:45.977626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df4b238a-6e96-4d4b-84b8-f5c378447571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055283e0>]}
[0m13:51:45.977904 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:51:45.978090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df4b238a-6e96-4d4b-84b8-f5c378447571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579aa50>]}
[0m13:51:45.978944 [info ] [MainThread]: 
[0m13:51:45.979132 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:51:45.979281 [info ] [MainThread]: 
[0m13:51:45.979523 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:51:45.981165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:51:46.003628 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:51:46.003890 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:51:46.004048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:46.023156 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.019 seconds
[0m13:51:46.023932 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:51:46.024679 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:51:46.027422 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:51:46.027690 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:51:46.027846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:51:46.036310 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m13:51:46.036460 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:51:46.036620 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:51:46.040076 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m13:51:46.040646 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:51:46.041138 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:51:46.043376 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:46.043526 [debug] [MainThread]: On master: BEGIN
[0m13:51:46.043657 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:51:46.050340 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:51:46.050506 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:46.050701 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:51:46.055408 [debug] [MainThread]: SQL status: SELECT 6 in 0.004 seconds
[0m13:51:46.056491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df4b238a-6e96-4d4b-84b8-f5c378447571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c77bf0>]}
[0m13:51:46.056727 [debug] [MainThread]: On master: ROLLBACK
[0m13:51:46.057265 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:46.057410 [debug] [MainThread]: On master: BEGIN
[0m13:51:46.058564 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:51:46.058707 [debug] [MainThread]: On master: COMMIT
[0m13:51:46.058844 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:46.058978 [debug] [MainThread]: On master: COMMIT
[0m13:51:46.059373 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:51:46.059514 [debug] [MainThread]: On master: Close
[0m13:51:46.060601 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m13:51:46.060805 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m13:51:46.061208 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_users
[0m13:51:46.061064 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_episodes ................................ [RUN]
[0m13:51:46.061491 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_user_events ............................. [RUN]
[0m13:51:46.061714 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_users ................................... [RUN]
[0m13:51:46.061925 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m13:51:46.062142 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m13:51:46.062335 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m13:51:46.062500 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m13:51:46.062660 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m13:51:46.062812 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_users
[0m13:51:46.065806 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m13:51:46.072308 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m13:51:46.073591 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m13:51:46.074614 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m13:51:46.074864 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_users
[0m13:51:46.075051 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m13:51:46.089630 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m13:51:46.092208 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m13:51:46.093749 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m13:51:46.094370 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:51:46.094616 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:51:46.094806 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m13:51:46.094982 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:51:46.095151 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: BEGIN
[0m13:51:46.095324 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:51:46.095496 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m13:51:46.095656 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:51:46.095880 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:46.105583 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m13:51:46.105782 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m13:51:46.105997 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:51:46.106179 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:51:46.106384 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m13:51:46.106596 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:51:46.106791 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

filtered as (
    select * from source
    where data ->> 'type' in ('play', 'pause', 'seek', 'complete')
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'ts' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        (data ->> 'ts')::timestamp as event_ts,
        data ->> 'type'         as event_type,
        (data ->> 'duration')::integer as duration
    from filtered
)
select * from typed
  );
[0m13:51:46.107019 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:51:46.107227 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m13:51:46.109310 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:51:46.109466 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:51:46.109616 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m13:51:46.112384 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:51:46.113637 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:51:46.114841 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:51:46.115021 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m13:51:46.115196 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m13:51:46.115371 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m13:51:46.116602 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:46.116777 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:46.117921 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:51:46.118077 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m13:51:46.119158 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:51:46.119341 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m13:51:46.120380 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:51:46.120553 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m13:51:46.120745 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:51:46.121689 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:46.128191 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m13:51:46.128382 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m13:51:46.129101 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: COMMIT
[0m13:51:46.129270 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m13:51:46.129927 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m13:51:46.130103 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:51:46.130265 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:51:46.130423 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:51:46.130578 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: COMMIT
[0m13:51:46.130732 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m13:51:46.130885 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m13:51:46.133592 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m13:51:46.135918 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m13:51:46.136110 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m13:51:46.138032 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:51:46.138213 [debug] [Thread-1 (]: SQL status: COMMIT in 0.007 seconds
[0m13:51:46.139840 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m13:51:46.140016 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m13:51:46.140846 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m13:51:46.141201 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:51:46.141586 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:51:46.141770 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m13:51:46.141944 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m13:51:46.144367 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:51:46.145325 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: Close
[0m13:51:46.145496 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:51:46.146028 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m13:51:46.146446 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m13:51:46.147313 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m13:51:46.147649 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df4b238a-6e96-4d4b-84b8-f5c378447571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10235e510>]}
[0m13:51:46.147817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df4b238a-6e96-4d4b-84b8-f5c378447571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8dd90>]}
[0m13:51:46.148467 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df4b238a-6e96-4d4b-84b8-f5c378447571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c9bc20>]}
[0m13:51:46.148099 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.08s]
[0m13:51:46.148343 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m13:51:46.149077 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_users
[0m13:51:46.148792 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m13:51:46.149360 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m13:51:46.149638 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m13:51:46.149992 [debug] [Thread-4 (]: Began running node model.podcast_analytics.int_user_sessions
[0m13:51:46.150169 [debug] [Thread-3 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m13:51:46.150375 [info ] [Thread-4 (]: 4 of 6 START sql view model public.int_user_sessions ........................... [RUN]
[0m13:51:46.150589 [info ] [Thread-3 (]: 5 of 6 START sql view model public.mart_top_episodes ........................... [RUN]
[0m13:51:46.150842 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.int_user_sessions'
[0m13:51:46.151016 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_users, now model.podcast_analytics.mart_top_episodes)
[0m13:51:46.151188 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m13:51:46.151347 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m13:51:46.153062 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m13:51:46.155726 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m13:51:46.156447 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m13:51:46.156643 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m13:51:46.158223 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m13:51:46.160161 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m13:51:46.160793 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:51:46.160989 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:51:46.161179 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m13:51:46.161346 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m13:51:46.161516 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:51:46.161700 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:51:46.170599 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m13:51:46.170778 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:51:46.170953 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m13:51:46.171160 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end
    from numbered
    group by user_id, session_number
),

final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        extract(epoch from (session_end - session_start)) as session_duration
    from agg
)

select * from final
  );
[0m13:51:46.171377 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:51:46.171833 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m13:51:46.175636 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m13:51:46.177009 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:51:46.177194 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:51:46.177370 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m13:51:46.178586 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:51:46.178795 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m13:51:46.179484 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:46.180106 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m13:51:46.180284 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:46.180446 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:51:46.181037 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m13:51:46.181207 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m13:51:46.181371 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:51:46.181552 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m13:51:46.182738 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m13:51:46.183588 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m13:51:46.183934 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:51:46.184095 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m13:51:46.184252 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m13:51:46.185766 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m13:51:46.186148 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:51:46.186316 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m13:51:46.186854 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:51:46.187343 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m13:51:46.187510 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:51:46.187972 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: Close
[0m13:51:46.188265 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df4b238a-6e96-4d4b-84b8-f5c378447571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf5190>]}
[0m13:51:46.188567 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df4b238a-6e96-4d4b-84b8-f5c378447571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf5f70>]}
[0m13:51:46.188937 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.int_user_sessions ...................... [[32mCREATE VIEW[0m in 0.04s]
[0m13:51:46.189140 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.04s]
[0m13:51:46.189484 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m13:51:46.189704 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m13:51:46.190066 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m13:51:46.190302 [info ] [Thread-2 (]: 6 of 6 START sql view model public.mart_user_session_metrics ................... [RUN]
[0m13:51:46.190503 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now model.podcast_analytics.mart_user_session_metrics)
[0m13:51:46.190669 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m13:51:46.220577 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m13:51:46.221231 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m13:51:46.223065 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m13:51:46.223583 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:51:46.223806 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m13:51:46.224010 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:51:46.232180 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m13:51:46.232357 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:51:46.232539 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  create view "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
    
    
  as (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
[0m13:51:46.235486 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:51:46.236763 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:51:46.236948 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m13:51:46.237798 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:51:46.238512 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m13:51:46.238691 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:51:46.238854 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m13:51:46.240008 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m13:51:46.240901 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m13:51:46.241295 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:51:46.241465 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop view if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m13:51:46.242086 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m13:51:46.242594 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m13:51:46.242845 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df4b238a-6e96-4d4b-84b8-f5c378447571', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf5520>]}
[0m13:51:46.243119 [info ] [Thread-2 (]: 6 of 6 OK created sql view model public.mart_user_session_metrics .............. [[32mCREATE VIEW[0m in 0.05s]
[0m13:51:46.243366 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m13:51:46.243887 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:46.244033 [debug] [MainThread]: On master: BEGIN
[0m13:51:46.244166 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:51:46.251103 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:51:46.251331 [debug] [MainThread]: On master: COMMIT
[0m13:51:46.251486 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:46.251626 [debug] [MainThread]: On master: COMMIT
[0m13:51:46.252037 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:51:46.252179 [debug] [MainThread]: On master: Close
[0m13:51:46.252374 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:46.252511 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_episodes' was properly closed.
[0m13:51:46.252640 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m13:51:46.252767 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m13:51:46.252955 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m13:51:46.253222 [info ] [MainThread]: 
[0m13:51:46.253423 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m13:51:46.253952 [debug] [MainThread]: Command end result
[0m13:51:46.265958 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:51:46.267303 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:51:46.269827 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:51:46.269995 [info ] [MainThread]: 
[0m13:51:46.270176 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:51:46.270325 [info ] [MainThread]: 
[0m13:51:46.270494 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m13:51:46.272033 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6030736, "process_in_blocks": "0", "process_kernel_time": 0.130442, "process_mem_max_rss": "130613248", "process_out_blocks": "0", "process_user_time": 0.99975}
[0m13:51:46.272281 [debug] [MainThread]: Command `dbt run` succeeded at 13:51:46.272240 after 0.60 seconds
[0m13:51:46.272511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104345160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a39b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a3ae40>]}
[0m13:51:46.272751 [debug] [MainThread]: Flushing usage events
[0m13:51:46.708798 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:48.225912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a01e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c2d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133f9640>]}


============================== 13:51:48.230453 | c53c7bce-1f21-44f1-ab74-6633d4604fbc ==============================
[0m13:51:48.230453 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:51:48.231226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'profiles_dir': '..', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir ..', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:51:48.365820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c53c7bce-1f21-44f1-ab74-6633d4604fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a1fcb0>]}
[0m13:51:48.415637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c53c7bce-1f21-44f1-ab74-6633d4604fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111815fa0>]}
[0m13:51:48.416563 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:51:48.530780 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:51:48.605165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:51:48.605488 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:51:48.633579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c53c7bce-1f21-44f1-ab74-6633d4604fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114269940>]}
[0m13:51:48.681707 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:51:48.683125 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:51:48.699674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c53c7bce-1f21-44f1-ab74-6633d4604fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11461b7d0>]}
[0m13:51:48.700034 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:51:48.700254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c53c7bce-1f21-44f1-ab74-6633d4604fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114268dd0>]}
[0m13:51:48.701357 [info ] [MainThread]: 
[0m13:51:48.701580 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:51:48.701751 [info ] [MainThread]: 
[0m13:51:48.702055 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:51:48.704160 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m13:51:48.729514 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:51:48.729851 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:51:48.730052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:51:48.753838 [debug] [ThreadPool]: SQL status: BEGIN in 0.024 seconds
[0m13:51:48.754269 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:51:48.754486 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:51:48.758392 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m13:51:48.759291 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:51:48.759972 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:51:48.763172 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:48.763378 [debug] [MainThread]: On master: BEGIN
[0m13:51:48.763546 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:51:48.774837 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:51:48.775181 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:48.775454 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:51:48.780639 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m13:51:48.781863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c53c7bce-1f21-44f1-ab74-6633d4604fbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146689b0>]}
[0m13:51:48.782150 [debug] [MainThread]: On master: ROLLBACK
[0m13:51:48.782941 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:48.783112 [debug] [MainThread]: On master: BEGIN
[0m13:51:48.783942 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:51:48.784111 [debug] [MainThread]: On master: COMMIT
[0m13:51:48.784275 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:48.784437 [debug] [MainThread]: On master: COMMIT
[0m13:51:48.785003 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:51:48.785172 [debug] [MainThread]: On master: Close
[0m13:51:48.786420 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m13:51:48.786759 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m13:51:48.786985 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m13:51:48.787360 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m13:51:48.787198 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m13:51:48.787663 [info ] [Thread-2 (]: 2 of 7 START test not_null_stg_episodes_episode_id ............................. [RUN]
[0m13:51:48.787882 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_user_events_event_id ............................ [RUN]
[0m13:51:48.788109 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_users_user_id ................................... [RUN]
[0m13:51:48.788369 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m13:51:48.788623 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422'
[0m13:51:48.788850 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7'
[0m13:51:48.789075 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77'
[0m13:51:48.789276 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m13:51:48.789645 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m13:51:48.790124 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m13:51:48.790328 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m13:51:48.800307 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m13:51:48.804877 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m13:51:48.808711 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m13:51:48.811032 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m13:51:48.811986 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m13:51:48.812255 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m13:51:48.812466 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m13:51:48.812679 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m13:51:48.824144 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m13:51:48.825887 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m13:51:48.827702 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m13:51:48.829152 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m13:51:48.830059 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m13:51:48.830332 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m13:51:48.830563 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m13:51:48.830796 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m13:51:48.831033 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m13:51:48.831268 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m13:51:48.831507 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m13:51:48.831728 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m13:51:48.831954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:48.832168 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:51:48.832381 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:51:48.832590 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:51:48.845856 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m13:51:48.846129 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m13:51:48.846372 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m13:51:48.846601 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m13:51:48.846831 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m13:51:48.847119 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m13:51:48.847867 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m13:51:48.848092 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m13:51:48.848317 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m13:51:48.848543 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m13:51:48.848741 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:51:48.848993 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m13:51:48.851411 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m13:51:48.851660 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m13:51:48.851852 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:51:48.852077 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m13:51:48.852856 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m13:51:48.853085 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m13:51:48.853818 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m13:51:48.854453 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m13:51:48.854258 [info ] [Thread-4 (]: 4 of 7 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.07s]
[0m13:51:48.854866 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.07s]
[0m13:51:48.855088 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m13:51:48.855376 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m13:51:48.855614 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:51:48.855904 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m13:51:48.856285 [info ] [Thread-3 (]: 3 of 7 PASS not_null_stg_user_events_event_id .................................. [[32mPASS[0m in 0.07s]
[0m13:51:48.856631 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m13:51:48.857331 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m13:51:48.857655 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m13:51:48.858001 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m13:51:48.858235 [info ] [Thread-4 (]: 5 of 7 START test unique_stg_episodes_episode_id ............................... [RUN]
[0m13:51:48.858523 [info ] [Thread-1 (]: 6 of 7 START test unique_stg_user_events_event_id .............................. [RUN]
[0m13:51:48.858811 [debug] [Thread-3 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m13:51:48.859209 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m13:51:48.859433 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m13:51:48.859654 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m13:51:48.859877 [info ] [Thread-3 (]: 7 of 7 START test unique_stg_users_user_id ..................................... [RUN]
[0m13:51:48.860343 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m13:51:48.860925 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m13:51:48.860755 [info ] [Thread-2 (]: 2 of 7 PASS not_null_stg_episodes_episode_id ................................... [[32mPASS[0m in 0.07s]
[0m13:51:48.861231 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m13:51:48.865171 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m13:51:48.867904 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m13:51:48.868239 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m13:51:48.868460 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m13:51:48.870727 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m13:51:48.871033 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m13:51:48.872457 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m13:51:48.872700 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m13:51:48.873245 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m13:51:48.876431 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m13:51:48.877917 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m13:51:48.878226 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m13:51:48.878653 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: BEGIN
[0m13:51:48.878972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:51:48.879405 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m13:51:48.879642 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m13:51:48.879866 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: BEGIN
[0m13:51:48.880087 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m13:51:48.880292 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:51:48.880508 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:51:48.942100 [debug] [Thread-3 (]: SQL status: BEGIN in 0.061 seconds
[0m13:51:48.942732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.064 seconds
[0m13:51:48.943706 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m13:51:48.944698 [debug] [Thread-4 (]: SQL status: BEGIN in 0.064 seconds
[0m13:51:48.945429 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m13:51:48.945964 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:51:48.946333 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m13:51:48.946678 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_user_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:51:48.947621 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:51:48.948750 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:51:48.950289 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m13:51:48.950707 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:51:48.950993 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:51:48.952013 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: ROLLBACK
[0m13:51:48.952286 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m13:51:48.953075 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: ROLLBACK
[0m13:51:48.953649 [info ] [Thread-3 (]: 7 of 7 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.09s]
[0m13:51:48.953983 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: Close
[0m13:51:48.954468 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m13:51:48.954707 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: Close
[0m13:51:48.955081 [info ] [Thread-4 (]: 5 of 7 PASS unique_stg_episodes_episode_id ..................................... [[32mPASS[0m in 0.10s]
[0m13:51:48.955606 [info ] [Thread-1 (]: 6 of 7 PASS unique_stg_user_events_event_id .................................... [[32mPASS[0m in 0.10s]
[0m13:51:48.956402 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m13:51:48.956918 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m13:51:48.958029 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:48.958277 [debug] [MainThread]: On master: BEGIN
[0m13:51:48.958479 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:51:48.966467 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m13:51:48.967023 [debug] [MainThread]: On master: COMMIT
[0m13:51:48.967276 [debug] [MainThread]: Using postgres connection "master"
[0m13:51:48.967487 [debug] [MainThread]: On master: COMMIT
[0m13:51:48.967914 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:51:48.968125 [debug] [MainThread]: On master: Close
[0m13:51:48.968448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:51:48.968646 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m13:51:48.968841 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422' was properly closed.
[0m13:51:48.969022 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m13:51:48.969200 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16' was properly closed.
[0m13:51:48.969436 [info ] [MainThread]: 
[0m13:51:48.969685 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m13:51:48.970486 [debug] [MainThread]: Command end result
[0m13:51:48.986453 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:51:48.987816 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:51:48.994022 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:51:48.994746 [info ] [MainThread]: 
[0m13:51:48.995086 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:51:48.995313 [info ] [MainThread]: 
[0m13:51:48.995539 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m13:51:48.998194 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.8260311, "process_in_blocks": "0", "process_kernel_time": 0.184512, "process_mem_max_rss": "129957888", "process_out_blocks": "0", "process_user_time": 1.283724}
[0m13:51:48.998547 [debug] [MainThread]: Command `dbt test` succeeded at 13:51:48.998493 after 0.83 seconds
[0m13:51:48.998817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c546e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e6f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114aaf1a0>]}
[0m13:51:48.999093 [debug] [MainThread]: Flushing usage events
[0m13:51:49.383366 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:45.937203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105728470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fd220>]}


============================== 13:55:45.941031 | 7f4b346e-7c40-44e8-94dd-2a018ab3066a ==============================
[0m13:55:45.941031 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:55:45.941648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '..', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir ..', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:55:46.056915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f4b346e-7c40-44e8-94dd-2a018ab3066a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106257e60>]}
[0m13:55:46.100187 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-4aju5c64'
[0m13:55:46.100678 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:55:46.187027 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:55:46.187746 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:55:46.240890 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:55:46.244471 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:55:46.483539 [info ] [MainThread]: Installed from version 1.3.0
[0m13:55:46.483993 [info ] [MainThread]: Up to date!
[0m13:55:46.484319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7f4b346e-7c40-44e8-94dd-2a018ab3066a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063a3e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106278b90>]}
[0m13:55:46.486736 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6153182, "process_in_blocks": "0", "process_kernel_time": 0.231356, "process_mem_max_rss": "109576192", "process_out_blocks": "0", "process_user_time": 0.976801}
[0m13:55:46.487179 [debug] [MainThread]: Command `dbt deps` succeeded at 13:55:46.487100 after 0.62 seconds
[0m13:55:46.487489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b91310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061fd850>]}
[0m13:55:46.487764 [debug] [MainThread]: Flushing usage events
[0m13:55:46.937400 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:48.794480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ef1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ef58e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ef51c0>]}


============================== 13:55:48.798131 | 635835a2-97b7-4e36-aeae-ec28471ffe12 ==============================
[0m13:55:48.798131 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:55:48.799358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m13:55:48.919963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '635835a2-97b7-4e36-aeae-ec28471ffe12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114558ec0>]}
[0m13:55:48.955016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '635835a2-97b7-4e36-aeae-ec28471ffe12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134fe540>]}
[0m13:55:48.976639 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:55:49.082263 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:55:49.187654 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:55:49.188276 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/1.staging/stg_user_events.sql
[0m13:55:49.447859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '635835a2-97b7-4e36-aeae-ec28471ffe12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150ef0e0>]}
[0m13:55:49.506145 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:55:49.508128 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:55:49.520117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '635835a2-97b7-4e36-aeae-ec28471ffe12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fa10d0>]}
[0m13:55:49.520582 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:55:49.520872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '635835a2-97b7-4e36-aeae-ec28471ffe12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11527a0f0>]}
[0m13:55:49.522058 [info ] [MainThread]: 
[0m13:55:49.522317 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:55:49.522509 [info ] [MainThread]: 
[0m13:55:49.522827 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:49.524862 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:55:49.604026 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:55:49.604386 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:55:49.604597 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:49.643550 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.039 seconds
[0m13:55:49.644496 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:55:49.645541 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:55:49.649647 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:55:49.650168 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:55:49.650609 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:49.662793 [debug] [ThreadPool]: SQL status: BEGIN in 0.012 seconds
[0m13:55:49.663259 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:55:49.663489 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:55:49.680976 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.017 seconds
[0m13:55:49.682424 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:55:49.683838 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:55:49.687927 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:49.688234 [debug] [MainThread]: On master: BEGIN
[0m13:55:49.688418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:49.697241 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:55:49.697589 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:49.697947 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:49.704367 [debug] [MainThread]: SQL status: SELECT 6 in 0.006 seconds
[0m13:55:49.706018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '635835a2-97b7-4e36-aeae-ec28471ffe12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115420a10>]}
[0m13:55:49.706360 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:49.707087 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:49.707301 [debug] [MainThread]: On master: BEGIN
[0m13:55:49.707957 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m13:55:49.708161 [debug] [MainThread]: On master: COMMIT
[0m13:55:49.708341 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:49.708520 [debug] [MainThread]: On master: COMMIT
[0m13:55:49.708914 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:55:49.709114 [debug] [MainThread]: On master: Close
[0m13:55:49.711795 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m13:55:49.712042 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m13:55:49.712364 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m13:55:49.712664 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m13:55:49.712938 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m13:55:49.713204 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m13:55:49.713424 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m13:55:49.713627 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m13:55:49.713839 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m13:55:49.714044 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m13:55:49.735837 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:55:49.738198 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:55:49.738491 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m13:55:49.738716 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m13:55:49.738931 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:49.739129 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:55:49.749487 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m13:55:49.749846 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m13:55:49.750182 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:55:49.750643 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:55:49.750953 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m13:55:49.751223 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m13:55:49.755568 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m13:55:49.755805 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m13:55:49.813004 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:55:49.832227 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m13:55:49.835443 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:55:49.836127 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m13:55:49.839016 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.003 seconds
[0m13:55:49.839310 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.003 seconds
[0m13:55:49.842732 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m13:55:49.843219 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m13:55:49.853363 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:55:49.854650 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:55:49.854979 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:55:49.855224 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:55:49.855458 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:55:49.855670 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:55:49.859335 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:55:49.860375 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m13:55:49.860617 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m13:55:49.861015 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m13:55:49.862272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '635835a2-97b7-4e36-aeae-ec28471ffe12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152298b0>]}
[0m13:55:49.862500 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '635835a2-97b7-4e36-aeae-ec28471ffe12', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ecccb0>]}
[0m13:55:49.862816 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.15s]
[0m13:55:49.863123 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.15s]
[0m13:55:49.863481 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m13:55:49.863801 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m13:55:49.864540 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:49.864749 [debug] [MainThread]: On master: BEGIN
[0m13:55:49.864930 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:49.875017 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:55:49.875363 [debug] [MainThread]: On master: COMMIT
[0m13:55:49.875576 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:49.875769 [debug] [MainThread]: On master: COMMIT
[0m13:55:49.876460 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:55:49.876655 [debug] [MainThread]: On master: Close
[0m13:55:49.876924 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:49.877107 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m13:55:49.877281 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m13:55:49.877490 [info ] [MainThread]: 
[0m13:55:49.877704 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m13:55:49.878172 [debug] [MainThread]: Command end result
[0m13:55:49.894255 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:55:49.895566 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:55:49.900079 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:55:49.900459 [info ] [MainThread]: 
[0m13:55:49.900740 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:49.900942 [info ] [MainThread]: 
[0m13:55:49.901158 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:55:49.902948 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.1582642, "process_in_blocks": "0", "process_kernel_time": 0.276072, "process_mem_max_rss": "133218304", "process_out_blocks": "0", "process_user_time": 2.020172}
[0m13:55:49.903241 [debug] [MainThread]: Command `dbt seed` succeeded at 13:55:49.903194 after 1.16 seconds
[0m13:55:49.903486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d77200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115459220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1157efef0>]}
[0m13:55:49.903722 [debug] [MainThread]: Flushing usage events
[0m13:55:50.256305 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:51.363496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b49b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaf59d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaf53a0>]}


============================== 13:55:51.366604 | e05515f4-4541-48e3-a960-a85e39533ee5 ==============================
[0m13:55:51.366604 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:55:51.367381 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir ..', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:51.458887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e05515f4-4541-48e3-a960-a85e39533ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b02fef0>]}
[0m13:55:51.489712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e05515f4-4541-48e3-a960-a85e39533ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abcdee0>]}
[0m13:55:51.490400 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:55:51.550400 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:55:51.624838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:51.625191 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:51.656255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e05515f4-4541-48e3-a960-a85e39533ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b966690>]}
[0m13:55:51.705955 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:55:51.707611 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:55:51.717361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e05515f4-4541-48e3-a960-a85e39533ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb5daf0>]}
[0m13:55:51.717991 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:55:51.718303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e05515f4-4541-48e3-a960-a85e39533ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b12db20>]}
[0m13:55:51.719875 [info ] [MainThread]: 
[0m13:55:51.720153 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:55:51.720350 [info ] [MainThread]: 
[0m13:55:51.720676 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:51.722896 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:55:51.750848 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:55:51.751644 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:55:51.751930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:51.776099 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.024 seconds
[0m13:55:51.776975 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:55:51.777892 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:55:51.781109 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:55:51.781324 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:55:51.781501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:51.791192 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m13:55:51.791542 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:55:51.791754 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:55:51.795547 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m13:55:51.796327 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:55:51.797415 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:55:51.801201 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:51.801685 [debug] [MainThread]: On master: BEGIN
[0m13:55:51.801891 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:51.809358 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m13:55:51.809606 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:51.809864 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:51.815256 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m13:55:51.817105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e05515f4-4541-48e3-a960-a85e39533ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b12d190>]}
[0m13:55:51.817573 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:51.818551 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:51.818731 [debug] [MainThread]: On master: BEGIN
[0m13:55:51.819633 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:55:51.819811 [debug] [MainThread]: On master: COMMIT
[0m13:55:51.819981 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:51.820144 [debug] [MainThread]: On master: COMMIT
[0m13:55:51.820600 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:55:51.820773 [debug] [MainThread]: On master: Close
[0m13:55:51.822182 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m13:55:51.822426 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m13:55:51.822650 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_users
[0m13:55:51.822930 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_episodes ................................ [RUN]
[0m13:55:51.823223 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_user_events ............................. [RUN]
[0m13:55:51.823479 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_users ................................... [RUN]
[0m13:55:51.823737 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m13:55:51.823989 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m13:55:51.824220 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m13:55:51.824418 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m13:55:51.824611 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m13:55:51.824799 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_users
[0m13:55:51.828553 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m13:55:51.837883 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m13:55:51.839742 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m13:55:51.840403 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m13:55:51.846953 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_users
[0m13:55:51.847171 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m13:55:51.859655 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m13:55:51.862567 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m13:55:51.864447 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m13:55:51.865022 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:55:51.865280 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:55:51.865517 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:55:51.865733 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m13:55:51.866226 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: BEGIN
[0m13:55:51.866661 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m13:55:51.866916 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:55:51.867132 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:55:51.867344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:51.875850 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m13:55:51.876171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m13:55:51.876459 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:55:51.876687 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:55:51.876922 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m13:55:51.877163 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m13:55:51.877378 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m13:55:51.877658 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:55:51.877967 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

filtered as (
    select * from source
    -- where data ->> 'type' in ('play', 'pause', 'seek', 'complete')
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'ts' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        (data ->> 'ts')::timestamp as event_ts,
        data ->> 'type'         as event_type,
        (data ->> 'duration')::integer as duration
    from filtered
)
select * from typed
  );
[0m13:55:51.879076 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:55:51.879289 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m13:55:51.883557 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:55:51.884022 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m13:55:51.886456 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:55:51.886728 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m13:55:51.888427 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:55:51.888662 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m13:55:51.888945 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m13:55:51.890297 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:51.890516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:51.890726 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:55:51.892213 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:55:51.893609 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:55:51.894920 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:55:51.895132 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m13:55:51.895340 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m13:55:51.895545 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:55:51.897464 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:55:51.897667 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:55:51.897853 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:55:51.907310 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: COMMIT
[0m13:55:51.908322 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m13:55:51.909150 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m13:55:51.909368 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:55:51.909577 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:55:51.909779 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:55:51.909975 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: COMMIT
[0m13:55:51.910169 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m13:55:51.910358 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m13:55:51.913628 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m13:55:51.917549 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m13:55:51.920371 [debug] [Thread-3 (]: SQL status: COMMIT in 0.010 seconds
[0m13:55:51.933375 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m13:55:51.938138 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m13:55:51.939447 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m13:55:51.942181 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:55:51.942662 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:55:51.943171 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:55:51.943425 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m13:55:51.943674 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m13:55:51.943950 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m13:55:51.950349 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.006 seconds
[0m13:55:51.950904 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m13:55:51.951377 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.007 seconds
[0m13:55:51.953407 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: Close
[0m13:55:51.954140 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m13:55:51.954786 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m13:55:51.956538 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e05515f4-4541-48e3-a960-a85e39533ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c141550>]}
[0m13:55:51.956775 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e05515f4-4541-48e3-a960-a85e39533ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c0b90>]}
[0m13:55:51.957168 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m13:55:51.957524 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.13s]
[0m13:55:51.957758 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e05515f4-4541-48e3-a960-a85e39533ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0c5280>]}
[0m13:55:51.958073 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m13:55:51.958369 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_users
[0m13:55:51.958705 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.13s]
[0m13:55:51.959168 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m13:55:51.959601 [debug] [Thread-4 (]: Began running node model.podcast_analytics.int_user_sessions
[0m13:55:51.959825 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m13:55:51.960132 [info ] [Thread-4 (]: 4 of 6 START sql view model public.int_user_sessions ........................... [RUN]
[0m13:55:51.960429 [info ] [Thread-1 (]: 5 of 6 START sql view model public.mart_top_episodes ........................... [RUN]
[0m13:55:51.960759 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.int_user_sessions'
[0m13:55:51.960986 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.mart_top_episodes)
[0m13:55:51.961209 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m13:55:51.961419 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m13:55:51.964665 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m13:55:51.969234 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m13:55:51.970112 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m13:55:51.970377 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m13:55:51.972471 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m13:55:51.974879 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m13:55:51.975498 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:55:51.975750 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:55:51.975988 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m13:55:51.976209 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m13:55:51.976423 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:55:51.976628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:51.994431 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m13:55:51.994745 [debug] [Thread-1 (]: SQL status: BEGIN in 0.018 seconds
[0m13:55:51.995015 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:55:51.995228 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:55:51.995496 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end
    from numbered
    group by user_id, session_number
),

final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        extract(epoch from (session_end - session_start)) as session_duration
    from agg
)

select * from final
  );
[0m13:55:51.995791 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m13:55:52.000700 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m13:55:52.003087 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:55:52.003320 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m13:55:52.003551 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m13:55:52.005143 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:55:52.005436 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m13:55:52.006145 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:52.006360 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:52.007201 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m13:55:52.007971 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m13:55:52.008196 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:55:52.008412 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:55:52.008624 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m13:55:52.008827 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m13:55:52.010188 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m13:55:52.011431 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m13:55:52.011664 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m13:55:52.012140 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:55:52.014354 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m13:55:52.014615 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m13:55:52.015102 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:55:52.015791 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m13:55:52.016332 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:55:52.017934 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m13:55:52.018166 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m13:55:52.018845 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: Close
[0m13:55:52.019163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e05515f4-4541-48e3-a960-a85e39533ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c224f50>]}
[0m13:55:52.019494 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e05515f4-4541-48e3-a960-a85e39533ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c249520>]}
[0m13:55:52.019802 [info ] [Thread-1 (]: 5 of 6 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.06s]
[0m13:55:52.020394 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m13:55:52.020079 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.int_user_sessions ...................... [[32mCREATE VIEW[0m in 0.06s]
[0m13:55:52.020825 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m13:55:52.021210 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m13:55:52.021493 [info ] [Thread-2 (]: 6 of 6 START sql view model public.mart_user_session_metrics ................... [RUN]
[0m13:55:52.021732 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now model.podcast_analytics.mart_user_session_metrics)
[0m13:55:52.021937 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m13:55:52.071273 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m13:55:52.072077 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m13:55:52.074200 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m13:55:52.074624 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:55:52.074851 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m13:55:52.075057 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:55:52.086004 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m13:55:52.086409 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:55:52.086665 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  create view "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
    
    
  as (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
[0m13:55:52.089715 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:55:52.091391 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:55:52.091610 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m13:55:52.092531 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:55:52.093299 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m13:55:52.093505 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:55:52.093699 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m13:55:52.094924 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m13:55:52.095991 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m13:55:52.096472 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:55:52.096677 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop view if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m13:55:52.097488 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:55:52.098100 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m13:55:52.098457 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e05515f4-4541-48e3-a960-a85e39533ee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1dc590>]}
[0m13:55:52.099312 [info ] [Thread-2 (]: 6 of 6 OK created sql view model public.mart_user_session_metrics .............. [[32mCREATE VIEW[0m in 0.08s]
[0m13:55:52.099966 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m13:55:52.101147 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:52.101358 [debug] [MainThread]: On master: BEGIN
[0m13:55:52.101538 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:52.115379 [debug] [MainThread]: SQL status: BEGIN in 0.014 seconds
[0m13:55:52.115902 [debug] [MainThread]: On master: COMMIT
[0m13:55:52.116482 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:52.116891 [debug] [MainThread]: On master: COMMIT
[0m13:55:52.118264 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:55:52.118582 [debug] [MainThread]: On master: Close
[0m13:55:52.119593 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:52.119833 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m13:55:52.120008 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m13:55:52.120170 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_users' was properly closed.
[0m13:55:52.120360 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m13:55:52.120607 [info ] [MainThread]: 
[0m13:55:52.120814 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m13:55:52.121493 [debug] [MainThread]: Command end result
[0m13:55:52.136864 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:55:52.138065 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:55:52.142095 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:55:52.142339 [info ] [MainThread]: 
[0m13:55:52.142571 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:55:52.142761 [info ] [MainThread]: 
[0m13:55:52.142963 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m13:55:52.144823 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8190052, "process_in_blocks": "0", "process_kernel_time": 0.165926, "process_mem_max_rss": "132546560", "process_out_blocks": "0", "process_user_time": 1.361674}
[0m13:55:52.145107 [debug] [MainThread]: Command `dbt run` succeeded at 13:55:52.145063 after 0.82 seconds
[0m13:55:52.145346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abf06b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abf0080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10abf0140>]}
[0m13:55:52.145586 [debug] [MainThread]: Flushing usage events
[0m13:55:52.578023 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:55:53.662827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab23830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2f5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2f5340>]}


============================== 13:55:53.665778 | cd95d59f-f6db-43a4-9118-1a92dc33ad36 ==============================
[0m13:55:53.665778 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:55:53.666158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir ..', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:55:53.778429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd95d59f-f6db-43a4-9118-1a92dc33ad36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b6b5160>]}
[0m13:55:53.812104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd95d59f-f6db-43a4-9118-1a92dc33ad36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11883f4a0>]}
[0m13:55:53.812989 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:55:53.882230 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:55:53.973627 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:55:53.973985 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:55:54.007510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd95d59f-f6db-43a4-9118-1a92dc33ad36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bd75b80>]}
[0m13:55:54.081082 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:55:54.083067 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:55:54.108000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd95d59f-f6db-43a4-9118-1a92dc33ad36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c31ec00>]}
[0m13:55:54.108491 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:55:54.108759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd95d59f-f6db-43a4-9118-1a92dc33ad36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c2f3350>]}
[0m13:55:54.110165 [info ] [MainThread]: 
[0m13:55:54.110609 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:55:54.110989 [info ] [MainThread]: 
[0m13:55:54.111457 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:55:54.114779 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m13:55:54.144269 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:55:54.144615 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:55:54.144831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:54.168372 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m13:55:54.168813 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:55:54.169127 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:55:54.173633 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m13:55:54.174527 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:55:54.175116 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:55:54.178419 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:54.178623 [debug] [MainThread]: On master: BEGIN
[0m13:55:54.178795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:54.188340 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:55:54.188719 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:54.189001 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:55:54.195042 [debug] [MainThread]: SQL status: SELECT 6 in 0.006 seconds
[0m13:55:54.196324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd95d59f-f6db-43a4-9118-1a92dc33ad36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b4d1580>]}
[0m13:55:54.196618 [debug] [MainThread]: On master: ROLLBACK
[0m13:55:54.197362 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:54.197548 [debug] [MainThread]: On master: BEGIN
[0m13:55:54.198704 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:55:54.198888 [debug] [MainThread]: On master: COMMIT
[0m13:55:54.199073 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:54.199257 [debug] [MainThread]: On master: COMMIT
[0m13:55:54.199744 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:55:54.199932 [debug] [MainThread]: On master: Close
[0m13:55:54.201952 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m13:55:54.202586 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m13:55:54.202875 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m13:55:54.203123 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m13:55:54.203409 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m13:55:54.203711 [info ] [Thread-2 (]: 2 of 7 START test not_null_stg_episodes_episode_id ............................. [RUN]
[0m13:55:54.203964 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_user_events_event_id ............................ [RUN]
[0m13:55:54.204206 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_users_user_id ................................... [RUN]
[0m13:55:54.204561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m13:55:54.204887 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422'
[0m13:55:54.205153 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7'
[0m13:55:54.205411 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77'
[0m13:55:54.205639 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m13:55:54.205849 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m13:55:54.206055 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m13:55:54.206254 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m13:55:54.216270 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m13:55:54.221624 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m13:55:54.225035 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m13:55:54.226928 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m13:55:54.227728 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m13:55:54.227985 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m13:55:54.228238 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m13:55:54.228452 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m13:55:54.239315 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m13:55:54.241061 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m13:55:54.242392 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m13:55:54.243651 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m13:55:54.244322 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m13:55:54.244590 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m13:55:54.244849 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:55:54.245132 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m13:55:54.245447 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m13:55:54.245659 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m13:55:54.245888 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m13:55:54.246234 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m13:55:54.246458 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m13:55:54.246673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:55:54.246878 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:55:54.247078 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:55:54.257688 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m13:55:54.258321 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m13:55:54.258627 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m13:55:54.259778 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m13:55:54.260115 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m13:55:54.260435 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m13:55:54.260776 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m13:55:54.261058 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m13:55:54.261277 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m13:55:54.261512 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:55:54.261739 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m13:55:54.261980 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m13:55:54.265241 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m13:55:54.265915 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m13:55:54.268106 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m13:55:54.268787 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.010 seconds
[0m13:55:54.269220 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:55:54.270640 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m13:55:54.271366 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m13:55:54.271135 [info ] [Thread-2 (]: 2 of 7 PASS not_null_stg_episodes_episode_id ................................... [[32mPASS[0m in 0.07s]
[0m13:55:54.272333 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m13:55:54.273435 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m13:55:54.273693 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m13:55:54.274056 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m13:55:54.274525 [info ] [Thread-3 (]: 3 of 7 PASS not_null_stg_user_events_event_id .................................. [[32mPASS[0m in 0.07s]
[0m13:55:54.274885 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m13:55:54.275146 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m13:55:54.275411 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m13:55:54.275746 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m13:55:54.275996 [info ] [Thread-2 (]: 5 of 7 START test unique_stg_episodes_episode_id ............................... [RUN]
[0m13:55:54.276859 [info ] [Thread-4 (]: 4 of 7 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.07s]
[0m13:55:54.277568 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.07s]
[0m13:55:54.277969 [debug] [Thread-3 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m13:55:54.278521 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m13:55:54.278878 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m13:55:54.279237 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m13:55:54.279513 [info ] [Thread-3 (]: 6 of 7 START test unique_stg_user_events_event_id .............................. [RUN]
[0m13:55:54.279855 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m13:55:54.280148 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m13:55:54.280525 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m13:55:54.286906 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m13:55:54.287357 [info ] [Thread-4 (]: 7 of 7 START test unique_stg_users_user_id ..................................... [RUN]
[0m13:55:54.287853 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m13:55:54.288221 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m13:55:54.290903 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m13:55:54.291476 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m13:55:54.291776 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m13:55:54.294474 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m13:55:54.296099 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m13:55:54.296477 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m13:55:54.296881 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m13:55:54.299440 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m13:55:54.299729 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m13:55:54.302019 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m13:55:54.302985 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: BEGIN
[0m13:55:54.303875 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m13:55:54.304211 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:55:54.304729 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: BEGIN
[0m13:55:54.305166 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m13:55:54.305668 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:55:54.306077 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m13:55:54.306722 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:55:54.322267 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m13:55:54.322908 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m13:55:54.323336 [debug] [Thread-2 (]: SQL status: BEGIN in 0.019 seconds
[0m13:55:54.323674 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m13:55:54.323934 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m13:55:54.324245 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m13:55:54.324966 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_user_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:55:54.325293 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:55:54.326015 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:55:54.328039 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:55:54.328363 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m13:55:54.329405 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: ROLLBACK
[0m13:55:54.330315 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m13:55:54.331002 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: Close
[0m13:55:54.331261 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m13:55:54.331765 [info ] [Thread-2 (]: 5 of 7 PASS unique_stg_episodes_episode_id ..................................... [[32mPASS[0m in 0.05s]
[0m13:55:54.334665 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m13:55:54.332073 [info ] [Thread-4 (]: 7 of 7 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.04s]
[0m13:55:54.335865 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m13:55:54.342862 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.016 seconds
[0m13:55:54.344021 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: ROLLBACK
[0m13:55:54.344659 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: Close
[0m13:55:54.345101 [error] [Thread-3 (]: 6 of 7 FAIL 1329 unique_stg_user_events_event_id ............................... [[31mFAIL 1329[0m in 0.06s]
[0m13:55:54.345584 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m13:55:54.346817 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:54.347133 [debug] [MainThread]: On master: BEGIN
[0m13:55:54.347356 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:55:54.358231 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:55:54.359079 [debug] [MainThread]: On master: COMMIT
[0m13:55:54.359412 [debug] [MainThread]: Using postgres connection "master"
[0m13:55:54.359628 [debug] [MainThread]: On master: COMMIT
[0m13:55:54.360266 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:55:54.360481 [debug] [MainThread]: On master: Close
[0m13:55:54.360815 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:54.361065 [debug] [MainThread]: Connection 'test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8' was properly closed.
[0m13:55:54.361270 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16' was properly closed.
[0m13:55:54.361456 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m13:55:54.361634 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m13:55:54.361871 [info ] [MainThread]: 
[0m13:55:54.362112 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m13:55:54.363059 [debug] [MainThread]: Command end result
[0m13:55:54.381077 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:55:54.382401 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:55:54.387677 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:55:54.388014 [info ] [MainThread]: 
[0m13:55:54.388285 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:55:54.388508 [info ] [MainThread]: 
[0m13:55:54.388772 [error] [MainThread]: [31mFailure in test unique_stg_user_events_event_id (models/schema.yml)[0m
[0m13:55:54.389019 [error] [MainThread]:   Got 1329 results, configured to fail if != 0
[0m13:55:54.389213 [info ] [MainThread]: 
[0m13:55:54.389437 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/schema.yml/unique_stg_user_events_event_id.sql
[0m13:55:54.389644 [info ] [MainThread]: 
[0m13:55:54.389865 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=7
[0m13:55:54.391827 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.77054346, "process_in_blocks": "0", "process_kernel_time": 0.179679, "process_mem_max_rss": "133267456", "process_out_blocks": "0", "process_user_time": 1.346415}
[0m13:55:54.392192 [debug] [MainThread]: Command `dbt test` failed at 13:55:54.392136 after 0.77 seconds
[0m13:55:54.392484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2f5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2f5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2f5670>]}
[0m13:55:54.392739 [debug] [MainThread]: Flushing usage events
[0m13:55:54.754942 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:58:11.310900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849e4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb1790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb1190>]}


============================== 13:58:11.315891 | 8289aee1-cd18-4ce5-8b91-5de816b03dc5 ==============================
[0m13:58:11.315891 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:58:11.316521 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '..', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps --profiles-dir ..', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:58:11.391264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8289aee1-cd18-4ce5-8b91-5de816b03dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108229250>]}
[0m13:58:11.428037 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-tj1uf8kf'
[0m13:58:11.428507 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:58:11.523835 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:58:11.524670 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:58:11.587100 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:58:11.589246 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:58:11.807307 [info ] [MainThread]: Installed from version 1.3.0
[0m13:58:11.807655 [info ] [MainThread]: Up to date!
[0m13:58:11.807904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8289aee1-cd18-4ce5-8b91-5de816b03dc5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109157e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082dc3b0>]}
[0m13:58:11.810210 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.55009335, "process_in_blocks": "0", "process_kernel_time": 0.181978, "process_mem_max_rss": "112394240", "process_out_blocks": "0", "process_user_time": 0.864993}
[0m13:58:11.810645 [debug] [MainThread]: Command `dbt deps` succeeded at 13:58:11.810569 after 0.55 seconds
[0m13:58:11.810998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108229250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f92840>]}
[0m13:58:11.811374 [debug] [MainThread]: Flushing usage events
[0m13:58:12.243193 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:58:13.955817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d609e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f5340>]}


============================== 13:58:13.959648 | a431677b-496f-4d96-a8e9-358461666a64 ==============================
[0m13:58:13.959648 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:58:13.960163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --profiles-dir ..', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:58:14.119656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a431677b-496f-4d96-a8e9-358461666a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b5bb30>]}
[0m13:58:14.157759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a431677b-496f-4d96-a8e9-358461666a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105411880>]}
[0m13:58:14.159406 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:58:14.241787 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:58:14.370156 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:58:14.370865 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/1.staging/stg_user_events.sql
[0m13:58:14.676768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a431677b-496f-4d96-a8e9-358461666a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10886b290>]}
[0m13:58:14.742412 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:58:14.745409 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:58:14.759985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a431677b-496f-4d96-a8e9-358461666a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a20500>]}
[0m13:58:14.760748 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:58:14.761217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a431677b-496f-4d96-a8e9-358461666a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108729970>]}
[0m13:58:14.762702 [info ] [MainThread]: 
[0m13:58:14.763040 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:58:14.763672 [info ] [MainThread]: 
[0m13:58:14.764668 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:58:14.768837 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:58:14.953087 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:58:14.953893 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:58:14.954213 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:15.003687 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.049 seconds
[0m13:58:15.004893 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:58:15.006147 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:58:15.010308 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:58:15.010621 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:58:15.010859 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:15.025071 [debug] [ThreadPool]: SQL status: BEGIN in 0.014 seconds
[0m13:58:15.025811 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:58:15.026122 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:58:15.032490 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.006 seconds
[0m13:58:15.034234 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:58:15.035320 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:58:15.039318 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:15.039587 [debug] [MainThread]: On master: BEGIN
[0m13:58:15.039801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:58:15.050742 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m13:58:15.051142 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:15.051468 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:58:15.056410 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m13:58:15.057981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a431677b-496f-4d96-a8e9-358461666a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10886b440>]}
[0m13:58:15.058339 [debug] [MainThread]: On master: ROLLBACK
[0m13:58:15.058899 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:15.059180 [debug] [MainThread]: On master: BEGIN
[0m13:58:15.059928 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:58:15.060164 [debug] [MainThread]: On master: COMMIT
[0m13:58:15.060389 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:15.060599 [debug] [MainThread]: On master: COMMIT
[0m13:58:15.061046 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:58:15.061316 [debug] [MainThread]: On master: Close
[0m13:58:15.063786 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m13:58:15.064263 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m13:58:15.065369 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m13:58:15.066054 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m13:58:15.066800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m13:58:15.067234 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m13:58:15.067547 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m13:58:15.067832 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m13:58:15.068135 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m13:58:15.068409 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m13:58:15.094335 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:58:15.096922 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:58:15.097259 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m13:58:15.097883 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m13:58:15.098246 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:15.098532 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:58:15.108873 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:58:15.109316 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:58:15.109740 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m13:58:15.110315 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m13:58:15.110644 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:58:15.110915 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m13:58:15.116096 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.005 seconds
[0m13:58:15.116632 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.007 seconds
[0m13:58:15.201123 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:58:15.207591 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:58:15.208110 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m13:58:15.208441 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m13:58:15.212250 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.003 seconds
[0m13:58:15.212630 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.004 seconds
[0m13:58:15.218660 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m13:58:15.219373 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m13:58:15.257515 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:58:15.259526 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:58:15.260348 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m13:58:15.260882 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m13:58:15.261250 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m13:58:15.261577 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m13:58:15.267323 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m13:58:15.267999 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m13:58:15.270053 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m13:58:15.270778 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m13:58:15.273614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a431677b-496f-4d96-a8e9-358461666a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108412870>]}
[0m13:58:15.274017 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a431677b-496f-4d96-a8e9-358461666a64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d0a10>]}
[0m13:58:15.274612 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.21s]
[0m13:58:15.275199 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.20s]
[0m13:58:15.275820 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m13:58:15.276262 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m13:58:15.277707 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:15.278033 [debug] [MainThread]: On master: BEGIN
[0m13:58:15.278289 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:15.291014 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m13:58:15.291505 [debug] [MainThread]: On master: COMMIT
[0m13:58:15.292082 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:15.292692 [debug] [MainThread]: On master: COMMIT
[0m13:58:15.293570 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m13:58:15.293899 [debug] [MainThread]: On master: Close
[0m13:58:15.294278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:15.294498 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m13:58:15.294699 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m13:58:15.294938 [info ] [MainThread]: 
[0m13:58:15.295185 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m13:58:15.295719 [debug] [MainThread]: Command end result
[0m13:58:15.314974 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:58:15.317311 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:58:15.321661 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:58:15.322000 [info ] [MainThread]: 
[0m13:58:15.322317 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:58:15.322550 [info ] [MainThread]: 
[0m13:58:15.322802 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m13:58:15.324793 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.4292713, "process_in_blocks": "0", "process_kernel_time": 0.267728, "process_mem_max_rss": "135348224", "process_out_blocks": "0", "process_user_time": 1.965368}
[0m13:58:15.325236 [debug] [MainThread]: Command `dbt seed` succeeded at 13:58:15.325162 after 1.43 seconds
[0m13:58:15.325557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108447c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a34da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a35820>]}
[0m13:58:15.325893 [debug] [MainThread]: Flushing usage events
[0m13:58:15.746840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:58:16.885918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e2f860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134f59a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134f5370>]}


============================== 13:58:16.888668 | cdb60cfc-c02a-4c4e-a98b-5d0f2dbfcfeb ==============================
[0m13:58:16.888668 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:58:16.889094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ..', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:58:17.026060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cdb60cfc-c02a-4c4e-a98b-5d0f2dbfcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135a4d10>]}
[0m13:58:17.064027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cdb60cfc-c02a-4c4e-a98b-5d0f2dbfcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060f4dd0>]}
[0m13:58:17.064797 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:58:17.132989 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:58:17.212933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:58:17.213297 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:58:17.245995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cdb60cfc-c02a-4c4e-a98b-5d0f2dbfcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a6b650>]}
[0m13:58:17.302913 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:58:17.304363 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:58:17.312231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cdb60cfc-c02a-4c4e-a98b-5d0f2dbfcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11425eb10>]}
[0m13:58:17.312564 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:58:17.312793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdb60cfc-c02a-4c4e-a98b-5d0f2dbfcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11397f5c0>]}
[0m13:58:17.313914 [info ] [MainThread]: 
[0m13:58:17.314149 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:58:17.314335 [info ] [MainThread]: 
[0m13:58:17.314698 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:58:17.318885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m13:58:17.442465 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m13:58:17.442875 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m13:58:17.443134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:17.474389 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.031 seconds
[0m13:58:17.475464 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m13:58:17.476568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m13:58:17.480924 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:58:17.481379 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:58:17.481615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:17.492481 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m13:58:17.492874 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:58:17.493118 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:58:17.496540 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.003 seconds
[0m13:58:17.497465 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:58:17.498233 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:58:17.502685 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:17.503018 [debug] [MainThread]: On master: BEGIN
[0m13:58:17.503233 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:58:17.511966 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:58:17.512208 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:17.512488 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:58:17.518226 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m13:58:17.519750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cdb60cfc-c02a-4c4e-a98b-5d0f2dbfcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106caa270>]}
[0m13:58:17.520085 [debug] [MainThread]: On master: ROLLBACK
[0m13:58:17.520760 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:17.520985 [debug] [MainThread]: On master: BEGIN
[0m13:58:17.521897 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:58:17.522091 [debug] [MainThread]: On master: COMMIT
[0m13:58:17.522275 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:17.522449 [debug] [MainThread]: On master: COMMIT
[0m13:58:17.522979 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:58:17.523162 [debug] [MainThread]: On master: Close
[0m13:58:17.524602 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m13:58:17.524840 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m13:58:17.525075 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_users
[0m13:58:17.525367 [info ] [Thread-1 (]: 1 of 6 START sql view model public.stg_episodes ................................ [RUN]
[0m13:58:17.525658 [info ] [Thread-2 (]: 2 of 6 START sql view model public.stg_user_events ............................. [RUN]
[0m13:58:17.525925 [info ] [Thread-3 (]: 3 of 6 START sql view model public.stg_users ................................... [RUN]
[0m13:58:17.526185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m13:58:17.526460 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m13:58:17.526709 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m13:58:17.526920 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m13:58:17.527125 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m13:58:17.527398 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_users
[0m13:58:17.532526 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m13:58:17.541761 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m13:58:17.543272 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m13:58:17.544769 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m13:58:17.545065 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_users
[0m13:58:17.545325 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m13:58:17.566002 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m13:58:17.569780 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m13:58:17.571816 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m13:58:17.572436 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:58:17.572719 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:58:17.572991 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:58:17.573213 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: BEGIN
[0m13:58:17.573429 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m13:58:17.573634 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m13:58:17.573836 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:58:17.574052 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.574270 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:58:17.587228 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m13:58:17.587562 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m13:58:17.587852 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:58:17.588113 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:58:17.588388 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

filtered as (
    select * from source
    where data ->> 'event_type' in ('play', 'pause', 'seek', 'complete')
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'timestamp' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'event_type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        (data ->> 'timestamp')::timestamp as event_ts,
        data ->> 'event_type'         as event_type,
        (data ->> 'duration')::integer as duration
    from filtered
)
select * from typed
  );
[0m13:58:17.588668 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m13:58:17.588921 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m13:58:17.589193 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:58:17.589429 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m13:58:17.605648 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.016 seconds
[0m13:58:17.606046 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m13:58:17.609941 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:58:17.610166 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.021 seconds
[0m13:58:17.611882 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:58:17.612145 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m13:58:17.613802 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:58:17.614029 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m13:58:17.614319 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m13:58:17.616324 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:58:17.616930 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:58:17.617190 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:58:17.619160 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:58:17.620627 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:58:17.622003 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:58:17.622239 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m13:58:17.622467 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m13:58:17.622688 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m13:58:17.624286 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:58:17.624496 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:58:17.624702 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m13:58:17.634745 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m13:58:17.635878 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m13:58:17.636789 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: COMMIT
[0m13:58:17.637037 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:58:17.637250 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:58:17.637457 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:58:17.637658 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m13:58:17.637858 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m13:58:17.638052 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: COMMIT
[0m13:58:17.640474 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:58:17.640687 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m13:58:17.640895 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m13:58:17.644077 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m13:58:17.646303 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m13:58:17.647731 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m13:58:17.651624 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m13:58:17.652252 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m13:58:17.652732 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m13:58:17.652965 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m13:58:17.653195 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m13:58:17.653422 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m13:58:17.657032 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m13:58:17.658463 [debug] [Thread-3 (]: On model.podcast_analytics.stg_users: Close
[0m13:58:17.658697 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m13:58:17.658936 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m13:58:17.660042 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m13:58:17.661118 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m13:58:17.661543 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb60cfc-c02a-4c4e-a98b-5d0f2dbfcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106022510>]}
[0m13:58:17.661820 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb60cfc-c02a-4c4e-a98b-5d0f2dbfcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148407d0>]}
[0m13:58:17.662030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb60cfc-c02a-4c4e-a98b-5d0f2dbfcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149f4c20>]}
[0m13:58:17.662464 [info ] [Thread-3 (]: 3 of 6 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.13s]
[0m13:58:17.662872 [info ] [Thread-2 (]: 2 of 6 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.14s]
[0m13:58:17.663246 [info ] [Thread-1 (]: 1 of 6 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.14s]
[0m13:58:17.663583 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_users
[0m13:58:17.663893 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m13:58:17.664173 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m13:58:17.664580 [debug] [Thread-4 (]: Began running node model.podcast_analytics.int_user_sessions
[0m13:58:17.664814 [debug] [Thread-3 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m13:58:17.665117 [info ] [Thread-4 (]: 4 of 6 START sql view model public.int_user_sessions ........................... [RUN]
[0m13:58:17.665901 [info ] [Thread-3 (]: 5 of 6 START sql view model public.mart_top_episodes ........................... [RUN]
[0m13:58:17.666382 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.int_user_sessions'
[0m13:58:17.666775 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_users, now model.podcast_analytics.mart_top_episodes)
[0m13:58:17.667115 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m13:58:17.667373 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m13:58:17.670592 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m13:58:17.673329 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m13:58:17.674024 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m13:58:17.674258 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m13:58:17.676293 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m13:58:17.678069 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m13:58:17.678488 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:58:17.678716 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:58:17.678941 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m13:58:17.679160 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m13:58:17.679368 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m13:58:17.679568 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:58:17.691378 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m13:58:17.691685 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m13:58:17.691958 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:58:17.692180 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:58:17.692431 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m13:58:17.692723 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end
    from numbered
    group by user_id, session_number
),

final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        extract(epoch from (session_end - session_start)) as session_duration
    from agg
)

select * from final
  );
[0m13:58:17.696306 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:58:17.698095 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:58:17.698322 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m13:58:17.702056 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m13:58:17.704288 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:58:17.704530 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m13:58:17.704786 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m13:58:17.705668 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m13:58:17.705941 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:58:17.706153 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m13:58:17.707223 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:58:17.708011 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m13:58:17.708235 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:58:17.708484 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m13:58:17.708737 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m13:58:17.710256 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m13:58:17.710809 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m13:58:17.711039 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m13:58:17.712061 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m13:58:17.712271 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:58:17.714458 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m13:58:17.715184 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m13:58:17.716010 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m13:58:17.716511 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb60cfc-c02a-4c4e-a98b-5d0f2dbfcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11450fc50>]}
[0m13:58:17.716759 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m13:58:17.717306 [info ] [Thread-3 (]: 5 of 6 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m13:58:17.717929 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m13:58:17.719013 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:58:17.719767 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: Close
[0m13:58:17.720086 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb60cfc-c02a-4c4e-a98b-5d0f2dbfcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a1cda0>]}
[0m13:58:17.720468 [info ] [Thread-4 (]: 4 of 6 OK created sql view model public.int_user_sessions ...................... [[32mCREATE VIEW[0m in 0.05s]
[0m13:58:17.720832 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m13:58:17.721286 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m13:58:17.721662 [info ] [Thread-1 (]: 6 of 6 START sql view model public.mart_user_session_metrics ................... [RUN]
[0m13:58:17.721937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.mart_user_session_metrics)
[0m13:58:17.722174 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m13:58:17.775721 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m13:58:17.777096 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m13:58:17.779367 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m13:58:17.779852 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:58:17.780088 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m13:58:17.780304 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:17.791093 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m13:58:17.791449 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:58:17.791696 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  create view "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
    
    
  as (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
[0m13:58:17.794652 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m13:58:17.796563 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:58:17.796791 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m13:58:17.798109 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m13:58:17.799294 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m13:58:17.799675 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:58:17.800021 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m13:58:17.802131 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m13:58:17.803566 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m13:58:17.804149 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m13:58:17.804382 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop view if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m13:58:17.805452 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m13:58:17.806240 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m13:58:17.806597 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cdb60cfc-c02a-4c4e-a98b-5d0f2dbfcfeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114841610>]}
[0m13:58:17.807092 [info ] [Thread-1 (]: 6 of 6 OK created sql view model public.mart_user_session_metrics .............. [[32mCREATE VIEW[0m in 0.08s]
[0m13:58:17.807457 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m13:58:17.808179 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:17.808386 [debug] [MainThread]: On master: BEGIN
[0m13:58:17.808566 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:17.818244 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:58:17.818668 [debug] [MainThread]: On master: COMMIT
[0m13:58:17.819006 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:17.819236 [debug] [MainThread]: On master: COMMIT
[0m13:58:17.819765 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:58:17.820010 [debug] [MainThread]: On master: Close
[0m13:58:17.820288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:17.820473 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m13:58:17.820642 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_user_events' was properly closed.
[0m13:58:17.820802 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m13:58:17.820961 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m13:58:17.821208 [info ] [MainThread]: 
[0m13:58:17.821421 [info ] [MainThread]: Finished running 6 view models in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m13:58:17.822096 [debug] [MainThread]: Command end result
[0m13:58:17.838236 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:58:17.839509 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:58:17.842888 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:58:17.843099 [info ] [MainThread]: 
[0m13:58:17.843324 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:58:17.843510 [info ] [MainThread]: 
[0m13:58:17.843709 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=6
[0m13:58:17.845802 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.006101, "process_in_blocks": "0", "process_kernel_time": 0.180361, "process_mem_max_rss": "132497408", "process_out_blocks": "0", "process_user_time": 1.449742}
[0m13:58:17.846117 [debug] [MainThread]: Command `dbt run` succeeded at 13:58:17.846064 after 1.01 seconds
[0m13:58:17.846390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e2f860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11496ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11496cc20>]}
[0m13:58:17.846620 [debug] [MainThread]: Flushing usage events
[0m13:58:18.284039 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:58:19.425761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bfd9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bfd3a0>]}


============================== 13:58:19.428351 | 6fffd1a6-8078-4f46-a8f4-29ca7677396c ==============================
[0m13:58:19.428351 [info ] [MainThread]: Running with dbt=1.10.3
[0m13:58:19.428769 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m13:58:19.524855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6fffd1a6-8078-4f46-a8f4-29ca7677396c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cd19d0>]}
[0m13:58:19.556067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6fffd1a6-8078-4f46-a8f4-29ca7677396c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d22e40>]}
[0m13:58:19.556730 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m13:58:19.622103 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m13:58:19.700097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:58:19.700533 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:58:19.731699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6fffd1a6-8078-4f46-a8f4-29ca7677396c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c2c4a0>]}
[0m13:58:19.788127 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:58:19.789612 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:58:19.805435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6fffd1a6-8078-4f46-a8f4-29ca7677396c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11322f080>]}
[0m13:58:19.805869 [info ] [MainThread]: Found 2 seeds, 6 models, 7 data tests, 3 sources, 549 macros
[0m13:58:19.806107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fffd1a6-8078-4f46-a8f4-29ca7677396c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a65c10>]}
[0m13:58:19.807658 [info ] [MainThread]: 
[0m13:58:19.808141 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m13:58:19.808419 [info ] [MainThread]: 
[0m13:58:19.808794 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:58:19.811275 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m13:58:19.840943 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:58:19.841355 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m13:58:19.841586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:19.867624 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m13:58:19.868415 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m13:58:19.868848 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m13:58:19.873399 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m13:58:19.874365 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m13:58:19.875062 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m13:58:19.878543 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:19.878747 [debug] [MainThread]: On master: BEGIN
[0m13:58:19.878919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:58:19.888699 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m13:58:19.888992 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:19.889245 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:58:19.895359 [debug] [MainThread]: SQL status: SELECT 6 in 0.006 seconds
[0m13:58:19.896592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6fffd1a6-8078-4f46-a8f4-29ca7677396c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a64ad0>]}
[0m13:58:19.896951 [debug] [MainThread]: On master: ROLLBACK
[0m13:58:19.897658 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:19.897840 [debug] [MainThread]: On master: BEGIN
[0m13:58:19.898636 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m13:58:19.898818 [debug] [MainThread]: On master: COMMIT
[0m13:58:19.898994 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:19.899165 [debug] [MainThread]: On master: COMMIT
[0m13:58:19.899894 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:58:19.900260 [debug] [MainThread]: On master: Close
[0m13:58:19.902240 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m13:58:19.902677 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m13:58:19.902940 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m13:58:19.903396 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m13:58:19.903190 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m13:58:19.903740 [info ] [Thread-2 (]: 2 of 7 START test not_null_stg_episodes_episode_id ............................. [RUN]
[0m13:58:19.903980 [info ] [Thread-3 (]: 3 of 7 START test not_null_stg_user_events_event_id ............................ [RUN]
[0m13:58:19.904212 [info ] [Thread-4 (]: 4 of 7 START test not_null_stg_users_user_id ................................... [RUN]
[0m13:58:19.904474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m13:58:19.904745 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422'
[0m13:58:19.904991 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7'
[0m13:58:19.905234 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77'
[0m13:58:19.905452 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m13:58:19.905655 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m13:58:19.905858 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m13:58:19.906056 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m13:58:19.916006 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m13:58:19.921709 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m13:58:19.925348 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m13:58:19.927284 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m13:58:19.928125 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m13:58:19.928380 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m13:58:19.928658 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m13:58:19.928869 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m13:58:19.939450 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m13:58:19.941012 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m13:58:19.942284 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m13:58:19.943518 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m13:58:19.944140 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m13:58:19.944487 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m13:58:19.944758 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m13:58:19.945011 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m13:58:19.945223 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m13:58:19.945439 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m13:58:19.945644 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m13:58:19.945854 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m13:58:19.946058 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:58:19.946259 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:58:19.946455 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:58:19.946658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:19.962954 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m13:58:19.963425 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m13:58:19.963671 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m13:58:19.963942 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m13:58:19.964165 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m13:58:19.964381 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m13:58:19.964606 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m13:58:19.964845 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m13:58:19.965077 [debug] [Thread-4 (]: SQL status: BEGIN in 0.019 seconds
[0m13:58:19.965321 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m13:58:19.965640 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m13:58:19.965900 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m13:58:19.969252 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m13:58:19.971951 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m13:58:19.972217 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.007 seconds
[0m13:58:19.973036 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m13:58:19.973282 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m13:58:19.973959 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.008 seconds
[0m13:58:19.973743 [info ] [Thread-4 (]: 4 of 7 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.07s]
[0m13:58:19.974241 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m13:58:19.974982 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m13:58:19.975305 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m13:58:19.975671 [info ] [Thread-2 (]: 2 of 7 PASS not_null_stg_episodes_episode_id ................................... [[32mPASS[0m in 0.07s]
[0m13:58:19.975961 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m13:58:19.976298 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m13:58:19.976529 [info ] [Thread-4 (]: 5 of 7 START test unique_stg_episodes_episode_id ............................... [RUN]
[0m13:58:19.976773 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m13:58:19.977033 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m13:58:19.977275 [info ] [Thread-2 (]: 6 of 7 START test unique_stg_user_events_event_id .............................. [RUN]
[0m13:58:19.977512 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m13:58:19.977737 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m13:58:19.981886 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m13:58:19.982152 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m13:58:19.982381 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.017 seconds
[0m13:58:19.982629 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m13:58:19.985533 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m13:58:19.983569 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.08s]
[0m13:58:19.988625 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m13:58:19.988907 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m13:58:19.989305 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m13:58:19.991539 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m13:58:19.991802 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m13:58:19.992102 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m13:58:19.992489 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m13:58:19.992824 [info ] [Thread-3 (]: 3 of 7 PASS not_null_stg_user_events_event_id .................................. [[32mPASS[0m in 0.09s]
[0m13:58:19.993176 [info ] [Thread-1 (]: 7 of 7 START test unique_stg_users_user_id ..................................... [RUN]
[0m13:58:19.993517 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m13:58:19.994968 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m13:58:19.995291 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m13:58:19.996769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m13:58:19.997053 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: BEGIN
[0m13:58:19.997419 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m13:58:19.997731 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m13:58:19.998007 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m13:58:20.001458 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m13:58:20.002241 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: BEGIN
[0m13:58:20.002667 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:58:20.003196 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m13:58:20.004744 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m13:58:20.005194 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m13:58:20.005434 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m13:58:20.005650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:20.010565 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m13:58:20.010872 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m13:58:20.011163 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m13:58:20.011423 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m13:58:20.011689 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_user_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:58:20.011979 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:58:20.012991 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m13:58:20.013269 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m13:58:20.013508 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:58:20.013786 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m13:58:20.014774 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: ROLLBACK
[0m13:58:20.015389 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: Close
[0m13:58:20.016006 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m13:58:20.015806 [info ] [Thread-4 (]: 5 of 7 PASS unique_stg_episodes_episode_id ..................................... [[32mPASS[0m in 0.04s]
[0m13:58:20.018830 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m13:58:20.019665 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m13:58:20.020637 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m13:58:20.021076 [info ] [Thread-1 (]: 7 of 7 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.03s]
[0m13:58:20.021826 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m13:58:20.027250 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.015 seconds
[0m13:58:20.028281 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: ROLLBACK
[0m13:58:20.028908 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: Close
[0m13:58:20.029380 [info ] [Thread-2 (]: 6 of 7 PASS unique_stg_user_events_event_id .................................... [[32mPASS[0m in 0.05s]
[0m13:58:20.029744 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m13:58:20.030653 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:20.030912 [debug] [MainThread]: On master: BEGIN
[0m13:58:20.031108 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:20.040183 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m13:58:20.040568 [debug] [MainThread]: On master: COMMIT
[0m13:58:20.040791 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:20.040990 [debug] [MainThread]: On master: COMMIT
[0m13:58:20.041412 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m13:58:20.041620 [debug] [MainThread]: On master: Close
[0m13:58:20.041910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:20.042106 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m13:58:20.042290 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m13:58:20.042475 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7' was properly closed.
[0m13:58:20.042692 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16' was properly closed.
[0m13:58:20.043013 [info ] [MainThread]: 
[0m13:58:20.043274 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m13:58:20.044065 [debug] [MainThread]: Command end result
[0m13:58:20.060869 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m13:58:20.062303 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m13:58:20.066232 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m13:58:20.066893 [info ] [MainThread]: 
[0m13:58:20.067201 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:58:20.067535 [info ] [MainThread]: 
[0m13:58:20.068013 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m13:58:20.070508 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.68520707, "process_in_blocks": "0", "process_kernel_time": 0.165058, "process_mem_max_rss": "134086656", "process_out_blocks": "0", "process_user_time": 1.30889}
[0m13:58:20.070881 [debug] [MainThread]: Command `dbt test` succeeded at 13:58:20.070829 after 0.69 seconds
[0m13:58:20.071149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105474290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cf42f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cd1550>]}
[0m13:58:20.071411 [debug] [MainThread]: Flushing usage events
[0m13:58:20.418675 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:49.228235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a9f800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b0d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b0d100>]}


============================== 14:03:49.232752 | 176432f1-705f-4a37-989a-bba9c994e986 ==============================
[0m14:03:49.232752 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:03:49.234141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '..', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir ..', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:03:49.323926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '176432f1-705f-4a37-989a-bba9c994e986', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10977df70>]}
[0m14:03:49.444516 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-oisvi8c_'
[0m14:03:49.444968 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:03:49.538372 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:03:49.538947 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:03:49.590993 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:03:49.593557 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:03:49.821756 [info ] [MainThread]: Installed from version 1.3.0
[0m14:03:49.822200 [info ] [MainThread]: Up to date!
[0m14:03:49.822522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '176432f1-705f-4a37-989a-bba9c994e986', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2c1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bca300>]}
[0m14:03:49.824784 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6568155, "process_in_blocks": "0", "process_kernel_time": 0.225466, "process_mem_max_rss": "111230976", "process_out_blocks": "0", "process_user_time": 1.031939}
[0m14:03:49.825165 [debug] [MainThread]: Command `dbt deps` succeeded at 14:03:49.825094 after 0.66 seconds
[0m14:03:49.825437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b7a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8a030>]}
[0m14:03:49.825698 [debug] [MainThread]: Flushing usage events
[0m14:03:50.257448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:51.963815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ae9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ae91f0>]}


============================== 14:03:51.968407 | 9ae97bf3-bbfe-4744-8177-ff9e701191da ==============================
[0m14:03:51.968407 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:03:51.969338 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --profiles-dir ..', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:03:52.173065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ae97bf3-bbfe-4744-8177-ff9e701191da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca5ca0>]}
[0m14:03:52.222636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ae97bf3-bbfe-4744-8177-ff9e701191da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dcac90>]}
[0m14:03:52.223785 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:03:52.319555 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:03:52.468492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 2 files changed.
[0m14:03:52.469128 [debug] [MainThread]: Partial parsing: added file: podcast_analytics://models/1.staging/stg_user_events_invalid.sql
[0m14:03:52.469622 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/schema.yml
[0m14:03:52.469998 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/1.staging/stg_user_events.sql
[0m14:03:52.799820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ae97bf3-bbfe-4744-8177-ff9e701191da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8ac7d0>]}
[0m14:03:52.998016 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:03:53.002835 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:03:53.024897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ae97bf3-bbfe-4744-8177-ff9e701191da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aad2600>]}
[0m14:03:53.025403 [info ] [MainThread]: Found 2 seeds, 7 models, 8 data tests, 3 sources, 549 macros
[0m14:03:53.025717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ae97bf3-bbfe-4744-8177-ff9e701191da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac40fe0>]}
[0m14:03:53.029971 [info ] [MainThread]: 
[0m14:03:53.030646 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:03:53.031027 [info ] [MainThread]: 
[0m14:03:53.031515 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:03:53.047863 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m14:03:53.431673 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m14:03:53.432126 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:03:53.432418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:53.531193 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.099 seconds
[0m14:03:53.533353 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m14:03:53.535498 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m14:03:53.540939 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:03:53.541278 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:03:53.541524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:03:53.551342 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:03:53.551733 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:03:53.552019 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:03:53.556442 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m14:03:53.557601 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:03:53.558203 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:03:53.562415 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:53.562702 [debug] [MainThread]: On master: BEGIN
[0m14:03:53.562954 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:03:53.572490 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:03:53.572817 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:53.573147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:03:53.578995 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m14:03:53.580716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ae97bf3-bbfe-4744-8177-ff9e701191da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8af8f0>]}
[0m14:03:53.581099 [debug] [MainThread]: On master: ROLLBACK
[0m14:03:53.581671 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:53.581928 [debug] [MainThread]: On master: BEGIN
[0m14:03:53.582669 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:03:53.582987 [debug] [MainThread]: On master: COMMIT
[0m14:03:53.583237 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:53.583462 [debug] [MainThread]: On master: COMMIT
[0m14:03:53.584016 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:03:53.584257 [debug] [MainThread]: On master: Close
[0m14:03:53.586900 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m14:03:53.587188 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m14:03:53.587566 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m14:03:53.587931 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m14:03:53.588340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m14:03:53.588712 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m14:03:53.588999 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m14:03:53.589268 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m14:03:53.589537 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m14:03:53.589789 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m14:03:53.615861 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:03:53.616619 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:03:53.616931 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m14:03:53.617183 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m14:03:53.617586 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:03:53.617834 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:53.626877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m14:03:53.627252 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m14:03:53.627559 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:03:53.627808 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:03:53.628068 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m14:03:53.628323 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m14:03:53.632689 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m14:03:53.632973 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m14:03:53.705973 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:03:53.713077 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:03:53.713379 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m14:03:53.713653 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m14:03:53.717158 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.003 seconds
[0m14:03:53.717525 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.004 seconds
[0m14:03:53.720905 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m14:03:53.721359 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m14:03:53.731494 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m14:03:53.731935 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m14:03:53.732188 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:03:53.732418 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:03:53.732643 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m14:03:53.732860 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m14:03:53.736919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:03:53.737223 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m14:03:53.738450 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m14:03:53.738887 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m14:03:53.740251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ae97bf3-bbfe-4744-8177-ff9e701191da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a22780>]}
[0m14:03:53.740495 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ae97bf3-bbfe-4744-8177-ff9e701191da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae7bd70>]}
[0m14:03:53.740844 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.15s]
[0m14:03:53.741488 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m14:03:53.741129 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.15s]
[0m14:03:53.741999 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m14:03:53.742732 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:53.742950 [debug] [MainThread]: On master: BEGIN
[0m14:03:53.743147 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:03:53.753578 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m14:03:53.753909 [debug] [MainThread]: On master: COMMIT
[0m14:03:53.754125 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:53.754321 [debug] [MainThread]: On master: COMMIT
[0m14:03:53.755028 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:03:53.755469 [debug] [MainThread]: On master: Close
[0m14:03:53.756007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:53.756230 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m14:03:53.756416 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m14:03:53.756674 [info ] [MainThread]: 
[0m14:03:53.756963 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m14:03:53.757533 [debug] [MainThread]: Command end result
[0m14:03:53.774418 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:03:53.775819 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:03:53.779167 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:03:53.779409 [info ] [MainThread]: 
[0m14:03:53.779687 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:03:53.779905 [info ] [MainThread]: 
[0m14:03:53.780143 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:03:53.782123 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.8733859, "process_in_blocks": "0", "process_kernel_time": 0.275609, "process_mem_max_rss": "130875392", "process_out_blocks": "0", "process_user_time": 2.115401}
[0m14:03:53.782441 [debug] [MainThread]: Command `dbt seed` succeeded at 14:03:53.782390 after 1.87 seconds
[0m14:03:53.782709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e6a1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ae9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ae9910>]}
[0m14:03:53.782977 [debug] [MainThread]: Flushing usage events
[0m14:03:54.132394 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:55.028541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062af590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e1340>]}


============================== 14:03:55.030670 | ac736721-c24e-4da9-ac3b-dccc995cdf03 ==============================
[0m14:03:55.030670 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:03:55.031002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --profiles-dir ..', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:03:55.114632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac736721-c24e-4da9-ac3b-dccc995cdf03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e17b30>]}
[0m14:03:55.144268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac736721-c24e-4da9-ac3b-dccc995cdf03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b4b00>]}
[0m14:03:55.145078 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:03:55.199255 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:03:55.266010 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:03:55.266401 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:03:55.292513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac736721-c24e-4da9-ac3b-dccc995cdf03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f85f0>]}
[0m14:03:55.336740 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:03:55.338014 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:03:55.345022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac736721-c24e-4da9-ac3b-dccc995cdf03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d9ac0>]}
[0m14:03:55.345317 [info ] [MainThread]: Found 2 seeds, 7 models, 8 data tests, 3 sources, 549 macros
[0m14:03:55.345525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac736721-c24e-4da9-ac3b-dccc995cdf03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10775f200>]}
[0m14:03:55.346567 [info ] [MainThread]: 
[0m14:03:55.346781 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:03:55.346949 [info ] [MainThread]: 
[0m14:03:55.347238 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:03:55.349225 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m14:03:55.373389 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m14:03:55.373727 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:03:55.373923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:55.398822 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.025 seconds
[0m14:03:55.399725 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m14:03:55.400594 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m14:03:55.403734 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:03:55.403937 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:03:55.404093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:03:55.412279 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:03:55.412445 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:03:55.412614 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:03:55.416373 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.004 seconds
[0m14:03:55.417127 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:03:55.417659 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:03:55.420459 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:55.420649 [debug] [MainThread]: On master: BEGIN
[0m14:03:55.420800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:03:55.427762 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:03:55.427933 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:55.428147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:03:55.433305 [debug] [MainThread]: SQL status: SELECT 6 in 0.005 seconds
[0m14:03:55.434264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac736721-c24e-4da9-ac3b-dccc995cdf03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b5310>]}
[0m14:03:55.434506 [debug] [MainThread]: On master: ROLLBACK
[0m14:03:55.435106 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:55.435283 [debug] [MainThread]: On master: BEGIN
[0m14:03:55.436300 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:03:55.436467 [debug] [MainThread]: On master: COMMIT
[0m14:03:55.436620 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:55.436777 [debug] [MainThread]: On master: COMMIT
[0m14:03:55.437235 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:03:55.437403 [debug] [MainThread]: On master: Close
[0m14:03:55.438635 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m14:03:55.438847 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m14:03:55.439271 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m14:03:55.439109 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_episodes ................................ [RUN]
[0m14:03:55.439519 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m14:03:55.439752 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_user_events ............................. [RUN]
[0m14:03:55.439988 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_user_events_invalid ..................... [RUN]
[0m14:03:55.440208 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m14:03:55.440425 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_users ................................... [RUN]
[0m14:03:55.440658 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m14:03:55.440872 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m14:03:55.441050 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m14:03:55.441265 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m14:03:55.441439 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m14:03:55.441612 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m14:03:55.445043 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m14:03:55.445247 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m14:03:55.454137 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m14:03:55.455535 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:03:55.456788 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m14:03:55.457163 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m14:03:55.463768 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m14:03:55.469677 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m14:03:55.474090 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m14:03:55.474296 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m14:03:55.475960 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m14:03:55.477545 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:03:55.479181 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m14:03:55.479549 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:03:55.479849 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m14:03:55.480082 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:03:55.480279 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:03:55.480467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:55.480671 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: BEGIN
[0m14:03:55.480880 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m14:03:55.481144 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:03:55.481326 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:03:55.481507 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:03:55.481686 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: BEGIN
[0m14:03:55.481969 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:03:55.492971 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m14:03:55.493199 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m14:03:55.493430 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:03:55.493635 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:03:55.493848 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m14:03:55.494084 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */

  create view "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp"
    
    
  as (
    -- stg_user_events_invalid.sql : capture invalid event records for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

invalid_events as (
    select 
        data,
        data ->> 'user_id' as user_id,
        data ->> 'episode_id' as episode_id,
        data ->> 'timestamp' as timestamp,
        data ->> 'event_type' as event_type,
        data ->> 'duration' as duration,
        case 
            when data ->> 'event_type' is null then 'missing_event_type'
            when data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete') then 'invalid_event_type'
            else 'other_issue'
        end as issue_type
    from source
    where data ->> 'event_type' is null 
       or data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete')
)

select * from invalid_events
  );
[0m14:03:55.494351 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m14:03:55.494560 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:03:55.494850 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
-- Note: Invalid events are captured in stg_user_events_invalid.sql for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

valid_events as (
    select * from source
    where data ->> 'event_type' is not null
      and data ->> 'event_type' in ('play', 'pause', 'seek', 'complete')
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'timestamp' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'event_type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        (data ->> 'timestamp')::timestamp as event_ts,
        data ->> 'event_type'         as event_type,
        (data ->> 'duration')::integer as duration
    from valid_events
)
select * from typed
  );
[0m14:03:55.495082 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m14:03:55.495296 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:03:55.495501 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m14:03:55.498735 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:03:55.498932 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:03:55.502142 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:03:55.503838 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:03:55.504048 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp" rename to "stg_user_events_invalid"
[0m14:03:55.504247 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m14:03:55.506034 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m14:03:55.506256 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m14:03:55.507784 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:03:55.507970 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:03:55.508151 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:03:55.509579 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:03:55.509784 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m14:03:55.516662 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m14:03:55.518019 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:03:55.518249 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m14:03:55.518488 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:03:55.518691 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m14:03:55.518911 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m14:03:55.550354 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.027 seconds
[0m14:03:55.562944 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m14:03:55.563375 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:03:55.529365 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m14:03:55.564476 [debug] [Thread-3 (]: SQL status: COMMIT in 0.045 seconds
[0m14:03:55.565300 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.047 seconds
[0m14:03:55.565862 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m14:03:55.576922 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup"
[0m14:03:55.577984 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:03:55.581139 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:03:55.585371 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:03:55.585662 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:03:55.585965 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:03:55.586318 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m14:03:55.586578 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
drop view if exists "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup" cascade
[0m14:03:55.587931 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m14:03:55.588531 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:03:55.588746 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m14:03:55.589158 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:03:55.589546 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:03:55.589996 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:03:55.591435 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: Close
[0m14:03:55.591674 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:03:55.592606 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m14:03:55.593565 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m14:03:55.594712 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m14:03:55.595368 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:03:55.595651 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:03:55.595948 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac736721-c24e-4da9-ac3b-dccc995cdf03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043e2390>]}
[0m14:03:55.596242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac736721-c24e-4da9-ac3b-dccc995cdf03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf6cc0>]}
[0m14:03:55.596462 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m14:03:55.596680 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m14:03:55.597074 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_user_events_invalid ................ [[32mCREATE VIEW[0m in 0.15s]
[0m14:03:55.597484 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m14:03:55.597907 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m14:03:55.598218 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m14:03:55.598435 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:03:55.598645 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:03:55.600219 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m14:03:55.601346 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m14:03:55.602000 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:03:55.602470 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:03:55.602701 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m14:03:55.602927 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m14:03:55.605105 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:03:55.606385 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: Close
[0m14:03:55.606614 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:03:55.607498 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m14:03:55.607920 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac736721-c24e-4da9-ac3b-dccc995cdf03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107beacf0>]}
[0m14:03:55.608327 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac736721-c24e-4da9-ac3b-dccc995cdf03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b44140>]}
[0m14:03:55.608648 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.17s]
[0m14:03:55.609171 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.17s]
[0m14:03:55.609519 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m14:03:55.609809 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m14:03:55.610258 [debug] [Thread-3 (]: Began running node model.podcast_analytics.int_user_sessions
[0m14:03:55.610514 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m14:03:55.610766 [info ] [Thread-3 (]: 5 of 7 START sql view model public.int_user_sessions ........................... [RUN]
[0m14:03:55.611085 [info ] [Thread-1 (]: 6 of 7 START sql view model public.mart_top_episodes ........................... [RUN]
[0m14:03:55.611348 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now model.podcast_analytics.int_user_sessions)
[0m14:03:55.611577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.mart_top_episodes)
[0m14:03:55.611794 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m14:03:55.611999 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m14:03:55.614734 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m14:03:55.617540 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m14:03:55.618474 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m14:03:55.618693 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m14:03:55.621098 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m14:03:55.624308 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m14:03:55.624841 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:03:55.625080 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:03:55.625285 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m14:03:55.625491 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m14:03:55.625695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:55.625884 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:03:55.633028 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:03:55.633309 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m14:03:55.633549 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:03:55.633796 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:03:55.634311 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m14:03:55.634888 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end
    from numbered
    group by user_id, session_number
),

final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        extract(epoch from (session_end - session_start)) as session_duration
    from agg
)

select * from final
  );
[0m14:03:55.637479 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:03:55.676520 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.041 seconds
[0m14:03:55.677500 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:03:55.678997 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:03:55.679216 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m14:03:55.679420 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m14:03:55.681053 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:03:55.681277 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:03:55.681989 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m14:03:55.682664 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m14:03:55.682860 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:03:55.683045 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:03:55.683233 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m14:03:55.683412 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m14:03:55.684845 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:03:55.685054 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:03:55.686267 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m14:03:55.687305 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m14:03:55.687794 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:03:55.688197 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:03:55.688398 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m14:03:55.688598 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m14:03:55.689418 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:03:55.690004 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m14:03:55.690199 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:03:55.690754 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: Close
[0m14:03:55.691042 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac736721-c24e-4da9-ac3b-dccc995cdf03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce50d0>]}
[0m14:03:55.691354 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac736721-c24e-4da9-ac3b-dccc995cdf03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107804410>]}
[0m14:03:55.691654 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:03:55.691921 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.int_user_sessions ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:03:55.692284 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m14:03:55.692536 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m14:03:55.692955 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m14:03:55.693243 [info ] [Thread-2 (]: 7 of 7 START sql view model public.mart_user_session_metrics ................... [RUN]
[0m14:03:55.693496 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now model.podcast_analytics.mart_user_session_metrics)
[0m14:03:55.693703 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m14:03:55.695070 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:03:55.695823 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m14:03:55.697720 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:03:55.698138 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:03:55.698333 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m14:03:55.698514 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:03:55.707753 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m14:03:55.708056 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:03:55.708278 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  create view "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
    
    
  as (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
[0m14:03:55.711267 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:03:55.712812 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:03:55.713002 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m14:03:55.713919 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:03:55.714597 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m14:03:55.714783 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:03:55.714958 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m14:03:55.716351 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:03:55.717368 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m14:03:55.717754 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:03:55.717939 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop view if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m14:03:55.718637 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:03:55.719186 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m14:03:55.719481 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac736721-c24e-4da9-ac3b-dccc995cdf03', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ccde80>]}
[0m14:03:55.719797 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.mart_user_session_metrics .............. [[32mCREATE VIEW[0m in 0.03s]
[0m14:03:55.720070 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m14:03:55.720718 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:55.720895 [debug] [MainThread]: On master: BEGIN
[0m14:03:55.721050 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:03:55.727934 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:03:55.728293 [debug] [MainThread]: On master: COMMIT
[0m14:03:55.728523 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:55.728728 [debug] [MainThread]: On master: COMMIT
[0m14:03:55.729224 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:03:55.729395 [debug] [MainThread]: On master: Close
[0m14:03:55.729718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:55.729887 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m14:03:55.730031 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m14:03:55.730170 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m14:03:55.730310 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_users' was properly closed.
[0m14:03:55.730539 [info ] [MainThread]: 
[0m14:03:55.730720 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.38 seconds (0.38s).
[0m14:03:55.731339 [debug] [MainThread]: Command end result
[0m14:03:55.745664 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:03:55.746809 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:03:55.749944 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:03:55.750158 [info ] [MainThread]: 
[0m14:03:55.750369 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:03:55.750537 [info ] [MainThread]: 
[0m14:03:55.750757 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m14:03:55.753415 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7580327, "process_in_blocks": "0", "process_kernel_time": 0.138059, "process_mem_max_rss": "130547712", "process_out_blocks": "0", "process_user_time": 1.190626}
[0m14:03:55.753807 [debug] [MainThread]: Command `dbt run` succeeded at 14:03:55.753752 after 0.76 seconds
[0m14:03:55.754067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10599fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c59fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c5a030>]}
[0m14:03:55.754304 [debug] [MainThread]: Flushing usage events
[0m14:03:56.189161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:57.008387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e72240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114de9a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114de9460>]}


============================== 14:03:57.010720 | e45e66c6-84bd-4e3a-a008-638d1079b92f ==============================
[0m14:03:57.010720 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:03:57.011071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir ..', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:03:57.091537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e45e66c6-84bd-4e3a-a008-638d1079b92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150d0620>]}
[0m14:03:57.117217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e45e66c6-84bd-4e3a-a008-638d1079b92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ef49b0>]}
[0m14:03:57.117874 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:03:57.169311 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:03:57.231485 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:03:57.231774 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:03:57.257128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e45e66c6-84bd-4e3a-a008-638d1079b92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115b43fe0>]}
[0m14:03:57.300520 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:03:57.301683 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:03:57.313803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e45e66c6-84bd-4e3a-a008-638d1079b92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11621bd70>]}
[0m14:03:57.314119 [info ] [MainThread]: Found 2 seeds, 7 models, 8 data tests, 3 sources, 549 macros
[0m14:03:57.314320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e45e66c6-84bd-4e3a-a008-638d1079b92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1161f7140>]}
[0m14:03:57.315333 [info ] [MainThread]: 
[0m14:03:57.315537 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:03:57.315693 [info ] [MainThread]: 
[0m14:03:57.315962 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:03:57.317883 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m14:03:57.339760 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:03:57.340070 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:03:57.340253 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:57.360819 [debug] [ThreadPool]: SQL status: BEGIN in 0.021 seconds
[0m14:03:57.361134 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:03:57.361329 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:03:57.365378 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m14:03:57.366148 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:03:57.366924 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:03:57.370059 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:57.370291 [debug] [MainThread]: On master: BEGIN
[0m14:03:57.370451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:03:57.379244 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:03:57.379450 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:57.379674 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:03:57.385741 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m14:03:57.387005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e45e66c6-84bd-4e3a-a008-638d1079b92f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11621b1d0>]}
[0m14:03:57.387280 [debug] [MainThread]: On master: ROLLBACK
[0m14:03:57.388131 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:57.388292 [debug] [MainThread]: On master: BEGIN
[0m14:03:57.389098 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:03:57.389255 [debug] [MainThread]: On master: COMMIT
[0m14:03:57.389403 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:57.389545 [debug] [MainThread]: On master: COMMIT
[0m14:03:57.390038 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:03:57.390202 [debug] [MainThread]: On master: Close
[0m14:03:57.391508 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:03:57.391729 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue.bbc5ecbd4c
[0m14:03:57.391936 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:03:57.392302 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:03:57.392141 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m14:03:57.392580 [info ] [Thread-2 (]: 2 of 8 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue  [RUN]
[0m14:03:57.392797 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_episodes_episode_id ............................. [RUN]
[0m14:03:57.393011 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_user_events_event_id ............................ [RUN]
[0m14:03:57.393253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m14:03:57.393495 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue.bbc5ecbd4c'
[0m14:03:57.393714 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422'
[0m14:03:57.393925 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7'
[0m14:03:57.394114 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:03:57.394299 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue.bbc5ecbd4c
[0m14:03:57.394470 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:03:57.394643 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:03:57.404313 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:03:57.407085 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue.bbc5ecbd4c"
[0m14:03:57.411401 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:03:57.412985 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:03:57.413489 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue.bbc5ecbd4c
[0m14:03:57.421749 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue.bbc5ecbd4c"
[0m14:03:57.422145 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:03:57.422348 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:03:57.422574 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:03:57.423698 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:03:57.423931 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue.bbc5ecbd4c"
[0m14:03:57.424952 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:03:57.426059 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:03:57.426356 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue.bbc5ecbd4c: BEGIN
[0m14:03:57.426607 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:03:57.426847 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:03:57.427041 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:03:57.427249 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m14:03:57.427525 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:03:57.427724 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m14:03:57.427908 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:03:57.428095 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m14:03:57.428281 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:57.428519 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:03:57.443241 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m14:03:57.443585 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue.bbc5ecbd4c"
[0m14:03:57.443811 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue.bbc5ecbd4c: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue.bbc5ecbd4c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m14:03:57.445527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m14:03:57.445741 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m14:03:57.445923 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m14:03:57.446109 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:03:57.446299 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:03:57.446485 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:03:57.446689 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m14:03:57.446903 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m14:03:57.447107 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m14:03:57.449764 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m14:03:57.449953 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:03:57.452246 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue.bbc5ecbd4c: ROLLBACK
[0m14:03:57.452607 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m14:03:57.453430 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m14:03:57.454728 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m14:03:57.455006 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue.bbc5ecbd4c: Close
[0m14:03:57.456298 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m14:03:57.456618 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m14:03:57.455822 [info ] [Thread-2 (]: 2 of 8 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue  [[32mPASS[0m in 0.06s]
[0m14:03:57.457195 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.06s]
[0m14:03:57.457615 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m14:03:57.457891 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_episodes_episode_id ................................... [[32mPASS[0m in 0.06s]
[0m14:03:57.458268 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue.bbc5ecbd4c
[0m14:03:57.458532 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:03:57.459259 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m14:03:57.459510 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:03:57.459723 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:03:57.459993 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:03:57.460262 [debug] [Thread-3 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:03:57.460505 [info ] [Thread-2 (]: 5 of 8 START test not_null_stg_users_user_id ................................... [RUN]
[0m14:03:57.460720 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m14:03:57.460893 [info ] [Thread-1 (]: 6 of 8 START test unique_stg_episodes_episode_id ............................... [RUN]
[0m14:03:57.461089 [info ] [Thread-3 (]: 7 of 8 START test unique_stg_user_events_event_id .............................. [RUN]
[0m14:03:57.461634 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__other_issue.bbc5ecbd4c, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m14:03:57.461922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m14:03:57.462198 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_user_events_event_id .................................. [[32mPASS[0m in 0.07s]
[0m14:03:57.462412 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m14:03:57.462605 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:03:57.462790 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:03:57.463039 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:03:57.463222 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:03:57.465349 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:03:57.468587 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:03:57.468869 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:03:57.471610 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:03:57.472094 [info ] [Thread-4 (]: 8 of 8 START test unique_stg_users_user_id ..................................... [RUN]
[0m14:03:57.472736 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m14:03:57.473117 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:03:57.473332 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:03:57.473564 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:03:57.475225 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:03:57.475424 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:03:57.477555 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:03:57.479813 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:03:57.481015 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:03:57.481448 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:03:57.481715 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m14:03:57.481916 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:03:57.482097 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:03:57.482297 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:03:57.482488 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:03:57.482697 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: BEGIN
[0m14:03:57.483758 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:03:57.484030 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: BEGIN
[0m14:03:57.484226 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:03:57.484463 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:03:57.484742 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:03:57.485898 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m14:03:57.486117 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:03:57.496726 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m14:03:57.497018 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m14:03:57.497225 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m14:03:57.497436 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m14:03:57.497690 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:03:57.497898 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:03:57.498096 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:03:57.498285 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:03:57.498499 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_user_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:03:57.498725 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:03:57.498948 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:03:57.499163 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:03:57.500277 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:57.500539 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:03:57.501380 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m14:03:57.501577 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:03:57.502412 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: ROLLBACK
[0m14:03:57.504369 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m14:03:57.504739 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m14:03:57.505437 [info ] [Thread-2 (]: 5 of 8 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.04s]
[0m14:03:57.505899 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:03:57.506257 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: Close
[0m14:03:57.506860 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m14:03:57.507907 [info ] [Thread-1 (]: 6 of 8 PASS unique_stg_episodes_episode_id ..................................... [[32mPASS[0m in 0.05s]
[0m14:03:57.508552 [info ] [Thread-4 (]: 8 of 8 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.04s]
[0m14:03:57.509421 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:03:57.509772 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:03:57.514231 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.015 seconds
[0m14:03:57.515053 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: ROLLBACK
[0m14:03:57.515545 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: Close
[0m14:03:57.515882 [info ] [Thread-3 (]: 7 of 8 PASS unique_stg_user_events_event_id .................................... [[32mPASS[0m in 0.05s]
[0m14:03:57.516163 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:03:57.517051 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:57.517233 [debug] [MainThread]: On master: BEGIN
[0m14:03:57.517433 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:03:57.526679 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:03:57.527023 [debug] [MainThread]: On master: COMMIT
[0m14:03:57.527217 [debug] [MainThread]: Using postgres connection "master"
[0m14:03:57.527395 [debug] [MainThread]: On master: COMMIT
[0m14:03:57.527798 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:03:57.528006 [debug] [MainThread]: On master: Close
[0m14:03:57.528280 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:57.528456 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16' was properly closed.
[0m14:03:57.528619 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m14:03:57.528781 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m14:03:57.528933 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m14:03:57.529136 [info ] [MainThread]: 
[0m14:03:57.529356 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.21 seconds (0.21s).
[0m14:03:57.530186 [debug] [MainThread]: Command end result
[0m14:03:57.628895 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:03:57.630403 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:03:57.634796 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:03:57.635063 [info ] [MainThread]: 
[0m14:03:57.635313 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:03:57.635807 [info ] [MainThread]: 
[0m14:03:57.636148 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m14:03:57.638287 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.66665673, "process_in_blocks": "0", "process_kernel_time": 0.134629, "process_mem_max_rss": "131334144", "process_out_blocks": "0", "process_user_time": 1.13016}
[0m14:03:57.638600 [debug] [MainThread]: Command `dbt test` succeeded at 14:03:57.638552 after 0.67 seconds
[0m14:03:57.638869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ecef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116633cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116633500>]}
[0m14:03:57.639108 [debug] [MainThread]: Flushing usage events
[0m14:03:57.984724 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:29.676065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107377b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075757c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075751c0>]}


============================== 14:05:29.680565 | 4841faaf-cd92-41a0-b393-8f991ddfc0f3 ==============================
[0m14:05:29.680565 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:05:29.681580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps --profiles-dir ..', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:29.771103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4841faaf-cd92-41a0-b393-8f991ddfc0f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075e0620>]}
[0m14:05:29.807884 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-58voalyk'
[0m14:05:29.808293 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:05:29.917677 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:05:29.918333 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:05:29.980490 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:05:29.984193 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:05:30.325611 [info ] [MainThread]: Installed from version 1.3.0
[0m14:05:30.326036 [info ] [MainThread]: Up to date!
[0m14:05:30.326350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4841faaf-cd92-41a0-b393-8f991ddfc0f3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107607680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106890080>]}
[0m14:05:30.329736 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.7157854, "process_in_blocks": "0", "process_kernel_time": 0.179274, "process_mem_max_rss": "108838912", "process_out_blocks": "0", "process_user_time": 0.793001}
[0m14:05:30.330374 [debug] [MainThread]: Command `dbt deps` succeeded at 14:05:30.330270 after 0.72 seconds
[0m14:05:30.330719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107377b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f2570>]}
[0m14:05:30.331044 [debug] [MainThread]: Flushing usage events
[0m14:05:30.745900 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:31.744523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2aa3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bff58e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bff52b0>]}


============================== 14:05:31.747163 | 37e3dfc7-f603-4da2-990a-2ddec9b2b95f ==============================
[0m14:05:31.747163 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:05:31.747529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed --profiles-dir ..', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:31.850676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37e3dfc7-f603-4da2-990a-2ddec9b2b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11921f470>]}
[0m14:05:31.880324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37e3dfc7-f603-4da2-990a-2ddec9b2b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b8279b0>]}
[0m14:05:31.881785 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:05:31.951248 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:05:32.038417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:05:32.039068 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/schema.yml
[0m14:05:32.039350 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/1.staging/stg_user_events.sql
[0m14:05:32.039558 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/1.staging/stg_user_events_invalid.sql
[0m14:05:32.310826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37e3dfc7-f603-4da2-990a-2ddec9b2b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7a54c0>]}
[0m14:05:32.357958 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:05:32.359656 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:05:32.369885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37e3dfc7-f603-4da2-990a-2ddec9b2b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d7f5400>]}
[0m14:05:32.370217 [info ] [MainThread]: Found 2 seeds, 7 models, 8 data tests, 3 sources, 549 macros
[0m14:05:32.370516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37e3dfc7-f603-4da2-990a-2ddec9b2b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce111c0>]}
[0m14:05:32.371602 [info ] [MainThread]: 
[0m14:05:32.371847 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:05:32.372030 [info ] [MainThread]: 
[0m14:05:32.372327 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:32.374202 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m14:05:32.443971 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m14:05:32.444312 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:05:32.444523 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:32.481204 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.037 seconds
[0m14:05:32.482059 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m14:05:32.482944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m14:05:32.485980 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:05:32.486174 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:05:32.486336 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:32.496734 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:05:32.496961 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:05:32.497162 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:05:32.501273 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m14:05:32.501983 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:05:32.502495 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:05:32.505296 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:32.505476 [debug] [MainThread]: On master: BEGIN
[0m14:05:32.505629 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:32.513975 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:05:32.514151 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:32.514371 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:32.520164 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m14:05:32.521329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37e3dfc7-f603-4da2-990a-2ddec9b2b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d32eab0>]}
[0m14:05:32.521593 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:32.522100 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:32.522319 [debug] [MainThread]: On master: BEGIN
[0m14:05:32.522980 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:05:32.523158 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.523323 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:32.523481 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.523863 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:32.524097 [debug] [MainThread]: On master: Close
[0m14:05:32.526507 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m14:05:32.526728 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m14:05:32.527028 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m14:05:32.527301 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m14:05:32.527550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m14:05:32.527802 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m14:05:32.528001 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m14:05:32.528183 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m14:05:32.528380 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m14:05:32.528570 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m14:05:32.547104 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:05:32.549201 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:05:32.549473 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m14:05:32.549693 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m14:05:32.549906 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:32.550105 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:05:32.562804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m14:05:32.563025 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m14:05:32.563259 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:05:32.563467 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:05:32.563666 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m14:05:32.563866 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m14:05:32.567142 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m14:05:32.573754 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.010 seconds
[0m14:05:32.630334 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:05:32.630748 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:05:32.631040 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m14:05:32.631286 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m14:05:32.634780 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.003 seconds
[0m14:05:32.637763 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m14:05:32.637991 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.006 seconds
[0m14:05:32.638437 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m14:05:32.647038 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m14:05:32.647977 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m14:05:32.648256 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:05:32.648462 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:05:32.648652 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m14:05:32.648836 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m14:05:32.655457 [debug] [Thread-1 (]: SQL status: COMMIT in 0.006 seconds
[0m14:05:32.656369 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m14:05:32.656573 [debug] [Thread-2 (]: SQL status: COMMIT in 0.008 seconds
[0m14:05:32.656924 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m14:05:32.658412 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37e3dfc7-f603-4da2-990a-2ddec9b2b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d6711f0>]}
[0m14:05:32.658614 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37e3dfc7-f603-4da2-990a-2ddec9b2b95f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11921e5d0>]}
[0m14:05:32.658897 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.13s]
[0m14:05:32.659171 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.13s]
[0m14:05:32.659463 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m14:05:32.659717 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m14:05:32.660390 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:32.660568 [debug] [MainThread]: On master: BEGIN
[0m14:05:32.660728 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:32.671989 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m14:05:32.672271 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.672471 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:32.672634 [debug] [MainThread]: On master: COMMIT
[0m14:05:32.673227 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:32.673389 [debug] [MainThread]: On master: Close
[0m14:05:32.673626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:32.673786 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m14:05:32.673936 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m14:05:32.674122 [info ] [MainThread]: 
[0m14:05:32.674309 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m14:05:32.674714 [debug] [MainThread]: Command end result
[0m14:05:32.688071 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:05:32.689219 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:05:32.691937 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:05:32.692139 [info ] [MainThread]: 
[0m14:05:32.692378 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:32.692554 [info ] [MainThread]: 
[0m14:05:32.692754 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:05:32.694367 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.9850247, "process_in_blocks": "0", "process_kernel_time": 0.174753, "process_mem_max_rss": "137199616", "process_out_blocks": "0", "process_user_time": 1.452178}
[0m14:05:32.694636 [debug] [MainThread]: Command `dbt seed` succeeded at 14:05:32.694590 after 0.99 seconds
[0m14:05:32.694859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11bff57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aed3980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aed2780>]}
[0m14:05:32.695069 [debug] [MainThread]: Flushing usage events
[0m14:05:33.048405 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:33.970101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e1ad80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10544da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10544d460>]}


============================== 14:05:33.972345 | 8b2c223b-d4ac-40ab-92a7-2e43f59503e9 ==============================
[0m14:05:33.972345 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:05:33.972684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ..', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:34.051429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8b2c223b-d4ac-40ab-92a7-2e43f59503e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047523c0>]}
[0m14:05:34.077491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8b2c223b-d4ac-40ab-92a7-2e43f59503e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047abf20>]}
[0m14:05:34.078224 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:05:34.132831 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:05:34.240353 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:34.240719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:34.270754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b2c223b-d4ac-40ab-92a7-2e43f59503e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8c680>]}
[0m14:05:34.317805 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:05:34.319079 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:05:34.326201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b2c223b-d4ac-40ab-92a7-2e43f59503e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062c97c0>]}
[0m14:05:34.326497 [info ] [MainThread]: Found 2 seeds, 7 models, 8 data tests, 3 sources, 549 macros
[0m14:05:34.326708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2c223b-d4ac-40ab-92a7-2e43f59503e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062e1640>]}
[0m14:05:34.327744 [info ] [MainThread]: 
[0m14:05:34.327957 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:05:34.328121 [info ] [MainThread]: 
[0m14:05:34.328406 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:34.330459 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m14:05:34.352762 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m14:05:34.353090 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:05:34.353285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:34.376924 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.024 seconds
[0m14:05:34.377765 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m14:05:34.378615 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m14:05:34.381876 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:05:34.382128 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:05:34.382307 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:05:34.390470 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:05:34.390649 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:05:34.390828 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:05:34.394775 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m14:05:34.395430 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:05:34.396127 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:05:34.398956 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:34.399172 [debug] [MainThread]: On master: BEGIN
[0m14:05:34.399333 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:34.407138 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:05:34.407300 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:34.407513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:34.413358 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m14:05:34.414441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b2c223b-d4ac-40ab-92a7-2e43f59503e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063119a0>]}
[0m14:05:34.414687 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:34.415283 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:34.415440 [debug] [MainThread]: On master: BEGIN
[0m14:05:34.416229 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:05:34.416383 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.416531 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:34.416675 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.417135 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:34.417313 [debug] [MainThread]: On master: Close
[0m14:05:34.418552 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m14:05:34.418776 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m14:05:34.418979 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m14:05:34.419417 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m14:05:34.419253 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_episodes ................................ [RUN]
[0m14:05:34.419725 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_user_events ............................. [RUN]
[0m14:05:34.419964 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_user_events_invalid ..................... [RUN]
[0m14:05:34.420192 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_users ................................... [RUN]
[0m14:05:34.420427 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m14:05:34.420663 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m14:05:34.420882 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m14:05:34.421094 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m14:05:34.421281 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m14:05:34.421458 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m14:05:34.421629 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m14:05:34.421824 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m14:05:34.425860 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m14:05:34.434394 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m14:05:34.435885 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:05:34.437019 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m14:05:34.437615 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m14:05:34.455260 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:05:34.455845 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m14:05:34.456061 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m14:05:34.458036 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m14:05:34.458265 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m14:05:34.458625 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:05:34.460436 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m14:05:34.462208 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m14:05:34.462479 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: BEGIN
[0m14:05:34.462802 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:05:34.463377 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:05:34.463726 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:05:34.464172 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: BEGIN
[0m14:05:34.464450 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:05:34.464832 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m14:05:34.465119 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:05:34.465477 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m14:05:34.465691 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:05:34.465988 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:34.478120 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m14:05:34.478355 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m14:05:34.478546 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m14:05:34.478778 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:05:34.478995 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:05:34.479194 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:05:34.479453 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
-- Note: Invalid events are captured in stg_user_events_invalid.sql for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

valid_events as (
    select * from source
    where data ->> 'event_type' is not null
      and data ->> 'event_type' in ('play', 'pause', 'seek', 'complete')
      and data ->> 'timestamp' is not null
      and data ->> 'timestamp' != ''
      and data ->> 'user_id' is not null
      and data ->> 'episode_id' is not null
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'timestamp' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'event_type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        (data ->> 'timestamp')::timestamp as event_ts,
        data ->> 'event_type'         as event_type,
        (data ->> 'duration')::integer as duration
    from valid_events
)
select * from typed
  );
[0m14:05:34.479705 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m14:05:34.479948 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */

  create view "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp"
    
    
  as (
    -- stg_user_events_invalid.sql : capture invalid event records for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

invalid_events as (
    select 
        data,
        data ->> 'user_id' as user_id,
        data ->> 'episode_id' as episode_id,
        data ->> 'timestamp' as timestamp,
        data ->> 'event_type' as event_type,
        data ->> 'duration' as duration,
        case 
            when data ->> 'event_type' is null then 'missing_event_type'
            when data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete') then 'invalid_event_type'
            when data ->> 'timestamp' is null or data ->> 'timestamp' = '' then 'missing_timestamp'
            when data ->> 'user_id' is null then 'missing_user_id'
            when data ->> 'episode_id' is null then 'missing_episode_id'
            else 'other_issue'
        end as issue_type
    from source
    where data ->> 'event_type' is null 
       or data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete')
       or data ->> 'timestamp' is null 
       or data ->> 'timestamp' = ''
       or data ->> 'user_id' is null
       or data ->> 'episode_id' is null
)

select * from invalid_events
  );
[0m14:05:34.480209 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m14:05:34.480463 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:05:34.480767 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m14:05:34.483912 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:05:34.487380 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:05:34.487588 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:05:34.487789 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:05:34.487978 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:05:34.488167 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m14:05:34.489777 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:05:34.491243 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:05:34.492644 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:05:34.492889 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m14:05:34.493099 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m14:05:34.493308 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid" rename to "stg_user_events_invalid__dbt_backup"
[0m14:05:34.494022 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:05:34.495304 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:05:34.495517 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:05:34.495716 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:05:34.495900 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:05:34.496139 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:05:34.498113 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:05:34.499535 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:05:34.499732 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:05:34.501037 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:05:34.501245 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp" rename to "stg_user_events_invalid"
[0m14:05:34.501454 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m14:05:34.509263 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m14:05:34.509468 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m14:05:34.509719 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:05:34.509942 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m14:05:34.511085 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:05:34.511290 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:05:34.511470 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:05:34.512256 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m14:05:34.512475 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:05:34.513444 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m14:05:34.514220 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m14:05:34.514418 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:05:34.517226 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m14:05:34.517439 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:05:34.517635 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:05:34.517825 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m14:05:34.520034 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:05:34.520237 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m14:05:34.520427 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m14:05:34.520652 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m14:05:34.522828 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:05:34.523038 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:05:34.524115 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m14:05:34.524304 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:05:34.524518 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:05:34.525503 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup"
[0m14:05:34.525916 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:05:34.527051 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: Close
[0m14:05:34.528080 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m14:05:34.528496 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:05:34.528700 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m14:05:34.529153 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:05:34.529678 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
drop view if exists "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup" cascade
[0m14:05:34.530268 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m14:05:34.530621 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2c223b-d4ac-40ab-92a7-2e43f59503e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e9a3f0>]}
[0m14:05:34.531065 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.11s]
[0m14:05:34.531371 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m14:05:34.533190 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:05:34.533847 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m14:05:34.534051 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:05:34.534269 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:05:34.534539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2c223b-d4ac-40ab-92a7-2e43f59503e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066be9c0>]}
[0m14:05:34.535110 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: Close
[0m14:05:34.535646 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m14:05:34.535950 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m14:05:34.536507 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2c223b-d4ac-40ab-92a7-2e43f59503e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679fd40>]}
[0m14:05:34.536866 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m14:05:34.537097 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2c223b-d4ac-40ab-92a7-2e43f59503e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106634410>]}
[0m14:05:34.537402 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_user_events_invalid ................ [[32mCREATE VIEW[0m in 0.12s]
[0m14:05:34.537786 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.12s]
[0m14:05:34.538074 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m14:05:34.538433 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m14:05:34.538964 [debug] [Thread-4 (]: Began running node model.podcast_analytics.int_user_sessions
[0m14:05:34.539185 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m14:05:34.539463 [info ] [Thread-4 (]: 5 of 7 START sql view model public.int_user_sessions ........................... [RUN]
[0m14:05:34.539796 [info ] [Thread-1 (]: 6 of 7 START sql view model public.mart_top_episodes ........................... [RUN]
[0m14:05:34.540106 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_users, now model.podcast_analytics.int_user_sessions)
[0m14:05:34.540327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.mart_top_episodes)
[0m14:05:34.540536 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m14:05:34.540735 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m14:05:34.543514 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m14:05:34.546000 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m14:05:34.546966 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m14:05:34.547249 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m14:05:34.550672 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m14:05:34.590092 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m14:05:34.590717 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:05:34.590970 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:05:34.591215 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m14:05:34.591415 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m14:05:34.591616 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:05:34.591820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:34.602475 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m14:05:34.602703 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m14:05:34.602947 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:05:34.603154 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:05:34.603389 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m14:05:34.603668 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end
    from numbered
    group by user_id, session_number
),

final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        extract(epoch from (session_end - session_start)) as session_duration
    from agg
)

select * from final
  );
[0m14:05:34.607203 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:05:34.608781 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:05:34.608982 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:05:34.609194 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m14:05:34.610549 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:05:34.610787 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m14:05:34.611408 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:05:34.612121 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m14:05:34.612325 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:05:34.612508 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:05:34.613307 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m14:05:34.613512 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m14:05:34.613709 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:05:34.613934 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m14:05:34.615305 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:05:34.615501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:05:34.616556 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m14:05:34.617612 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m14:05:34.618034 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:05:34.618434 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:05:34.618635 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m14:05:34.618833 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m14:05:34.619926 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:05:34.620525 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: Close
[0m14:05:34.620726 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:05:34.621053 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2c223b-d4ac-40ab-92a7-2e43f59503e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067856d0>]}
[0m14:05:34.621651 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m14:05:34.622002 [info ] [Thread-4 (]: 5 of 7 OK created sql view model public.int_user_sessions ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:05:34.622318 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2c223b-d4ac-40ab-92a7-2e43f59503e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067707d0>]}
[0m14:05:34.622583 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m14:05:34.622872 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:05:34.623227 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m14:05:34.623576 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m14:05:34.623858 [info ] [Thread-2 (]: 7 of 7 START sql view model public.mart_user_session_metrics ................... [RUN]
[0m14:05:34.624089 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now model.podcast_analytics.mart_user_session_metrics)
[0m14:05:34.624290 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m14:05:34.625661 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:05:34.626234 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m14:05:34.627859 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:05:34.628535 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:05:34.628734 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m14:05:34.628919 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:05:34.638708 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m14:05:34.639007 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:05:34.639228 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  create view "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
    
    
  as (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
[0m14:05:34.643572 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:05:34.645222 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:05:34.645425 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m14:05:34.646676 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:05:34.647517 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m14:05:34.647722 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:05:34.647901 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m14:05:34.649355 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:05:34.650449 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m14:05:34.650850 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:05:34.651042 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop view if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m14:05:34.651800 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:05:34.652379 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m14:05:34.652686 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b2c223b-d4ac-40ab-92a7-2e43f59503e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f3410>]}
[0m14:05:34.653014 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.mart_user_session_metrics .............. [[32mCREATE VIEW[0m in 0.03s]
[0m14:05:34.653299 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m14:05:34.653914 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:34.654087 [debug] [MainThread]: On master: BEGIN
[0m14:05:34.654243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:34.663462 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:05:34.663730 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.663938 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:34.664114 [debug] [MainThread]: On master: COMMIT
[0m14:05:34.664932 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:05:34.665181 [debug] [MainThread]: On master: Close
[0m14:05:34.665460 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:34.665625 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m14:05:34.665773 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m14:05:34.665915 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_user_events_invalid' was properly closed.
[0m14:05:34.666053 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m14:05:34.666308 [info ] [MainThread]: 
[0m14:05:34.666559 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m14:05:34.667209 [debug] [MainThread]: Command end result
[0m14:05:34.680867 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:05:34.682424 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:05:34.685530 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:05:34.685722 [info ] [MainThread]: 
[0m14:05:34.685937 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:34.686109 [info ] [MainThread]: 
[0m14:05:34.686294 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m14:05:34.687872 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7512357, "process_in_blocks": "0", "process_kernel_time": 0.141142, "process_mem_max_rss": "132055040", "process_out_blocks": "0", "process_user_time": 1.206147}
[0m14:05:34.688128 [debug] [MainThread]: Command `dbt run` succeeded at 14:05:34.688085 after 0.75 seconds
[0m14:05:34.688345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104727920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106635580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106635e50>]}
[0m14:05:34.688554 [debug] [MainThread]: Flushing usage events
[0m14:05:35.129275 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:35.929747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086880b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e9b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e9550>]}


============================== 14:05:35.932840 | 4c30a8d2-b8b1-49cd-8556-e5a43337eb48 ==============================
[0m14:05:35.932840 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:05:35.933278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --profiles-dir ..', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:05:36.012106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c30a8d2-b8b1-49cd-8556-e5a43337eb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a10fe90>]}
[0m14:05:36.039048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c30a8d2-b8b1-49cd-8556-e5a43337eb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092d24e0>]}
[0m14:05:36.039655 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:05:36.091827 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:05:36.158274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:36.158575 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:36.185088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c30a8d2-b8b1-49cd-8556-e5a43337eb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab65c10>]}
[0m14:05:36.253427 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:05:36.254936 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:05:36.270160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c30a8d2-b8b1-49cd-8556-e5a43337eb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b81bf50>]}
[0m14:05:36.270544 [info ] [MainThread]: Found 2 seeds, 7 models, 8 data tests, 3 sources, 549 macros
[0m14:05:36.270763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c30a8d2-b8b1-49cd-8556-e5a43337eb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a31a150>]}
[0m14:05:36.271990 [info ] [MainThread]: 
[0m14:05:36.272317 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:05:36.272546 [info ] [MainThread]: 
[0m14:05:36.272865 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:05:36.275039 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m14:05:36.299514 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:05:36.299868 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:05:36.300075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:36.322636 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m14:05:36.322984 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:05:36.323195 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:05:36.326925 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m14:05:36.327799 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:05:36.328891 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:05:36.332689 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.332952 [debug] [MainThread]: On master: BEGIN
[0m14:05:36.333124 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:36.341535 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:05:36.341763 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.342005 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:05:36.347782 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m14:05:36.349273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c30a8d2-b8b1-49cd-8556-e5a43337eb48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b2d520>]}
[0m14:05:36.349548 [debug] [MainThread]: On master: ROLLBACK
[0m14:05:36.350242 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.350409 [debug] [MainThread]: On master: BEGIN
[0m14:05:36.351278 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:05:36.351451 [debug] [MainThread]: On master: COMMIT
[0m14:05:36.351674 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.351855 [debug] [MainThread]: On master: COMMIT
[0m14:05:36.352329 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:36.352509 [debug] [MainThread]: On master: Close
[0m14:05:36.353848 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:05:36.354084 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue.284de6403d
[0m14:05:36.354463 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:05:36.354306 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m14:05:36.354751 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:05:36.355005 [info ] [Thread-2 (]: 2 of 8 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue  [RUN]
[0m14:05:36.355232 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_episodes_episode_id ............................. [RUN]
[0m14:05:36.355474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m14:05:36.355681 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_user_events_event_id ............................ [RUN]
[0m14:05:36.355958 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue.284de6403d'
[0m14:05:36.356198 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422'
[0m14:05:36.356401 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:05:36.356631 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7'
[0m14:05:36.356830 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue.284de6403d
[0m14:05:36.357020 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:05:36.366168 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:05:36.366501 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:05:36.370520 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue.284de6403d"
[0m14:05:36.375275 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:05:36.377125 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:05:36.377519 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:05:36.377851 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:05:36.378055 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue.284de6403d
[0m14:05:36.387212 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:05:36.388605 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:05:36.388829 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:05:36.390053 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue.284de6403d"
[0m14:05:36.391352 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:05:36.391735 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:05:36.391958 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:05:36.392209 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m14:05:36.392458 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue.284de6403d"
[0m14:05:36.392666 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m14:05:36.392869 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:05:36.393062 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:05:36.393268 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue.284de6403d: BEGIN
[0m14:05:36.393467 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:36.393658 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m14:05:36.393929 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:05:36.394169 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:05:36.407755 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m14:05:36.408020 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m14:05:36.408238 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m14:05:36.408459 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m14:05:36.408676 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue.284de6403d"
[0m14:05:36.408908 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:05:36.409110 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:05:36.409308 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:05:36.409545 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue.284de6403d: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue.284de6403d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','missing_timestamp','missing_user_id','missing_episode_id','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m14:05:36.409799 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m14:05:36.410029 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m14:05:36.410251 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m14:05:36.412489 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:05:36.415479 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m14:05:36.416670 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m14:05:36.416935 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.006 seconds
[0m14:05:36.417149 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.007 seconds
[0m14:05:36.417487 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_episodes_episode_id ................................... [[32mPASS[0m in 0.06s]
[0m14:05:36.418264 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue.284de6403d: ROLLBACK
[0m14:05:36.418888 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m14:05:36.419192 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:05:36.419475 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:05:36.419688 [info ] [Thread-3 (]: 5 of 8 START test not_null_stg_users_user_id ................................... [RUN]
[0m14:05:36.419986 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m14:05:36.420208 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m14:05:36.420422 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue.284de6403d: Close
[0m14:05:36.420616 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:05:36.420916 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.07s]
[0m14:05:36.423465 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:05:36.423748 [info ] [Thread-2 (]: 2 of 8 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue  [[32mPASS[0m in 0.07s]
[0m14:05:36.424062 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:05:36.424405 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue.284de6403d
[0m14:05:36.424631 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.014 seconds
[0m14:05:36.424843 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:05:36.425117 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:05:36.425335 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:05:36.426059 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m14:05:36.426273 [info ] [Thread-1 (]: 6 of 8 START test unique_stg_episodes_episode_id ............................... [RUN]
[0m14:05:36.426491 [info ] [Thread-2 (]: 7 of 8 START test unique_stg_user_events_event_id .............................. [RUN]
[0m14:05:36.427792 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:05:36.428048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m14:05:36.428300 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__missing_user_id__missing_episode_id__other_issue.284de6403d, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m14:05:36.428602 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:05:36.428786 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m14:05:36.429013 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:05:36.433153 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:05:36.433475 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:05:36.437710 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:05:36.438068 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_user_events_event_id .................................. [[32mPASS[0m in 0.08s]
[0m14:05:36.438386 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m14:05:36.438736 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:05:36.438931 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:05:36.439159 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:05:36.439386 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:05:36.439613 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:05:36.440842 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:05:36.442028 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:05:36.442257 [info ] [Thread-4 (]: 8 of 8 START test unique_stg_users_user_id ..................................... [RUN]
[0m14:05:36.442605 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m14:05:36.442864 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:05:36.443089 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:05:36.443296 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:05:36.445808 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:05:36.446111 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: BEGIN
[0m14:05:36.446746 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: BEGIN
[0m14:05:36.447403 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:05:36.447720 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:36.448169 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:05:36.450468 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:05:36.451658 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:05:36.451890 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m14:05:36.452079 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:05:36.452373 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m14:05:36.452574 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:05:36.452783 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:05:36.454074 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:05:36.454919 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m14:05:36.455552 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m14:05:36.455893 [info ] [Thread-3 (]: 5 of 8 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.04s]
[0m14:05:36.456328 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:05:36.457717 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:05:36.457942 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m14:05:36.458166 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:05:36.458382 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:05:36.458621 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:05:36.458881 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_user_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:05:36.459576 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m14:05:36.459779 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:05:36.459983 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:05:36.460208 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:05:36.461068 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: ROLLBACK
[0m14:05:36.462197 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: Close
[0m14:05:36.462605 [info ] [Thread-1 (]: 6 of 8 PASS unique_stg_episodes_episode_id ..................................... [[32mPASS[0m in 0.03s]
[0m14:05:36.463018 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:05:36.463483 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:05:36.464657 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m14:05:36.465851 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m14:05:36.466294 [info ] [Thread-4 (]: 8 of 8 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.02s]
[0m14:05:36.467056 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:05:36.475883 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.017 seconds
[0m14:05:36.476932 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: ROLLBACK
[0m14:05:36.477671 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: Close
[0m14:05:36.478056 [info ] [Thread-2 (]: 7 of 8 PASS unique_stg_user_events_event_id .................................... [[32mPASS[0m in 0.05s]
[0m14:05:36.478381 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:05:36.479252 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.479459 [debug] [MainThread]: On master: BEGIN
[0m14:05:36.479636 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:05:36.487507 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:05:36.487853 [debug] [MainThread]: On master: COMMIT
[0m14:05:36.488044 [debug] [MainThread]: Using postgres connection "master"
[0m14:05:36.488215 [debug] [MainThread]: On master: COMMIT
[0m14:05:36.488603 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:05:36.488820 [debug] [MainThread]: On master: Close
[0m14:05:36.489112 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:36.489292 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16' was properly closed.
[0m14:05:36.489454 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m14:05:36.489605 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m14:05:36.489754 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m14:05:36.489978 [info ] [MainThread]: 
[0m14:05:36.490188 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m14:05:36.490961 [debug] [MainThread]: Command end result
[0m14:05:36.549727 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:05:36.550892 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:05:36.554356 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:05:36.554591 [info ] [MainThread]: 
[0m14:05:36.554813 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:05:36.554988 [info ] [MainThread]: 
[0m14:05:36.555172 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m14:05:36.557076 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.65907925, "process_in_blocks": "0", "process_kernel_time": 0.133199, "process_mem_max_rss": "132448256", "process_out_blocks": "0", "process_user_time": 1.132037}
[0m14:05:36.557356 [debug] [MainThread]: Command `dbt test` succeeded at 14:05:36.557311 after 0.66 seconds
[0m14:05:36.557577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108713a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060dbf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070f4140>]}
[0m14:05:36.557787 [debug] [MainThread]: Flushing usage events
[0m14:05:36.901716 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:31.375922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084bb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d59880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d59160>]}


============================== 14:06:31.379177 | 583fe9ad-614c-4f36-af2e-c6820110dfb8 ==============================
[0m14:06:31.379177 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:06:31.379577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt deps --profiles-dir ..', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:31.450627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '583fe9ad-614c-4f36-af2e-c6820110dfb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10811a870>]}
[0m14:06:31.481984 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-ersi3kb3'
[0m14:06:31.482357 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:06:31.545405 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:06:31.545967 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:06:31.609264 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:06:31.613802 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:06:31.848641 [info ] [MainThread]: Installed from version 1.3.0
[0m14:06:31.849057 [info ] [MainThread]: Up to date!
[0m14:06:31.849381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '583fe9ad-614c-4f36-af2e-c6820110dfb8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e0aed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eed820>]}
[0m14:06:31.851594 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.5239257, "process_in_blocks": "0", "process_kernel_time": 0.193411, "process_mem_max_rss": "112066560", "process_out_blocks": "0", "process_user_time": 0.907206}
[0m14:06:31.851962 [debug] [MainThread]: Command `dbt deps` succeeded at 14:06:31.851900 after 0.52 seconds
[0m14:06:31.852216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b71160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084bb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cee6c0>]}
[0m14:06:31.852449 [debug] [MainThread]: Flushing usage events
[0m14:06:32.235793 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:33.324153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bf3d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105505a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105505460>]}


============================== 14:06:33.327217 | 142afdb2-0e2a-4326-a06c-1a24ec4ad1e1 ==============================
[0m14:06:33.327217 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:06:33.327609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m14:06:33.449810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '142afdb2-0e2a-4326-a06c-1a24ec4ad1e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10595d0a0>]}
[0m14:06:33.479995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '142afdb2-0e2a-4326-a06c-1a24ec4ad1e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048024e0>]}
[0m14:06:33.481352 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:06:33.551437 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:06:33.638820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m14:06:33.639446 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/schema.yml
[0m14:06:33.639828 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/1.staging/stg_user_events.sql
[0m14:06:33.640053 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/1.staging/stg_user_events_invalid.sql
[0m14:06:33.858020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '142afdb2-0e2a-4326-a06c-1a24ec4ad1e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106560440>]}
[0m14:06:33.903385 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:06:33.904969 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:06:33.915116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '142afdb2-0e2a-4326-a06c-1a24ec4ad1e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106173d40>]}
[0m14:06:33.915541 [info ] [MainThread]: Found 2 seeds, 7 models, 8 data tests, 3 sources, 549 macros
[0m14:06:33.915823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '142afdb2-0e2a-4326-a06c-1a24ec4ad1e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106604d40>]}
[0m14:06:33.916922 [info ] [MainThread]: 
[0m14:06:33.917154 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:06:33.917333 [info ] [MainThread]: 
[0m14:06:33.917638 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:33.919452 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m14:06:33.990191 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m14:06:33.990592 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:06:33.990837 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:34.037634 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.047 seconds
[0m14:06:34.038524 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m14:06:34.039434 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m14:06:34.043067 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:06:34.043332 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:06:34.043492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:34.051047 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:06:34.051235 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:06:34.051412 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:06:34.053514 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m14:06:34.054247 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:06:34.054895 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:06:34.057955 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:34.058139 [debug] [MainThread]: On master: BEGIN
[0m14:06:34.058293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:34.065292 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:06:34.065531 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:34.065757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:34.069396 [debug] [MainThread]: SQL status: SELECT 7 in 0.003 seconds
[0m14:06:34.070579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '142afdb2-0e2a-4326-a06c-1a24ec4ad1e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065337d0>]}
[0m14:06:34.070851 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:34.071234 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:34.071401 [debug] [MainThread]: On master: BEGIN
[0m14:06:34.071988 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:06:34.072209 [debug] [MainThread]: On master: COMMIT
[0m14:06:34.072429 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:34.072599 [debug] [MainThread]: On master: COMMIT
[0m14:06:34.072971 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:06:34.073155 [debug] [MainThread]: On master: Close
[0m14:06:34.077821 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m14:06:34.078228 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m14:06:34.078591 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m14:06:34.078883 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m14:06:34.079164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m14:06:34.079424 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m14:06:34.079623 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m14:06:34.079812 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m14:06:34.080010 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m14:06:34.080201 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m14:06:34.098955 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:06:34.100715 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:06:34.100978 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m14:06:34.101187 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m14:06:34.101380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:34.101562 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:06:34.112817 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m14:06:34.113044 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:06:34.113267 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m14:06:34.113818 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m14:06:34.114041 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:06:34.114244 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m14:06:34.116750 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m14:06:34.123544 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.009 seconds
[0m14:06:34.185483 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:06:34.198585 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m14:06:34.214951 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:06:34.215492 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m14:06:34.217739 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.003 seconds
[0m14:06:34.217998 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.002 seconds
[0m14:06:34.221193 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m14:06:34.221620 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m14:06:34.230464 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m14:06:34.231671 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m14:06:34.231920 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:06:34.232127 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:06:34.232323 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m14:06:34.232516 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m14:06:34.237997 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:06:34.238203 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m14:06:34.239171 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m14:06:34.239558 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m14:06:34.240912 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '142afdb2-0e2a-4326-a06c-1a24ec4ad1e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e8e5a0>]}
[0m14:06:34.241154 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '142afdb2-0e2a-4326-a06c-1a24ec4ad1e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106875a60>]}
[0m14:06:34.241552 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.16s]
[0m14:06:34.241850 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.16s]
[0m14:06:34.242160 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m14:06:34.242421 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m14:06:34.243189 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:34.243379 [debug] [MainThread]: On master: BEGIN
[0m14:06:34.243548 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:34.250652 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:06:34.251022 [debug] [MainThread]: On master: COMMIT
[0m14:06:34.251232 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:34.251431 [debug] [MainThread]: On master: COMMIT
[0m14:06:34.251994 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:06:34.252208 [debug] [MainThread]: On master: Close
[0m14:06:34.252479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:34.252658 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m14:06:34.252817 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m14:06:34.253017 [info ] [MainThread]: 
[0m14:06:34.253243 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.34 seconds (0.34s).
[0m14:06:34.253691 [debug] [MainThread]: Command end result
[0m14:06:34.268707 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:06:34.269940 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:06:34.272931 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:06:34.273128 [info ] [MainThread]: 
[0m14:06:34.273658 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:34.273856 [info ] [MainThread]: 
[0m14:06:34.274115 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:06:34.276415 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.0058104, "process_in_blocks": "0", "process_kernel_time": 0.184276, "process_mem_max_rss": "135692288", "process_out_blocks": "0", "process_user_time": 1.489035}
[0m14:06:34.276757 [debug] [MainThread]: Command `dbt seed` succeeded at 14:06:34.276705 after 1.01 seconds
[0m14:06:34.277005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105505730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102b528d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10534a1e0>]}
[0m14:06:34.277238 [debug] [MainThread]: Flushing usage events
[0m14:06:34.628341 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:35.503803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036b0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104df8470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052995b0>]}


============================== 14:06:35.505869 | 7294b6d7-293f-4974-a583-99317fbcda60 ==============================
[0m14:06:35.505869 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:06:35.506196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m14:06:35.585811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7294b6d7-293f-4974-a583-99317fbcda60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105349c10>]}
[0m14:06:35.611606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7294b6d7-293f-4974-a583-99317fbcda60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103078620>]}
[0m14:06:35.612189 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:06:35.662852 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:06:35.727185 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:35.727485 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:35.752585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7294b6d7-293f-4974-a583-99317fbcda60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058dd9d0>]}
[0m14:06:35.795534 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:06:35.796684 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:06:35.803348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7294b6d7-293f-4974-a583-99317fbcda60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff39b0>]}
[0m14:06:35.803628 [info ] [MainThread]: Found 2 seeds, 7 models, 8 data tests, 3 sources, 549 macros
[0m14:06:35.803822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7294b6d7-293f-4974-a583-99317fbcda60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106129f40>]}
[0m14:06:35.804797 [info ] [MainThread]: 
[0m14:06:35.804995 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:06:35.805147 [info ] [MainThread]: 
[0m14:06:35.805413 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:35.807341 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m14:06:35.829168 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m14:06:35.829472 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:06:35.829654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:35.850650 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.021 seconds
[0m14:06:35.851490 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m14:06:35.852339 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m14:06:35.855271 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:06:35.855475 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:06:35.855631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:35.863301 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:06:35.863467 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:06:35.863636 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:06:35.867417 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m14:06:35.868155 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:06:35.868693 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:06:35.871426 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:35.871604 [debug] [MainThread]: On master: BEGIN
[0m14:06:35.871751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:35.879043 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:06:35.879314 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:35.879548 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:35.884930 [debug] [MainThread]: SQL status: SELECT 7 in 0.005 seconds
[0m14:06:35.886092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7294b6d7-293f-4974-a583-99317fbcda60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060092e0>]}
[0m14:06:35.886365 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:35.887075 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:35.887237 [debug] [MainThread]: On master: BEGIN
[0m14:06:35.888117 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:06:35.888277 [debug] [MainThread]: On master: COMMIT
[0m14:06:35.888429 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:35.888577 [debug] [MainThread]: On master: COMMIT
[0m14:06:35.889042 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:06:35.889200 [debug] [MainThread]: On master: Close
[0m14:06:35.890412 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m14:06:35.890648 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m14:06:35.891095 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m14:06:35.890936 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_episodes ................................ [RUN]
[0m14:06:35.891443 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m14:06:35.891702 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_user_events ............................. [RUN]
[0m14:06:35.891948 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_user_events_invalid ..................... [RUN]
[0m14:06:35.892181 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m14:06:35.892405 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_users ................................... [RUN]
[0m14:06:35.892676 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m14:06:35.892925 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m14:06:35.893119 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m14:06:35.893342 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m14:06:35.893533 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m14:06:35.893715 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m14:06:35.897131 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m14:06:35.897336 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m14:06:35.905165 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m14:06:35.906540 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:06:35.908179 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m14:06:35.908913 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m14:06:35.914920 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m14:06:35.921494 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m14:06:35.926246 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m14:06:35.928080 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m14:06:35.928290 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m14:06:35.929835 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:06:35.931536 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m14:06:35.931906 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:06:35.932109 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:06:35.932373 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m14:06:35.932570 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:06:35.932777 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m14:06:35.932965 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:06:35.933152 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:35.933334 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: BEGIN
[0m14:06:35.933512 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:06:35.933689 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: BEGIN
[0m14:06:35.933933 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:06:35.934164 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:06:35.946950 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m14:06:35.947164 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m14:06:35.947399 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:06:35.947611 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:06:35.947845 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
-- Note: Invalid events are captured in stg_user_events_invalid.sql for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

valid_events as (
    select * from source
    where data ->> 'event_type' is not null
      and data ->> 'event_type' in ('play', 'pause', 'seek', 'complete')
      and data ->> 'timestamp' is not null
      and data ->> 'timestamp' != ''
      and data ->> 'user_id' is not null
      and data ->> 'episode_id' is not null
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'timestamp' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'event_type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        case 
            when (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}' then (data ->> 'timestamp')::timestamp
            else null
        end as event_ts,
        data ->> 'event_type'         as event_type,
        (data ->> 'duration')::integer as duration
    from valid_events
    where (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}'
)
select * from typed
  );
[0m14:06:35.948086 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m14:06:35.948265 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m14:06:35.948441 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m14:06:35.948652 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:06:35.948879 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:06:35.949071 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m14:06:35.949312 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */

  create view "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp"
    
    
  as (
    -- stg_user_events_invalid.sql : capture invalid event records for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

invalid_events as (
    select 
        data,
        data ->> 'user_id' as user_id,
        data ->> 'episode_id' as episode_id,
        data ->> 'timestamp' as timestamp,
        data ->> 'event_type' as event_type,
        data ->> 'duration' as duration,
        case 
            when data ->> 'event_type' is null then 'missing_event_type'
            when data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete') then 'invalid_event_type'
            when data ->> 'timestamp' is null or data ->> 'timestamp' = '' then 'missing_timestamp'
            when not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}') then 'malformed_timestamp'
            when data ->> 'user_id' is null then 'missing_user_id'
            when data ->> 'episode_id' is null then 'missing_episode_id'
            else 'other_issue'
        end as issue_type
    from source
    where data ->> 'event_type' is null 
       or data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete')
       or data ->> 'timestamp' is null 
       or data ->> 'timestamp' = ''
       or not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}')
       or data ->> 'user_id' is null
       or data ->> 'episode_id' is null
)

select * from invalid_events
  );
[0m14:06:35.952414 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:06:35.952598 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:06:35.955698 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:06:35.955883 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:06:35.956047 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:06:35.957428 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:06:35.957622 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m14:06:35.959040 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:06:35.960356 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:06:35.960548 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m14:06:35.960777 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m14:06:35.960979 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid" rename to "stg_user_events_invalid__dbt_backup"
[0m14:06:35.961863 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:06:35.962036 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:06:35.962199 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:06:35.962356 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:06:35.963551 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:06:35.965338 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:06:35.966497 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:06:35.967628 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:06:35.967821 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m14:06:35.968010 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m14:06:35.968198 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:06:35.968397 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp" rename to "stg_user_events_invalid"
[0m14:06:35.969432 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:06:35.969616 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:06:35.975909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m14:06:35.977089 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m14:06:35.977280 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m14:06:35.978090 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m14:06:35.978911 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m14:06:35.979108 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:06:35.979830 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m14:06:35.980019 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:06:35.980199 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:06:35.980377 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m14:06:35.980554 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:06:35.980729 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m14:06:35.980901 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m14:06:35.981109 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m14:06:35.983116 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:06:35.983304 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m14:06:35.985876 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m14:06:35.986060 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:06:35.986224 [debug] [Thread-2 (]: SQL status: COMMIT in 0.005 seconds
[0m14:06:35.987217 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup"
[0m14:06:35.989384 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:06:35.990358 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m14:06:35.991444 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m14:06:35.991871 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:06:35.992075 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m14:06:35.992481 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:06:35.992874 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:06:35.993075 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
drop view if exists "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup" cascade
[0m14:06:35.993304 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m14:06:35.993507 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m14:06:35.996150 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:06:35.997314 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m14:06:35.997503 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:06:35.997693 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:06:35.998788 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: Close
[0m14:06:35.999027 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:06:35.999561 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: Close
[0m14:06:35.999779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7294b6d7-293f-4974-a583-99317fbcda60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db4fe0>]}
[0m14:06:36.000036 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7294b6d7-293f-4974-a583-99317fbcda60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106482420>]}
[0m14:06:36.000559 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m14:06:36.000797 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7294b6d7-293f-4974-a583-99317fbcda60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667fe30>]}
[0m14:06:36.001106 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m14:06:36.001436 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_user_events_invalid ................ [[32mCREATE VIEW[0m in 0.11s]
[0m14:06:36.001712 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7294b6d7-293f-4974-a583-99317fbcda60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064d6e70>]}
[0m14:06:36.001983 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.11s]
[0m14:06:36.002260 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m14:06:36.002507 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m14:06:36.002764 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.11s]
[0m14:06:36.003020 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m14:06:36.003381 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m14:06:36.003787 [debug] [Thread-1 (]: Began running node model.podcast_analytics.int_user_sessions
[0m14:06:36.004039 [info ] [Thread-1 (]: 5 of 7 START sql view model public.int_user_sessions ........................... [RUN]
[0m14:06:36.004235 [debug] [Thread-3 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m14:06:36.004430 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.int_user_sessions)
[0m14:06:36.004656 [info ] [Thread-3 (]: 6 of 7 START sql view model public.mart_top_episodes ........................... [RUN]
[0m14:06:36.004854 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m14:06:36.005041 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now model.podcast_analytics.mart_top_episodes)
[0m14:06:36.008105 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m14:06:36.008560 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m14:06:36.011081 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m14:06:36.011417 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m14:06:36.011607 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m14:06:36.014132 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m14:06:36.053378 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m14:06:36.054022 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:06:36.054259 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:06:36.054469 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m14:06:36.054655 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m14:06:36.054833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:36.055015 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:06:36.065139 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:06:36.065352 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:06:36.065587 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end
    from numbered
    group by user_id, session_number
),

final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        extract(epoch from (session_end - session_start)) as session_duration
    from agg
)

select * from final
  );
[0m14:06:36.066607 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m14:06:36.066824 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:06:36.067039 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m14:06:36.070139 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:06:36.071636 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:06:36.071823 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:06:36.072022 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m14:06:36.073434 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:06:36.073737 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m14:06:36.074327 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:06:36.075313 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m14:06:36.075520 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:06:36.075712 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:06:36.076574 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m14:06:36.076809 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m14:06:36.077003 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:06:36.077228 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m14:06:36.078495 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:06:36.078688 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m14:06:36.079783 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m14:06:36.080742 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m14:06:36.081189 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:06:36.081575 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:06:36.081763 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m14:06:36.081956 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m14:06:36.082665 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:06:36.082851 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:06:36.083475 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m14:06:36.084013 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: Close
[0m14:06:36.084329 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7294b6d7-293f-4974-a583-99317fbcda60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106033680>]}
[0m14:06:36.084571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7294b6d7-293f-4974-a583-99317fbcda60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050de240>]}
[0m14:06:36.084892 [info ] [Thread-3 (]: 6 of 7 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:06:36.085182 [info ] [Thread-1 (]: 5 of 7 OK created sql view model public.int_user_sessions ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:06:36.085454 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m14:06:36.085699 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m14:06:36.086115 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m14:06:36.086356 [info ] [Thread-2 (]: 7 of 7 START sql view model public.mart_user_session_metrics ................... [RUN]
[0m14:06:36.086576 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now model.podcast_analytics.mart_user_session_metrics)
[0m14:06:36.086767 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m14:06:36.088080 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:06:36.088570 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m14:06:36.090158 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:06:36.090486 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:06:36.090673 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m14:06:36.091070 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:36.099602 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m14:06:36.099845 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:06:36.100062 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  create view "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
    
    
  as (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
[0m14:06:36.103878 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:06:36.105409 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:06:36.105608 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m14:06:36.106467 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:06:36.107151 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m14:06:36.107479 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:06:36.107718 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m14:06:36.109458 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:06:36.110660 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m14:06:36.111089 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:06:36.111278 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop view if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m14:06:36.112051 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:06:36.112650 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m14:06:36.112942 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7294b6d7-293f-4974-a583-99317fbcda60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066d7200>]}
[0m14:06:36.113261 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.mart_user_session_metrics .............. [[32mCREATE VIEW[0m in 0.03s]
[0m14:06:36.113536 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m14:06:36.114149 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:36.114327 [debug] [MainThread]: On master: BEGIN
[0m14:06:36.114479 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:36.123787 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:06:36.124016 [debug] [MainThread]: On master: COMMIT
[0m14:06:36.124346 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:36.124533 [debug] [MainThread]: On master: COMMIT
[0m14:06:36.125154 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:06:36.125694 [debug] [MainThread]: On master: Close
[0m14:06:36.126039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:36.126216 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m14:06:36.126368 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m14:06:36.126509 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m14:06:36.126649 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_users' was properly closed.
[0m14:06:36.126937 [info ] [MainThread]: 
[0m14:06:36.127136 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m14:06:36.127786 [debug] [MainThread]: Command end result
[0m14:06:36.141237 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:06:36.143053 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:06:36.146078 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:06:36.146266 [info ] [MainThread]: 
[0m14:06:36.146467 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:36.146628 [info ] [MainThread]: 
[0m14:06:36.146811 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m14:06:36.148326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.67705923, "process_in_blocks": "0", "process_kernel_time": 0.131379, "process_mem_max_rss": "131383296", "process_out_blocks": "0", "process_user_time": 1.144497}
[0m14:06:36.148571 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:36.148530 after 0.68 seconds
[0m14:06:36.148778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd4170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036b0bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d8e30>]}
[0m14:06:36.148977 [debug] [MainThread]: Flushing usage events
[0m14:06:36.590198 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:37.449137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10749d220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10790cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186f9520>]}


============================== 14:06:37.451467 | 9ecdb31d-0018-478f-a91c-261efcfe94b7 ==============================
[0m14:06:37.451467 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:06:37.451816 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir ..', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:37.536727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ecdb31d-0018-478f-a91c-261efcfe94b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10762ca40>]}
[0m14:06:37.563608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ecdb31d-0018-478f-a91c-261efcfe94b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11872a690>]}
[0m14:06:37.564217 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:06:37.623997 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:06:37.707343 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:37.707687 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:37.739281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ecdb31d-0018-478f-a91c-261efcfe94b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119465f70>]}
[0m14:06:37.789729 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:06:37.791010 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:06:37.804577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ecdb31d-0018-478f-a91c-261efcfe94b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11981aea0>]}
[0m14:06:37.804940 [info ] [MainThread]: Found 2 seeds, 7 models, 8 data tests, 3 sources, 549 macros
[0m14:06:37.805160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ecdb31d-0018-478f-a91c-261efcfe94b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186f97f0>]}
[0m14:06:37.806263 [info ] [MainThread]: 
[0m14:06:37.806490 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:06:37.806664 [info ] [MainThread]: 
[0m14:06:37.806957 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:06:37.809328 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m14:06:37.833245 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:06:37.833558 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:06:37.833740 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:38.005614 [debug] [ThreadPool]: SQL status: BEGIN in 0.172 seconds
[0m14:06:38.006088 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:06:38.006377 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:06:38.015549 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m14:06:38.016826 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:06:38.017827 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:06:38.024027 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:38.024389 [debug] [MainThread]: On master: BEGIN
[0m14:06:38.024594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:38.047629 [debug] [MainThread]: SQL status: BEGIN in 0.023 seconds
[0m14:06:38.048005 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:38.048359 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:06:38.056065 [debug] [MainThread]: SQL status: SELECT 7 in 0.007 seconds
[0m14:06:38.057652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ecdb31d-0018-478f-a91c-261efcfe94b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c30740>]}
[0m14:06:38.058010 [debug] [MainThread]: On master: ROLLBACK
[0m14:06:38.058751 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:38.058967 [debug] [MainThread]: On master: BEGIN
[0m14:06:38.059863 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:06:38.060066 [debug] [MainThread]: On master: COMMIT
[0m14:06:38.060261 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:38.060450 [debug] [MainThread]: On master: COMMIT
[0m14:06:38.060936 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:06:38.061139 [debug] [MainThread]: On master: Close
[0m14:06:38.062737 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:06:38.063030 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:06:38.063319 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:06:38.063534 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:06:38.063777 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m14:06:38.064064 [info ] [Thread-2 (]: 2 of 8 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [RUN]
[0m14:06:38.064340 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_episodes_episode_id ............................. [RUN]
[0m14:06:38.064606 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_user_events_event_id ............................ [RUN]
[0m14:06:38.064889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m14:06:38.065204 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7'
[0m14:06:38.065481 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422'
[0m14:06:38.065744 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7'
[0m14:06:38.065995 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:06:38.066232 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:06:38.066442 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:06:38.066648 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:06:38.078309 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:06:38.082347 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:06:38.087541 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:06:38.089452 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:06:38.090141 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:06:38.090422 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:06:38.090635 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:06:38.090865 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:06:38.100314 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:06:38.101725 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:06:38.103006 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:06:38.104174 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:06:38.104772 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:06:38.105029 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:06:38.105248 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:06:38.105510 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m14:06:38.105804 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: BEGIN
[0m14:06:38.106067 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:06:38.106290 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m14:06:38.106513 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:38.106744 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:06:38.106964 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m14:06:38.107183 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:06:38.107534 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:06:38.120368 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m14:06:38.120659 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:06:38.120900 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m14:06:38.123183 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m14:06:38.123406 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:06:38.123658 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','missing_timestamp','malformed_timestamp','missing_user_id','missing_episode_id','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m14:06:38.125343 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m14:06:38.125582 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m14:06:38.125830 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:06:38.126053 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:06:38.126280 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m14:06:38.126519 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m14:06:38.128785 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:06:38.131186 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m14:06:38.131836 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m14:06:38.132252 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_episodes_episode_id ................................... [[32mPASS[0m in 0.07s]
[0m14:06:38.132589 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:06:38.132838 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:06:38.133307 [info ] [Thread-3 (]: 5 of 8 START test not_null_stg_users_user_id ................................... [RUN]
[0m14:06:38.133977 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m14:06:38.134448 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:06:38.136841 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:06:38.137088 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.013 seconds
[0m14:06:38.137318 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m14:06:38.138715 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: ROLLBACK
[0m14:06:38.140243 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m14:06:38.141045 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:06:38.144382 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:06:38.144743 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: Close
[0m14:06:38.144997 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.018 seconds
[0m14:06:38.145215 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m14:06:38.146574 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m14:06:38.145714 [info ] [Thread-2 (]: 2 of 8 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [[32mPASS[0m in 0.08s]
[0m14:06:38.147454 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:06:38.147206 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.08s]
[0m14:06:38.147884 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:06:38.148155 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m14:06:38.148374 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m14:06:38.148681 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:06:38.148942 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:06:38.149459 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:06:38.149296 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_user_events_event_id .................................. [[32mPASS[0m in 0.08s]
[0m14:06:38.149771 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:06:38.150021 [info ] [Thread-2 (]: 6 of 8 START test unique_stg_episodes_episode_id ............................... [RUN]
[0m14:06:38.150482 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:06:38.150734 [info ] [Thread-1 (]: 7 of 8 START test unique_stg_user_events_event_id .............................. [RUN]
[0m14:06:38.151585 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m14:06:38.151913 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:06:38.152352 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m14:06:38.152628 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:06:38.152916 [info ] [Thread-4 (]: 8 of 8 START test unique_stg_users_user_id ..................................... [RUN]
[0m14:06:38.153203 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:06:38.157131 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:06:38.157475 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m14:06:38.162640 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:06:38.162975 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m14:06:38.163345 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:06:38.163693 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:06:38.164000 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:06:38.166160 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:06:38.166390 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:06:38.166647 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:06:38.168020 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:06:38.169354 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:06:38.169706 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:06:38.171234 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:06:38.171530 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:06:38.171772 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:06:38.172070 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: BEGIN
[0m14:06:38.172300 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:06:38.173189 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m14:06:38.173466 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:06:38.173704 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:06:38.173943 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: BEGIN
[0m14:06:38.174210 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m14:06:38.174511 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m14:06:38.174754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:38.175286 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:06:38.176225 [info ] [Thread-3 (]: 5 of 8 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.04s]
[0m14:06:38.177452 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:06:38.184938 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m14:06:38.185258 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m14:06:38.185496 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m14:06:38.185762 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:06:38.186002 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:06:38.186242 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:06:38.186493 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:06:38.186755 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:06:38.187012 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_user_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:06:38.188196 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:06:38.188444 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:06:38.189469 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m14:06:38.190447 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: ROLLBACK
[0m14:06:38.191214 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: Close
[0m14:06:38.191487 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m14:06:38.192250 [info ] [Thread-2 (]: 6 of 8 PASS unique_stg_episodes_episode_id ..................................... [[32mPASS[0m in 0.04s]
[0m14:06:38.193830 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:06:38.192976 [info ] [Thread-4 (]: 8 of 8 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.04s]
[0m14:06:38.194542 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:06:38.211466 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.024 seconds
[0m14:06:38.212571 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: ROLLBACK
[0m14:06:38.213188 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: Close
[0m14:06:38.213623 [info ] [Thread-1 (]: 7 of 8 PASS unique_stg_user_events_event_id .................................... [[32mPASS[0m in 0.06s]
[0m14:06:38.213999 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:06:38.214844 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:38.215048 [debug] [MainThread]: On master: BEGIN
[0m14:06:38.215232 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:06:38.221758 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:06:38.222034 [debug] [MainThread]: On master: COMMIT
[0m14:06:38.222265 [debug] [MainThread]: Using postgres connection "master"
[0m14:06:38.222451 [debug] [MainThread]: On master: COMMIT
[0m14:06:38.222866 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:06:38.223101 [debug] [MainThread]: On master: Close
[0m14:06:38.223369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:38.223554 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m14:06:38.223728 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16' was properly closed.
[0m14:06:38.223900 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m14:06:38.224075 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m14:06:38.224290 [info ] [MainThread]: 
[0m14:06:38.224512 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.42 seconds (0.42s).
[0m14:06:38.225813 [debug] [MainThread]: Command end result
[0m14:06:38.354465 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:06:38.355699 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:06:38.359769 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:06:38.360027 [info ] [MainThread]: 
[0m14:06:38.360271 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:38.360468 [info ] [MainThread]: 
[0m14:06:38.360680 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m14:06:38.362725 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.9515667, "process_in_blocks": "0", "process_kernel_time": 0.157073, "process_mem_max_rss": "129351680", "process_out_blocks": "0", "process_user_time": 1.20207}
[0m14:06:38.363015 [debug] [MainThread]: Command `dbt test` succeeded at 14:06:38.362968 after 0.95 seconds
[0m14:06:38.363257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11878f440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a88140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bc0e0>]}
[0m14:06:38.363494 [debug] [MainThread]: Flushing usage events
[0m14:06:38.718721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:48.015699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f9e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099fd640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099fcf80>]}


============================== 14:07:48.020082 | af45d7f8-a83e-428b-b02b-d1768e02ecbb ==============================
[0m14:07:48.020082 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:07:48.021006 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '..', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps --profiles-dir ..', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:07:48.140707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af45d7f8-a83e-428b-b02b-d1768e02ecbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930c530>]}
[0m14:07:48.177780 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-8ve321cj'
[0m14:07:48.178190 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:07:48.432736 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:07:48.433432 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:07:48.516498 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:07:48.519077 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:07:48.763204 [info ] [MainThread]: Installed from version 1.3.0
[0m14:07:48.763924 [info ] [MainThread]: Up to date!
[0m14:07:48.764352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'af45d7f8-a83e-428b-b02b-d1768e02ecbb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bb1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bb2510>]}
[0m14:07:48.766999 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.86409724, "process_in_blocks": "0", "process_kernel_time": 0.194248, "process_mem_max_rss": "112934912", "process_out_blocks": "0", "process_user_time": 0.894727}
[0m14:07:48.767369 [debug] [MainThread]: Command `dbt deps` succeeded at 14:07:48.767303 after 0.86 seconds
[0m14:07:48.767637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107973ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10723d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10930c530>]}
[0m14:07:48.767881 [debug] [MainThread]: Flushing usage events
[0m14:07:49.203293 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:50.374120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f57980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd57f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fd51f0>]}


============================== 14:07:50.377691 | d0223c23-e708-435a-8589-d0860c580ff6 ==============================
[0m14:07:50.377691 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:07:50.378174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt seed --profiles-dir ..', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:07:50.491433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0223c23-e708-435a-8589-d0860c580ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070686e0>]}
[0m14:07:50.524183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0223c23-e708-435a-8589-d0860c580ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706a4b0>]}
[0m14:07:50.525993 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:07:50.596766 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:07:50.690374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:07:50.690894 [debug] [MainThread]: Partial parsing: updated file: podcast_analytics://models/2.intermediate/int_user_sessions.sql
[0m14:07:50.844540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0223c23-e708-435a-8589-d0860c580ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2c4a0>]}
[0m14:07:50.900916 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:07:50.902680 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:07:50.913364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0223c23-e708-435a-8589-d0860c580ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc2090>]}
[0m14:07:50.913752 [info ] [MainThread]: Found 2 seeds, 7 models, 8 data tests, 3 sources, 549 macros
[0m14:07:50.914004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0223c23-e708-435a-8589-d0860c580ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcda90>]}
[0m14:07:50.915293 [info ] [MainThread]: 
[0m14:07:50.915620 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:07:50.915841 [info ] [MainThread]: 
[0m14:07:50.916179 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:07:50.918315 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m14:07:50.951728 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m14:07:50.952057 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:07:50.952263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:50.985115 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m14:07:50.986062 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m14:07:50.987096 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m14:07:50.990675 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:07:50.990932 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:07:50.991124 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:50.998231 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:07:50.998521 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:07:50.998744 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:07:51.001478 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m14:07:51.002328 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:07:51.002800 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:07:51.006149 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:51.006364 [debug] [MainThread]: On master: BEGIN
[0m14:07:51.006538 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:51.014749 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:07:51.015090 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:51.015380 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:07:51.019899 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m14:07:51.021321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0223c23-e708-435a-8589-d0860c580ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6d7f0>]}
[0m14:07:51.021630 [debug] [MainThread]: On master: ROLLBACK
[0m14:07:51.022109 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:51.022340 [debug] [MainThread]: On master: BEGIN
[0m14:07:51.022960 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:07:51.023159 [debug] [MainThread]: On master: COMMIT
[0m14:07:51.023345 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:51.023534 [debug] [MainThread]: On master: COMMIT
[0m14:07:51.024001 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:07:51.024416 [debug] [MainThread]: On master: Close
[0m14:07:51.026800 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m14:07:51.027068 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m14:07:51.027409 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m14:07:51.027746 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m14:07:51.028050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m14:07:51.028344 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m14:07:51.028578 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m14:07:51.028797 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m14:07:51.029018 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m14:07:51.029231 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m14:07:51.047520 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:07:51.048255 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m14:07:51.048498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:51.050552 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:07:51.050879 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m14:07:51.051088 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:07:51.059464 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m14:07:51.059800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m14:07:51.060209 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:07:51.060499 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:07:51.060781 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m14:07:51.061026 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m14:07:51.063225 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m14:07:51.069790 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.008 seconds
[0m14:07:51.163678 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:07:51.173471 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:07:51.173760 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m14:07:51.174015 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m14:07:51.176991 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.002 seconds
[0m14:07:51.177273 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.003 seconds
[0m14:07:51.180503 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m14:07:51.180925 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m14:07:51.189184 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m14:07:51.189508 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m14:07:51.189745 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:07:51.189958 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:07:51.190161 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m14:07:51.190363 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m14:07:51.194560 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m14:07:51.194785 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:07:51.195825 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m14:07:51.196229 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m14:07:51.197930 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0223c23-e708-435a-8589-d0860c580ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cc2870>]}
[0m14:07:51.198151 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd0223c23-e708-435a-8589-d0860c580ff6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108411400>]}
[0m14:07:51.198477 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.17s]
[0m14:07:51.198784 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.17s]
[0m14:07:51.199105 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m14:07:51.199388 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m14:07:51.200164 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:51.200358 [debug] [MainThread]: On master: BEGIN
[0m14:07:51.200530 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:51.212271 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m14:07:51.212609 [debug] [MainThread]: On master: COMMIT
[0m14:07:51.212805 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:51.212975 [debug] [MainThread]: On master: COMMIT
[0m14:07:51.213638 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:07:51.213818 [debug] [MainThread]: On master: Close
[0m14:07:51.214076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:51.214240 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m14:07:51.214401 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m14:07:51.214594 [info ] [MainThread]: 
[0m14:07:51.214796 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m14:07:51.215228 [debug] [MainThread]: Command end result
[0m14:07:51.230305 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:07:51.231617 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:07:51.234816 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:07:51.235040 [info ] [MainThread]: 
[0m14:07:51.235291 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:51.235483 [info ] [MainThread]: 
[0m14:07:51.235687 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:07:51.237402 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.90542, "process_in_blocks": "0", "process_kernel_time": 0.192374, "process_mem_max_rss": "136462336", "process_out_blocks": "0", "process_user_time": 1.510226}
[0m14:07:51.237714 [debug] [MainThread]: Command `dbt seed` succeeded at 14:07:51.237662 after 0.91 seconds
[0m14:07:51.237966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f57980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fcdd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b830e0>]}
[0m14:07:51.238197 [debug] [MainThread]: Flushing usage events
[0m14:07:51.625948 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:52.982727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ec9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125f5a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125f53d0>]}


============================== 14:07:52.985486 | 65d1e83e-bb36-47ac-bc58-57fb2c21502e ==============================
[0m14:07:52.985486 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:07:52.985934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir ..', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:53.108290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65d1e83e-bb36-47ac-bc58-57fb2c21502e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f00b0>]}
[0m14:07:53.144268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65d1e83e-bb36-47ac-bc58-57fb2c21502e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d025a0>]}
[0m14:07:53.145117 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:07:53.221304 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:07:53.311004 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:07:53.311419 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:07:53.348177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65d1e83e-bb36-47ac-bc58-57fb2c21502e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f0740>]}
[0m14:07:53.416499 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:07:53.418514 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:07:53.435351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65d1e83e-bb36-47ac-bc58-57fb2c21502e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113291670>]}
[0m14:07:53.435821 [info ] [MainThread]: Found 2 seeds, 7 models, 8 data tests, 3 sources, 549 macros
[0m14:07:53.436090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65d1e83e-bb36-47ac-bc58-57fb2c21502e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113411070>]}
[0m14:07:53.437433 [info ] [MainThread]: 
[0m14:07:53.437715 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:07:53.437931 [info ] [MainThread]: 
[0m14:07:53.438285 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:07:53.440824 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m14:07:53.470564 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m14:07:53.470942 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:07:53.471177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:53.496336 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.025 seconds
[0m14:07:53.497271 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m14:07:53.498223 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m14:07:53.501577 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:07:53.501820 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:07:53.502009 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:07:53.512493 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:07:53.512717 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:07:53.512921 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:07:53.516841 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m14:07:53.517600 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:07:53.518427 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:07:53.521491 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:53.521688 [debug] [MainThread]: On master: BEGIN
[0m14:07:53.521860 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:53.530264 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:07:53.530540 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:53.530815 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:07:53.536592 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m14:07:53.537920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65d1e83e-bb36-47ac-bc58-57fb2c21502e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113432f90>]}
[0m14:07:53.538223 [debug] [MainThread]: On master: ROLLBACK
[0m14:07:53.538985 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:53.539170 [debug] [MainThread]: On master: BEGIN
[0m14:07:53.540170 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:07:53.540354 [debug] [MainThread]: On master: COMMIT
[0m14:07:53.540534 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:53.540701 [debug] [MainThread]: On master: COMMIT
[0m14:07:53.541227 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:07:53.541398 [debug] [MainThread]: On master: Close
[0m14:07:53.542863 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m14:07:53.543119 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m14:07:53.543340 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m14:07:53.543568 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m14:07:53.543904 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_episodes ................................ [RUN]
[0m14:07:53.544183 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_user_events ............................. [RUN]
[0m14:07:53.544437 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_user_events_invalid ..................... [RUN]
[0m14:07:53.544728 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_users ................................... [RUN]
[0m14:07:53.544998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m14:07:53.545258 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m14:07:53.545501 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m14:07:53.545730 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m14:07:53.545928 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m14:07:53.546116 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m14:07:53.546306 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m14:07:53.546492 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m14:07:53.550652 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m14:07:53.559865 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m14:07:53.561710 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:07:53.563052 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m14:07:53.564388 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m14:07:53.564615 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m14:07:53.564841 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m14:07:53.565036 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m14:07:53.584651 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:07:53.586661 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m14:07:53.588520 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m14:07:53.590295 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m14:07:53.590954 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:07:53.591223 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:07:53.591480 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:07:53.591725 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m14:07:53.591957 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: BEGIN
[0m14:07:53.592180 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:07:53.592466 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m14:07:53.592801 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:07:53.593047 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:07:53.593283 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: BEGIN
[0m14:07:53.593510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:53.593904 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:07:53.607218 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m14:07:53.607495 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:07:53.607730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m14:07:53.607937 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m14:07:53.608222 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */

  create view "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp"
    
    
  as (
    -- stg_user_events_invalid.sql : capture invalid event records for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

invalid_events as (
    select 
        data,
        data ->> 'user_id' as user_id,
        data ->> 'episode_id' as episode_id,
        data ->> 'timestamp' as timestamp,
        data ->> 'event_type' as event_type,
        data ->> 'duration' as duration,
        case 
            when data ->> 'event_type' is null then 'missing_event_type'
            when data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete') then 'invalid_event_type'
            when data ->> 'timestamp' is null or data ->> 'timestamp' = '' then 'missing_timestamp'
            when not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}') then 'malformed_timestamp'
            when data ->> 'user_id' is null then 'missing_user_id'
            when data ->> 'episode_id' is null then 'missing_episode_id'
            else 'other_issue'
        end as issue_type
    from source
    where data ->> 'event_type' is null 
       or data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete')
       or data ->> 'timestamp' is null 
       or data ->> 'timestamp' = ''
       or not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}')
       or data ->> 'user_id' is null
       or data ->> 'episode_id' is null
)

select * from invalid_events
  );
[0m14:07:53.608504 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m14:07:53.608727 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:07:53.608945 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:07:53.609237 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:07:53.609476 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m14:07:53.609722 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m14:07:53.610005 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
-- Note: Invalid events are captured in stg_user_events_invalid.sql for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

valid_events as (
    select * from source
    where data ->> 'event_type' is not null
      and data ->> 'event_type' in ('play', 'pause', 'seek', 'complete')
      and data ->> 'timestamp' is not null
      and data ->> 'timestamp' != ''
      and data ->> 'user_id' is not null
      and data ->> 'episode_id' is not null
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'timestamp' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'event_type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        case 
            when (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}' then (data ->> 'timestamp')::timestamp
            else null
        end as event_ts,
        data ->> 'event_type'         as event_type,
        (data ->> 'duration')::integer as duration
    from valid_events
    where (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}'
)
select * from typed
  );
[0m14:07:53.612823 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:07:53.613040 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:07:53.613251 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:07:53.616857 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:07:53.617071 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m14:07:53.618674 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:07:53.620171 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:07:53.620397 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m14:07:53.621860 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:07:53.622085 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m14:07:53.622310 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid" rename to "stg_user_events_invalid__dbt_backup"
[0m14:07:53.622571 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m14:07:53.623819 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:07:53.624036 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:07:53.625489 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:07:53.625710 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:07:53.625972 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:07:53.627605 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:07:53.627848 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m14:07:53.630015 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:07:53.631393 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:07:53.631623 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:07:53.631894 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp" rename to "stg_user_events_invalid"
[0m14:07:53.632129 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m14:07:53.632994 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:07:53.639584 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.007 seconds
[0m14:07:53.641811 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m14:07:53.642052 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m14:07:53.642249 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.010 seconds
[0m14:07:53.643210 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m14:07:53.643452 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:07:53.644431 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m14:07:53.645274 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m14:07:53.645498 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:07:53.645707 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m14:07:53.645916 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:07:53.646123 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:07:53.646325 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m14:07:53.646569 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m14:07:53.646791 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m14:07:53.649703 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:07:53.652854 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m14:07:53.653074 [debug] [Thread-4 (]: SQL status: COMMIT in 0.006 seconds
[0m14:07:53.653282 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m14:07:53.653475 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m14:07:53.655923 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:07:53.657126 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m14:07:53.658338 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m14:07:53.659450 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup"
[0m14:07:53.659693 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m14:07:53.660183 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:07:53.660657 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:07:53.661113 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:07:53.661378 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m14:07:53.661615 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m14:07:53.661843 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
drop view if exists "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup" cascade
[0m14:07:53.664846 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:07:53.665074 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:07:53.666378 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: Close
[0m14:07:53.666597 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:07:53.666792 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:07:53.667440 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m14:07:53.668179 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: Close
[0m14:07:53.669522 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m14:07:53.669933 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d1e83e-bb36-47ac-bc58-57fb2c21502e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e22750>]}
[0m14:07:53.670200 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d1e83e-bb36-47ac-bc58-57fb2c21502e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11389ff20>]}
[0m14:07:53.670409 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d1e83e-bb36-47ac-bc58-57fb2c21502e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113d0a40>]}
[0m14:07:53.670687 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d1e83e-bb36-47ac-bc58-57fb2c21502e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137d2240>]}
[0m14:07:53.671049 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.12s]
[0m14:07:53.671407 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_user_events_invalid ................ [[32mCREATE VIEW[0m in 0.12s]
[0m14:07:53.671729 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.12s]
[0m14:07:53.672085 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.13s]
[0m14:07:53.672423 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m14:07:53.672716 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m14:07:53.672990 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m14:07:53.673267 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m14:07:53.673831 [debug] [Thread-4 (]: Began running node model.podcast_analytics.int_user_sessions
[0m14:07:53.674059 [debug] [Thread-3 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m14:07:53.674348 [info ] [Thread-4 (]: 5 of 7 START sql view model public.int_user_sessions ........................... [RUN]
[0m14:07:53.674622 [info ] [Thread-3 (]: 6 of 7 START sql view model public.mart_top_episodes ........................... [RUN]
[0m14:07:53.674874 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_users, now model.podcast_analytics.int_user_sessions)
[0m14:07:53.675097 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now model.podcast_analytics.mart_top_episodes)
[0m14:07:53.675316 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m14:07:53.675527 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m14:07:53.678449 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m14:07:53.681463 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m14:07:53.682228 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m14:07:53.682462 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m14:07:53.685433 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m14:07:53.724718 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m14:07:53.725338 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:07:53.725585 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:07:53.725824 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m14:07:53.726138 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m14:07:53.726352 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:07:53.726552 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:07:53.737275 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m14:07:53.737537 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m14:07:53.737775 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:07:53.737990 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:07:53.738231 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m14:07:53.738514 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end,
        sum(coalesce(duration, 0)) as total_listening_duration
    from numbered
    group by user_id, session_number
),

final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        total_listening_duration as session_duration
    from agg
)

select * from final
  );
[0m14:07:53.742174 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:07:53.743995 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:07:53.744308 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:07:53.744530 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m14:07:53.745985 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:07:53.746237 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m14:07:53.747119 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:07:53.747325 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:07:53.748074 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m14:07:53.748794 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m14:07:53.749016 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:07:53.749224 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:07:53.749423 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m14:07:53.749614 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m14:07:53.751205 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:07:53.752264 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m14:07:53.752460 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m14:07:53.752886 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:07:53.753904 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m14:07:53.754117 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m14:07:53.754587 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:07:53.754946 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m14:07:53.755975 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:07:53.756193 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:07:53.756867 [debug] [Thread-4 (]: On model.podcast_analytics.int_user_sessions: Close
[0m14:07:53.757476 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m14:07:53.757830 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d1e83e-bb36-47ac-bc58-57fb2c21502e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132fd520>]}
[0m14:07:53.758092 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d1e83e-bb36-47ac-bc58-57fb2c21502e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132e14c0>]}
[0m14:07:53.758463 [info ] [Thread-4 (]: 5 of 7 OK created sql view model public.int_user_sessions ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:07:53.758784 [info ] [Thread-3 (]: 6 of 7 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:07:53.759193 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m14:07:53.759485 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m14:07:53.759843 [debug] [Thread-3 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m14:07:53.760141 [info ] [Thread-3 (]: 7 of 7 START sql view model public.mart_user_session_metrics ................... [RUN]
[0m14:07:53.760391 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.mart_top_episodes, now model.podcast_analytics.mart_user_session_metrics)
[0m14:07:53.760603 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m14:07:53.762067 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:07:53.762807 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m14:07:53.764859 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:07:53.766108 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:07:53.766382 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m14:07:53.766585 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:07:53.777399 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m14:07:53.777819 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:07:53.778067 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  create view "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
    
    
  as (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
[0m14:07:53.781606 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:07:53.783287 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:07:53.783507 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m14:07:53.784395 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:07:53.785143 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m14:07:53.785348 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:07:53.785540 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m14:07:53.786924 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:07:53.788012 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m14:07:53.788441 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:07:53.788648 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop view if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m14:07:53.789624 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:07:53.790264 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m14:07:53.790586 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65d1e83e-bb36-47ac-bc58-57fb2c21502e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11388ffb0>]}
[0m14:07:53.790932 [info ] [Thread-3 (]: 7 of 7 OK created sql view model public.mart_user_session_metrics .............. [[32mCREATE VIEW[0m in 0.03s]
[0m14:07:53.791247 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m14:07:53.791958 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:53.792173 [debug] [MainThread]: On master: BEGIN
[0m14:07:53.792349 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:53.801991 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m14:07:53.802276 [debug] [MainThread]: On master: COMMIT
[0m14:07:53.802465 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:53.802637 [debug] [MainThread]: On master: COMMIT
[0m14:07:53.803409 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:07:53.803582 [debug] [MainThread]: On master: Close
[0m14:07:53.803828 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:53.803994 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_episodes' was properly closed.
[0m14:07:53.804152 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_user_events' was properly closed.
[0m14:07:53.804307 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m14:07:53.804459 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m14:07:53.804693 [info ] [MainThread]: 
[0m14:07:53.804897 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m14:07:53.805576 [debug] [MainThread]: Command end result
[0m14:07:53.820665 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:07:53.821789 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:07:53.824984 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:07:53.825190 [info ] [MainThread]: 
[0m14:07:53.825409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:53.825594 [info ] [MainThread]: 
[0m14:07:53.825793 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m14:07:53.827983 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8909851, "process_in_blocks": "0", "process_kernel_time": 0.196971, "process_mem_max_rss": "131465216", "process_out_blocks": "0", "process_user_time": 1.586812}
[0m14:07:53.828314 [debug] [MainThread]: Command `dbt run` succeeded at 14:07:53.828262 after 0.89 seconds
[0m14:07:53.828555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113796f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119883b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138a1cd0>]}
[0m14:07:53.828803 [debug] [MainThread]: Flushing usage events
[0m14:07:54.345963 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:55.326169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10679f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f9b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f9550>]}


============================== 14:07:55.328745 | 824cfd28-54bb-401e-a0bf-6b72814166ed ==============================
[0m14:07:55.328745 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:07:55.329115 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir ..', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:07:55.413111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '824cfd28-54bb-401e-a0bf-6b72814166ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102f4620>]}
[0m14:07:55.445683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '824cfd28-54bb-401e-a0bf-6b72814166ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102a5010>]}
[0m14:07:55.446393 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:07:55.503995 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:07:55.578378 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:07:55.578736 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:07:55.607121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '824cfd28-54bb-401e-a0bf-6b72814166ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d15bb0>]}
[0m14:07:55.654482 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:07:55.655749 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:07:55.669320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '824cfd28-54bb-401e-a0bf-6b72814166ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d15af0>]}
[0m14:07:55.669674 [info ] [MainThread]: Found 2 seeds, 7 models, 8 data tests, 3 sources, 549 macros
[0m14:07:55.669889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '824cfd28-54bb-401e-a0bf-6b72814166ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11019c5c0>]}
[0m14:07:55.670981 [info ] [MainThread]: 
[0m14:07:55.671199 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:07:55.671376 [info ] [MainThread]: 
[0m14:07:55.671673 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:07:55.673789 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m14:07:55.697211 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:07:55.697510 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:07:55.697696 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:55.719917 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m14:07:55.720257 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:07:55.720469 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:07:55.724462 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m14:07:55.725283 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:07:55.726048 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:07:55.729697 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:55.729935 [debug] [MainThread]: On master: BEGIN
[0m14:07:55.730104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:55.737836 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:07:55.738024 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:55.738250 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:07:55.744268 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m14:07:55.745559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '824cfd28-54bb-401e-a0bf-6b72814166ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11073ef60>]}
[0m14:07:55.745834 [debug] [MainThread]: On master: ROLLBACK
[0m14:07:55.746650 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:55.746815 [debug] [MainThread]: On master: BEGIN
[0m14:07:55.747707 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:07:55.747874 [debug] [MainThread]: On master: COMMIT
[0m14:07:55.748033 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:55.748188 [debug] [MainThread]: On master: COMMIT
[0m14:07:55.748681 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:07:55.748913 [debug] [MainThread]: On master: Close
[0m14:07:55.750312 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:07:55.750563 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:07:55.750956 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:07:55.750785 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m14:07:55.751223 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:07:55.751440 [info ] [Thread-2 (]: 2 of 8 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [RUN]
[0m14:07:55.751648 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_episodes_episode_id ............................. [RUN]
[0m14:07:55.751893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m14:07:55.752110 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_user_events_event_id ............................ [RUN]
[0m14:07:55.752376 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7'
[0m14:07:55.752607 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422'
[0m14:07:55.752804 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:07:55.753024 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7'
[0m14:07:55.753225 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:07:55.753411 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:07:55.765265 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:07:55.765787 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:07:55.769514 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:07:55.774232 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:07:55.776102 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:07:55.776508 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:07:55.777040 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:07:55.782981 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:07:55.786036 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:07:55.786285 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:07:55.787521 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:07:55.788702 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:07:55.789916 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:07:55.790270 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:07:55.790644 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:07:55.790893 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m14:07:55.791105 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:07:55.791317 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:07:55.791535 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: BEGIN
[0m14:07:55.791762 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:55.791966 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m14:07:55.792167 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m14:07:55.792376 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:07:55.792653 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:07:55.792846 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:07:55.807142 [debug] [Thread-2 (]: SQL status: BEGIN in 0.015 seconds
[0m14:07:55.807386 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m14:07:55.807654 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:07:55.807888 [debug] [Thread-3 (]: SQL status: BEGIN in 0.015 seconds
[0m14:07:55.808098 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:07:55.808297 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m14:07:55.808546 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','missing_timestamp','malformed_timestamp','missing_user_id','missing_episode_id','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m14:07:55.808784 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:07:55.809007 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m14:07:55.809224 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:07:55.809472 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m14:07:55.809736 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m14:07:55.812231 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:07:55.814479 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m14:07:55.815243 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m14:07:55.815592 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_episodes_episode_id ................................... [[32mPASS[0m in 0.06s]
[0m14:07:55.815899 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:07:55.816126 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:07:55.816377 [info ] [Thread-3 (]: 5 of 8 START test not_null_stg_users_user_id ................................... [RUN]
[0m14:07:55.816629 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m14:07:55.816832 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:07:55.818891 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:07:55.819295 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:07:55.820451 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:07:55.820789 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:07:55.820982 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m14:07:55.821165 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:07:55.825852 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m14:07:55.826109 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m14:07:55.827497 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: ROLLBACK
[0m14:07:55.829616 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m14:07:55.830404 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.020 seconds
[0m14:07:55.830642 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m14:07:55.830890 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: Close
[0m14:07:55.831628 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m14:07:55.831855 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m14:07:55.832252 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.08s]
[0m14:07:55.832901 [info ] [Thread-2 (]: 2 of 8 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [[32mPASS[0m in 0.08s]
[0m14:07:55.833345 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:07:55.833696 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:07:55.833901 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m14:07:55.834187 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:07:55.834424 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:07:55.834667 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:07:55.834939 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:07:55.835196 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_user_events_event_id .................................. [[32mPASS[0m in 0.08s]
[0m14:07:55.835491 [info ] [Thread-1 (]: 6 of 8 START test unique_stg_episodes_episode_id ............................... [RUN]
[0m14:07:55.835723 [info ] [Thread-2 (]: 7 of 8 START test unique_stg_user_events_event_id .............................. [RUN]
[0m14:07:55.836007 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:07:55.836239 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:07:55.836471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m14:07:55.836708 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m14:07:55.836948 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:07:55.837747 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m14:07:55.837974 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:07:55.838182 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:07:55.838393 [info ] [Thread-4 (]: 8 of 8 START test unique_stg_users_user_id ..................................... [RUN]
[0m14:07:55.842447 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:07:55.842691 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m14:07:55.847688 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:07:55.848091 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m14:07:55.848541 [info ] [Thread-3 (]: 5 of 8 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m14:07:55.848893 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:07:55.849222 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:07:55.849442 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:07:55.851647 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:07:55.851896 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:07:55.853231 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:07:55.854562 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:07:55.854923 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:07:55.856488 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:07:55.856851 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:07:55.857083 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:07:55.857328 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: BEGIN
[0m14:07:55.857546 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:07:55.857782 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: BEGIN
[0m14:07:55.858010 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:55.858226 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m14:07:55.858440 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:55.858718 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:07:55.868766 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m14:07:55.869076 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m14:07:55.869322 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m14:07:55.869588 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:07:55.869828 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:07:55.870055 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:07:55.870299 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:07:55.870554 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_user_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:07:55.870801 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:07:55.872033 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:07:55.872257 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:07:55.873164 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: ROLLBACK
[0m14:07:55.873861 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m14:07:55.874427 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: Close
[0m14:07:55.874650 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m14:07:55.875003 [info ] [Thread-1 (]: 6 of 8 PASS unique_stg_episodes_episode_id ..................................... [[32mPASS[0m in 0.04s]
[0m14:07:55.875518 [info ] [Thread-4 (]: 8 of 8 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.03s]
[0m14:07:55.876111 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:07:55.876422 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:07:55.891793 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.021 seconds
[0m14:07:55.892750 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: ROLLBACK
[0m14:07:55.893582 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: Close
[0m14:07:55.894032 [info ] [Thread-2 (]: 7 of 8 PASS unique_stg_user_events_event_id .................................... [[32mPASS[0m in 0.06s]
[0m14:07:55.894517 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:07:55.895880 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:55.896215 [debug] [MainThread]: On master: BEGIN
[0m14:07:55.896404 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:07:55.902861 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:07:55.903123 [debug] [MainThread]: On master: COMMIT
[0m14:07:55.903316 [debug] [MainThread]: Using postgres connection "master"
[0m14:07:55.903486 [debug] [MainThread]: On master: COMMIT
[0m14:07:55.903872 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:07:55.904052 [debug] [MainThread]: On master: Close
[0m14:07:55.904302 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:55.904473 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16' was properly closed.
[0m14:07:55.904635 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m14:07:55.904792 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m14:07:55.904943 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m14:07:55.905139 [info ] [MainThread]: 
[0m14:07:55.905352 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m14:07:55.906102 [debug] [MainThread]: Command end result
[0m14:07:55.966892 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:07:55.968510 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:07:55.972472 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:07:55.972699 [info ] [MainThread]: 
[0m14:07:55.972921 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:55.973101 [info ] [MainThread]: 
[0m14:07:55.973298 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m14:07:55.975198 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.683614, "process_in_blocks": "0", "process_kernel_time": 0.146433, "process_mem_max_rss": "132382720", "process_out_blocks": "0", "process_user_time": 1.223401}
[0m14:07:55.975486 [debug] [MainThread]: Command `dbt test` succeeded at 14:07:55.975440 after 0.68 seconds
[0m14:07:55.975727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb8170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106771fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113a3fb0>]}
[0m14:07:55.975961 [debug] [MainThread]: Flushing usage events
[0m14:07:56.690329 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:05.642141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e27e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d54c0>]}


============================== 14:08:05.645487 | 4ea892f8-e774-4792-a4d2-9880c963dc2e ==============================
[0m14:08:05.645487 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:08:05.645894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --profiles-dir ..', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:05.739926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ea892f8-e774-4792-a4d2-9880c963dc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a853d0>]}
[0m14:08:05.768644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ea892f8-e774-4792-a4d2-9880c963dc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3ff80>]}
[0m14:08:05.769574 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:08:05.831163 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:08:05.911715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:08:05.912050 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:08:05.939912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ea892f8-e774-4792-a4d2-9880c963dc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075f05c0>]}
[0m14:08:05.987127 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:08:05.989063 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:08:06.000848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ea892f8-e774-4792-a4d2-9880c963dc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ad0a70>]}
[0m14:08:06.001173 [info ] [MainThread]: Found 2 seeds, 7 models, 8 data tests, 3 sources, 549 macros
[0m14:08:06.001406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ea892f8-e774-4792-a4d2-9880c963dc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107865730>]}
[0m14:08:06.002429 [info ] [MainThread]: 
[0m14:08:06.002649 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:08:06.002824 [info ] [MainThread]: 
[0m14:08:06.003107 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:08:06.004957 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m14:08:06.037736 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m14:08:06.038059 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:08:06.038256 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:06.062959 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.025 seconds
[0m14:08:06.063850 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m14:08:06.064797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m14:08:06.068380 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:08:06.068636 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:08:06.068812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:06.078986 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m14:08:06.079244 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:08:06.079435 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:08:06.085044 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m14:08:06.085819 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:08:06.086399 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:08:06.089388 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:06.089593 [debug] [MainThread]: On master: BEGIN
[0m14:08:06.089759 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:06.101706 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m14:08:06.102037 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:06.102299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:08:06.106520 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m14:08:06.107829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ea892f8-e774-4792-a4d2-9880c963dc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104570ec0>]}
[0m14:08:06.108110 [debug] [MainThread]: On master: ROLLBACK
[0m14:08:06.108536 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:06.108731 [debug] [MainThread]: On master: BEGIN
[0m14:08:06.109252 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:08:06.109437 [debug] [MainThread]: On master: COMMIT
[0m14:08:06.109611 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:06.109779 [debug] [MainThread]: On master: COMMIT
[0m14:08:06.110116 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:08:06.110303 [debug] [MainThread]: On master: Close
[0m14:08:06.112077 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m14:08:06.112302 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m14:08:06.112610 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m14:08:06.112911 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m14:08:06.113180 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m14:08:06.113450 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m14:08:06.113668 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m14:08:06.113869 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m14:08:06.114076 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m14:08:06.114275 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m14:08:06.132323 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:08:06.133698 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m14:08:06.135068 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:08:06.135270 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:06.135477 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m14:08:06.135763 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:08:06.142773 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m14:08:06.143029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:08:06.143272 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:08:06.143480 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:08:06.143690 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m14:08:06.143901 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m14:08:06.145979 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m14:08:06.152498 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.008 seconds
[0m14:08:06.186565 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:08:06.205726 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m14:08:06.213881 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:08:06.214126 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m14:08:06.215618 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.003 seconds
[0m14:08:06.218869 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m14:08:06.219115 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.005 seconds
[0m14:08:06.219555 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m14:08:06.228011 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m14:08:06.228382 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m14:08:06.228618 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:08:06.228836 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:08:06.229040 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m14:08:06.229240 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m14:08:06.232471 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:08:06.232717 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m14:08:06.233788 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m14:08:06.234160 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m14:08:06.274581 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ea892f8-e774-4792-a4d2-9880c963dc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f6e960>]}
[0m14:08:06.274848 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ea892f8-e774-4792-a4d2-9880c963dc2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105caccb0>]}
[0m14:08:06.275211 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.12s]
[0m14:08:06.275530 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.12s]
[0m14:08:06.275877 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m14:08:06.276167 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m14:08:06.276887 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:06.277075 [debug] [MainThread]: On master: BEGIN
[0m14:08:06.277237 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:06.287820 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m14:08:06.288125 [debug] [MainThread]: On master: COMMIT
[0m14:08:06.288304 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:06.288471 [debug] [MainThread]: On master: COMMIT
[0m14:08:06.289067 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:08:06.289244 [debug] [MainThread]: On master: Close
[0m14:08:06.289502 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:06.289669 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m14:08:06.289829 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m14:08:06.290019 [info ] [MainThread]: 
[0m14:08:06.290215 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m14:08:06.290637 [debug] [MainThread]: Command end result
[0m14:08:06.304576 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:08:06.305748 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:08:06.308712 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:08:06.308911 [info ] [MainThread]: 
[0m14:08:06.309139 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:08:06.309314 [info ] [MainThread]: 
[0m14:08:06.309509 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:08:06.311432 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.70903885, "process_in_blocks": "0", "process_kernel_time": 0.167532, "process_mem_max_rss": "131170304", "process_out_blocks": "0", "process_user_time": 1.182199}
[0m14:08:06.311691 [debug] [MainThread]: Command `dbt seed` succeeded at 14:08:06.311651 after 0.71 seconds
[0m14:08:06.311918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061e27e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cac9e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d04a70>]}
[0m14:08:06.312131 [debug] [MainThread]: Flushing usage events
[0m14:08:06.660926 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:07.711274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107157860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e30470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f5220>]}


============================== 14:08:07.713479 | 186ddcb6-5bf9-41f2-9590-f0fd89439d01 ==============================
[0m14:08:07.713479 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:08:07.713847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '..', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps --profiles-dir ..', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:07.770851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '186ddcb6-5bf9-41f2-9590-f0fd89439d01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fc53a0>]}
[0m14:08:07.795175 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-w15oagn8'
[0m14:08:07.795516 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:08:07.874367 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:08:07.874931 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:08:07.930746 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:08:07.932960 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:08:08.139008 [info ] [MainThread]: Installed from version 1.3.0
[0m14:08:08.139367 [info ] [MainThread]: Up to date!
[0m14:08:08.139644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '186ddcb6-5bf9-41f2-9590-f0fd89439d01', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11056eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077281d0>]}
[0m14:08:08.141369 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.46355736, "process_in_blocks": "0", "process_kernel_time": 0.121317, "process_mem_max_rss": "112345088", "process_out_blocks": "0", "process_user_time": 0.743584}
[0m14:08:08.141695 [debug] [MainThread]: Command `dbt deps` succeeded at 14:08:08.141640 after 0.46 seconds
[0m14:08:08.141923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106f55b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106db020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077282c0>]}
[0m14:08:08.142128 [debug] [MainThread]: Flushing usage events
[0m14:08:08.487458 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:09.400112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e3d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe9c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe95b0>]}


============================== 14:08:09.403944 | 1d5d753f-9b0f-41a0-8a27-1573cd22ab6a ==============================
[0m14:08:09.403944 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:08:09.404309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --profiles-dir ..', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:09.487563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1d5d753f-9b0f-41a0-8a27-1573cd22ab6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064dbc50>]}
[0m14:08:09.514592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1d5d753f-9b0f-41a0-8a27-1573cd22ab6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10608a6f0>]}
[0m14:08:09.515513 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:08:09.568863 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:08:09.636608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:08:09.636913 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:08:09.662725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1d5d753f-9b0f-41a0-8a27-1573cd22ab6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10658f6e0>]}
[0m14:08:09.707189 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:08:09.708382 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:08:09.715562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1d5d753f-9b0f-41a0-8a27-1573cd22ab6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5d850>]}
[0m14:08:09.715855 [info ] [MainThread]: Found 2 seeds, 7 models, 8 data tests, 3 sources, 549 macros
[0m14:08:09.716063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d5d753f-9b0f-41a0-8a27-1573cd22ab6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10658cb60>]}
[0m14:08:09.717141 [info ] [MainThread]: 
[0m14:08:09.717361 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:08:09.717533 [info ] [MainThread]: 
[0m14:08:09.717816 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:08:09.719751 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m14:08:09.745956 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m14:08:09.746249 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:08:09.746437 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:09.768479 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.022 seconds
[0m14:08:09.769311 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m14:08:09.770174 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m14:08:09.773168 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:08:09.773393 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:08:09.773564 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:09.782105 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:08:09.782282 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:08:09.782464 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:08:09.785798 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m14:08:09.786540 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:08:09.787039 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:08:09.790605 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:09.790826 [debug] [MainThread]: On master: BEGIN
[0m14:08:09.790995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:09.800372 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:08:09.800565 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:09.800790 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:08:09.806758 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m14:08:09.807846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1d5d753f-9b0f-41a0-8a27-1573cd22ab6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105623e60>]}
[0m14:08:09.808095 [debug] [MainThread]: On master: ROLLBACK
[0m14:08:09.808657 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:09.808811 [debug] [MainThread]: On master: BEGIN
[0m14:08:09.809628 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:08:09.809783 [debug] [MainThread]: On master: COMMIT
[0m14:08:09.809935 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:09.810084 [debug] [MainThread]: On master: COMMIT
[0m14:08:09.810610 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:08:09.810770 [debug] [MainThread]: On master: Close
[0m14:08:09.812008 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m14:08:09.812236 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m14:08:09.812723 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m14:08:09.812547 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_episodes ................................ [RUN]
[0m14:08:09.812968 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m14:08:09.813206 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_user_events ............................. [RUN]
[0m14:08:09.813443 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_user_events_invalid ..................... [RUN]
[0m14:08:09.813688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m14:08:09.813933 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_users ................................... [RUN]
[0m14:08:09.814193 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m14:08:09.814424 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m14:08:09.814613 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m14:08:09.814822 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m14:08:09.815003 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m14:08:09.815180 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m14:08:09.818753 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m14:08:09.818978 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m14:08:09.827004 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m14:08:09.828380 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:08:09.829712 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m14:08:09.830084 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m14:08:09.836750 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m14:08:09.843595 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m14:08:09.848296 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m14:08:09.850154 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:08:09.851976 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m14:08:09.852222 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m14:08:09.854081 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m14:08:09.854413 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:08:09.854635 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:08:09.854852 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: BEGIN
[0m14:08:09.855048 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:08:09.855236 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:08:09.855430 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m14:08:09.855642 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:08:09.855842 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m14:08:09.856033 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: BEGIN
[0m14:08:09.856219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:09.856467 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:08:09.856648 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:08:09.869221 [debug] [Thread-3 (]: SQL status: BEGIN in 0.014 seconds
[0m14:08:09.869456 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:08:09.869701 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */

  create view "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp"
    
    
  as (
    -- stg_user_events_invalid.sql : capture invalid event records for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

invalid_events as (
    select 
        data,
        data ->> 'user_id' as user_id,
        data ->> 'episode_id' as episode_id,
        data ->> 'timestamp' as timestamp,
        data ->> 'event_type' as event_type,
        data ->> 'duration' as duration,
        case 
            when data ->> 'event_type' is null then 'missing_event_type'
            when data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete') then 'invalid_event_type'
            when data ->> 'timestamp' is null or data ->> 'timestamp' = '' then 'missing_timestamp'
            when not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}') then 'malformed_timestamp'
            when data ->> 'user_id' is null then 'missing_user_id'
            when data ->> 'episode_id' is null then 'missing_episode_id'
            else 'other_issue'
        end as issue_type
    from source
    where data ->> 'event_type' is null 
       or data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete')
       or data ->> 'timestamp' is null 
       or data ->> 'timestamp' = ''
       or not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}')
       or data ->> 'user_id' is null
       or data ->> 'episode_id' is null
)

select * from invalid_events
  );
[0m14:08:09.871664 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m14:08:09.871854 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:08:09.872055 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m14:08:09.872295 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m14:08:09.872505 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:08:09.872753 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
-- Note: Invalid events are captured in stg_user_events_invalid.sql for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

valid_events as (
    select * from source
    where data ->> 'event_type' is not null
      and data ->> 'event_type' in ('play', 'pause', 'seek', 'complete')
      and data ->> 'timestamp' is not null
      and data ->> 'timestamp' != ''
      and data ->> 'user_id' is not null
      and data ->> 'episode_id' is not null
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'timestamp' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'event_type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        case 
            when (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}' then (data ->> 'timestamp')::timestamp
            else null
        end as event_ts,
        data ->> 'event_type'         as event_type,
        (data ->> 'duration')::integer as duration
    from valid_events
    where (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}'
)
select * from typed
  );
[0m14:08:09.873023 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m14:08:09.873221 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:08:09.873416 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:08:09.873612 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m14:08:09.876882 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:08:09.877082 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:08:09.877280 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:08:09.877515 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid" rename to "stg_user_events_invalid__dbt_backup"
[0m14:08:09.879038 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:08:09.879222 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:08:09.880583 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:08:09.880809 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m14:08:09.882334 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:08:09.882528 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:08:09.882730 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m14:08:09.882969 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m14:08:09.884547 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:08:09.884770 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:08:09.885064 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp" rename to "stg_user_events_invalid"
[0m14:08:09.887200 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:08:09.887399 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:08:09.887586 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:08:09.887810 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m14:08:09.889089 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:08:09.889299 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:08:09.890526 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:08:09.890759 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m14:08:09.898859 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m14:08:09.899065 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m14:08:09.899282 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:08:09.899537 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:08:09.900451 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m14:08:09.900660 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:08:09.900910 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m14:08:09.901126 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:08:09.902100 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m14:08:09.902309 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:08:09.902533 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m14:08:09.902734 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:08:09.903521 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m14:08:09.903720 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m14:08:09.903934 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m14:08:09.904129 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:08:09.906915 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup"
[0m14:08:09.907123 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m14:08:09.907325 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m14:08:09.909572 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:08:09.909762 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:08:09.910831 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m14:08:09.911071 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
drop view if exists "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup" cascade
[0m14:08:09.912118 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m14:08:09.912326 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m14:08:09.912724 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:08:09.913166 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:08:09.914314 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m14:08:09.914546 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:08:09.914735 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m14:08:09.914940 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m14:08:09.915347 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:08:09.916536 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: Close
[0m14:08:09.916795 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m14:08:09.917730 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d5d753f-9b0f-41a0-8a27-1573cd22ab6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103122510>]}
[0m14:08:09.918096 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_user_events_invalid ................ [[32mCREATE VIEW[0m in 0.10s]
[0m14:08:09.918403 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m14:08:09.918608 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:08:09.918882 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:08:09.919095 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:08:09.919690 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m14:08:09.920253 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: Close
[0m14:08:09.920795 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m14:08:09.921079 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d5d753f-9b0f-41a0-8a27-1573cd22ab6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073bad20>]}
[0m14:08:09.921331 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d5d753f-9b0f-41a0-8a27-1573cd22ab6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e1df0>]}
[0m14:08:09.921568 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d5d753f-9b0f-41a0-8a27-1573cd22ab6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074ce6f0>]}
[0m14:08:09.921846 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.11s]
[0m14:08:09.922133 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.11s]
[0m14:08:09.922413 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.11s]
[0m14:08:09.922690 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m14:08:09.923246 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m14:08:09.923497 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m14:08:09.924005 [debug] [Thread-3 (]: Began running node model.podcast_analytics.int_user_sessions
[0m14:08:09.924221 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m14:08:09.924664 [info ] [Thread-3 (]: 5 of 7 START sql view model public.int_user_sessions ........................... [RUN]
[0m14:08:09.925032 [info ] [Thread-1 (]: 6 of 7 START sql view model public.mart_top_episodes ........................... [RUN]
[0m14:08:09.925371 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now model.podcast_analytics.int_user_sessions)
[0m14:08:09.925588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.mart_top_episodes)
[0m14:08:09.925812 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m14:08:09.926011 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m14:08:09.928669 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m14:08:09.931141 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m14:08:09.931965 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m14:08:09.932263 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m14:08:09.936133 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m14:08:09.975374 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m14:08:09.975976 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:08:09.976229 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:08:09.976419 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m14:08:09.976618 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m14:08:09.976807 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:09.976989 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:08:09.989234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m14:08:09.989469 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:08:09.989700 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m14:08:09.990483 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m14:08:09.990695 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:08:09.990934 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end,
        sum(coalesce(duration, 0)) as total_listening_duration
    from numbered
    group by user_id, session_number
),

final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        total_listening_duration as session_duration
    from agg
)

select * from final
  );
[0m14:08:09.993228 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:08:09.994730 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:08:09.994935 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m14:08:09.995466 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:08:09.996860 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:08:09.997067 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m14:08:09.997266 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:08:09.998081 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m14:08:09.998311 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:08:09.998498 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:08:09.999314 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m14:08:09.999530 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m14:08:09.999728 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:08:09.999953 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m14:08:10.001501 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:08:10.002617 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m14:08:10.002819 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m14:08:10.003274 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:08:10.004277 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m14:08:10.004483 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m14:08:10.004891 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:08:10.005114 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m14:08:10.005749 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.000 seconds
[0m14:08:10.006370 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: Close
[0m14:08:10.006565 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:08:10.007127 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m14:08:10.007437 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d5d753f-9b0f-41a0-8a27-1573cd22ab6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ebe870>]}
[0m14:08:10.007693 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d5d753f-9b0f-41a0-8a27-1573cd22ab6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107585d60>]}
[0m14:08:10.008025 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.int_user_sessions ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:08:10.008325 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m14:08:10.008612 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m14:08:10.008866 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m14:08:10.009219 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m14:08:10.009473 [info ] [Thread-2 (]: 7 of 7 START sql view model public.mart_user_session_metrics ................... [RUN]
[0m14:08:10.009693 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now model.podcast_analytics.mart_user_session_metrics)
[0m14:08:10.009887 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m14:08:10.011196 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:08:10.011610 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m14:08:10.013231 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:08:10.013859 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:08:10.014104 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m14:08:10.014297 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:08:10.021959 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m14:08:10.022278 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:08:10.022502 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  create view "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
    
    
  as (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
[0m14:08:10.023989 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m14:08:10.025605 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:08:10.025814 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m14:08:10.026757 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:08:10.027540 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m14:08:10.027741 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:08:10.027928 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m14:08:10.029241 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m14:08:10.030333 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m14:08:10.030751 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:08:10.030951 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop view if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m14:08:10.031746 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:08:10.032337 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m14:08:10.032653 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1d5d753f-9b0f-41a0-8a27-1573cd22ab6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f7cb30>]}
[0m14:08:10.033000 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.mart_user_session_metrics .............. [[32mCREATE VIEW[0m in 0.02s]
[0m14:08:10.033414 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m14:08:10.034164 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:10.034353 [debug] [MainThread]: On master: BEGIN
[0m14:08:10.034528 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:10.040574 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:08:10.040852 [debug] [MainThread]: On master: COMMIT
[0m14:08:10.041045 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:10.041211 [debug] [MainThread]: On master: COMMIT
[0m14:08:10.041833 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:08:10.042094 [debug] [MainThread]: On master: Close
[0m14:08:10.042420 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:10.042608 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m14:08:10.042773 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m14:08:10.042931 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m14:08:10.043120 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_users' was properly closed.
[0m14:08:10.043387 [info ] [MainThread]: 
[0m14:08:10.043608 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m14:08:10.044320 [debug] [MainThread]: Command end result
[0m14:08:10.058610 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:08:10.059804 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:08:10.062800 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:08:10.062994 [info ] [MainThread]: 
[0m14:08:10.063205 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:08:10.063377 [info ] [MainThread]: 
[0m14:08:10.063566 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m14:08:10.065276 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.70579207, "process_in_blocks": "0", "process_kernel_time": 0.156997, "process_mem_max_rss": "132644864", "process_out_blocks": "0", "process_user_time": 1.182426}
[0m14:08:10.065543 [debug] [MainThread]: Command `dbt run` succeeded at 14:08:10.065500 after 0.71 seconds
[0m14:08:10.065761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10542f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b68050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b68da0>]}
[0m14:08:10.065972 [debug] [MainThread]: Flushing usage events
[0m14:08:10.500971 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:08:11.406835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088efb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109606c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096716d0>]}


============================== 14:08:11.409088 | bb4ff3e4-1fb3-4855-bbb5-422564ff8968 ==============================
[0m14:08:11.409088 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:08:11.409440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '..', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir ..', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:11.491006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb4ff3e4-1fb3-4855-bbb5-422564ff8968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071773b0>]}
[0m14:08:11.517487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb4ff3e4-1fb3-4855-bbb5-422564ff8968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10896dca0>]}
[0m14:08:11.518053 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:08:11.581952 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:08:11.658033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:08:11.658391 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:08:11.688572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb4ff3e4-1fb3-4855-bbb5-422564ff8968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c418b0>]}
[0m14:08:11.745070 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:08:11.746497 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:08:11.762766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb4ff3e4-1fb3-4855-bbb5-422564ff8968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6430b0>]}
[0m14:08:11.763770 [info ] [MainThread]: Found 2 seeds, 7 models, 8 data tests, 3 sources, 549 macros
[0m14:08:11.764376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb4ff3e4-1fb3-4855-bbb5-422564ff8968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a60ccb0>]}
[0m14:08:11.766043 [info ] [MainThread]: 
[0m14:08:11.766679 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:08:11.767239 [info ] [MainThread]: 
[0m14:08:11.767841 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:08:11.774118 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m14:08:11.805100 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:08:11.805677 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:08:11.805948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:11.832051 [debug] [ThreadPool]: SQL status: BEGIN in 0.026 seconds
[0m14:08:11.832442 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:08:11.832695 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:08:11.836405 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m14:08:11.837390 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:08:11.838032 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:08:11.841551 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:11.841815 [debug] [MainThread]: On master: BEGIN
[0m14:08:11.842011 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:11.850874 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:08:11.851255 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:11.851621 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:08:11.859210 [debug] [MainThread]: SQL status: SELECT 7 in 0.007 seconds
[0m14:08:11.860673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb4ff3e4-1fb3-4855-bbb5-422564ff8968', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a695010>]}
[0m14:08:11.861008 [debug] [MainThread]: On master: ROLLBACK
[0m14:08:11.861900 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:11.862095 [debug] [MainThread]: On master: BEGIN
[0m14:08:11.862987 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:08:11.863184 [debug] [MainThread]: On master: COMMIT
[0m14:08:11.863367 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:11.863543 [debug] [MainThread]: On master: COMMIT
[0m14:08:11.864143 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:08:11.864338 [debug] [MainThread]: On master: Close
[0m14:08:11.865836 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:08:11.866115 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:08:11.866566 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:08:11.866384 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m14:08:11.866896 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:08:11.867302 [info ] [Thread-2 (]: 2 of 8 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [RUN]
[0m14:08:11.867622 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_episodes_episode_id ............................. [RUN]
[0m14:08:11.868134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m14:08:11.868453 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_user_events_event_id ............................ [RUN]
[0m14:08:11.868831 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7'
[0m14:08:11.869106 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422'
[0m14:08:11.869342 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:08:11.869610 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7'
[0m14:08:11.869844 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:08:11.870056 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:08:11.877019 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:08:11.882456 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:08:11.888092 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:08:11.893932 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:08:11.896075 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:08:11.896719 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:08:11.896966 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:08:11.897388 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:08:11.897606 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:08:11.911492 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:08:11.914129 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:08:11.915750 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:08:11.917147 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:08:11.918057 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:08:11.918471 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:08:11.918807 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m14:08:11.919065 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:08:11.919332 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: BEGIN
[0m14:08:11.919575 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:08:11.919804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:11.920030 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m14:08:11.920257 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:08:11.920473 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m14:08:11.920789 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:08:11.921125 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:08:11.938001 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m14:08:11.938367 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m14:08:11.938664 [debug] [Thread-4 (]: SQL status: BEGIN in 0.018 seconds
[0m14:08:11.938930 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:08:11.939168 [debug] [Thread-3 (]: SQL status: BEGIN in 0.018 seconds
[0m14:08:11.939432 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:08:11.939682 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:08:11.939986 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','missing_timestamp','malformed_timestamp','missing_user_id','missing_episode_id','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m14:08:11.940274 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:08:11.940545 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m14:08:11.940825 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m14:08:11.941143 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m14:08:11.942898 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:08:11.945961 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m14:08:11.947086 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m14:08:11.947511 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_episodes_episode_id ................................... [[32mPASS[0m in 0.08s]
[0m14:08:11.947889 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:08:11.948156 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:08:11.948451 [info ] [Thread-3 (]: 5 of 8 START test not_null_stg_users_user_id ................................... [RUN]
[0m14:08:11.948751 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m14:08:11.948989 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:08:11.951876 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:08:11.952763 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:08:11.954737 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:08:11.955307 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:08:11.955693 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m14:08:11.956163 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:08:11.956670 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.015 seconds
[0m14:08:11.957129 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.016 seconds
[0m14:08:11.958950 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: ROLLBACK
[0m14:08:11.960055 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m14:08:11.961327 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.020 seconds
[0m14:08:11.961645 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: Close
[0m14:08:11.961942 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m14:08:11.962946 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m14:08:11.963445 [info ] [Thread-2 (]: 2 of 8 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [[32mPASS[0m in 0.09s]
[0m14:08:11.964966 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.10s]
[0m14:08:11.965673 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m14:08:11.966185 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:08:11.966632 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:08:11.967508 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m14:08:11.967125 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_user_events_event_id .................................. [[32mPASS[0m in 0.10s]
[0m14:08:11.968277 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:08:11.969120 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:08:11.970715 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:08:11.971196 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:08:11.971490 [info ] [Thread-2 (]: 6 of 8 START test unique_stg_episodes_episode_id ............................... [RUN]
[0m14:08:11.971864 [info ] [Thread-1 (]: 7 of 8 START test unique_stg_user_events_event_id .............................. [RUN]
[0m14:08:11.972193 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:08:11.972499 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:08:11.972850 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m14:08:11.973143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m14:08:11.973454 [info ] [Thread-4 (]: 8 of 8 START test unique_stg_users_user_id ..................................... [RUN]
[0m14:08:11.973860 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:08:11.974114 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:08:11.974413 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m14:08:11.974705 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:08:11.979578 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:08:11.983334 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:08:11.983637 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:08:11.985619 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m14:08:11.989701 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:08:11.990197 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:08:11.990474 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:08:11.992194 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:08:11.992494 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m14:08:11.993917 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:08:11.994333 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:08:11.994825 [info ] [Thread-3 (]: 5 of 8 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.05s]
[0m14:08:11.995316 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:08:11.997125 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:08:11.997523 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:08:11.997816 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: BEGIN
[0m14:08:11.998099 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:08:11.998765 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:08:11.999049 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:08:11.999309 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: BEGIN
[0m14:08:11.999645 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m14:08:11.999894 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:12.000145 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:08:12.013192 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m14:08:12.013603 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m14:08:12.013913 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m14:08:12.014246 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:08:12.014541 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:08:12.014801 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:08:12.015082 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:08:12.015382 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_user_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:08:12.015665 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:08:12.017107 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:08:12.018441 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m14:08:12.019122 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.003 seconds
[0m14:08:12.020971 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: ROLLBACK
[0m14:08:12.021719 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m14:08:12.022494 [info ] [Thread-4 (]: 8 of 8 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.05s]
[0m14:08:12.022965 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:08:12.023386 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: Close
[0m14:08:12.024826 [info ] [Thread-2 (]: 6 of 8 PASS unique_stg_episodes_episode_id ..................................... [[32mPASS[0m in 0.05s]
[0m14:08:12.025424 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:08:12.048729 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.033 seconds
[0m14:08:12.049940 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: ROLLBACK
[0m14:08:12.050698 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: Close
[0m14:08:12.051850 [info ] [Thread-1 (]: 7 of 8 PASS unique_stg_user_events_event_id .................................... [[32mPASS[0m in 0.08s]
[0m14:08:12.052677 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:08:12.054236 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:12.054546 [debug] [MainThread]: On master: BEGIN
[0m14:08:12.054763 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:08:12.063310 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:08:12.063770 [debug] [MainThread]: On master: COMMIT
[0m14:08:12.064032 [debug] [MainThread]: Using postgres connection "master"
[0m14:08:12.064536 [debug] [MainThread]: On master: COMMIT
[0m14:08:12.065309 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:08:12.065552 [debug] [MainThread]: On master: Close
[0m14:08:12.065874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:12.066102 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m14:08:12.066309 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16' was properly closed.
[0m14:08:12.066504 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m14:08:12.066697 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m14:08:12.066939 [info ] [MainThread]: 
[0m14:08:12.067200 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m14:08:12.068823 [debug] [MainThread]: Command end result
[0m14:08:12.138019 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:08:12.139456 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:08:12.144028 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:08:12.144390 [info ] [MainThread]: 
[0m14:08:12.144708 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:08:12.144956 [info ] [MainThread]: 
[0m14:08:12.145208 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m14:08:12.147534 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.77402073, "process_in_blocks": "0", "process_kernel_time": 0.158314, "process_mem_max_rss": "132104192", "process_out_blocks": "0", "process_user_time": 1.262784}
[0m14:08:12.147876 [debug] [MainThread]: Command `dbt test` succeeded at 14:08:12.147822 after 0.77 seconds
[0m14:08:12.148157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080df470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bd40e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3e7f80>]}
[0m14:08:12.148431 [debug] [MainThread]: Flushing usage events
[0m14:08:12.497882 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:23:59.787049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106557fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10758af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10731db20>]}


============================== 14:23:59.790434 | eb494b23-fd7b-4052-9a7c-ea440a943058 ==============================
[0m14:23:59.790434 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:23:59.790843 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'profiles_dir': '/Users/samydoreau/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:23:59.906726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb494b23-fd7b-4052-9a7c-ea440a943058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a3bec0>]}
[0m14:23:59.936591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb494b23-fd7b-4052-9a7c-ea440a943058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076cd6a0>]}
[0m14:23:59.937455 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:24:00.004145 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:24:00.185268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:24:00.185667 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:24:00.218496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb494b23-fd7b-4052-9a7c-ea440a943058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b40e00>]}
[0m14:24:00.234588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb494b23-fd7b-4052-9a7c-ea440a943058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108397890>]}
[0m14:24:00.235051 [info ] [MainThread]: Found 2 seeds, 7 models, 8 data tests, 3 sources, 549 macros
[0m14:24:00.235319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb494b23-fd7b-4052-9a7c-ea440a943058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076cfe60>]}
[0m14:24:00.236733 [info ] [MainThread]: 
[0m14:24:00.237006 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:24:00.237212 [info ] [MainThread]: 
[0m14:24:00.237558 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:00.239969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m14:24:00.320262 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:24:00.320658 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:24:00.320901 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:00.421672 [debug] [ThreadPool]: SQL status: BEGIN in 0.101 seconds
[0m14:24:00.422035 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:24:00.422255 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:24:00.430549 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.008 seconds
[0m14:24:00.431628 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:24:00.432702 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:24:00.436068 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:00.436271 [debug] [MainThread]: On master: BEGIN
[0m14:24:00.436439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:00.443685 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:24:00.443921 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:00.444169 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:24:00.448742 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m14:24:00.450046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb494b23-fd7b-4052-9a7c-ea440a943058', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108550f20>]}
[0m14:24:00.450324 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:00.450799 [debug] [MainThread]: On master: Close
[0m14:24:00.452863 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m14:24:00.453131 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m14:24:00.453506 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m14:24:00.453763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m14:24:00.453974 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m14:24:00.454245 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m14:24:00.454513 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m14:24:00.454730 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m14:24:00.454976 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m14:24:00.455174 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m14:24:00.455376 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m14:24:00.459249 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m14:24:00.459484 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m14:24:00.467548 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m14:24:00.469042 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:24:00.470439 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m14:24:00.470906 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m14:24:00.471158 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m14:24:00.471590 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m14:24:00.471981 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m14:24:00.472179 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m14:24:00.472384 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m14:24:00.472630 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m14:24:00.472912 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m14:24:00.473290 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m14:24:00.473697 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m14:24:00.473932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now seed.podcast_analytics.raw_episodes)
[0m14:24:00.474167 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now seed.podcast_analytics.raw_users)
[0m14:24:00.474405 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:24:00.474685 [debug] [Thread-3 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:24:00.474934 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m14:24:00.475150 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m14:24:00.475369 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_users, now test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422)
[0m14:24:00.475669 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m14:24:00.476529 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m14:24:00.478130 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m14:24:00.478351 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:24:00.478564 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:24:00.478908 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m14:24:00.479236 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m14:24:00.485449 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:24:00.488477 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:24:00.488757 [debug] [Thread-1 (]: Began running node model.podcast_analytics.int_user_sessions
[0m14:24:00.489030 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m14:24:00.489416 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.podcast_analytics.raw_episodes, now model.podcast_analytics.int_user_sessions)
[0m14:24:00.489729 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.podcast_analytics.raw_users, now model.podcast_analytics.mart_top_episodes)
[0m14:24:00.489972 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:24:00.490190 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:24:00.490401 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m14:24:00.490608 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m14:24:00.490945 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:24:00.491266 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:24:00.493563 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m14:24:00.496153 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m14:24:00.496407 [debug] [Thread-3 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:24:00.496672 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:24:00.497015 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m14:24:00.497313 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7)
[0m14:24:00.497533 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m14:24:00.497746 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m14:24:00.497970 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:24:00.498198 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:24:00.498554 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m14:24:00.498913 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m14:24:00.503787 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:24:00.505730 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:24:00.506003 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:24:00.506347 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:24:00.506827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.int_user_sessions, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m14:24:00.507146 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:24:00.507366 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:24:00.507595 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.mart_top_episodes, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m14:24:00.507833 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:24:00.508199 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:24:00.508537 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:24:00.508753 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:24:00.511124 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:24:00.511445 [debug] [Thread-3 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:24:00.511742 [debug] [Thread-4 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:24:00.514062 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:24:00.514653 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m14:24:00.515003 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7)
[0m14:24:00.515419 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:24:00.515654 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:24:00.515914 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:24:00.516128 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:24:00.516506 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:24:00.520049 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:24:00.524044 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:24:00.524453 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:24:00.524714 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m14:24:00.525149 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:24:00.525410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7, now model.podcast_analytics.mart_user_session_metrics)
[0m14:24:00.525652 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:24:00.526021 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:24:00.526254 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m14:24:00.526627 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:24:00.528036 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:24:00.528571 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m14:24:00.528926 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m14:24:00.529877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:00.530098 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m14:24:00.530289 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m14:24:00.530471 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m14:24:00.530660 [debug] [MainThread]: Connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7' was properly closed.
[0m14:24:00.532017 [debug] [MainThread]: Command end result
[0m14:24:00.583290 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:24:00.585233 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:24:00.589536 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:24:00.592092 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:24:00.592328 [info ] [MainThread]: Building catalog
[0m14:24:00.597328 [debug] [ThreadPool]: Acquiring new postgres connection 'podcast_analytics.information_schema'
[0m14:24:00.606525 [debug] [ThreadPool]: Using postgres connection "podcast_analytics.information_schema"
[0m14:24:00.606997 [debug] [ThreadPool]: On podcast_analytics.information_schema: BEGIN
[0m14:24:00.607211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:00.618606 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m14:24:00.619050 [debug] [ThreadPool]: Using postgres connection "podcast_analytics.information_schema"
[0m14:24:00.619395 [debug] [ThreadPool]: On podcast_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "podcast_analytics.information_schema"} */

    
    

    select
        'podcast_analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_users')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_users')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_event_files')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_user_events_invalid')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_top_episodes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('int_user_sessions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_episodes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_user_events')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_episodes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_user_session_metrics')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:24:00.626186 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.006 seconds
[0m14:24:00.628544 [debug] [ThreadPool]: On podcast_analytics.information_schema: ROLLBACK
[0m14:24:00.629880 [debug] [ThreadPool]: On podcast_analytics.information_schema: Close
[0m14:24:00.638740 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/samydoreau/global-assignment/dbt/target/catalog.json
[0m14:24:00.697866 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:24:00.699037 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:24:00.699282 [info ] [MainThread]: Catalog written to /Users/samydoreau/global-assignment/dbt/target/catalog.json
[0m14:24:00.701333 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.9634605, "process_in_blocks": "0", "process_kernel_time": 0.220675, "process_mem_max_rss": "129204224", "process_out_blocks": "0", "process_user_time": 1.336067}
[0m14:24:00.701675 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:24:00.701625 after 0.96 seconds
[0m14:24:00.701891 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:24:00.702064 [debug] [MainThread]: Connection 'podcast_analytics.information_schema' was properly closed.
[0m14:24:00.702273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1025f3140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087f9ac0>]}
[0m14:24:00.702507 [debug] [MainThread]: Flushing usage events
[0m14:24:01.120306 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:34.238435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109629c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112fd5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112fd250>]}


============================== 14:24:34.242684 | e426f708-cc11-4cae-aa9c-2f48fa70ee98 ==============================
[0m14:24:34.242684 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:24:34.243229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps --profiles-dir ..', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:24:34.466036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e426f708-cc11-4cae-aa9c-2f48fa70ee98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112bbf20>]}
[0m14:24:34.509988 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-p0svx62z'
[0m14:24:34.510436 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:24:34.611051 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:24:34.612068 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:24:34.664698 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:24:34.668016 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:24:34.917579 [info ] [MainThread]: Installed from version 1.3.0
[0m14:24:34.918619 [info ] [MainThread]: Up to date!
[0m14:24:34.919155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e426f708-cc11-4cae-aa9c-2f48fa70ee98', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101e9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101eb8f0>]}
[0m14:24:34.922595 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.74754393, "process_in_blocks": "0", "process_kernel_time": 0.268244, "process_mem_max_rss": "110559232", "process_out_blocks": "0", "process_user_time": 1.296615}
[0m14:24:34.923063 [debug] [MainThread]: Command `dbt deps` succeeded at 14:24:34.922986 after 0.75 seconds
[0m14:24:34.923378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112fd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111489a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11137fa10>]}
[0m14:24:34.923695 [debug] [MainThread]: Flushing usage events
[0m14:24:35.301199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:36.866779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123b33a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244fd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1244fd460>]}


============================== 14:24:36.870633 | 971d81c0-f837-46af-831c-78a6f9f1ed6d ==============================
[0m14:24:36.870633 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:24:36.871155 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ..', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:24:37.014743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '971d81c0-f837-46af-831c-78a6f9f1ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125067ec0>]}
[0m14:24:37.057175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '971d81c0-f837-46af-831c-78a6f9f1ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123424ad0>]}
[0m14:24:37.058936 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:24:37.356035 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:24:37.358581 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:24:37.360045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '971d81c0-f837-46af-831c-78a6f9f1ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12515bf20>]}
[0m14:24:40.005431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '971d81c0-f837-46af-831c-78a6f9f1ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1252be630>]}
[0m14:24:40.089990 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:24:40.092176 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:24:40.109800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '971d81c0-f837-46af-831c-78a6f9f1ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125879df0>]}
[0m14:24:40.110365 [info ] [MainThread]: Found 7 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m14:24:40.110700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '971d81c0-f837-46af-831c-78a6f9f1ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1258b07a0>]}
[0m14:24:40.112333 [info ] [MainThread]: 
[0m14:24:40.112699 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:24:40.112960 [info ] [MainThread]: 
[0m14:24:40.113366 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:40.118516 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m14:24:40.169338 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m14:24:40.169749 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:24:40.170026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:40.223620 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.054 seconds
[0m14:24:40.224752 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m14:24:40.226005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m14:24:40.230722 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:24:40.231142 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:24:40.231855 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:40.253815 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m14:24:40.254332 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:24:40.254638 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:24:40.259199 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m14:24:40.260425 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:24:40.261858 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:24:40.269292 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:40.269823 [debug] [MainThread]: On master: BEGIN
[0m14:24:40.270107 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:40.283282 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m14:24:40.283960 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:40.284390 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:24:40.290461 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m14:24:40.292762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '971d81c0-f837-46af-831c-78a6f9f1ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125161520>]}
[0m14:24:40.293273 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:40.294446 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:40.294749 [debug] [MainThread]: On master: BEGIN
[0m14:24:40.295759 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:24:40.296127 [debug] [MainThread]: On master: COMMIT
[0m14:24:40.296430 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:40.296711 [debug] [MainThread]: On master: COMMIT
[0m14:24:40.297654 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m14:24:40.297997 [debug] [MainThread]: On master: Close
[0m14:24:40.302297 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m14:24:40.302724 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m14:24:40.303086 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m14:24:40.303422 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m14:24:40.303889 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_episodes ................................ [RUN]
[0m14:24:40.304377 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_user_events ............................. [RUN]
[0m14:24:40.304851 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_user_events_invalid ..................... [RUN]
[0m14:24:40.305287 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_users ................................... [RUN]
[0m14:24:40.305709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m14:24:40.306147 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m14:24:40.306552 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m14:24:40.306923 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m14:24:40.307252 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m14:24:40.307564 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m14:24:40.307869 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m14:24:40.308165 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m14:24:40.318227 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m14:24:40.323413 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m14:24:40.329317 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:24:40.335211 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m14:24:40.337844 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m14:24:40.338496 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m14:24:40.339381 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m14:24:40.426296 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m14:24:40.506792 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m14:24:40.504672 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:24:40.507776 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m14:24:40.525387 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m14:24:40.527676 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:24:40.528602 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:24:40.529362 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:24:40.529989 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: BEGIN
[0m14:24:40.530594 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:24:40.532202 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m14:24:40.534404 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: BEGIN
[0m14:24:40.535811 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:24:40.536571 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m14:24:40.537030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:40.537626 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:24:40.538304 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:24:40.572063 [debug] [Thread-3 (]: SQL status: BEGIN in 0.034 seconds
[0m14:24:40.572752 [debug] [Thread-4 (]: SQL status: BEGIN in 0.037 seconds
[0m14:24:40.573428 [debug] [Thread-2 (]: SQL status: BEGIN in 0.035 seconds
[0m14:24:40.573814 [debug] [Thread-1 (]: SQL status: BEGIN in 0.037 seconds
[0m14:24:40.574739 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:24:40.575405 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:24:40.576188 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:24:40.577011 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:24:40.577746 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */

  create view "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp"
    
    
  as (
    -- stg_user_events_invalid.sql : capture invalid event records for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

invalid_events as (
    select 
        data,
        data ->> 'user_id' as user_id,
        data ->> 'episode_id' as episode_id,
        data ->> 'timestamp' as timestamp,
        data ->> 'event_type' as event_type,
        data ->> 'duration' as duration,
        case 
            when data ->> 'event_type' is null then 'missing_event_type'
            when data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete') then 'invalid_event_type'
            when data ->> 'timestamp' is null or data ->> 'timestamp' = '' then 'missing_timestamp'
            when not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}') then 'malformed_timestamp'
            when data ->> 'user_id' is null then 'missing_user_id'
            when data ->> 'episode_id' is null then 'missing_episode_id'
            else 'other_issue'
        end as issue_type
    from source
    where data ->> 'event_type' is null 
       or data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete')
       or data ->> 'timestamp' is null 
       or data ->> 'timestamp' = ''
       or not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}')
       or data ->> 'user_id' is null
       or data ->> 'episode_id' is null
)

select * from invalid_events
  );
[0m14:24:40.578901 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m14:24:40.579742 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
-- Note: Invalid events are captured in stg_user_events_invalid.sql for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

valid_events as (
    select * from source
    where data ->> 'event_type' is not null
      and data ->> 'event_type' in ('play', 'pause', 'seek', 'complete')
      and data ->> 'timestamp' is not null
      and data ->> 'timestamp' != ''
      and data ->> 'user_id' is not null
      and data ->> 'episode_id' is not null
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'timestamp' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'event_type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        case 
            when (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}' then (data ->> 'timestamp')::timestamp
            else null
        end as event_ts,
        data ->> 'event_type'         as event_type,
        (data ->> 'duration')::integer as duration
    from valid_events
    where (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}'
)
select * from typed
  );
[0m14:24:40.580360 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m14:24:40.589050 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:24:40.589764 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m14:24:40.590171 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m14:24:40.590571 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.010 seconds
[0m14:24:40.611290 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:24:40.612405 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:24:40.619224 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:24:40.622486 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:24:40.622982 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m14:24:40.623419 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m14:24:40.623850 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid" rename to "stg_user_events_invalid__dbt_backup"
[0m14:24:40.624528 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m14:24:40.626549 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:24:40.627039 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:24:40.627516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:24:40.628242 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m14:24:40.632280 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:24:40.637392 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:24:40.640196 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:24:40.643168 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:24:40.644230 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m14:24:40.644736 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:24:40.645435 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m14:24:40.645977 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp" rename to "stg_user_events_invalid"
[0m14:24:40.648918 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:24:40.650724 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:24:40.651697 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.005 seconds
[0m14:24:40.652278 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m14:24:40.669850 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m14:24:40.671505 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m14:24:40.673008 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m14:24:40.674912 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m14:24:40.675318 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:24:40.675680 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:24:40.676011 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:24:40.676552 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:24:40.676957 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m14:24:40.677343 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m14:24:40.677914 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m14:24:40.678373 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m14:24:40.680574 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:24:40.681064 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:24:40.682147 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m14:24:40.682692 [debug] [Thread-3 (]: SQL status: COMMIT in 0.004 seconds
[0m14:24:40.691446 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m14:24:40.693954 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m14:24:40.696050 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m14:24:40.698090 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup"
[0m14:24:40.703987 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:24:40.705177 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:24:40.705969 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:24:40.706683 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:24:40.707067 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m14:24:40.707491 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m14:24:40.707855 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m14:24:40.708202 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
drop view if exists "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup" cascade
[0m14:24:40.712672 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:24:40.715132 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m14:24:40.715780 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.007 seconds
[0m14:24:40.716302 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.008 seconds
[0m14:24:40.716813 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.008 seconds
[0m14:24:40.720004 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: Close
[0m14:24:40.721221 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m14:24:40.722262 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: Close
[0m14:24:40.722703 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '971d81c0-f837-46af-831c-78a6f9f1ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121822660>]}
[0m14:24:40.723255 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '971d81c0-f837-46af-831c-78a6f9f1ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125e24a10>]}
[0m14:24:40.723729 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '971d81c0-f837-46af-831c-78a6f9f1ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125e26090>]}
[0m14:24:40.724124 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '971d81c0-f837-46af-831c-78a6f9f1ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1258791c0>]}
[0m14:24:40.724803 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.41s]
[0m14:24:40.725635 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.42s]
[0m14:24:40.726320 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.42s]
[0m14:24:40.728645 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m14:24:40.727031 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_user_events_invalid ................ [[32mCREATE VIEW[0m in 0.42s]
[0m14:24:40.729407 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m14:24:40.730039 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m14:24:40.732618 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m14:24:40.735458 [debug] [Thread-1 (]: Began running node model.podcast_analytics.int_user_sessions
[0m14:24:40.736017 [debug] [Thread-4 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m14:24:40.736740 [info ] [Thread-1 (]: 5 of 7 START sql view model public.int_user_sessions ........................... [RUN]
[0m14:24:40.737437 [info ] [Thread-4 (]: 6 of 7 START sql view model public.mart_top_episodes ........................... [RUN]
[0m14:24:40.738711 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.int_user_sessions)
[0m14:24:40.739434 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_users, now model.podcast_analytics.mart_top_episodes)
[0m14:24:40.739917 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m14:24:40.741625 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m14:24:40.752726 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m14:24:40.760363 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m14:24:40.762370 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m14:24:40.763097 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m14:24:40.769213 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m14:24:40.773405 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m14:24:40.774785 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:24:40.775286 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:24:40.775713 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m14:24:40.776108 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m14:24:40.776717 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:24:40.777188 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:40.792116 [debug] [Thread-4 (]: SQL status: BEGIN in 0.015 seconds
[0m14:24:40.792724 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m14:24:40.793362 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:24:40.793959 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:24:40.794615 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m14:24:40.795263 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end,
        sum(coalesce(duration, 0)) as total_listening_duration
    from numbered
    group by user_id, session_number
),

final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        total_listening_duration as session_duration
    from agg
)

select * from final
  );
[0m14:24:40.800441 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:24:40.804345 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:24:40.804721 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m14:24:40.805095 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m14:24:40.809467 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:24:40.810128 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m14:24:40.811337 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:24:40.811731 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:24:40.813369 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m14:24:40.815245 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m14:24:40.815970 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:24:40.816877 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:24:40.817996 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m14:24:40.818438 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m14:24:40.820940 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m14:24:40.821373 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:24:40.945337 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m14:24:40.947354 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m14:24:40.949401 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:24:40.950753 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:24:40.951203 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m14:24:40.951564 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m14:24:40.953248 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:24:40.953631 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m14:24:40.954825 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m14:24:40.955841 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: Close
[0m14:24:40.956376 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '971d81c0-f837-46af-831c-78a6f9f1ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12606b680>]}
[0m14:24:40.956807 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '971d81c0-f837-46af-831c-78a6f9f1ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12604d9d0>]}
[0m14:24:40.957369 [info ] [Thread-4 (]: 6 of 7 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m14:24:40.958058 [info ] [Thread-1 (]: 5 of 7 OK created sql view model public.int_user_sessions ...................... [[32mCREATE VIEW[0m in 0.22s]
[0m14:24:40.958604 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m14:24:40.959078 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m14:24:40.959870 [debug] [Thread-3 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m14:24:40.960426 [info ] [Thread-3 (]: 7 of 7 START sql view model public.mart_user_session_metrics ................... [RUN]
[0m14:24:40.961019 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now model.podcast_analytics.mart_user_session_metrics)
[0m14:24:40.961470 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m14:24:40.965002 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:24:40.966945 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m14:24:40.970711 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:24:40.971980 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:24:40.972651 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m14:24:40.972989 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:24:40.985976 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m14:24:40.986604 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:24:40.987087 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  create view "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
    
    
  as (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
[0m14:24:40.990714 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:24:40.993997 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:24:40.994398 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m14:24:40.995526 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:24:40.996699 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m14:24:40.997032 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:24:40.997449 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m14:24:41.000386 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m14:24:41.002688 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m14:24:41.003712 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:24:41.004157 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop view if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m14:24:41.005580 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:24:41.006830 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m14:24:41.007396 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '971d81c0-f837-46af-831c-78a6f9f1ed6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x126050950>]}
[0m14:24:41.008023 [info ] [Thread-3 (]: 7 of 7 OK created sql view model public.mart_user_session_metrics .............. [[32mCREATE VIEW[0m in 0.05s]
[0m14:24:41.008530 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m14:24:41.009838 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:41.010209 [debug] [MainThread]: On master: BEGIN
[0m14:24:41.010512 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:41.023355 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m14:24:41.024012 [debug] [MainThread]: On master: COMMIT
[0m14:24:41.024655 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:41.025252 [debug] [MainThread]: On master: COMMIT
[0m14:24:41.026446 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:24:41.027104 [debug] [MainThread]: On master: Close
[0m14:24:41.027689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:41.028142 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m14:24:41.028416 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_user_events' was properly closed.
[0m14:24:41.028787 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m14:24:41.029074 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m14:24:41.029437 [info ] [MainThread]: 
[0m14:24:41.029821 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.92 seconds (0.92s).
[0m14:24:41.030945 [debug] [MainThread]: Command end result
[0m14:24:41.058328 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:24:41.060324 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:24:41.065584 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:24:41.066151 [info ] [MainThread]: 
[0m14:24:41.066695 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:24:41.067059 [info ] [MainThread]: 
[0m14:24:41.067435 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m14:24:41.070332 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.2591896, "process_in_blocks": "0", "process_kernel_time": 0.37165, "process_mem_max_rss": "135708672", "process_out_blocks": "0", "process_user_time": 3.603502}
[0m14:24:41.070779 [debug] [MainThread]: Command `dbt run` succeeded at 14:24:41.070707 after 4.26 seconds
[0m14:24:41.071133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125630920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1256336e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x125632510>]}
[0m14:24:41.071481 [debug] [MainThread]: Flushing usage events
[0m14:24:41.517686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:43.223331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df5a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df56a0>]}


============================== 14:24:43.226936 | b37a3b42-2fd0-4923-a71f-9fc552f5279c ==============================
[0m14:24:43.226936 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:24:43.227497 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate --profiles-dir ..', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:24:43.370743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b37a3b42-2fd0-4923-a71f-9fc552f5279c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c2b680>]}
[0m14:24:43.415759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b37a3b42-2fd0-4923-a71f-9fc552f5279c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d804a0>]}
[0m14:24:43.417400 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:24:43.499591 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:24:43.607134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:24:43.607524 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:24:43.642316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b37a3b42-2fd0-4923-a71f-9fc552f5279c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a36bf50>]}
[0m14:24:43.653807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b37a3b42-2fd0-4923-a71f-9fc552f5279c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b611bb0>]}
[0m14:24:43.654238 [info ] [MainThread]: Found 7 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m14:24:43.654509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b37a3b42-2fd0-4923-a71f-9fc552f5279c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5c9d00>]}
[0m14:24:43.656034 [info ] [MainThread]: 
[0m14:24:43.656319 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:24:43.656534 [info ] [MainThread]: 
[0m14:24:43.656881 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:43.659465 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m14:24:43.691219 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:24:43.691644 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:24:43.691898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:43.717236 [debug] [ThreadPool]: SQL status: BEGIN in 0.025 seconds
[0m14:24:43.717874 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:24:43.718181 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:24:43.721813 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m14:24:43.722855 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:24:43.723507 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:24:43.728439 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:43.728705 [debug] [MainThread]: On master: BEGIN
[0m14:24:43.728914 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:43.739303 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m14:24:43.739683 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:43.740001 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:24:43.745132 [debug] [MainThread]: SQL status: SELECT 7 in 0.005 seconds
[0m14:24:43.747249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b37a3b42-2fd0-4923-a71f-9fc552f5279c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a33bb90>]}
[0m14:24:43.747633 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:43.748500 [debug] [MainThread]: On master: Close
[0m14:24:43.751258 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m14:24:43.751763 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m14:24:43.752225 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m14:24:43.752505 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m14:24:43.752891 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m14:24:43.753265 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m14:24:43.753586 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m14:24:43.753884 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m14:24:43.754167 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m14:24:43.754416 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m14:24:43.754658 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m14:24:43.754891 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m14:24:43.759686 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m14:24:43.774109 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:24:43.772004 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m14:24:43.775907 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m14:24:43.776592 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m14:24:43.777007 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m14:24:43.777576 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m14:24:43.777900 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m14:24:43.778189 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m14:24:43.778624 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m14:24:43.778954 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m14:24:43.779514 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m14:24:43.779983 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m14:24:43.780315 [debug] [Thread-3 (]: Began running node seed.podcast_analytics.raw_users
[0m14:24:43.780684 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now seed.podcast_analytics.raw_episodes)
[0m14:24:43.781017 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:24:43.781342 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:24:43.781725 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now seed.podcast_analytics.raw_users)
[0m14:24:43.782006 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m14:24:43.782282 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_users, now test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422)
[0m14:24:43.782557 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m14:24:43.783090 [debug] [Thread-3 (]: Began compiling node seed.podcast_analytics.raw_users
[0m14:24:43.785089 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m14:24:43.785441 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:24:43.785701 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:24:43.786811 [debug] [Thread-3 (]: Began executing node seed.podcast_analytics.raw_users
[0m14:24:43.787315 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m14:24:43.795248 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:24:43.799722 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:24:43.800465 [debug] [Thread-3 (]: Finished running node seed.podcast_analytics.raw_users
[0m14:24:43.800903 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:24:43.801918 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:24:43.802426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.podcast_analytics.raw_episodes, now test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7)
[0m14:24:43.802814 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:24:43.803119 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:24:43.803418 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.podcast_analytics.raw_users, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m14:24:43.803871 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:24:43.804365 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:24:43.804810 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:24:43.805079 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:24:43.813255 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:24:43.813555 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:24:43.813898 [debug] [Thread-4 (]: Began running node model.podcast_analytics.int_user_sessions
[0m14:24:43.816445 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:24:43.816887 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m14:24:43.817191 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now model.podcast_analytics.int_user_sessions)
[0m14:24:43.817802 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:24:43.818149 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:24:43.818563 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m14:24:43.818877 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:24:43.819461 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:24:43.821966 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:24:43.824508 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m14:24:43.824929 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:24:43.825227 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m14:24:43.825643 [debug] [Thread-3 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:24:43.825995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now model.podcast_analytics.mart_top_episodes)
[0m14:24:43.826299 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m14:24:43.826559 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:24:43.826822 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m14:24:43.827067 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m14:24:43.827327 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:24:43.827725 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:24:43.828112 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m14:24:43.831208 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m14:24:43.837184 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:24:43.837649 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:24:43.838005 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:24:43.838524 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b, now test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7)
[0m14:24:43.838847 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.int_user_sessions, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m14:24:43.839182 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:24:43.839458 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:24:43.839690 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:24:43.839922 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m14:24:43.842542 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:24:43.843052 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:24:43.846034 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:24:43.846516 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m14:24:43.846912 [debug] [Thread-3 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m14:24:43.847405 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:24:43.847771 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now model.podcast_analytics.mart_user_session_metrics)
[0m14:24:43.848230 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:24:43.848539 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:24:43.848872 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m14:24:43.849453 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:24:43.852566 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:24:43.853277 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m14:24:43.853801 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m14:24:43.854590 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:43.854857 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m14:24:43.855086 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7' was properly closed.
[0m14:24:43.855313 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m14:24:43.855591 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m14:24:43.857335 [debug] [MainThread]: Command end result
[0m14:24:43.925367 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:24:43.926964 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:24:43.932077 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:24:43.935534 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:24:43.935927 [info ] [MainThread]: Building catalog
[0m14:24:43.943395 [debug] [ThreadPool]: Acquiring new postgres connection 'podcast_analytics.information_schema'
[0m14:24:43.950861 [debug] [ThreadPool]: Using postgres connection "podcast_analytics.information_schema"
[0m14:24:43.951831 [debug] [ThreadPool]: On podcast_analytics.information_schema: BEGIN
[0m14:24:43.952261 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:43.998329 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m14:24:43.999740 [debug] [ThreadPool]: Using postgres connection "podcast_analytics.information_schema"
[0m14:24:44.000496 [debug] [ThreadPool]: On podcast_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "podcast_analytics.information_schema"} */

    
    

    select
        'podcast_analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_event_files')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_episodes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_top_episodes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_episodes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('int_user_sessions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_user_events')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_user_session_metrics')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_user_events_invalid')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_users')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_users')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:24:44.008214 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.005 seconds
[0m14:24:44.011067 [debug] [ThreadPool]: On podcast_analytics.information_schema: ROLLBACK
[0m14:24:44.013562 [debug] [ThreadPool]: On podcast_analytics.information_schema: Close
[0m14:24:44.031160 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/samydoreau/global-assignment/dbt/target/catalog.json
[0m14:24:44.104016 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:24:44.105457 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:24:44.105762 [info ] [MainThread]: Catalog written to /Users/samydoreau/global-assignment/dbt/target/catalog.json
[0m14:24:44.107982 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.93944, "process_in_blocks": "0", "process_kernel_time": 0.257996, "process_mem_max_rss": "132759552", "process_out_blocks": "0", "process_user_time": 1.774981}
[0m14:24:44.108388 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:24:44.108326 after 0.94 seconds
[0m14:24:44.108660 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:24:44.108883 [debug] [MainThread]: Connection 'podcast_analytics.information_schema' was properly closed.
[0m14:24:44.109146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10997e510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9bf7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9bf1d0>]}
[0m14:24:44.109441 [debug] [MainThread]: Flushing usage events
[0m14:24:44.469419 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:50.246283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a70b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ed4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070ca810>]}


============================== 14:24:50.249771 | b620d0a1-9aac-4838-acff-5e759ffbdc86 ==============================
[0m14:24:50.249771 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:24:50.250290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/samydoreau/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:24:50.377347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b620d0a1-9aac-4838-acff-5e759ffbdc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b43170>]}
[0m14:24:50.417071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b620d0a1-9aac-4838-acff-5e759ffbdc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c14ad0>]}
[0m14:24:50.418146 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:24:50.720920 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:24:50.828830 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:24:50.829277 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:24:50.868445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b620d0a1-9aac-4838-acff-5e759ffbdc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a5cd0>]}
[0m14:24:50.880508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b620d0a1-9aac-4838-acff-5e759ffbdc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fb58e0>]}
[0m14:24:50.880992 [info ] [MainThread]: Found 7 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m14:24:50.881298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b620d0a1-9aac-4838-acff-5e759ffbdc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d29070>]}
[0m14:24:50.882904 [info ] [MainThread]: 
[0m14:24:50.883230 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:24:50.883474 [info ] [MainThread]: 
[0m14:24:50.883884 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:50.887971 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m14:24:50.921948 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:24:50.922456 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:24:50.922724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:50.954308 [debug] [ThreadPool]: SQL status: BEGIN in 0.031 seconds
[0m14:24:50.954892 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:24:50.955184 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:24:50.962773 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m14:24:50.963870 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:24:50.964686 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:24:50.969027 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:50.969580 [debug] [MainThread]: On master: BEGIN
[0m14:24:50.969908 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:50.981735 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m14:24:50.982059 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:50.982375 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:24:50.989061 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m14:24:50.990760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b620d0a1-9aac-4838-acff-5e759ffbdc86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107086ed0>]}
[0m14:24:50.991075 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:50.991762 [debug] [MainThread]: On master: Close
[0m14:24:50.993483 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m14:24:50.993842 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m14:24:50.994297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m14:24:50.994552 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m14:24:50.994841 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m14:24:50.995164 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m14:24:50.995431 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m14:24:50.995750 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m14:24:50.996053 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m14:24:50.996325 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m14:24:51.001565 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m14:24:51.001888 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m14:24:51.002170 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m14:24:51.013209 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m14:24:51.015412 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:24:51.017188 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m14:24:51.017804 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m14:24:51.018368 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m14:24:51.018635 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m14:24:51.018946 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m14:24:51.019769 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m14:24:51.020329 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m14:24:51.020839 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m14:24:51.021360 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m14:24:51.021740 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m14:24:51.022225 [debug] [Thread-3 (]: Began running node seed.podcast_analytics.raw_users
[0m14:24:51.022648 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:24:51.023058 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:24:51.023426 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now seed.podcast_analytics.raw_episodes)
[0m14:24:51.023738 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now seed.podcast_analytics.raw_users)
[0m14:24:51.024042 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422)
[0m14:24:51.024468 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_users, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m14:24:51.024772 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m14:24:51.025059 [debug] [Thread-3 (]: Began compiling node seed.podcast_analytics.raw_users
[0m14:24:51.025346 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:24:51.025628 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:24:51.027328 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m14:24:51.028561 [debug] [Thread-3 (]: Began executing node seed.podcast_analytics.raw_users
[0m14:24:51.038519 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:24:51.042787 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:24:51.043338 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m14:24:51.043799 [debug] [Thread-3 (]: Finished running node seed.podcast_analytics.raw_users
[0m14:24:51.044451 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:24:51.044896 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:24:51.045174 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:24:51.045480 [debug] [Thread-3 (]: Began running node model.podcast_analytics.int_user_sessions
[0m14:24:51.045814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.podcast_analytics.raw_episodes, now test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7)
[0m14:24:51.046277 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:24:51.046697 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:24:51.047000 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.podcast_analytics.raw_users, now model.podcast_analytics.int_user_sessions)
[0m14:24:51.047313 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:24:51.047634 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m14:24:51.047965 [debug] [Thread-4 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:24:51.048258 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m14:24:51.056298 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:24:51.056711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now model.podcast_analytics.mart_top_episodes)
[0m14:24:51.057028 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m14:24:51.059828 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m14:24:51.060226 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m14:24:51.060605 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:24:51.064077 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m14:24:51.064406 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:24:51.068411 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:24:51.068704 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m14:24:51.069275 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:24:51.070146 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m14:24:51.070535 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:24:51.071030 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m14:24:51.071375 [debug] [Thread-3 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:24:51.071720 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:24:51.072063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7)
[0m14:24:51.072522 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m14:24:51.072823 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.int_user_sessions, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m14:24:51.073358 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:24:51.073652 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:24:51.073939 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:24:51.074432 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:24:51.074974 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:24:51.078412 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:24:51.078803 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.mart_top_episodes, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m14:24:51.081613 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:24:51.081928 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m14:24:51.082334 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:24:51.082787 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:24:51.083095 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:24:51.085904 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:24:51.086229 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:24:51.090647 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:24:51.091158 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:24:51.091693 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:24:51.092130 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m14:24:51.092463 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:24:51.092829 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now model.podcast_analytics.mart_user_session_metrics)
[0m14:24:51.093111 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:24:51.093536 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:24:51.093811 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m14:24:51.094220 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:24:51.095967 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:24:51.096463 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m14:24:51.096884 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m14:24:51.097604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:51.097858 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m14:24:51.098083 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m14:24:51.098311 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m14:24:51.098523 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m14:24:51.100050 [debug] [MainThread]: Command end result
[0m14:24:51.169011 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:24:51.172281 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:24:51.177128 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:24:51.178903 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:24:51.179169 [info ] [MainThread]: Building catalog
[0m14:24:51.193082 [debug] [ThreadPool]: Acquiring new postgres connection 'podcast_analytics.information_schema'
[0m14:24:51.199126 [debug] [ThreadPool]: Using postgres connection "podcast_analytics.information_schema"
[0m14:24:51.199585 [debug] [ThreadPool]: On podcast_analytics.information_schema: BEGIN
[0m14:24:51.199880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:51.215909 [debug] [ThreadPool]: SQL status: BEGIN in 0.016 seconds
[0m14:24:51.216726 [debug] [ThreadPool]: Using postgres connection "podcast_analytics.information_schema"
[0m14:24:51.217192 [debug] [ThreadPool]: On podcast_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "podcast_analytics.information_schema"} */

    
    

    select
        'podcast_analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_top_episodes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_episodes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('int_user_sessions')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_user_session_metrics')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_user_events_invalid')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_event_files')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_users')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_users')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_user_events')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_episodes')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:24:51.228934 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.011 seconds
[0m14:24:51.232587 [debug] [ThreadPool]: On podcast_analytics.information_schema: ROLLBACK
[0m14:24:51.234374 [debug] [ThreadPool]: On podcast_analytics.information_schema: Close
[0m14:24:51.250436 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/samydoreau/global-assignment/dbt/target/catalog.json
[0m14:24:51.337473 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:24:51.339589 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:24:51.339903 [info ] [MainThread]: Catalog written to /Users/samydoreau/global-assignment/dbt/target/catalog.json
[0m14:24:51.342397 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 1.2342848, "process_in_blocks": "0", "process_kernel_time": 0.239678, "process_mem_max_rss": "130039808", "process_out_blocks": "0", "process_user_time": 1.795456}
[0m14:24:51.342854 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:24:51.342786 after 1.23 seconds
[0m14:24:51.343140 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:24:51.343380 [debug] [MainThread]: Connection 'podcast_analytics.information_schema' was properly closed.
[0m14:24:51.343654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a17140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081acc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108357f50>]}
[0m14:24:51.343973 [debug] [MainThread]: Flushing usage events
[0m14:24:51.713405 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:22.891599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070389b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10703a510>]}


============================== 14:30:22.895609 | 4c0157f3-f08c-4e82-8fe0-bff089e0c47a ==============================
[0m14:30:22.895609 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:30:22.896088 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/samydoreau/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:30:23.298013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c0157f3-f08c-4e82-8fe0-bff089e0c47a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701a600>]}
[0m14:30:23.335574 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 0.51661694, "process_in_blocks": "0", "process_kernel_time": 0.159471, "process_mem_max_rss": "106512384", "process_out_blocks": "0", "process_user_time": 0.956371}
[0m14:30:23.337799 [debug] [MainThread]: Command `dbt clean` succeeded at 14:30:23.337313 after 0.52 seconds
[0m14:30:23.340122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5cf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e9bce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10701ac60>]}
[0m14:30:23.393679 [debug] [MainThread]: Flushing usage events
[0m14:30:23.898018 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:26.017437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e66f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ced8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ced2b0>]}


============================== 14:30:26.021050 | 5767ef02-43e3-4324-9150-8947d67d225b ==============================
[0m14:30:26.021050 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:30:26.021906 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir ..', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:30:26.109587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5767ef02-43e3-4324-9150-8947d67d225b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dd24e0>]}
[0m14:30:26.151187 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-ys01gk6a'
[0m14:30:26.151648 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:30:26.301883 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:30:26.303056 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:30:26.360948 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:30:26.363957 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:30:26.605166 [info ] [MainThread]: Installed from version 1.3.0
[0m14:30:26.605783 [info ] [MainThread]: Up to date!
[0m14:30:26.606258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '5767ef02-43e3-4324-9150-8947d67d225b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb1f70>]}
[0m14:30:26.608619 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.6410554, "process_in_blocks": "0", "process_kernel_time": 0.255261, "process_mem_max_rss": "111378432", "process_out_blocks": "0", "process_user_time": 1.427688}
[0m14:30:26.609026 [debug] [MainThread]: Command `dbt deps` succeeded at 14:30:26.608958 after 0.64 seconds
[0m14:30:26.609311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ced2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c8a8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da66c0>]}
[0m14:30:26.609583 [debug] [MainThread]: Flushing usage events
[0m14:30:26.989465 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:28.137378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10661dbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df9af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df94c0>]}


============================== 14:30:28.140869 | f90c2bfb-2b1f-44f5-ac89-a07a2c90764e ==============================
[0m14:30:28.140869 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:30:28.141299 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m14:30:28.252991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f90c2bfb-2b1f-44f5-ac89-a07a2c90764e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d80560>]}
[0m14:30:28.287841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f90c2bfb-2b1f-44f5-ac89-a07a2c90764e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df9010>]}
[0m14:30:28.289907 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:30:28.360087 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:30:28.360725 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:30:28.361002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f90c2bfb-2b1f-44f5-ac89-a07a2c90764e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bde090>]}
[0m14:30:29.278548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f90c2bfb-2b1f-44f5-ac89-a07a2c90764e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f30f80>]}
[0m14:30:29.342824 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:30:29.344487 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:30:29.356294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f90c2bfb-2b1f-44f5-ac89-a07a2c90764e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090616d0>]}
[0m14:30:29.356968 [info ] [MainThread]: Found 7 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m14:30:29.357616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f90c2bfb-2b1f-44f5-ac89-a07a2c90764e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c9adb0>]}
[0m14:30:29.359218 [info ] [MainThread]: 
[0m14:30:29.359551 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:30:29.359785 [info ] [MainThread]: 
[0m14:30:29.360109 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:30:29.362921 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m14:30:29.397331 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m14:30:29.397696 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:30:29.397931 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:29.455256 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.057 seconds
[0m14:30:29.457004 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m14:30:29.458988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m14:30:29.463824 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:30:29.464154 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:30:29.464367 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:29.477018 [debug] [ThreadPool]: SQL status: BEGIN in 0.013 seconds
[0m14:30:29.477482 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:30:29.478124 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:30:29.483799 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.005 seconds
[0m14:30:29.484895 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:30:29.485508 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:30:29.494980 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:29.495347 [debug] [MainThread]: On master: BEGIN
[0m14:30:29.495574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:29.528437 [debug] [MainThread]: SQL status: BEGIN in 0.033 seconds
[0m14:30:29.529015 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:29.529375 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:30:29.567017 [debug] [MainThread]: SQL status: SELECT 7 in 0.037 seconds
[0m14:30:29.576343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f90c2bfb-2b1f-44f5-ac89-a07a2c90764e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10673d520>]}
[0m14:30:29.580879 [debug] [MainThread]: On master: ROLLBACK
[0m14:30:29.585221 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:29.586085 [debug] [MainThread]: On master: BEGIN
[0m14:30:29.591268 [debug] [MainThread]: SQL status: BEGIN in 0.004 seconds
[0m14:30:29.592527 [debug] [MainThread]: On master: COMMIT
[0m14:30:29.593419 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:29.594246 [debug] [MainThread]: On master: COMMIT
[0m14:30:29.598228 [debug] [MainThread]: SQL status: COMMIT in 0.003 seconds
[0m14:30:29.599421 [debug] [MainThread]: On master: Close
[0m14:30:29.617359 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m14:30:29.619703 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m14:30:29.620980 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m14:30:29.624231 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m14:30:29.624891 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m14:30:29.623388 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m14:30:29.634938 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m14:30:29.636249 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m14:30:29.652117 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m14:30:29.653412 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m14:30:29.669007 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:30:29.673259 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:30:29.673809 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m14:30:29.674533 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m14:30:29.675013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:29.675609 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:30:29.687254 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m14:30:29.687676 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m14:30:29.688083 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:30:29.688402 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:30:29.688711 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m14:30:29.689014 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m14:30:29.695853 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.006 seconds
[0m14:30:29.696283 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.007 seconds
[0m14:30:29.824233 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:30:29.842476 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m14:30:29.847551 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:30:29.848411 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m14:30:29.850609 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.003 seconds
[0m14:30:29.859127 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m14:30:29.859697 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.011 seconds
[0m14:30:29.860606 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m14:30:29.896751 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m14:30:29.897897 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m14:30:29.898356 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m14:30:29.898703 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m14:30:29.898993 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m14:30:29.899530 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m14:30:29.920402 [debug] [Thread-2 (]: SQL status: COMMIT in 0.020 seconds
[0m14:30:29.921019 [debug] [Thread-1 (]: SQL status: COMMIT in 0.021 seconds
[0m14:30:29.922860 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m14:30:29.924025 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m14:30:29.928760 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f90c2bfb-2b1f-44f5-ac89-a07a2c90764e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045224b0>]}
[0m14:30:29.929165 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f90c2bfb-2b1f-44f5-ac89-a07a2c90764e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cccc50>]}
[0m14:30:29.929704 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.29s]
[0m14:30:29.930215 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.30s]
[0m14:30:29.930995 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m14:30:29.931384 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m14:30:29.932629 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:29.932942 [debug] [MainThread]: On master: BEGIN
[0m14:30:29.933194 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:30:29.946070 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m14:30:29.946560 [debug] [MainThread]: On master: COMMIT
[0m14:30:29.946861 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:29.947227 [debug] [MainThread]: On master: COMMIT
[0m14:30:29.947864 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:30:29.948131 [debug] [MainThread]: On master: Close
[0m14:30:29.948617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:29.948970 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m14:30:29.949268 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m14:30:29.949578 [info ] [MainThread]: 
[0m14:30:29.949876 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.59 seconds (0.59s).
[0m14:30:29.950625 [debug] [MainThread]: Command end result
[0m14:30:30.078229 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:30:30.080998 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:30:30.085274 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:30:30.085666 [info ] [MainThread]: 
[0m14:30:30.086338 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:30:30.086743 [info ] [MainThread]: 
[0m14:30:30.087172 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:30:30.090533 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 1.9939308, "process_in_blocks": "0", "process_kernel_time": 0.227104, "process_mem_max_rss": "137674752", "process_out_blocks": "0", "process_user_time": 2.338969}
[0m14:30:30.091282 [debug] [MainThread]: Command `dbt seed` succeeded at 14:30:30.091195 after 1.99 seconds
[0m14:30:30.092046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b6840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b64e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090b5640>]}
[0m14:30:30.092821 [debug] [MainThread]: Flushing usage events
[0m14:30:30.452146 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:31.899796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132017c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cf1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cf14f0>]}


============================== 14:30:31.903058 | 16a9e941-75e0-4e99-8a8b-040a7f3cd1d9 ==============================
[0m14:30:31.903058 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:30:31.903536 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ..', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:30:32.020655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16a9e941-75e0-4e99-8a8b-040a7f3cd1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113acd640>]}
[0m14:30:32.059979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16a9e941-75e0-4e99-8a8b-040a7f3cd1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b8f110>]}
[0m14:30:32.060890 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:30:32.142846 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:30:32.237029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:32.237481 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:32.277006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16a9e941-75e0-4e99-8a8b-040a7f3cd1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141f8590>]}
[0m14:30:32.340907 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:30:32.342948 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:30:32.352273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16a9e941-75e0-4e99-8a8b-040a7f3cd1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114260200>]}
[0m14:30:32.352701 [info ] [MainThread]: Found 7 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m14:30:32.352968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16a9e941-75e0-4e99-8a8b-040a7f3cd1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114716210>]}
[0m14:30:32.354491 [info ] [MainThread]: 
[0m14:30:32.354864 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:30:32.355109 [info ] [MainThread]: 
[0m14:30:32.355520 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:30:32.358465 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m14:30:32.391928 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m14:30:32.392656 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:30:32.393063 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:32.424696 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.031 seconds
[0m14:30:32.426614 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m14:30:32.428180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m14:30:32.432626 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:30:32.432971 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:30:32.433286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:32.444298 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m14:30:32.444681 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:30:32.445013 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:30:32.448736 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m14:30:32.449849 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:30:32.450806 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:30:32.455653 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:32.456040 [debug] [MainThread]: On master: BEGIN
[0m14:30:32.456295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:32.468125 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m14:30:32.468607 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:32.468991 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:30:32.475863 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m14:30:32.477976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16a9e941-75e0-4e99-8a8b-040a7f3cd1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148d4f80>]}
[0m14:30:32.478440 [debug] [MainThread]: On master: ROLLBACK
[0m14:30:32.479365 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:32.479626 [debug] [MainThread]: On master: BEGIN
[0m14:30:32.480578 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:30:32.480829 [debug] [MainThread]: On master: COMMIT
[0m14:30:32.481068 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:32.481296 [debug] [MainThread]: On master: COMMIT
[0m14:30:32.481870 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:30:32.482219 [debug] [MainThread]: On master: Close
[0m14:30:32.484117 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m14:30:32.484440 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m14:30:32.484748 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m14:30:32.485423 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m14:30:32.485174 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_episodes ................................ [RUN]
[0m14:30:32.485891 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_user_events ............................. [RUN]
[0m14:30:32.486322 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_user_events_invalid ..................... [RUN]
[0m14:30:32.486836 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_users ................................... [RUN]
[0m14:30:32.487481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m14:30:32.487885 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m14:30:32.488283 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m14:30:32.488649 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m14:30:32.488973 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m14:30:32.489251 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m14:30:32.489572 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m14:30:32.489843 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m14:30:32.497384 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m14:30:32.513580 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m14:30:32.516074 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:30:32.517907 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m14:30:32.519521 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m14:30:32.519893 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m14:30:32.520207 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m14:30:32.532986 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m14:30:32.551337 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m14:30:32.555482 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:30:32.559265 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m14:30:32.563223 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m14:30:32.564637 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:30:32.565949 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: BEGIN
[0m14:30:32.565311 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:30:32.565629 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:30:32.566269 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:30:32.564984 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:30:32.566560 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: BEGIN
[0m14:30:32.566843 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m14:30:32.567221 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m14:30:32.567499 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:30:32.567777 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:30:32.568043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:32.590125 [debug] [Thread-1 (]: SQL status: BEGIN in 0.022 seconds
[0m14:30:32.591139 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:30:32.591771 [debug] [Thread-4 (]: SQL status: BEGIN in 0.025 seconds
[0m14:30:32.592384 [debug] [Thread-3 (]: SQL status: BEGIN in 0.025 seconds
[0m14:30:32.592796 [debug] [Thread-2 (]: SQL status: BEGIN in 0.025 seconds
[0m14:30:32.593186 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m14:30:32.593575 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:30:32.593861 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:30:32.594133 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:30:32.594496 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m14:30:32.594866 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */

  create view "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp"
    
    
  as (
    -- stg_user_events_invalid.sql : capture invalid event records for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

invalid_events as (
    select 
        data,
        data ->> 'user_id' as user_id,
        data ->> 'episode_id' as episode_id,
        data ->> 'timestamp' as timestamp,
        data ->> 'event_type' as event_type,
        data ->> 'duration' as duration,
        case 
            when data ->> 'event_type' is null then 'missing_event_type'
            when data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete') then 'invalid_event_type'
            when data ->> 'timestamp' is null or data ->> 'timestamp' = '' then 'missing_timestamp'
            when not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}') then 'malformed_timestamp'
            when data ->> 'user_id' is null then 'missing_user_id'
            when data ->> 'episode_id' is null then 'missing_episode_id'
            else 'other_issue'
        end as issue_type
    from source
    where data ->> 'event_type' is null 
       or data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete')
       or data ->> 'timestamp' is null 
       or data ->> 'timestamp' = ''
       or not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}')
       or data ->> 'user_id' is null
       or data ->> 'episode_id' is null
)

select * from invalid_events
  );
[0m14:30:32.595347 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
-- Note: Invalid events are captured in stg_user_events_invalid.sql for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

valid_events as (
    select * from source
    where data ->> 'event_type' is not null
      and data ->> 'event_type' in ('play', 'pause', 'seek', 'complete')
      and data ->> 'timestamp' is not null
      and data ->> 'timestamp' != ''
      and data ->> 'user_id' is not null
      and data ->> 'episode_id' is not null
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'timestamp' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'event_type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        case 
            when (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}' then (data ->> 'timestamp')::timestamp
            else null
        end as event_ts,
        data ->> 'event_type'         as event_type,
        (data ->> 'duration')::integer as duration
    from valid_events
    where (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}'
)
select * from typed
  );
[0m14:30:32.597576 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m14:30:32.597906 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:30:32.603366 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:30:32.603839 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:30:32.604156 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m14:30:32.606953 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:30:32.608053 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m14:30:32.612123 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:30:32.615107 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:30:32.615587 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m14:30:32.616116 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m14:30:32.616484 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid" rename to "stg_user_events_invalid__dbt_backup"
[0m14:30:32.617700 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:30:32.620284 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:30:32.620607 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:30:32.620938 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:30:32.621227 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.004 seconds
[0m14:30:32.621564 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m14:30:32.627765 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:30:32.632389 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:30:32.634545 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:30:32.634962 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m14:30:32.635312 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp" rename to "stg_user_events_invalid"
[0m14:30:32.635624 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m14:30:32.636084 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:30:32.643559 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m14:30:32.643919 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.008 seconds
[0m14:30:32.649364 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m14:30:32.649664 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.014 seconds
[0m14:30:32.650968 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m14:30:32.652123 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m14:30:32.652560 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:30:32.653666 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m14:30:32.653949 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:30:32.654219 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:30:32.654499 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m14:30:32.654771 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:30:32.655049 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m14:30:32.655319 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m14:30:32.655654 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m14:30:32.660979 [debug] [Thread-4 (]: SQL status: COMMIT in 0.005 seconds
[0m14:30:32.661375 [debug] [Thread-1 (]: SQL status: COMMIT in 0.005 seconds
[0m14:30:32.661650 [debug] [Thread-3 (]: SQL status: COMMIT in 0.006 seconds
[0m14:30:32.661916 [debug] [Thread-2 (]: SQL status: COMMIT in 0.006 seconds
[0m14:30:32.666984 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m14:30:32.669033 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m14:30:32.670860 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup"
[0m14:30:32.672691 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m14:30:32.678262 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m14:30:32.679478 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m14:30:32.680441 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m14:30:32.681430 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m14:30:32.681988 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m14:30:32.682436 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m14:30:32.682857 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
drop view if exists "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup" cascade
[0m14:30:32.683279 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m14:30:32.687940 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:30:32.688564 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:30:32.688870 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:30:32.689263 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:30:32.691993 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: Close
[0m14:30:32.693807 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m14:30:32.694838 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: Close
[0m14:30:32.695906 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m14:30:32.698221 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16a9e941-75e0-4e99-8a8b-040a7f3cd1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b8cd10>]}
[0m14:30:32.698883 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_user_events_invalid ................ [[32mCREATE VIEW[0m in 0.21s]
[0m14:30:32.699415 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m14:30:32.699771 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16a9e941-75e0-4e99-8a8b-040a7f3cd1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c52420>]}
[0m14:30:32.700270 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.21s]
[0m14:30:32.700920 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m14:30:32.701238 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16a9e941-75e0-4e99-8a8b-040a7f3cd1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d2ca70>]}
[0m14:30:32.701578 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16a9e941-75e0-4e99-8a8b-040a7f3cd1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d26630>]}
[0m14:30:32.702191 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.21s]
[0m14:30:32.702739 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.21s]
[0m14:30:32.703361 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m14:30:32.703957 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m14:30:32.704575 [debug] [Thread-3 (]: Began running node model.podcast_analytics.int_user_sessions
[0m14:30:32.704922 [debug] [Thread-4 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m14:30:32.705355 [info ] [Thread-3 (]: 5 of 7 START sql view model public.int_user_sessions ........................... [RUN]
[0m14:30:32.706151 [info ] [Thread-4 (]: 6 of 7 START sql view model public.mart_top_episodes ........................... [RUN]
[0m14:30:32.707262 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now model.podcast_analytics.int_user_sessions)
[0m14:30:32.707901 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_users, now model.podcast_analytics.mart_top_episodes)
[0m14:30:32.708896 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m14:30:32.709514 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m14:30:32.715246 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m14:30:32.723060 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m14:30:32.724478 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m14:30:32.725089 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m14:30:32.729846 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m14:30:32.733715 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m14:30:32.734504 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:30:32.734840 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:30:32.735171 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m14:30:32.735456 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m14:30:32.735739 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:30:32.736013 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:30:32.748945 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m14:30:32.749382 [debug] [Thread-4 (]: SQL status: BEGIN in 0.014 seconds
[0m14:30:32.749730 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:30:32.750022 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:30:32.750372 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end,
        sum(coalesce(duration, 0)) as total_listening_duration
    from numbered
    group by user_id, session_number
),

final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        total_listening_duration as session_duration
    from agg
)

select * from final
  );
[0m14:30:32.750768 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m14:30:32.754930 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:30:32.811586 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.060 seconds
[0m14:30:32.813152 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:30:32.815832 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:30:32.816193 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m14:30:32.816510 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m14:30:32.818225 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:30:32.818523 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m14:30:32.819683 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m14:30:32.820695 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m14:30:32.820992 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:30:32.821269 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:30:32.821543 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m14:30:32.821808 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m14:30:32.824927 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m14:30:32.825434 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m14:30:32.827673 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m14:30:32.829211 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m14:30:32.829931 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m14:30:32.830531 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m14:30:32.830828 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m14:30:32.831120 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m14:30:32.832249 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:30:32.833527 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m14:30:32.832550 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:30:32.833990 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16a9e941-75e0-4e99-8a8b-040a7f3cd1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e07710>]}
[0m14:30:32.834859 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: Close
[0m14:30:32.835348 [info ] [Thread-4 (]: 6 of 7 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.13s]
[0m14:30:32.835774 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16a9e941-75e0-4e99-8a8b-040a7f3cd1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e06ba0>]}
[0m14:30:32.836175 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m14:30:32.836849 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.int_user_sessions ...................... [[32mCREATE VIEW[0m in 0.13s]
[0m14:30:32.837548 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m14:30:32.838084 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m14:30:32.838503 [info ] [Thread-2 (]: 7 of 7 START sql view model public.mart_user_session_metrics ................... [RUN]
[0m14:30:32.838990 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now model.podcast_analytics.mart_user_session_metrics)
[0m14:30:32.839282 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m14:30:32.843194 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:30:32.843939 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m14:30:32.846559 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:30:32.847088 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:30:32.847371 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m14:30:32.847635 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:30:32.860055 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m14:30:32.860751 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:30:32.861097 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  create view "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
    
    
  as (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
[0m14:30:32.865422 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:30:32.867658 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:30:32.867954 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m14:30:32.869219 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:30:32.870776 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m14:30:32.871114 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:30:32.871450 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m14:30:32.873762 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m14:30:32.876522 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m14:30:32.877271 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m14:30:32.877573 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop view if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m14:30:32.878896 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:30:32.886619 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m14:30:32.887229 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16a9e941-75e0-4e99-8a8b-040a7f3cd1d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147932c0>]}
[0m14:30:32.887758 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.mart_user_session_metrics .............. [[32mCREATE VIEW[0m in 0.05s]
[0m14:30:32.888197 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m14:30:32.889331 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:32.889720 [debug] [MainThread]: On master: BEGIN
[0m14:30:32.889996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:30:32.901813 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m14:30:32.902375 [debug] [MainThread]: On master: COMMIT
[0m14:30:32.902769 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:32.903070 [debug] [MainThread]: On master: COMMIT
[0m14:30:32.903683 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:30:32.903978 [debug] [MainThread]: On master: Close
[0m14:30:32.904367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:32.904644 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_episodes' was properly closed.
[0m14:30:32.904901 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m14:30:32.905149 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m14:30:32.905395 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m14:30:32.905749 [info ] [MainThread]: 
[0m14:30:32.906077 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m14:30:32.907164 [debug] [MainThread]: Command end result
[0m14:30:32.933313 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:30:32.935060 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:30:32.940200 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:30:32.940665 [info ] [MainThread]: 
[0m14:30:32.941871 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:30:32.942403 [info ] [MainThread]: 
[0m14:30:32.942963 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m14:30:32.945919 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0955306, "process_in_blocks": "0", "process_kernel_time": 0.225095, "process_mem_max_rss": "132890624", "process_out_blocks": "0", "process_user_time": 1.817902}
[0m14:30:32.946535 [debug] [MainThread]: Command `dbt run` succeeded at 14:30:32.946452 after 1.10 seconds
[0m14:30:32.946959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d99700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d98fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d994c0>]}
[0m14:30:32.947645 [debug] [MainThread]: Flushing usage events
[0m14:30:33.392820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:34.844299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ade80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf9c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cf9640>]}


============================== 14:30:34.847991 | fbf75ab3-de66-4c6c-a406-a4db54547463 ==============================
[0m14:30:34.847991 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:30:34.848550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m14:30:34.998688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbf75ab3-de66-4c6c-a406-a4db54547463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cde660>]}
[0m14:30:35.037345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbf75ab3-de66-4c6c-a406-a4db54547463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ca3020>]}
[0m14:30:35.038224 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:30:35.111456 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:30:35.195681 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:35.196048 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:35.233168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbf75ab3-de66-4c6c-a406-a4db54547463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d640b0>]}
[0m14:30:35.303650 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:30:35.305943 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:30:35.324828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbf75ab3-de66-4c6c-a406-a4db54547463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d647d0>]}
[0m14:30:35.325691 [info ] [MainThread]: Found 7 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m14:30:35.326480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbf75ab3-de66-4c6c-a406-a4db54547463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801d280>]}
[0m14:30:35.328894 [info ] [MainThread]: 
[0m14:30:35.329288 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:30:35.329535 [info ] [MainThread]: 
[0m14:30:35.329896 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:30:35.333001 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m14:30:35.368755 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:30:35.369207 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:30:35.369485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:35.396789 [debug] [ThreadPool]: SQL status: BEGIN in 0.027 seconds
[0m14:30:35.397158 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:30:35.397443 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:30:35.401132 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m14:30:35.402133 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:30:35.402930 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:30:35.407218 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:35.407513 [debug] [MainThread]: On master: BEGIN
[0m14:30:35.407733 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:35.417350 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m14:30:35.417719 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:35.418038 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:30:35.424248 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m14:30:35.426758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbf75ab3-de66-4c6c-a406-a4db54547463', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7f800>]}
[0m14:30:35.427510 [debug] [MainThread]: On master: ROLLBACK
[0m14:30:35.428480 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:35.428739 [debug] [MainThread]: On master: BEGIN
[0m14:30:35.429538 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:30:35.429826 [debug] [MainThread]: On master: COMMIT
[0m14:30:35.430063 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:35.430267 [debug] [MainThread]: On master: COMMIT
[0m14:30:35.430801 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:30:35.431024 [debug] [MainThread]: On master: Close
[0m14:30:35.432907 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:30:35.433225 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:30:35.433550 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:30:35.434063 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:30:35.433838 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m14:30:35.434474 [info ] [Thread-2 (]: 2 of 8 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [RUN]
[0m14:30:35.434774 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_episodes_episode_id ............................. [RUN]
[0m14:30:35.435045 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_user_events_event_id ............................ [RUN]
[0m14:30:35.435371 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m14:30:35.435717 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7'
[0m14:30:35.436019 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422'
[0m14:30:35.436307 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7'
[0m14:30:35.436565 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:30:35.436817 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:30:35.437057 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:30:35.437291 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:30:35.450805 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:30:35.455699 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:30:35.462897 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:30:35.465268 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:30:35.466050 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:30:35.466364 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:30:35.466666 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:30:35.473533 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:30:35.477821 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:30:35.479595 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:30:35.481051 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:30:35.482371 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:30:35.483098 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:30:35.483495 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:30:35.483781 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: BEGIN
[0m14:30:35.484037 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:30:35.484317 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:30:35.484619 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m14:30:35.484893 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:30:35.485147 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m14:30:35.485389 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m14:30:35.485629 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:35.485958 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:30:35.486194 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:30:35.501177 [debug] [Thread-2 (]: SQL status: BEGIN in 0.016 seconds
[0m14:30:35.501573 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:30:35.501871 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m14:30:35.502161 [debug] [Thread-1 (]: SQL status: BEGIN in 0.017 seconds
[0m14:30:35.502456 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','missing_timestamp','malformed_timestamp','missing_user_id','missing_episode_id','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m14:30:35.502737 [debug] [Thread-3 (]: SQL status: BEGIN in 0.017 seconds
[0m14:30:35.502992 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:30:35.503251 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:30:35.503549 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:30:35.503889 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m14:30:35.504190 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m14:30:35.504494 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m14:30:35.506340 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:30:35.509421 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m14:30:35.511224 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m14:30:35.511684 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_episodes_episode_id ................................... [[32mPASS[0m in 0.08s]
[0m14:30:35.512080 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:30:35.512371 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:30:35.512637 [info ] [Thread-3 (]: 5 of 8 START test not_null_stg_users_user_id ................................... [RUN]
[0m14:30:35.512978 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m14:30:35.513257 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:30:35.515994 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:30:35.516534 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:30:35.518025 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:30:35.518494 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:30:35.518752 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m14:30:35.519426 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m14:30:35.519710 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:30:35.519969 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m14:30:35.521066 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m14:30:35.522066 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: ROLLBACK
[0m14:30:35.522990 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m14:30:35.523329 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.019 seconds
[0m14:30:35.523633 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: Close
[0m14:30:35.525147 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m14:30:35.524198 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.09s]
[0m14:30:35.527268 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m14:30:35.526621 [info ] [Thread-2 (]: 2 of 8 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [[32mPASS[0m in 0.09s]
[0m14:30:35.528420 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:30:35.529789 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:30:35.528976 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_user_events_event_id .................................. [[32mPASS[0m in 0.09s]
[0m14:30:35.530274 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:30:35.530813 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:30:35.531241 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:30:35.531535 [info ] [Thread-1 (]: 6 of 8 START test unique_stg_episodes_episode_id ............................... [RUN]
[0m14:30:35.531857 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m14:30:35.532150 [info ] [Thread-2 (]: 7 of 8 START test unique_stg_user_events_event_id .............................. [RUN]
[0m14:30:35.532510 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:30:35.532911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m14:30:35.533210 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:30:35.533526 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m14:30:35.533837 [info ] [Thread-4 (]: 8 of 8 START test unique_stg_users_user_id ..................................... [RUN]
[0m14:30:35.534131 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:30:35.534434 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m14:30:35.534725 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:30:35.535005 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m14:30:35.539998 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:30:35.544228 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:30:35.544923 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m14:30:35.545417 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:30:35.546695 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m14:30:35.547066 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:30:35.551111 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:30:35.551448 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:30:35.553122 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:30:35.553383 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m14:30:35.554821 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:30:35.555296 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:30:35.555795 [info ] [Thread-3 (]: 5 of 8 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.04s]
[0m14:30:35.556559 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:30:35.558225 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:30:35.559166 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:30:35.560025 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:30:35.560409 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: BEGIN
[0m14:30:35.561035 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: BEGIN
[0m14:30:35.561885 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:35.562472 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:30:35.562773 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:30:35.563220 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m14:30:35.563901 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:30:35.580078 [debug] [Thread-1 (]: SQL status: BEGIN in 0.019 seconds
[0m14:30:35.580502 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m14:30:35.580799 [debug] [Thread-2 (]: SQL status: BEGIN in 0.018 seconds
[0m14:30:35.581138 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:30:35.581438 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:30:35.581719 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:30:35.582023 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:30:35.582355 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:30:35.582680 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_user_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:30:35.584209 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m14:30:35.584558 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m14:30:35.585937 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: ROLLBACK
[0m14:30:35.587311 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m14:30:35.588287 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: Close
[0m14:30:35.588586 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m14:30:35.589124 [info ] [Thread-1 (]: 6 of 8 PASS unique_stg_episodes_episode_id ..................................... [[32mPASS[0m in 0.06s]
[0m14:30:35.589913 [info ] [Thread-4 (]: 8 of 8 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.05s]
[0m14:30:35.590983 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:30:35.591396 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:30:35.613912 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.031 seconds
[0m14:30:35.615363 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: ROLLBACK
[0m14:30:35.616131 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: Close
[0m14:30:35.616673 [info ] [Thread-2 (]: 7 of 8 PASS unique_stg_user_events_event_id .................................... [[32mPASS[0m in 0.08s]
[0m14:30:35.617107 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:30:35.618110 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:35.618368 [debug] [MainThread]: On master: BEGIN
[0m14:30:35.618592 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:30:35.628380 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m14:30:35.628840 [debug] [MainThread]: On master: COMMIT
[0m14:30:35.629121 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:35.629462 [debug] [MainThread]: On master: COMMIT
[0m14:30:35.629988 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:30:35.630296 [debug] [MainThread]: On master: Close
[0m14:30:35.630661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:35.630909 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16' was properly closed.
[0m14:30:35.631134 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m14:30:35.631351 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m14:30:35.631561 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m14:30:35.631834 [info ] [MainThread]: 
[0m14:30:35.632112 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m14:30:35.633119 [debug] [MainThread]: Command end result
[0m14:30:35.713584 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:30:35.715018 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:30:35.719307 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:30:35.719575 [info ] [MainThread]: 
[0m14:30:35.719861 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:30:35.720163 [info ] [MainThread]: 
[0m14:30:35.720851 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m14:30:35.724329 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.93776864, "process_in_blocks": "0", "process_kernel_time": 0.205619, "process_mem_max_rss": "132169728", "process_out_blocks": "0", "process_user_time": 1.633947}
[0m14:30:35.725582 [debug] [MainThread]: Command `dbt test` succeeded at 14:30:35.725330 after 0.94 seconds
[0m14:30:35.726423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2bd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040ade80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10845c890>]}
[0m14:30:35.726856 [debug] [MainThread]: Flushing usage events
[0m14:30:36.149243 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:43.591936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087daae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096cc470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096cdd60>]}


============================== 14:30:43.595432 | f31606b6-3eb2-4bed-8409-6180380f076b ==============================
[0m14:30:43.595432 [info ] [MainThread]: Running with dbt=1.10.3
[0m14:30:43.596368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/samydoreau/.dbt', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m14:30:43.713762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f31606b6-3eb2-4bed-8409-6180380f076b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097d3770>]}
[0m14:30:43.746999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f31606b6-3eb2-4bed-8409-6180380f076b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108890b60>]}
[0m14:30:43.747865 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:30:43.817143 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m14:30:43.943662 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:43.944058 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:43.978117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f31606b6-3eb2-4bed-8409-6180380f076b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c968d0>]}
[0m14:30:43.989317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f31606b6-3eb2-4bed-8409-6180380f076b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5116d0>]}
[0m14:30:43.989743 [info ] [MainThread]: Found 7 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m14:30:43.990018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f31606b6-3eb2-4bed-8409-6180380f076b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cbfe60>]}
[0m14:30:43.991447 [info ] [MainThread]: 
[0m14:30:43.991726 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m14:30:43.991941 [info ] [MainThread]: 
[0m14:30:43.992292 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:30:43.994860 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m14:30:44.033861 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:30:44.034293 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m14:30:44.034537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:44.064987 [debug] [ThreadPool]: SQL status: BEGIN in 0.030 seconds
[0m14:30:44.065389 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m14:30:44.065649 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m14:30:44.071979 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.006 seconds
[0m14:30:44.072959 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m14:30:44.073791 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m14:30:44.077935 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:44.078189 [debug] [MainThread]: On master: BEGIN
[0m14:30:44.078385 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:44.087181 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m14:30:44.087513 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:44.087796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:30:44.091700 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m14:30:44.093169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f31606b6-3eb2-4bed-8409-6180380f076b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4baff0>]}
[0m14:30:44.093513 [debug] [MainThread]: On master: ROLLBACK
[0m14:30:44.094014 [debug] [MainThread]: On master: Close
[0m14:30:44.095504 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m14:30:44.096123 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m14:30:44.096625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m14:30:44.096901 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m14:30:44.097146 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m14:30:44.097527 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m14:30:44.097780 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m14:30:44.098066 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m14:30:44.098335 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m14:30:44.098563 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m14:30:44.102960 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m14:30:44.103217 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m14:30:44.103445 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m14:30:44.112684 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m14:30:44.114907 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m14:30:44.116562 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m14:30:44.117089 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m14:30:44.117508 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m14:30:44.117870 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m14:30:44.118905 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m14:30:44.119445 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m14:30:44.119816 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m14:30:44.120217 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m14:30:44.120575 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m14:30:44.121003 [debug] [Thread-3 (]: Began running node seed.podcast_analytics.raw_users
[0m14:30:44.121590 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m14:30:44.121901 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:30:44.122280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now seed.podcast_analytics.raw_episodes)
[0m14:30:44.122590 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now seed.podcast_analytics.raw_users)
[0m14:30:44.122886 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:30:44.123279 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422)
[0m14:30:44.123748 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m14:30:44.124035 [debug] [Thread-3 (]: Began compiling node seed.podcast_analytics.raw_users
[0m14:30:44.124418 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_users, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m14:30:44.124742 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:30:44.125984 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m14:30:44.127157 [debug] [Thread-3 (]: Began executing node seed.podcast_analytics.raw_users
[0m14:30:44.127446 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:30:44.137934 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m14:30:44.138601 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m14:30:44.139069 [debug] [Thread-3 (]: Finished running node seed.podcast_analytics.raw_users
[0m14:30:44.143559 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m14:30:44.144049 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:30:44.144443 [debug] [Thread-3 (]: Began running node model.podcast_analytics.int_user_sessions
[0m14:30:44.144906 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.podcast_analytics.raw_episodes, now test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7)
[0m14:30:44.145222 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:30:44.145544 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.podcast_analytics.raw_users, now model.podcast_analytics.int_user_sessions)
[0m14:30:44.146169 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:30:44.146494 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:30:44.147051 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m14:30:44.147347 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m14:30:44.155048 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m14:30:44.155547 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m14:30:44.155854 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m14:30:44.158603 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m14:30:44.159044 [debug] [Thread-4 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:30:44.159438 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now model.podcast_analytics.mart_top_episodes)
[0m14:30:44.159864 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:30:44.160189 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m14:30:44.160476 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m14:30:44.160736 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m14:30:44.161166 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m14:30:44.161439 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:30:44.165241 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m14:30:44.165764 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m14:30:44.166055 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:30:44.169747 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m14:30:44.170099 [debug] [Thread-3 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:30:44.170506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7)
[0m14:30:44.170782 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m14:30:44.171095 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.int_user_sessions, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m14:30:44.171376 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:30:44.171774 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m14:30:44.172024 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:30:44.172268 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:30:44.174413 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m14:30:44.174699 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:30:44.175116 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m14:30:44.177229 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m14:30:44.177557 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.mart_top_episodes, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m14:30:44.177869 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:30:44.178217 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:30:44.178463 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:30:44.178753 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m14:30:44.182142 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m14:30:44.182696 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m14:30:44.183035 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:30:44.183303 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:30:44.183673 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m14:30:44.184106 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m14:30:44.188112 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m14:30:44.188451 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now model.podcast_analytics.mart_user_session_metrics)
[0m14:30:44.188715 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:30:44.189091 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m14:30:44.189520 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m14:30:44.191057 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m14:30:44.191304 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:30:44.191807 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m14:30:44.192166 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m14:30:44.192555 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m14:30:44.193283 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:44.193508 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m14:30:44.193706 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m14:30:44.193901 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m14:30:44.194092 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m14:30:44.195492 [debug] [MainThread]: Command end result
[0m14:30:44.254691 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:30:44.256221 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:30:44.260722 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m14:30:44.264696 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m14:30:44.265073 [info ] [MainThread]: Building catalog
[0m14:30:44.270712 [debug] [ThreadPool]: Acquiring new postgres connection 'podcast_analytics.information_schema'
[0m14:30:44.275865 [debug] [ThreadPool]: Using postgres connection "podcast_analytics.information_schema"
[0m14:30:44.276191 [debug] [ThreadPool]: On podcast_analytics.information_schema: BEGIN
[0m14:30:44.276418 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:44.296189 [debug] [ThreadPool]: SQL status: BEGIN in 0.020 seconds
[0m14:30:44.296918 [debug] [ThreadPool]: Using postgres connection "podcast_analytics.information_schema"
[0m14:30:44.297317 [debug] [ThreadPool]: On podcast_analytics.information_schema: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "podcast_analytics.information_schema"} */

    
    

    select
        'podcast_analytics' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_episodes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_user_events')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_episodes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_event_files')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('raw_users')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_user_events_invalid')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_user_session_metrics')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('stg_users')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('mart_top_episodes')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('int_user_sessions')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m14:30:44.303786 [debug] [ThreadPool]: SQL status: SELECT 46 in 0.006 seconds
[0m14:30:44.305748 [debug] [ThreadPool]: On podcast_analytics.information_schema: ROLLBACK
[0m14:30:44.306380 [debug] [ThreadPool]: On podcast_analytics.information_schema: Close
[0m14:30:44.314486 [debug] [MainThread]: Wrote artifact CatalogArtifact to /Users/samydoreau/global-assignment/dbt/target/catalog.json
[0m14:30:44.375580 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m14:30:44.377165 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m14:30:44.377424 [info ] [MainThread]: Catalog written to /Users/samydoreau/global-assignment/dbt/target/catalog.json
[0m14:30:44.380163 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.8380653, "process_in_blocks": "0", "process_kernel_time": 0.197431, "process_mem_max_rss": "130580480", "process_out_blocks": "0", "process_user_time": 1.431328}
[0m14:30:44.380703 [debug] [MainThread]: Command `dbt docs generate` succeeded at 14:30:44.380617 after 0.84 seconds
[0m14:30:44.381047 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m14:30:44.381299 [debug] [MainThread]: Connection 'podcast_analytics.information_schema' was properly closed.
[0m14:30:44.381655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b33ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8b3dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8b34d0>]}
[0m14:30:44.381978 [debug] [MainThread]: Flushing usage events
[0m14:30:44.765239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:30:26.959678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046a61b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd1b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd1520>]}


============================== 15:30:26.963188 | d3d78220-d025-4750-a6fc-584c143dd0c9 ==============================
[0m15:30:26.963188 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:30:26.963611 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt seed --profiles-dir ..', 'send_anonymous_usage_stats': 'True'}
[0m15:30:27.069698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3d78220-d025-4750-a6fc-584c143dd0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060584d0>]}
[0m15:30:27.098279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3d78220-d025-4750-a6fc-584c143dd0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720bf50>]}
[0m15:30:27.099099 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:30:27.164495 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m15:30:27.253827 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:30:27.254171 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:30:27.283735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3d78220-d025-4750-a6fc-584c143dd0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107461b80>]}
[0m15:30:27.332739 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m15:30:27.334248 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m15:30:27.348149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3d78220-d025-4750-a6fc-584c143dd0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107460410>]}
[0m15:30:27.348512 [info ] [MainThread]: Found 7 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m15:30:27.348744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3d78220-d025-4750-a6fc-584c143dd0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c9c10>]}
[0m15:30:27.349792 [info ] [MainThread]: 
[0m15:30:27.350024 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:30:27.350200 [info ] [MainThread]: 
[0m15:30:27.350512 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:30:27.352431 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m15:30:27.389184 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m15:30:27.389543 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:30:27.389758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:27.423288 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.033 seconds
[0m15:30:27.424280 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m15:30:27.425254 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m15:30:27.428688 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m15:30:27.428944 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m15:30:27.429138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:27.439754 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m15:30:27.440018 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m15:30:27.440219 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:30:27.447682 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.007 seconds
[0m15:30:27.448563 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m15:30:27.449078 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m15:30:27.452433 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:27.452657 [debug] [MainThread]: On master: BEGIN
[0m15:30:27.452837 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:27.461527 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:30:27.461874 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:27.462151 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:30:27.468753 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m15:30:27.470224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3d78220-d025-4750-a6fc-584c143dd0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a0560>]}
[0m15:30:27.470596 [debug] [MainThread]: On master: ROLLBACK
[0m15:30:27.471381 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:27.471604 [debug] [MainThread]: On master: BEGIN
[0m15:30:27.472320 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:30:27.472560 [debug] [MainThread]: On master: COMMIT
[0m15:30:27.472759 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:27.472941 [debug] [MainThread]: On master: COMMIT
[0m15:30:27.473352 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:30:27.473541 [debug] [MainThread]: On master: Close
[0m15:30:27.475849 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m15:30:27.476127 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m15:30:27.476494 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m15:30:27.477239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m15:30:27.476897 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m15:30:27.477545 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m15:30:27.477836 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m15:30:27.478076 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m15:30:27.478290 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m15:30:27.488875 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m15:30:27.498351 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m15:30:27.500511 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m15:30:27.500742 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m15:30:27.500969 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m15:30:27.501194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:27.501400 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:30:27.510669 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m15:30:27.511015 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m15:30:27.511243 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m15:30:27.512113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m15:30:27.512348 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m15:30:27.512567 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m15:30:27.520628 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.008 seconds
[0m15:30:27.527543 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.016 seconds
[0m15:30:27.580240 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m15:30:27.597032 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m15:30:27.597348 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m15:30:27.597656 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m15:30:27.601505 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.004 seconds
[0m15:30:27.605196 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m15:30:27.605493 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.007 seconds
[0m15:30:27.606114 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m15:30:27.615184 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m15:30:27.616858 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m15:30:27.617117 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m15:30:27.617352 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m15:30:27.617569 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m15:30:27.617774 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m15:30:27.620868 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:30:27.621144 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m15:30:27.622236 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m15:30:27.622676 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m15:30:27.623884 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d78220-d025-4750-a6fc-584c143dd0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa4bc0>]}
[0m15:30:27.624109 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd3d78220-d025-4750-a6fc-584c143dd0c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111450e60>]}
[0m15:30:27.624442 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.15s]
[0m15:30:27.624781 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.15s]
[0m15:30:27.625129 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m15:30:27.625432 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m15:30:27.626200 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:27.626428 [debug] [MainThread]: On master: BEGIN
[0m15:30:27.626622 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:27.636533 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m15:30:27.637109 [debug] [MainThread]: On master: COMMIT
[0m15:30:27.637328 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:27.637520 [debug] [MainThread]: On master: COMMIT
[0m15:30:27.638606 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:30:27.638908 [debug] [MainThread]: On master: Close
[0m15:30:27.639195 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:27.639387 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m15:30:27.639564 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m15:30:27.639776 [info ] [MainThread]: 
[0m15:30:27.639992 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m15:30:27.640446 [debug] [MainThread]: Command end result
[0m15:30:27.694703 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m15:30:27.696165 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m15:30:27.699283 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m15:30:27.699515 [info ] [MainThread]: 
[0m15:30:27.699810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:30:27.700036 [info ] [MainThread]: 
[0m15:30:27.700260 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m15:30:27.703416 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.84582156, "process_in_blocks": "0", "process_kernel_time": 0.194618, "process_mem_max_rss": "129646592", "process_out_blocks": "0", "process_user_time": 1.273294}
[0m15:30:27.704456 [debug] [MainThread]: Command `dbt seed` succeeded at 15:30:27.704298 after 0.85 seconds
[0m15:30:27.705468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11141b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11141a2a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11141b500>]}
[0m15:30:27.706660 [debug] [MainThread]: Flushing usage events
[0m15:30:28.113052 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:30:29.191765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a3b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105071bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105071550>]}


============================== 15:30:29.194098 | 6c489ffb-d718-4bb6-9c03-0d3d4e6116bc ==============================
[0m15:30:29.194098 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:30:29.194460 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir ..', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:30:29.250309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c489ffb-d718-4bb6-9c03-0d3d4e6116bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e36c30>]}
[0m15:30:29.282401 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-hdu61k5v'
[0m15:30:29.282798 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:30:29.395346 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:30:29.396050 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:30:29.450844 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:30:29.461573 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:30:29.813217 [info ] [MainThread]: Installed from version 1.3.0
[0m15:30:29.813691 [info ] [MainThread]: Up to date!
[0m15:30:29.814033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '6c489ffb-d718-4bb6-9c03-0d3d4e6116bc', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105184ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043a40e0>]}
[0m15:30:29.816436 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.65822476, "process_in_blocks": "0", "process_kernel_time": 0.136747, "process_mem_max_rss": "111738880", "process_out_blocks": "0", "process_user_time": 0.76759}
[0m15:30:29.816887 [debug] [MainThread]: Command `dbt deps` succeeded at 15:30:29.816811 after 0.66 seconds
[0m15:30:29.817194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105071970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10487a270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051baf60>]}
[0m15:30:29.817471 [debug] [MainThread]: Flushing usage events
[0m15:30:30.195417 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:30:31.326622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11918c170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119af9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119af9640>]}


============================== 15:30:31.329006 | 066f942d-923a-4f25-8899-f620c7981015 ==============================
[0m15:30:31.329006 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:30:31.329371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '..', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ..', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:30:31.422334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '066f942d-923a-4f25-8899-f620c7981015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a99bf50>]}
[0m15:30:31.452433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '066f942d-923a-4f25-8899-f620c7981015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f3b260>]}
[0m15:30:31.453035 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:30:31.516903 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m15:30:31.593008 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:30:31.593372 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:30:31.622487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '066f942d-923a-4f25-8899-f620c7981015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b2a3e30>]}
[0m15:30:31.676441 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m15:30:31.677867 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m15:30:31.686266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '066f942d-923a-4f25-8899-f620c7981015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b0bcc50>]}
[0m15:30:31.686618 [info ] [MainThread]: Found 7 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m15:30:31.686852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '066f942d-923a-4f25-8899-f620c7981015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aaa14f0>]}
[0m15:30:31.688020 [info ] [MainThread]: 
[0m15:30:31.688265 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:30:31.688457 [info ] [MainThread]: 
[0m15:30:31.688774 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:30:31.691037 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m15:30:31.722053 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m15:30:31.722519 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:30:31.722780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:31.759805 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.037 seconds
[0m15:30:31.760769 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m15:30:31.761878 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m15:30:31.765486 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m15:30:31.765780 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m15:30:31.765966 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:31.772818 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:30:31.773174 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m15:30:31.773547 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:30:31.777068 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m15:30:31.777961 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m15:30:31.778421 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m15:30:31.782090 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:31.782406 [debug] [MainThread]: On master: BEGIN
[0m15:30:31.782601 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:31.789980 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:30:31.790223 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:31.790479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:30:31.793897 [debug] [MainThread]: SQL status: SELECT 7 in 0.003 seconds
[0m15:30:31.795260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '066f942d-923a-4f25-8899-f620c7981015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b690c80>]}
[0m15:30:31.795557 [debug] [MainThread]: On master: ROLLBACK
[0m15:30:31.795981 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:31.796166 [debug] [MainThread]: On master: BEGIN
[0m15:30:31.796711 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:30:31.796923 [debug] [MainThread]: On master: COMMIT
[0m15:30:31.797115 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:31.797295 [debug] [MainThread]: On master: COMMIT
[0m15:30:31.797708 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:30:31.797898 [debug] [MainThread]: On master: Close
[0m15:30:31.799421 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m15:30:31.799677 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m15:30:31.800194 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m15:30:31.799995 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_episodes ................................ [RUN]
[0m15:30:31.800482 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m15:30:31.800756 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_user_events ............................. [RUN]
[0m15:30:31.801038 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_user_events_invalid ..................... [RUN]
[0m15:30:31.801311 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m15:30:31.801589 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_users ................................... [RUN]
[0m15:30:31.801883 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m15:30:31.802154 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m15:30:31.802373 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m15:30:31.802624 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m15:30:31.802839 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m15:30:31.803062 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m15:30:31.808084 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m15:30:31.808619 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m15:30:31.817900 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m15:30:31.819603 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m15:30:31.821373 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m15:30:31.821781 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m15:30:31.822511 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m15:30:31.823167 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m15:30:31.823724 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m15:30:31.845731 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m15:30:31.849498 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m15:30:31.851747 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m15:30:31.855709 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events_invalid"
[0m15:30:31.856634 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m15:30:31.857005 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m15:30:31.857281 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m15:30:31.857538 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m15:30:31.857778 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m15:30:31.858054 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:30:31.858330 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m15:30:31.858572 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: BEGIN
[0m15:30:31.858811 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: BEGIN
[0m15:30:31.859115 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:31.859360 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:30:31.859603 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:30:31.870276 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m15:30:31.870575 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m15:30:31.870871 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
-- Note: Invalid events are captured in stg_user_events_invalid.sql for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

valid_events as (
    select * from source
    where data ->> 'event_type' is not null
      and data ->> 'event_type' in ('play', 'pause', 'seek', 'complete')
      and data ->> 'timestamp' is not null
      and data ->> 'timestamp' != ''
      and data ->> 'user_id' is not null
      and data ->> 'episode_id' is not null
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'timestamp' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'event_type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        case 
            when (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}' then (data ->> 'timestamp')::timestamp
            else null
        end as event_ts,
        data ->> 'event_type'         as event_type,
        (data ->> 'duration')::integer as duration
    from valid_events
    where (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}'
)
select * from typed
  );
[0m15:30:31.871182 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m15:30:31.871461 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m15:30:31.871719 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m15:30:31.875397 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m15:30:31.875642 [debug] [Thread-4 (]: SQL status: BEGIN in 0.016 seconds
[0m15:30:31.875891 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m15:30:31.876121 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m15:30:31.876417 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */

  create view "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp"
    
    
  as (
    -- stg_user_events_invalid.sql : capture invalid event records for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

invalid_events as (
    select 
        data,
        data ->> 'user_id' as user_id,
        data ->> 'episode_id' as episode_id,
        data ->> 'timestamp' as timestamp,
        data ->> 'event_type' as event_type,
        data ->> 'duration' as duration,
        case 
            when data ->> 'event_type' is null then 'missing_event_type'
            when data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete') then 'invalid_event_type'
            when data ->> 'timestamp' is null or data ->> 'timestamp' = '' then 'missing_timestamp'
            when not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}') then 'malformed_timestamp'
            when data ->> 'user_id' is null then 'missing_user_id'
            when data ->> 'episode_id' is null then 'missing_episode_id'
            else 'other_issue'
        end as issue_type
    from source
    where data ->> 'event_type' is null 
       or data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete')
       or data ->> 'timestamp' is null 
       or data ->> 'timestamp' = ''
       or not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}')
       or data ->> 'user_id' is null
       or data ->> 'episode_id' is null
)

select * from invalid_events
  );
[0m15:30:31.876724 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m15:30:31.877705 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m15:30:31.881698 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m15:30:31.881956 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m15:30:31.882216 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:30:31.882441 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m15:30:31.882656 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m15:30:31.884420 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m15:30:31.886053 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m15:30:31.887859 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m15:30:31.888088 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:30:31.888329 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m15:30:31.888571 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m15:30:31.888816 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid" rename to "stg_user_events_invalid__dbt_backup"
[0m15:30:31.890312 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m15:30:31.890682 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m15:30:31.891430 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:30:31.891646 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:30:31.891849 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:30:31.892108 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:30:31.893590 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m15:30:31.895779 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m15:30:31.897233 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m15:30:31.906412 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m15:30:31.906723 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m15:30:31.906975 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m15:30:31.907209 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp" rename to "stg_user_events_invalid"
[0m15:30:31.907437 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m15:30:31.907762 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m15:30:31.909433 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:30:31.909661 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:30:31.910594 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m15:30:31.910797 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:30:31.910988 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:30:31.911921 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m15:30:31.912147 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m15:30:31.912981 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m15:30:31.916075 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m15:30:31.916304 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m15:30:31.916527 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m15:30:31.916737 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m15:30:31.919176 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m15:30:31.919399 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m15:30:31.919653 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m15:30:31.919911 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m15:30:31.921884 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:30:31.923304 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup"
[0m15:30:31.923539 [debug] [Thread-4 (]: SQL status: COMMIT in 0.003 seconds
[0m15:30:31.923762 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m15:30:31.924310 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m15:30:31.924526 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m15:30:31.925845 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m15:30:31.927049 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m15:30:31.927288 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
drop view if exists "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup" cascade
[0m15:30:31.928692 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m15:30:31.929191 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m15:30:31.929658 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m15:30:31.930281 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m15:30:31.930892 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m15:30:31.931190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066f942d-923a-4f25-8899-f620c7981015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c225a0>]}
[0m15:30:31.931610 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m15:30:31.931968 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m15:30:31.934501 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:30:31.935194 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: Close
[0m15:30:31.935509 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066f942d-923a-4f25-8899-f620c7981015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b62be90>]}
[0m15:30:31.935863 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_user_events_invalid ................ [[32mCREATE VIEW[0m in 0.13s]
[0m15:30:31.936100 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:30:31.936399 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m15:30:31.936612 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:30:31.937255 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: Close
[0m15:30:31.938412 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m15:30:31.938743 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066f942d-923a-4f25-8899-f620c7981015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b682690>]}
[0m15:30:31.939070 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066f942d-923a-4f25-8899-f620c7981015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f81cb30>]}
[0m15:30:31.939534 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.14s]
[0m15:30:31.940324 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m15:30:31.939853 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.14s]
[0m15:30:31.940893 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m15:30:31.941660 [debug] [Thread-1 (]: Began running node model.podcast_analytics.int_user_sessions
[0m15:30:31.941951 [debug] [Thread-3 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m15:30:31.942264 [info ] [Thread-1 (]: 5 of 7 START sql view model public.int_user_sessions ........................... [RUN]
[0m15:30:31.942730 [info ] [Thread-3 (]: 6 of 7 START sql view model public.mart_top_episodes ........................... [RUN]
[0m15:30:31.943122 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.int_user_sessions)
[0m15:30:31.943361 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now model.podcast_analytics.mart_top_episodes)
[0m15:30:31.943671 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m15:30:31.943891 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m15:30:31.947382 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m15:30:31.950421 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m15:30:31.953103 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m15:30:31.953341 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m15:30:31.958807 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m15:30:31.962746 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m15:30:31.963369 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m15:30:31.963634 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m15:30:31.963874 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m15:30:31.964121 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m15:30:31.964351 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:30:31.964568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:31.976697 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m15:30:31.977050 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m15:30:31.977352 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m15:30:31.977605 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m15:30:31.977881 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m15:30:31.978207 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end,
        sum(coalesce(duration, 0)) as total_listening_duration
    from numbered
    group by user_id, session_number
),

final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        total_listening_duration as session_duration
    from agg
)

select * from final
  );
[0m15:30:31.983366 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m15:30:32.020864 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.042 seconds
[0m15:30:32.021910 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m15:30:32.023545 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m15:30:32.023797 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m15:30:32.024032 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m15:30:32.025847 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:30:32.026685 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m15:30:32.026899 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m15:30:32.027105 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:30:32.027319 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m15:30:32.028111 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m15:30:32.028348 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m15:30:32.028543 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m15:30:32.030090 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:30:32.031244 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m15:30:32.031457 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m15:30:32.031884 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m15:30:32.032924 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m15:30:32.033137 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m15:30:32.033605 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m15:30:32.033857 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m15:30:32.034773 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:30:32.034978 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:30:32.035649 [debug] [Thread-3 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m15:30:32.036236 [debug] [Thread-1 (]: On model.podcast_analytics.int_user_sessions: Close
[0m15:30:32.036575 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066f942d-923a-4f25-8899-f620c7981015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f936300>]}
[0m15:30:32.036836 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066f942d-923a-4f25-8899-f620c7981015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b32ed20>]}
[0m15:30:32.037194 [info ] [Thread-3 (]: 6 of 7 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m15:30:32.037511 [info ] [Thread-1 (]: 5 of 7 OK created sql view model public.int_user_sessions ...................... [[32mCREATE VIEW[0m in 0.09s]
[0m15:30:32.037822 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m15:30:32.038094 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m15:30:32.038535 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m15:30:32.038833 [info ] [Thread-2 (]: 7 of 7 START sql view model public.mart_user_session_metrics ................... [RUN]
[0m15:30:32.039095 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now model.podcast_analytics.mart_user_session_metrics)
[0m15:30:32.039316 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m15:30:32.041096 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m15:30:32.041791 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m15:30:32.043692 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m15:30:32.044112 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m15:30:32.045074 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m15:30:32.045721 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:30:32.058812 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m15:30:32.059852 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m15:30:32.060373 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  create view "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
    
    
  as (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
[0m15:30:32.064443 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m15:30:32.066551 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m15:30:32.066822 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m15:30:32.068446 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:30:32.070431 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m15:30:32.070717 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m15:30:32.070942 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m15:30:32.073491 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:30:32.075151 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m15:30:32.075677 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m15:30:32.075917 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop view if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m15:30:32.077052 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:30:32.077842 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m15:30:32.078225 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '066f942d-923a-4f25-8899-f620c7981015', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f936c00>]}
[0m15:30:32.078642 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.mart_user_session_metrics .............. [[32mCREATE VIEW[0m in 0.04s]
[0m15:30:32.079020 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m15:30:32.079815 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:32.080030 [debug] [MainThread]: On master: BEGIN
[0m15:30:32.080225 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:32.097957 [debug] [MainThread]: SQL status: BEGIN in 0.018 seconds
[0m15:30:32.098284 [debug] [MainThread]: On master: COMMIT
[0m15:30:32.098495 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:32.098689 [debug] [MainThread]: On master: COMMIT
[0m15:30:32.099362 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:30:32.099564 [debug] [MainThread]: On master: Close
[0m15:30:32.099846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:32.100042 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m15:30:32.100230 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m15:30:32.100409 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m15:30:32.100584 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_users' was properly closed.
[0m15:30:32.100844 [info ] [MainThread]: 
[0m15:30:32.101074 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.41 seconds (0.41s).
[0m15:30:32.101852 [debug] [MainThread]: Command end result
[0m15:30:32.119428 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m15:30:32.120777 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m15:30:32.125155 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m15:30:32.125468 [info ] [MainThread]: 
[0m15:30:32.125733 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:30:32.125932 [info ] [MainThread]: 
[0m15:30:32.126152 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m15:30:32.127808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.8370252, "process_in_blocks": "0", "process_kernel_time": 0.183453, "process_mem_max_rss": "131973120", "process_out_blocks": "0", "process_user_time": 1.392073}
[0m15:30:32.128089 [debug] [MainThread]: Command `dbt run` succeeded at 15:30:32.128043 after 0.84 seconds
[0m15:30:32.128331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022bb290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119583d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195806e0>]}
[0m15:30:32.128565 [debug] [MainThread]: Flushing usage events
[0m15:30:32.561841 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:30:33.485189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111dd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123f5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123f5670>]}


============================== 15:30:33.487578 | 92c74bfb-53c5-428e-ac6d-9a862f478ef8 ==============================
[0m15:30:33.487578 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:30:33.487932 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'profiles_dir': '..', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --profiles-dir ..', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:30:33.572080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92c74bfb-53c5-428e-ac6d-9a862f478ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111de870>]}
[0m15:30:33.599177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92c74bfb-53c5-428e-ac6d-9a862f478ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec0da0>]}
[0m15:30:33.599840 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:30:33.655276 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m15:30:33.724618 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:30:33.725044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:30:33.751818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92c74bfb-53c5-428e-ac6d-9a862f478ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115bbbad0>]}
[0m15:30:33.802668 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m15:30:33.803912 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m15:30:33.817420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92c74bfb-53c5-428e-ac6d-9a862f478ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115cc1a30>]}
[0m15:30:33.817780 [info ] [MainThread]: Found 7 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m15:30:33.818007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92c74bfb-53c5-428e-ac6d-9a862f478ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1124a6480>]}
[0m15:30:33.819132 [info ] [MainThread]: 
[0m15:30:33.819360 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:30:33.819540 [info ] [MainThread]: 
[0m15:30:33.819844 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:30:33.821973 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m15:30:33.846198 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m15:30:33.846514 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m15:30:33.846709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:33.869127 [debug] [ThreadPool]: SQL status: BEGIN in 0.022 seconds
[0m15:30:33.869454 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m15:30:33.869667 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:30:33.873778 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m15:30:33.874712 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m15:30:33.875824 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m15:30:33.879118 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:33.879315 [debug] [MainThread]: On master: BEGIN
[0m15:30:33.879478 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:33.892688 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m15:30:33.892965 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:33.893208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:30:33.898709 [debug] [MainThread]: SQL status: SELECT 7 in 0.005 seconds
[0m15:30:33.899916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92c74bfb-53c5-428e-ac6d-9a862f478ef8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115cfbbf0>]}
[0m15:30:33.900199 [debug] [MainThread]: On master: ROLLBACK
[0m15:30:33.900824 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:33.900993 [debug] [MainThread]: On master: BEGIN
[0m15:30:33.901824 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:30:33.901990 [debug] [MainThread]: On master: COMMIT
[0m15:30:33.902150 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:33.902306 [debug] [MainThread]: On master: COMMIT
[0m15:30:33.902805 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:30:33.902972 [debug] [MainThread]: On master: Close
[0m15:30:33.904286 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m15:30:33.904548 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m15:30:33.904784 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m15:30:33.905177 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m15:30:33.905014 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m15:30:33.905482 [info ] [Thread-2 (]: 2 of 8 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [RUN]
[0m15:30:33.905714 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_episodes_episode_id ............................. [RUN]
[0m15:30:33.905927 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_user_events_event_id ............................ [RUN]
[0m15:30:33.906166 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m15:30:33.906436 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7'
[0m15:30:33.906667 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422'
[0m15:30:33.906886 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7'
[0m15:30:33.907082 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m15:30:33.907280 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m15:30:33.907501 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m15:30:33.907731 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m15:30:33.917548 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m15:30:33.921191 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m15:30:33.926758 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m15:30:33.928746 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m15:30:33.929543 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m15:30:33.929770 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m15:30:33.929974 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m15:30:33.930182 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m15:30:33.938277 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m15:30:33.939447 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m15:30:33.940563 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m15:30:33.941802 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m15:30:33.942514 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m15:30:33.942828 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: BEGIN
[0m15:30:33.943105 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:30:33.943321 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m15:30:33.943533 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m15:30:33.943730 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m15:30:33.943986 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m15:30:33.944180 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m15:30:33.944371 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m15:30:33.944554 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:30:33.944734 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:30:33.944918 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:33.956900 [debug] [Thread-2 (]: SQL status: BEGIN in 0.014 seconds
[0m15:30:33.957125 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m15:30:33.957468 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','missing_timestamp','malformed_timestamp','missing_user_id','missing_episode_id','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m15:30:33.957740 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m15:30:33.957920 [debug] [Thread-4 (]: SQL status: BEGIN in 0.013 seconds
[0m15:30:33.958158 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m15:30:33.958351 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m15:30:33.958559 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m15:30:33.958778 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m15:30:33.959073 [debug] [Thread-1 (]: SQL status: BEGIN in 0.014 seconds
[0m15:30:33.959277 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m15:30:33.959492 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m15:30:33.960317 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:30:33.962559 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m15:30:33.963405 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m15:30:33.963760 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_episodes_episode_id ................................... [[32mPASS[0m in 0.06s]
[0m15:30:33.964080 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m15:30:33.964308 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m15:30:33.964569 [info ] [Thread-3 (]: 5 of 8 START test not_null_stg_users_user_id ................................... [RUN]
[0m15:30:33.964837 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m15:30:33.965052 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m15:30:33.967196 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m15:30:33.967783 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m15:30:33.970877 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m15:30:33.971327 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m15:30:33.971538 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m15:30:33.971729 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:30:33.972361 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.014 seconds
[0m15:30:33.972583 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.013 seconds
[0m15:30:33.973474 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: ROLLBACK
[0m15:30:33.974477 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m15:30:33.975750 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: Close
[0m15:30:33.976111 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m15:30:33.976569 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.017 seconds
[0m15:30:33.977729 [info ] [Thread-2 (]: 2 of 8 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [[32mPASS[0m in 0.07s]
[0m15:30:33.978415 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.07s]
[0m15:30:33.979441 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m15:30:33.979789 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m15:30:33.980127 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m15:30:33.980460 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m15:30:33.980756 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m15:30:33.980987 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m15:30:33.981222 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m15:30:33.981477 [info ] [Thread-2 (]: 6 of 8 START test unique_stg_episodes_episode_id ............................... [RUN]
[0m15:30:33.981719 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m15:30:33.982042 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_user_events_event_id .................................. [[32mPASS[0m in 0.08s]
[0m15:30:33.982283 [info ] [Thread-1 (]: 7 of 8 START test unique_stg_user_events_event_id .............................. [RUN]
[0m15:30:33.983044 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m15:30:33.983295 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m15:30:33.983614 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m15:30:33.983839 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m15:30:33.984059 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m15:30:33.984313 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m15:30:33.984538 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m15:30:33.988025 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m15:30:33.988632 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m15:30:33.988893 [info ] [Thread-4 (]: 8 of 8 START test unique_stg_users_user_id ..................................... [RUN]
[0m15:30:33.991005 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m15:30:33.991992 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m15:30:33.992376 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m15:30:33.992845 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m15:30:33.993195 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m15:30:33.993407 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m15:30:33.997023 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m15:30:33.997304 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m15:30:33.999530 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m15:30:34.000856 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m15:30:34.001350 [info ] [Thread-3 (]: 5 of 8 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.04s]
[0m15:30:34.001898 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m15:30:34.002194 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m15:30:34.002413 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m15:30:34.002809 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m15:30:34.003036 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: BEGIN
[0m15:30:34.004348 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m15:30:34.004591 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: BEGIN
[0m15:30:34.004822 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:30:34.005074 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:34.005465 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m15:30:34.005691 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m15:30:34.005893 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:30:34.014720 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m15:30:34.015071 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m15:30:34.015377 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m15:30:34.015641 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m15:30:34.015916 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_user_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:30:34.016184 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:30:34.016423 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m15:30:34.016718 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m15:30:34.016971 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:30:34.017698 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:30:34.018065 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:30:34.018962 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: ROLLBACK
[0m15:30:34.019651 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m15:30:34.020167 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: Close
[0m15:30:34.020381 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m15:30:34.020798 [info ] [Thread-2 (]: 6 of 8 PASS unique_stg_episodes_episode_id ..................................... [[32mPASS[0m in 0.04s]
[0m15:30:34.021489 [info ] [Thread-4 (]: 8 of 8 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.03s]
[0m15:30:34.022429 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m15:30:34.022729 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m15:30:34.037658 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m15:30:34.038687 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: ROLLBACK
[0m15:30:34.039302 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: Close
[0m15:30:34.039702 [info ] [Thread-1 (]: 7 of 8 PASS unique_stg_user_events_event_id .................................... [[32mPASS[0m in 0.06s]
[0m15:30:34.040143 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m15:30:34.042317 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:34.042607 [debug] [MainThread]: On master: BEGIN
[0m15:30:34.042825 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:34.049544 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:30:34.049827 [debug] [MainThread]: On master: COMMIT
[0m15:30:34.050021 [debug] [MainThread]: Using postgres connection "master"
[0m15:30:34.050198 [debug] [MainThread]: On master: COMMIT
[0m15:30:34.050579 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:30:34.050801 [debug] [MainThread]: On master: Close
[0m15:30:34.051078 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:34.051259 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m15:30:34.051430 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16' was properly closed.
[0m15:30:34.051598 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m15:30:34.051765 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m15:30:34.051985 [info ] [MainThread]: 
[0m15:30:34.052238 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m15:30:34.053033 [debug] [MainThread]: Command end result
[0m15:30:34.108756 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m15:30:34.109817 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m15:30:34.113202 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m15:30:34.113399 [info ] [MainThread]: 
[0m15:30:34.113610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:30:34.113777 [info ] [MainThread]: 
[0m15:30:34.113961 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m15:30:34.115723 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6666234, "process_in_blocks": "0", "process_kernel_time": 0.143797, "process_mem_max_rss": "133660672", "process_out_blocks": "0", "process_user_time": 1.174453}
[0m15:30:34.115978 [debug] [MainThread]: Command `dbt test` succeeded at 15:30:34.115938 after 0.67 seconds
[0m15:30:34.116193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f51b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cd3290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111bcbc0>]}
[0m15:30:34.116396 [debug] [MainThread]: Flushing usage events
[0m15:30:34.472505 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:03.699131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108209d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8fd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8fd1f0>]}


============================== 15:44:03.702893 | a428b3a3-c281-40d0-8f50-6f74040324fb ==============================
[0m15:44:03.702893 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:44:03.703317 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'profiles_dir': '/Users/samydoreau/global-assignment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt deps --profiles-dir /Users/samydoreau/global-assignment', 'send_anonymous_usage_stats': 'True'}
[0m15:44:03.775791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a428b3a3-c281-40d0-8f50-6f74040324fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9caae0>]}
[0m15:44:03.811498 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-m8w3btnm'
[0m15:44:03.811857 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:44:03.907453 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:44:03.907997 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:44:03.960834 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:44:03.962738 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:44:04.203428 [info ] [MainThread]: Installed from version 1.3.0
[0m15:44:04.203765 [info ] [MainThread]: Up to date!
[0m15:44:04.204005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'a428b3a3-c281-40d0-8f50-6f74040324fb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bab1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bab18b0>]}
[0m15:44:04.206286 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.55694973, "process_in_blocks": "0", "process_kernel_time": 0.164581, "process_mem_max_rss": "112754688", "process_out_blocks": "0", "process_user_time": 0.746083}
[0m15:44:04.206588 [debug] [MainThread]: Command `dbt deps` succeeded at 15:44:04.206536 after 0.56 seconds
[0m15:44:04.206809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8fd460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10946eae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9caae0>]}
[0m15:44:04.207015 [debug] [MainThread]: Flushing usage events
[0m15:44:04.630450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:05.688622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107056ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119df9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119df9310>]}


============================== 15:44:05.691680 | a8287a63-540e-4abf-abc6-8160de125f85 ==============================
[0m15:44:05.691680 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:44:05.692152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'profiles_dir': '/Users/samydoreau/global-assignment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed --profiles-dir /Users/samydoreau/global-assignment', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:44:05.810931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8287a63-540e-4abf-abc6-8160de125f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11be09160>]}
[0m15:44:05.854108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8287a63-540e-4abf-abc6-8160de125f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b1d3920>]}
[0m15:44:05.855138 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:44:05.928021 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m15:44:06.022005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:44:06.022361 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:44:06.055177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8287a63-540e-4abf-abc6-8160de125f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2beff0>]}
[0m15:44:06.121749 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m15:44:06.124120 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m15:44:06.139972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8287a63-540e-4abf-abc6-8160de125f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2f5eb0>]}
[0m15:44:06.140534 [info ] [MainThread]: Found 7 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m15:44:06.140866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8287a63-540e-4abf-abc6-8160de125f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b12c0b0>]}
[0m15:44:06.142500 [info ] [MainThread]: 
[0m15:44:06.142828 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:44:06.143069 [info ] [MainThread]: 
[0m15:44:06.143493 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:44:06.146505 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m15:44:06.194075 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m15:44:06.194461 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:44:06.194709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:06.261028 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.066 seconds
[0m15:44:06.262106 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m15:44:06.263249 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m15:44:06.267107 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m15:44:06.267416 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m15:44:06.267631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:06.277344 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m15:44:06.277780 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m15:44:06.278072 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:44:06.282168 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.004 seconds
[0m15:44:06.283266 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m15:44:06.284261 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m15:44:06.288770 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:06.289114 [debug] [MainThread]: On master: BEGIN
[0m15:44:06.289345 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:44:06.296885 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:44:06.297168 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:06.297453 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:44:06.301154 [debug] [MainThread]: SQL status: SELECT 7 in 0.003 seconds
[0m15:44:06.302739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8287a63-540e-4abf-abc6-8160de125f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106564680>]}
[0m15:44:06.303080 [debug] [MainThread]: On master: ROLLBACK
[0m15:44:06.303613 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:06.303825 [debug] [MainThread]: On master: BEGIN
[0m15:44:06.304499 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:44:06.304702 [debug] [MainThread]: On master: COMMIT
[0m15:44:06.304897 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:06.305083 [debug] [MainThread]: On master: COMMIT
[0m15:44:06.305525 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:44:06.305813 [debug] [MainThread]: On master: Close
[0m15:44:06.308022 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m15:44:06.308288 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m15:44:06.308646 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m15:44:06.308992 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m15:44:06.309320 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m15:44:06.309628 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m15:44:06.309872 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m15:44:06.310104 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m15:44:06.310340 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m15:44:06.310564 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m15:44:06.331750 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m15:44:06.334094 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m15:44:06.334386 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m15:44:06.334830 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m15:44:06.335120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:06.335628 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:44:06.350312 [debug] [Thread-1 (]: SQL status: BEGIN in 0.015 seconds
[0m15:44:06.350799 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m15:44:06.351094 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m15:44:06.356019 [debug] [Thread-2 (]: SQL status: BEGIN in 0.020 seconds
[0m15:44:06.356429 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.005 seconds
[0m15:44:06.356743 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m15:44:06.382212 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m15:44:06.398155 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m15:44:06.398474 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m15:44:06.398774 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m15:44:06.432601 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.008 seconds
[0m15:44:06.435217 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m15:44:06.438860 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m15:44:06.439156 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m15:44:06.447985 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.008 seconds
[0m15:44:06.448216 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m15:44:06.448662 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m15:44:06.448911 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m15:44:06.449212 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m15:44:06.450227 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m15:44:06.450470 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m15:44:06.450705 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m15:44:06.453050 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m15:44:06.453343 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m15:44:06.454623 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m15:44:06.455167 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m15:44:06.457107 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8287a63-540e-4abf-abc6-8160de125f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106491f70>]}
[0m15:44:06.457369 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8287a63-540e-4abf-abc6-8160de125f85', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d844860>]}
[0m15:44:06.457762 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.15s]
[0m15:44:06.458168 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.15s]
[0m15:44:06.458554 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m15:44:06.458869 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m15:44:06.459811 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:06.460030 [debug] [MainThread]: On master: BEGIN
[0m15:44:06.460222 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:44:06.471223 [debug] [MainThread]: SQL status: BEGIN in 0.011 seconds
[0m15:44:06.471960 [debug] [MainThread]: On master: COMMIT
[0m15:44:06.472367 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:06.472840 [debug] [MainThread]: On master: COMMIT
[0m15:44:06.473844 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m15:44:06.474065 [debug] [MainThread]: On master: Close
[0m15:44:06.474356 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:06.474560 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m15:44:06.474746 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m15:44:06.474979 [info ] [MainThread]: 
[0m15:44:06.475227 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m15:44:06.475759 [debug] [MainThread]: Command end result
[0m15:44:06.534806 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m15:44:06.536264 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m15:44:06.539985 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m15:44:06.540224 [info ] [MainThread]: 
[0m15:44:06.540496 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:44:06.540708 [info ] [MainThread]: 
[0m15:44:06.540929 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m15:44:06.542726 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.94056827, "process_in_blocks": "0", "process_kernel_time": 0.194136, "process_mem_max_rss": "130957312", "process_out_blocks": "0", "process_user_time": 1.379509}
[0m15:44:06.543033 [debug] [MainThread]: Command `dbt seed` succeeded at 15:44:06.542983 after 0.94 seconds
[0m15:44:06.543288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193b9160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192b5a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107056ff0>]}
[0m15:44:06.543535 [debug] [MainThread]: Flushing usage events
[0m15:44:06.903192 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:07.892417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c6180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086b7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f355b0>]}


============================== 15:44:07.894891 | a92e9c9f-bb4c-4c90-93a3-8ea9750768f4 ==============================
[0m15:44:07.894891 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:44:07.895270 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/samydoreau/global-assignment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /Users/samydoreau/global-assignment', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:44:07.984615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a92e9c9f-bb4c-4c90-93a3-8ea9750768f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c78c0>]}
[0m15:44:08.013511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a92e9c9f-bb4c-4c90-93a3-8ea9750768f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e1a30>]}
[0m15:44:08.014100 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:44:08.074608 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m15:44:08.145473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:44:08.145799 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:44:08.177543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a92e9c9f-bb4c-4c90-93a3-8ea9750768f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a4df40>]}
[0m15:44:08.234781 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m15:44:08.236644 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m15:44:08.245248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a92e9c9f-bb4c-4c90-93a3-8ea9750768f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cdd430>]}
[0m15:44:08.245584 [info ] [MainThread]: Found 7 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m15:44:08.245821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a92e9c9f-bb4c-4c90-93a3-8ea9750768f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c9b440>]}
[0m15:44:08.246967 [info ] [MainThread]: 
[0m15:44:08.247216 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:44:08.247405 [info ] [MainThread]: 
[0m15:44:08.247710 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:44:08.249936 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m15:44:08.275051 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m15:44:08.275471 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:44:08.275744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:08.295866 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m15:44:08.296804 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m15:44:08.297858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m15:44:08.301341 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m15:44:08.301651 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m15:44:08.301981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:44:08.308933 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:44:08.309189 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m15:44:08.309402 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:44:08.311127 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.002 seconds
[0m15:44:08.312046 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m15:44:08.312502 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m15:44:08.315886 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:08.316106 [debug] [MainThread]: On master: BEGIN
[0m15:44:08.316282 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:44:08.323483 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:44:08.323726 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:08.323986 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:44:08.328282 [debug] [MainThread]: SQL status: SELECT 7 in 0.004 seconds
[0m15:44:08.329590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a92e9c9f-bb4c-4c90-93a3-8ea9750768f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a058080>]}
[0m15:44:08.329885 [debug] [MainThread]: On master: ROLLBACK
[0m15:44:08.330364 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:08.330619 [debug] [MainThread]: On master: BEGIN
[0m15:44:08.331232 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:44:08.331425 [debug] [MainThread]: On master: COMMIT
[0m15:44:08.331613 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:08.331786 [debug] [MainThread]: On master: COMMIT
[0m15:44:08.332161 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:44:08.332345 [debug] [MainThread]: On master: Close
[0m15:44:08.333817 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m15:44:08.334090 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m15:44:08.334341 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m15:44:08.334568 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m15:44:08.334880 [info ] [Thread-1 (]: 1 of 7 START sql view model public.stg_episodes ................................ [RUN]
[0m15:44:08.335191 [info ] [Thread-2 (]: 2 of 7 START sql view model public.stg_user_events ............................. [RUN]
[0m15:44:08.335584 [info ] [Thread-3 (]: 3 of 7 START sql view model public.stg_user_events_invalid ..................... [RUN]
[0m15:44:08.335946 [info ] [Thread-4 (]: 4 of 7 START sql view model public.stg_users ................................... [RUN]
[0m15:44:08.336258 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m15:44:08.336555 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m15:44:08.336864 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m15:44:08.337136 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m15:44:08.337381 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m15:44:08.337607 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m15:44:08.337831 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m15:44:08.338039 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m15:44:08.342685 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m15:44:08.351013 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m15:44:08.352670 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m15:44:08.354380 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m15:44:08.355218 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m15:44:08.355455 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m15:44:08.361920 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m15:44:08.368306 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m15:44:08.375859 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m15:44:08.379012 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m15:44:08.380901 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m15:44:08.382691 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events_invalid"
[0m15:44:08.383479 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m15:44:08.383728 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m15:44:08.383996 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m15:44:08.384251 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m15:44:08.384499 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m15:44:08.384738 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: BEGIN
[0m15:44:08.384968 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m15:44:08.385187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:08.385416 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: BEGIN
[0m15:44:08.385775 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:44:08.386025 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:44:08.386357 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:44:08.398023 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m15:44:08.398396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m15:44:08.398713 [debug] [Thread-2 (]: SQL status: BEGIN in 0.013 seconds
[0m15:44:08.398976 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m15:44:08.399236 [debug] [Thread-3 (]: SQL status: BEGIN in 0.013 seconds
[0m15:44:08.399476 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m15:44:08.399697 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m15:44:08.399938 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m15:44:08.400199 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m15:44:08.400453 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m15:44:08.400764 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
-- Note: Invalid events are captured in stg_user_events_invalid.sql for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

valid_events as (
    select * from source
    where data ->> 'event_type' is not null
      and data ->> 'event_type' in ('play', 'pause', 'seek', 'complete')
      and data ->> 'timestamp' is not null
      and data ->> 'timestamp' != ''
      and data ->> 'user_id' is not null
      and data ->> 'episode_id' is not null
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'timestamp' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'event_type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        case 
            when (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}' then (data ->> 'timestamp')::timestamp
            else null
        end as event_ts,
        data ->> 'event_type'         as event_type,
        (data ->> 'duration')::integer as duration
    from valid_events
    where (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}'
)
select * from typed
  );
[0m15:44:08.401171 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */

  create view "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp"
    
    
  as (
    -- stg_user_events_invalid.sql : capture invalid event records for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

invalid_events as (
    select 
        data,
        data ->> 'user_id' as user_id,
        data ->> 'episode_id' as episode_id,
        data ->> 'timestamp' as timestamp,
        data ->> 'event_type' as event_type,
        data ->> 'duration' as duration,
        case 
            when data ->> 'event_type' is null then 'missing_event_type'
            when data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete') then 'invalid_event_type'
            when data ->> 'timestamp' is null or data ->> 'timestamp' = '' then 'missing_timestamp'
            when not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}') then 'malformed_timestamp'
            when data ->> 'user_id' is null then 'missing_user_id'
            when data ->> 'episode_id' is null then 'missing_episode_id'
            else 'other_issue'
        end as issue_type
    from source
    where data ->> 'event_type' is null 
       or data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete')
       or data ->> 'timestamp' is null 
       or data ->> 'timestamp' = ''
       or not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}')
       or data ->> 'user_id' is null
       or data ->> 'episode_id' is null
)

select * from invalid_events
  );
[0m15:44:08.403470 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:44:08.403959 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:44:08.404433 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:44:08.408565 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m15:44:08.408819 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m15:44:08.410680 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m15:44:08.412352 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m15:44:08.412599 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m15:44:08.414190 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m15:44:08.414433 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m15:44:08.414675 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid" rename to "stg_user_events_invalid__dbt_backup"
[0m15:44:08.414973 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m15:44:08.415473 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:44:08.417228 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m15:44:08.417470 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:44:08.417682 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:44:08.417917 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m15:44:08.418162 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m15:44:08.419847 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m15:44:08.422606 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m15:44:08.424151 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m15:44:08.424463 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m15:44:08.424738 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp" rename to "stg_user_events_invalid"
[0m15:44:08.424996 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m15:44:08.425258 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:44:08.431672 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:44:08.431909 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m15:44:08.434582 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m15:44:08.434893 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.009 seconds
[0m15:44:08.436150 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m15:44:08.437192 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m15:44:08.437550 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m15:44:08.438425 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m15:44:08.438659 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m15:44:08.438899 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m15:44:08.439137 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m15:44:08.439362 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m15:44:08.439580 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m15:44:08.439793 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m15:44:08.440057 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m15:44:08.441391 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m15:44:08.441613 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:44:08.441839 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:44:08.442040 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:44:08.445404 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m15:44:08.446664 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m15:44:08.447787 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m15:44:08.448943 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup"
[0m15:44:08.451561 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m15:44:08.452031 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m15:44:08.452637 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m15:44:08.453121 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m15:44:08.453413 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m15:44:08.453664 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m15:44:08.453895 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m15:44:08.454125 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
drop view if exists "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup" cascade
[0m15:44:08.456786 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m15:44:08.457031 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:44:08.457287 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m15:44:08.459017 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m15:44:08.459243 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:44:08.460044 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: Close
[0m15:44:08.460754 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: Close
[0m15:44:08.461430 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m15:44:08.462978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92e9c9f-bb4c-4c90-93a3-8ea9750768f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a043b00>]}
[0m15:44:08.463288 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92e9c9f-bb4c-4c90-93a3-8ea9750768f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109405700>]}
[0m15:44:08.463510 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92e9c9f-bb4c-4c90-93a3-8ea9750768f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a078c50>]}
[0m15:44:08.464231 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92e9c9f-bb4c-4c90-93a3-8ea9750768f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a007c20>]}
[0m15:44:08.464021 [info ] [Thread-1 (]: 1 of 7 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m15:44:08.464684 [info ] [Thread-2 (]: 2 of 7 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.13s]
[0m15:44:08.465060 [info ] [Thread-3 (]: 3 of 7 OK created sql view model public.stg_user_events_invalid ................ [[32mCREATE VIEW[0m in 0.13s]
[0m15:44:08.465396 [info ] [Thread-4 (]: 4 of 7 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.13s]
[0m15:44:08.465735 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m15:44:08.466052 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m15:44:08.466346 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m15:44:08.466642 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m15:44:08.467072 [debug] [Thread-3 (]: Began running node model.podcast_analytics.int_user_sessions
[0m15:44:08.467289 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m15:44:08.467608 [info ] [Thread-3 (]: 5 of 7 START sql view model public.int_user_sessions ........................... [RUN]
[0m15:44:08.467909 [info ] [Thread-1 (]: 6 of 7 START sql view model public.mart_top_episodes ........................... [RUN]
[0m15:44:08.468187 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now model.podcast_analytics.int_user_sessions)
[0m15:44:08.468421 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.mart_top_episodes)
[0m15:44:08.468650 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m15:44:08.468876 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m15:44:08.472439 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m15:44:08.475381 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m15:44:08.475910 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m15:44:08.476203 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m15:44:08.478271 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m15:44:08.481122 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m15:44:08.481573 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m15:44:08.481824 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m15:44:08.482068 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m15:44:08.482298 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m15:44:08.482533 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:08.482755 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:44:08.494997 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m15:44:08.495363 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m15:44:08.495632 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m15:44:08.495859 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m15:44:08.496131 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end,
        sum(coalesce(duration, 0)) as total_listening_duration
    from numbered
    group by user_id, session_number
),

final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        total_listening_duration as session_duration
    from agg
)

select * from final
  );
[0m15:44:08.496437 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m15:44:08.498569 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:44:08.546363 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.050 seconds
[0m15:44:08.547469 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m15:44:08.549162 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m15:44:08.549416 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m15:44:08.549657 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m15:44:08.551590 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:44:08.551817 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m15:44:08.552772 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m15:44:08.553563 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m15:44:08.553796 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m15:44:08.554008 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m15:44:08.554213 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m15:44:08.554414 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m15:44:08.556667 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:44:08.556879 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m15:44:08.558051 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m15:44:08.559169 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m15:44:08.559685 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m15:44:08.560142 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m15:44:08.560373 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m15:44:08.560605 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m15:44:08.561933 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:44:08.562142 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:44:08.562784 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: Close
[0m15:44:08.563403 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m15:44:08.563755 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92e9c9f-bb4c-4c90-93a3-8ea9750768f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d06120>]}
[0m15:44:08.564085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92e9c9f-bb4c-4c90-93a3-8ea9750768f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21d760>]}
[0m15:44:08.564458 [info ] [Thread-3 (]: 5 of 7 OK created sql view model public.int_user_sessions ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m15:44:08.564881 [info ] [Thread-1 (]: 6 of 7 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.10s]
[0m15:44:08.565262 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m15:44:08.565767 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m15:44:08.566205 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m15:44:08.566526 [info ] [Thread-2 (]: 7 of 7 START sql view model public.mart_user_session_metrics ................... [RUN]
[0m15:44:08.566871 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now model.podcast_analytics.mart_user_session_metrics)
[0m15:44:08.567145 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m15:44:08.568811 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m15:44:08.569403 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m15:44:08.571975 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m15:44:08.572530 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m15:44:08.572760 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m15:44:08.572968 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:44:08.583461 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m15:44:08.583805 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m15:44:08.584058 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  create view "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
    
    
  as (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
[0m15:44:08.587352 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m15:44:08.589131 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m15:44:08.589369 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m15:44:08.590353 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:44:08.591157 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m15:44:08.591381 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m15:44:08.591588 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m15:44:08.592995 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m15:44:08.594143 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m15:44:08.594607 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m15:44:08.594830 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop view if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m15:44:08.595644 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:44:08.596299 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m15:44:08.596648 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a92e9c9f-bb4c-4c90-93a3-8ea9750768f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b97290>]}
[0m15:44:08.597027 [info ] [Thread-2 (]: 7 of 7 OK created sql view model public.mart_user_session_metrics .............. [[32mCREATE VIEW[0m in 0.03s]
[0m15:44:08.597359 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m15:44:08.598099 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:08.598323 [debug] [MainThread]: On master: BEGIN
[0m15:44:08.598506 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:44:08.607864 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:44:08.608208 [debug] [MainThread]: On master: COMMIT
[0m15:44:08.608415 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:08.608602 [debug] [MainThread]: On master: COMMIT
[0m15:44:08.609105 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:44:08.609299 [debug] [MainThread]: On master: Close
[0m15:44:08.609574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:08.609759 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m15:44:08.609968 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m15:44:08.610377 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m15:44:08.610589 [debug] [MainThread]: Connection 'model.podcast_analytics.stg_users' was properly closed.
[0m15:44:08.610884 [info ] [MainThread]: 
[0m15:44:08.611167 [info ] [MainThread]: Finished running 7 view models in 0 hours 0 minutes and 0.36 seconds (0.36s).
[0m15:44:08.611970 [debug] [MainThread]: Command end result
[0m15:44:08.628859 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m15:44:08.630154 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m15:44:08.633645 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m15:44:08.633867 [info ] [MainThread]: 
[0m15:44:08.634100 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:44:08.634292 [info ] [MainThread]: 
[0m15:44:08.634495 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=7
[0m15:44:08.636536 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7805268, "process_in_blocks": "0", "process_kernel_time": 0.153442, "process_mem_max_rss": "131661824", "process_out_blocks": "0", "process_user_time": 1.347403}
[0m15:44:08.637066 [debug] [MainThread]: Command `dbt run` succeeded at 15:44:08.636992 after 0.78 seconds
[0m15:44:08.637436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10820a900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c6180>]}
[0m15:44:08.637695 [debug] [MainThread]: Flushing usage events
[0m15:44:09.078489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:44:10.006344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c11c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732da00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732d310>]}


============================== 15:44:10.008641 | 11bd5831-460c-4088-86c3-31b7f033e1c5 ==============================
[0m15:44:10.008641 [info ] [MainThread]: Running with dbt=1.10.3
[0m15:44:10.009002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/samydoreau/global-assignment', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --profiles-dir /Users/samydoreau/global-assignment', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:44:10.095875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11bd5831-460c-4088-86c3-31b7f033e1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10786fda0>]}
[0m15:44:10.123337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11bd5831-460c-4088-86c3-31b7f033e1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073d8320>]}
[0m15:44:10.123893 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:44:10.182543 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m15:44:10.252085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:44:10.252474 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:44:10.279453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11bd5831-460c-4088-86c3-31b7f033e1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f448f0>]}
[0m15:44:10.326097 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m15:44:10.327302 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m15:44:10.340926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11bd5831-460c-4088-86c3-31b7f033e1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082d9730>]}
[0m15:44:10.341310 [info ] [MainThread]: Found 7 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m15:44:10.341536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11bd5831-460c-4088-86c3-31b7f033e1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108279ac0>]}
[0m15:44:10.342660 [info ] [MainThread]: 
[0m15:44:10.342890 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m15:44:10.343066 [info ] [MainThread]: 
[0m15:44:10.343368 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:44:10.345508 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m15:44:10.370583 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m15:44:10.370999 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m15:44:10.371235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:44:10.393960 [debug] [ThreadPool]: SQL status: BEGIN in 0.023 seconds
[0m15:44:10.394302 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m15:44:10.394515 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m15:44:10.397880 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.003 seconds
[0m15:44:10.398741 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m15:44:10.399521 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m15:44:10.402622 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:10.402812 [debug] [MainThread]: On master: BEGIN
[0m15:44:10.402969 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:44:10.410607 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:44:10.410822 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:10.411043 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:44:10.417138 [debug] [MainThread]: SQL status: SELECT 7 in 0.006 seconds
[0m15:44:10.418284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11bd5831-460c-4088-86c3-31b7f033e1c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f00440>]}
[0m15:44:10.418545 [debug] [MainThread]: On master: ROLLBACK
[0m15:44:10.419254 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:10.419421 [debug] [MainThread]: On master: BEGIN
[0m15:44:10.420270 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m15:44:10.420437 [debug] [MainThread]: On master: COMMIT
[0m15:44:10.420592 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:10.420745 [debug] [MainThread]: On master: COMMIT
[0m15:44:10.421171 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:44:10.421336 [debug] [MainThread]: On master: Close
[0m15:44:10.422703 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m15:44:10.422946 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m15:44:10.423180 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m15:44:10.423549 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m15:44:10.423393 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m15:44:10.423844 [info ] [Thread-2 (]: 2 of 8 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [RUN]
[0m15:44:10.424052 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_episodes_episode_id ............................. [RUN]
[0m15:44:10.424250 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_user_events_event_id ............................ [RUN]
[0m15:44:10.424475 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m15:44:10.424728 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7'
[0m15:44:10.424959 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422'
[0m15:44:10.425175 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7'
[0m15:44:10.425370 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m15:44:10.425564 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m15:44:10.425746 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m15:44:10.425919 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m15:44:10.434941 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m15:44:10.439510 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m15:44:10.444341 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m15:44:10.446153 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m15:44:10.447412 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m15:44:10.447639 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m15:44:10.453495 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m15:44:10.453776 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m15:44:10.457296 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m15:44:10.458640 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m15:44:10.459859 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m15:44:10.460992 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m15:44:10.461672 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m15:44:10.461956 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m15:44:10.462227 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m15:44:10.462431 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m15:44:10.462637 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m15:44:10.462857 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: BEGIN
[0m15:44:10.463069 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m15:44:10.463269 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:44:10.463468 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m15:44:10.463666 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:44:10.463858 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:10.464129 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:44:10.479810 [debug] [Thread-1 (]: SQL status: BEGIN in 0.016 seconds
[0m15:44:10.480086 [debug] [Thread-4 (]: SQL status: BEGIN in 0.017 seconds
[0m15:44:10.480316 [debug] [Thread-3 (]: SQL status: BEGIN in 0.016 seconds
[0m15:44:10.480532 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m15:44:10.480753 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m15:44:10.480958 [debug] [Thread-2 (]: SQL status: BEGIN in 0.017 seconds
[0m15:44:10.481155 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m15:44:10.481382 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m15:44:10.481614 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m15:44:10.481837 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m15:44:10.482046 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m15:44:10.482358 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','missing_timestamp','malformed_timestamp','missing_user_id','missing_episode_id','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m15:44:10.484839 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m15:44:10.487267 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m15:44:10.488839 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m15:44:10.489203 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_episodes_episode_id ................................... [[32mPASS[0m in 0.06s]
[0m15:44:10.489530 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m15:44:10.489765 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m15:44:10.490037 [info ] [Thread-3 (]: 5 of 8 START test not_null_stg_users_user_id ................................... [RUN]
[0m15:44:10.490293 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m15:44:10.490502 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m15:44:10.492636 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m15:44:10.493047 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m15:44:10.494232 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m15:44:10.494584 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m15:44:10.494780 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m15:44:10.494966 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:44:10.497463 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.015 seconds
[0m15:44:10.498420 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m15:44:10.498719 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m15:44:10.499422 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: ROLLBACK
[0m15:44:10.499635 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m15:44:10.500083 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.08s]
[0m15:44:10.500398 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m15:44:10.500619 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: Close
[0m15:44:10.500829 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.019 seconds
[0m15:44:10.501061 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m15:44:10.502499 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m15:44:10.501554 [info ] [Thread-2 (]: 2 of 8 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [[32mPASS[0m in 0.08s]
[0m15:44:10.502877 [info ] [Thread-1 (]: 6 of 8 START test unique_stg_episodes_episode_id ............................... [RUN]
[0m15:44:10.503605 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m15:44:10.503858 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m15:44:10.504301 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m15:44:10.504580 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m15:44:10.504905 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m15:44:10.505303 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m15:44:10.506012 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_user_events_event_id .................................. [[32mPASS[0m in 0.08s]
[0m15:44:10.506436 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m15:44:10.506714 [info ] [Thread-2 (]: 7 of 8 START test unique_stg_user_events_event_id .............................. [RUN]
[0m15:44:10.511167 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m15:44:10.511841 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m15:44:10.512136 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m15:44:10.512819 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m15:44:10.513149 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m15:44:10.513530 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m15:44:10.513766 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m15:44:10.514015 [info ] [Thread-4 (]: 8 of 8 START test unique_stg_users_user_id ..................................... [RUN]
[0m15:44:10.516335 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m15:44:10.516585 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.003 seconds
[0m15:44:10.519190 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m15:44:10.519464 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m15:44:10.523562 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m15:44:10.524172 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m15:44:10.524397 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m15:44:10.524802 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m15:44:10.525198 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m15:44:10.528749 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m15:44:10.532619 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m15:44:10.532950 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: BEGIN
[0m15:44:10.534505 [info ] [Thread-3 (]: 5 of 8 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.04s]
[0m15:44:10.540105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:44:10.542875 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m15:44:10.543230 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m15:44:10.544001 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m15:44:10.544600 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: BEGIN
[0m15:44:10.546580 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m15:44:10.546850 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:44:10.547352 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m15:44:10.547583 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m15:44:10.547793 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:44:10.552032 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m15:44:10.552308 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m15:44:10.552541 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:44:10.554307 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:44:10.554784 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m15:44:10.556062 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: ROLLBACK
[0m15:44:10.556304 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m15:44:10.556560 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m15:44:10.556841 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m15:44:10.557160 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: Close
[0m15:44:10.557402 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_user_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:44:10.557664 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:44:10.558096 [info ] [Thread-1 (]: 6 of 8 PASS unique_stg_episodes_episode_id ..................................... [[32mPASS[0m in 0.05s]
[0m15:44:10.558601 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m15:44:10.559802 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m15:44:10.561132 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m15:44:10.561959 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m15:44:10.562467 [info ] [Thread-4 (]: 8 of 8 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.04s]
[0m15:44:10.562831 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m15:44:10.582438 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.024 seconds
[0m15:44:10.583529 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: ROLLBACK
[0m15:44:10.584343 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: Close
[0m15:44:10.584768 [info ] [Thread-2 (]: 7 of 8 PASS unique_stg_user_events_event_id .................................... [[32mPASS[0m in 0.07s]
[0m15:44:10.585133 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m15:44:10.586040 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:10.586293 [debug] [MainThread]: On master: BEGIN
[0m15:44:10.586507 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:44:10.594148 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:44:10.594471 [debug] [MainThread]: On master: COMMIT
[0m15:44:10.594673 [debug] [MainThread]: Using postgres connection "master"
[0m15:44:10.594851 [debug] [MainThread]: On master: COMMIT
[0m15:44:10.595288 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:44:10.595561 [debug] [MainThread]: On master: Close
[0m15:44:10.595877 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:44:10.596073 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16' was properly closed.
[0m15:44:10.596252 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m15:44:10.596424 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m15:44:10.596591 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m15:44:10.596815 [info ] [MainThread]: 
[0m15:44:10.597032 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m15:44:10.597902 [debug] [MainThread]: Command end result
[0m15:44:10.657036 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m15:44:10.658158 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m15:44:10.661733 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m15:44:10.661942 [info ] [MainThread]: 
[0m15:44:10.662162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:44:10.662346 [info ] [MainThread]: 
[0m15:44:10.662539 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m15:44:10.664377 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.69253653, "process_in_blocks": "0", "process_kernel_time": 0.142561, "process_mem_max_rss": "132808704", "process_out_blocks": "0", "process_user_time": 1.18637}
[0m15:44:10.664666 [debug] [MainThread]: Command `dbt test` succeeded at 15:44:10.664620 after 0.69 seconds
[0m15:44:10.664893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e907a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c11c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f9610>]}
[0m15:44:10.665112 [debug] [MainThread]: Flushing usage events
[0m15:44:11.018026 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:08:13.836600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108032c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110ef0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117a3ef0>]}


============================== 18:08:13.840938 | 47be426e-f414-4aca-b725-25e5540ecf54 ==============================
[0m18:08:13.840938 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:08:13.841534 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/samydoreau/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:08:13.946349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47be426e-f414-4aca-b725-25e5540ecf54', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118c9b80>]}
[0m18:08:13.999435 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-xcv2lzqa'
[0m18:08:14.000081 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:08:14.255108 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:08:14.255791 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:08:14.310520 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:08:14.316576 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:08:14.736270 [info ] [MainThread]: Installed from version 1.3.0
[0m18:08:14.736667 [info ] [MainThread]: Up to date!
[0m18:08:14.737162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '47be426e-f414-4aca-b725-25e5540ecf54', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aa2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111989bb0>]}
[0m18:08:14.739779 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.96345186, "process_in_blocks": "0", "process_kernel_time": 0.276954, "process_mem_max_rss": "113917952", "process_out_blocks": "0", "process_user_time": 1.38257}
[0m18:08:14.740203 [debug] [MainThread]: Command `cli deps` succeeded at 18:08:14.740115 after 0.96 seconds
[0m18:08:14.740489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10448a930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118b0860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111194c0>]}
[0m18:08:14.740736 [debug] [MainThread]: Flushing usage events
[0m18:08:15.147819 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:00.930707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106639400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fe11f0>]}


============================== 18:48:00.932960 | ac1259eb-eaa6-46ec-acff-0e29b0a43c37 ==============================
[0m18:48:00.932960 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:48:00.933266 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'profiles_dir': '/Users/samydoreau/global-assignment', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps --profiles-dir /Users/samydoreau/global-assignment', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:48:00.983493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac1259eb-eaa6-46ec-acff-0e29b0a43c37', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106faade0>]}
[0m18:48:01.012163 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-q2c4fkqd'
[0m18:48:01.012420 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:48:01.057458 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:48:01.058046 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:48:01.080139 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:48:01.082301 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:48:01.256506 [info ] [MainThread]: Installed from version 1.3.0
[0m18:48:01.256836 [info ] [MainThread]: Up to date!
[0m18:48:01.257076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'ac1259eb-eaa6-46ec-acff-0e29b0a43c37', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10706e960>]}
[0m18:48:01.259568 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.35955092, "process_in_blocks": "0", "process_kernel_time": 0.132984, "process_mem_max_rss": "112230400", "process_out_blocks": "0", "process_user_time": 0.593464}
[0m18:48:01.259878 [debug] [MainThread]: Command `dbt deps` succeeded at 18:48:01.259826 after 0.36 seconds
[0m18:48:01.260115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b65160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107159eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10704a420>]}
[0m18:48:01.260309 [debug] [MainThread]: Flushing usage events
[0m18:48:01.624825 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:02.336462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106246a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f55700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f552e0>]}


============================== 18:48:02.338118 | 6b5523ea-532e-47b2-96db-24eb3e534be7 ==============================
[0m18:48:02.338118 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:48:02.338418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/samydoreau/global-assignment', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed --profiles-dir /Users/samydoreau/global-assignment', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:48:02.406890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b5523ea-532e-47b2-96db-24eb3e534be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107048a70>]}
[0m18:48:02.428313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b5523ea-532e-47b2-96db-24eb3e534be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106246ed0>]}
[0m18:48:02.429502 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:48:02.476522 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m18:48:02.538473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:48:02.538696 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:48:02.559647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b5523ea-532e-47b2-96db-24eb3e534be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f85700>]}
[0m18:48:02.595702 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:48:02.596950 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:48:02.604336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b5523ea-532e-47b2-96db-24eb3e534be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e45fd0>]}
[0m18:48:02.604559 [info ] [MainThread]: Found 9 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m18:48:02.604729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b5523ea-532e-47b2-96db-24eb3e534be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0c6b0>]}
[0m18:48:02.605514 [info ] [MainThread]: 
[0m18:48:02.605684 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:48:02.605823 [info ] [MainThread]: 
[0m18:48:02.606045 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:48:02.607462 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m18:48:02.638307 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m18:48:02.638557 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:48:02.638710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:02.665385 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.027 seconds
[0m18:48:02.666013 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m18:48:02.666725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m18:48:02.669134 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:48:02.669290 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m18:48:02.669418 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:02.675518 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m18:48:02.675656 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:48:02.675799 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:48:02.684732 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.009 seconds
[0m18:48:02.685898 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m18:48:02.686373 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m18:48:02.688842 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:02.689002 [debug] [MainThread]: On master: BEGIN
[0m18:48:02.689130 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:02.694442 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:48:02.694714 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:02.694919 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:48:02.701804 [debug] [MainThread]: SQL status: SELECT 7 in 0.007 seconds
[0m18:48:02.702966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b5523ea-532e-47b2-96db-24eb3e534be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e7cc20>]}
[0m18:48:02.703214 [debug] [MainThread]: On master: ROLLBACK
[0m18:48:02.703605 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:02.703750 [debug] [MainThread]: On master: BEGIN
[0m18:48:02.704279 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:48:02.704420 [debug] [MainThread]: On master: COMMIT
[0m18:48:02.704555 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:02.704688 [debug] [MainThread]: On master: COMMIT
[0m18:48:02.704950 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:02.705089 [debug] [MainThread]: On master: Close
[0m18:48:02.707457 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m18:48:02.707679 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m18:48:02.707967 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m18:48:02.708224 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m18:48:02.708466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m18:48:02.708719 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m18:48:02.708905 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m18:48:02.709074 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m18:48:02.709244 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m18:48:02.709408 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m18:48:02.723838 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m18:48:02.724138 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m18:48:02.725940 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m18:48:02.726122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:02.726312 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m18:48:02.726526 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:48:02.731587 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m18:48:02.731793 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:48:02.731994 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m18:48:02.732154 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m18:48:02.732349 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m18:48:02.732526 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m18:48:02.734577 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.002 seconds
[0m18:48:02.739973 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.007 seconds
[0m18:48:02.766779 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m18:48:02.779517 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m18:48:02.784925 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m18:48:02.785301 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m18:48:02.788111 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.003 seconds
[0m18:48:02.788279 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.003 seconds
[0m18:48:02.790546 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m18:48:02.790841 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m18:48:02.796512 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m18:48:02.797163 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m18:48:02.797334 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m18:48:02.797510 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m18:48:02.797686 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m18:48:02.797833 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m18:48:02.813050 [debug] [Thread-1 (]: SQL status: COMMIT in 0.015 seconds
[0m18:48:02.813777 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m18:48:02.814620 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5523ea-532e-47b2-96db-24eb3e534be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108254d70>]}
[0m18:48:02.814805 [debug] [Thread-2 (]: SQL status: COMMIT in 0.017 seconds
[0m18:48:02.815034 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.11s]
[0m18:48:02.815356 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m18:48:02.815592 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m18:48:02.815836 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5523ea-532e-47b2-96db-24eb3e534be7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082bf4a0>]}
[0m18:48:02.816132 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.11s]
[0m18:48:02.816380 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m18:48:02.817054 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:02.817210 [debug] [MainThread]: On master: BEGIN
[0m18:48:02.817345 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:48:02.824800 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:48:02.825305 [debug] [MainThread]: On master: COMMIT
[0m18:48:02.825925 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:02.826117 [debug] [MainThread]: On master: COMMIT
[0m18:48:02.826966 [debug] [MainThread]: SQL status: COMMIT in 0.001 seconds
[0m18:48:02.827177 [debug] [MainThread]: On master: Close
[0m18:48:02.827423 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:02.827617 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m18:48:02.827980 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m18:48:02.828163 [info ] [MainThread]: 
[0m18:48:02.828461 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m18:48:02.828970 [debug] [MainThread]: Command end result
[0m18:48:02.876416 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:48:02.877707 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:48:02.880208 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m18:48:02.880384 [info ] [MainThread]: 
[0m18:48:02.880574 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:48:02.880821 [info ] [MainThread]: 
[0m18:48:02.880986 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:48:02.882321 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.5733786, "process_in_blocks": "0", "process_kernel_time": 0.120128, "process_mem_max_rss": "130531328", "process_out_blocks": "0", "process_user_time": 0.924158}
[0m18:48:02.882520 [debug] [MainThread]: Command `dbt seed` succeeded at 18:48:02.882488 after 0.57 seconds
[0m18:48:02.882681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106226a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10827b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108279340>]}
[0m18:48:02.882839 [debug] [MainThread]: Flushing usage events
[0m18:48:03.220182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:03.951018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b0ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114f9a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114f9610>]}


============================== 18:48:03.952909 | b8ea6ab3-42a3-4b79-a300-26264fb7e402 ==============================
[0m18:48:03.952909 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:48:03.953212 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'profiles_dir': '/Users/samydoreau/global-assignment', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --profiles-dir /Users/samydoreau/global-assignment', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:48:04.019383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8ea6ab3-42a3-4b79-a300-26264fb7e402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105b91c0>]}
[0m18:48:04.041143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8ea6ab3-42a3-4b79-a300-26264fb7e402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054f4cb0>]}
[0m18:48:04.041501 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:48:04.083079 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m18:48:04.135136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:48:04.135356 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:48:04.156006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8ea6ab3-42a3-4b79-a300-26264fb7e402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115f02f0>]}
[0m18:48:04.192127 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:48:04.193017 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:48:04.198664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8ea6ab3-42a3-4b79-a300-26264fb7e402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112541b80>]}
[0m18:48:04.198899 [info ] [MainThread]: Found 9 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m18:48:04.199082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ea6ab3-42a3-4b79-a300-26264fb7e402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111fe3050>]}
[0m18:48:04.199960 [info ] [MainThread]: 
[0m18:48:04.200148 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:48:04.200294 [info ] [MainThread]: 
[0m18:48:04.200524 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:48:04.202144 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m18:48:04.220440 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m18:48:04.220685 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:48:04.220844 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:04.236582 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.016 seconds
[0m18:48:04.237555 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m18:48:04.239082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m18:48:04.242437 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:48:04.245208 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m18:48:04.245382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:04.250187 [debug] [ThreadPool]: SQL status: BEGIN in 0.005 seconds
[0m18:48:04.250496 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:48:04.250693 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:48:04.252182 [debug] [ThreadPool]: SQL status: SELECT 10 in 0.001 seconds
[0m18:48:04.253000 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m18:48:04.253549 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m18:48:04.256773 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:04.257324 [debug] [MainThread]: On master: BEGIN
[0m18:48:04.257720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:04.266206 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m18:48:04.266517 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:04.266754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:48:04.269760 [debug] [MainThread]: SQL status: SELECT 7 in 0.003 seconds
[0m18:48:04.270937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8ea6ab3-42a3-4b79-a300-26264fb7e402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112145040>]}
[0m18:48:04.271195 [debug] [MainThread]: On master: ROLLBACK
[0m18:48:04.271899 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:04.272096 [debug] [MainThread]: On master: BEGIN
[0m18:48:04.272792 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:48:04.273003 [debug] [MainThread]: On master: COMMIT
[0m18:48:04.273268 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:04.273604 [debug] [MainThread]: On master: COMMIT
[0m18:48:04.274089 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:04.274312 [debug] [MainThread]: On master: Close
[0m18:48:04.276232 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m18:48:04.276542 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m18:48:04.276728 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m18:48:04.276972 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m18:48:04.277238 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_episodes ................................ [RUN]
[0m18:48:04.277592 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_user_events ............................. [RUN]
[0m18:48:04.278000 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_user_events_invalid ..................... [RUN]
[0m18:48:04.278333 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_users ................................... [RUN]
[0m18:48:04.278595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m18:48:04.278828 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m18:48:04.279154 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m18:48:04.279622 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m18:48:04.279883 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m18:48:04.280116 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m18:48:04.280521 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m18:48:04.280702 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m18:48:04.284324 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m18:48:04.293197 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m18:48:04.294609 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m18:48:04.295691 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m18:48:04.296367 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m18:48:04.296548 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m18:48:04.296716 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m18:48:04.296864 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m18:48:04.311073 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m18:48:04.312561 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m18:48:04.313954 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m18:48:04.315289 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events_invalid"
[0m18:48:04.315747 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:48:04.315938 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:48:04.316154 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:48:04.316364 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m18:48:04.316552 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m18:48:04.316732 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:48:04.316904 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: BEGIN
[0m18:48:04.317076 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:48:04.317249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:04.317413 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: BEGIN
[0m18:48:04.317577 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:48:04.317842 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:48:04.328661 [debug] [Thread-2 (]: SQL status: BEGIN in 0.012 seconds
[0m18:48:04.328921 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m18:48:04.329111 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m18:48:04.329276 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m18:48:04.329485 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:48:04.329670 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:48:04.329842 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:48:04.330017 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:48:04.330242 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
-- Note: Invalid events are captured in stg_user_events_invalid.sql for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

valid_events as (
    select * from source
    where data ->> 'event_type' is not null
      and data ->> 'event_type' in ('play', 'pause', 'seek', 'complete')
      and data ->> 'timestamp' is not null
      and data ->> 'timestamp' != ''
      and data ->> 'user_id' is not null
      and data ->> 'episode_id' is not null
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'timestamp' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'event_type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        case 
            when (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}' then (data ->> 'timestamp')::timestamp
            else null
        end as event_ts,
        data ->> 'event_type'         as event_type,
        (data ->> 'duration')::integer as duration
    from valid_events
    where (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}'
)
select * from typed
  );
[0m18:48:04.330510 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */

  create view "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp"
    
    
  as (
    -- stg_user_events_invalid.sql : capture invalid event records for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

invalid_events as (
    select 
        data,
        data ->> 'user_id' as user_id,
        data ->> 'episode_id' as episode_id,
        data ->> 'timestamp' as timestamp,
        data ->> 'event_type' as event_type,
        data ->> 'duration' as duration,
        case 
            when data ->> 'event_type' is null then 'missing_event_type'
            when data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete') then 'invalid_event_type'
            when data ->> 'timestamp' is null or data ->> 'timestamp' = '' then 'missing_timestamp'
            when not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}') then 'malformed_timestamp'
            when data ->> 'user_id' is null then 'missing_user_id'
            when data ->> 'episode_id' is null then 'missing_episode_id'
            else 'other_issue'
        end as issue_type
    from source
    where data ->> 'event_type' is null 
       or data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete')
       or data ->> 'timestamp' is null 
       or data ->> 'timestamp' = ''
       or not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}')
       or data ->> 'user_id' is null
       or data ->> 'episode_id' is null
)

select * from invalid_events
  );
[0m18:48:04.330739 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m18:48:04.330934 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m18:48:04.336581 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:48:04.336784 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:48:04.336953 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:48:04.337116 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:48:04.339959 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:48:04.341308 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:48:04.342571 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:48:04.343748 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:48:04.343926 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m18:48:04.344110 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid" rename to "stg_user_events_invalid__dbt_backup"
[0m18:48:04.344295 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m18:48:04.344466 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m18:48:04.345143 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:04.345333 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:04.345532 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:04.345684 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:04.346769 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:48:04.348300 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:48:04.349345 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:48:04.350394 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:48:04.350566 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m18:48:04.350745 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m18:48:04.350927 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp" rename to "stg_user_events_invalid"
[0m18:48:04.351099 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m18:48:04.351605 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:48:04.351782 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:48:04.351941 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:04.352095 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:04.358854 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m18:48:04.359603 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m18:48:04.360350 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m18:48:04.360996 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m18:48:04.361171 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:48:04.361340 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:48:04.361500 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:48:04.361657 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:48:04.361815 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m18:48:04.361968 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m18:48:04.362122 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m18:48:04.362280 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m18:48:04.363218 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m18:48:04.365649 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m18:48:04.365825 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m18:48:04.365998 [debug] [Thread-3 (]: SQL status: COMMIT in 0.003 seconds
[0m18:48:04.366174 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m18:48:04.368022 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:48:04.368907 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m18:48:04.369779 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup"
[0m18:48:04.370628 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m18:48:04.370808 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m18:48:04.371171 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:48:04.371514 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:48:04.371854 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:48:04.372052 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m18:48:04.372270 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
drop view if exists "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup" cascade
[0m18:48:04.372460 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m18:48:04.374560 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:48:04.375654 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: Close
[0m18:48:04.375838 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m18:48:04.376006 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m18:48:04.376163 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.004 seconds
[0m18:48:04.376674 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m18:48:04.377704 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m18:48:04.378216 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: Close
[0m18:48:04.378423 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ea6ab3-42a3-4b79-a300-26264fb7e402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105422570>]}
[0m18:48:04.378646 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ea6ab3-42a3-4b79-a300-26264fb7e402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128b0920>]}
[0m18:48:04.378883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ea6ab3-42a3-4b79-a300-26264fb7e402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112145400>]}
[0m18:48:04.379101 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ea6ab3-42a3-4b79-a300-26264fb7e402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128b2060>]}
[0m18:48:04.379583 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_user_events_invalid ................ [[32mCREATE VIEW[0m in 0.10s]
[0m18:48:04.379928 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.10s]
[0m18:48:04.380259 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:48:04.380577 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.10s]
[0m18:48:04.380910 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m18:48:04.381195 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m18:48:04.381447 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m18:48:04.381686 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m18:48:04.382029 [debug] [Thread-3 (]: Began running node model.podcast_analytics.int_user_sessions
[0m18:48:04.382214 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m18:48:04.382455 [debug] [Thread-2 (]: Began running node model.podcast_analytics.dim_episodes
[0m18:48:04.382698 [info ] [Thread-3 (]: 5 of 9 START sql view model public.int_user_sessions ........................... [RUN]
[0m18:48:04.382907 [debug] [Thread-4 (]: Began running node model.podcast_analytics.dim_users
[0m18:48:04.383104 [info ] [Thread-1 (]: 6 of 9 START sql view model public.mart_top_episodes ........................... [RUN]
[0m18:48:04.383313 [info ] [Thread-2 (]: 7 of 9 START sql view model public.dim_episodes ................................ [RUN]
[0m18:48:04.383534 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now model.podcast_analytics.int_user_sessions)
[0m18:48:04.383746 [info ] [Thread-4 (]: 8 of 9 START sql view model public.dim_users ................................... [RUN]
[0m18:48:04.383934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.mart_top_episodes)
[0m18:48:04.384121 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now model.podcast_analytics.dim_episodes)
[0m18:48:04.384301 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m18:48:04.384488 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_users, now model.podcast_analytics.dim_users)
[0m18:48:04.384660 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m18:48:04.384827 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.dim_episodes
[0m18:48:04.387984 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m18:48:04.388320 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.dim_users
[0m18:48:04.391448 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m18:48:04.393740 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.dim_episodes"
[0m18:48:04.420996 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.dim_users"
[0m18:48:04.421509 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.dim_episodes
[0m18:48:04.421710 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m18:48:04.421913 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m18:48:04.422121 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.dim_users
[0m18:48:04.423895 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.dim_episodes"
[0m18:48:04.425323 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m18:48:04.426678 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m18:48:04.428239 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.dim_users"
[0m18:48:04.428740 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:48:04.428974 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:48:04.429181 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m18:48:04.429406 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:48:04.429592 [debug] [Thread-2 (]: On model.podcast_analytics.dim_episodes: BEGIN
[0m18:48:04.429794 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:48:04.429969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:04.430158 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m18:48:04.430328 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:48:04.430498 [debug] [Thread-4 (]: On model.podcast_analytics.dim_users: BEGIN
[0m18:48:04.430725 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:48:04.430987 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:48:04.439800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m18:48:04.440032 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m18:48:04.440251 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m18:48:04.440488 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:48:04.440667 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m18:48:04.440839 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:48:04.441020 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:48:04.441223 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m18:48:04.441428 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:48:04.441602 [debug] [Thread-2 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */

  create view "podcast_analytics"."public"."dim_episodes__dbt_tmp"
    
    
  as (
    -- dim_episodes.sql : dimension table for episodes (one row per episode)
select * from "podcast_analytics"."public"."stg_episodes"
  );
[0m18:48:04.441791 [debug] [Thread-4 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */

  create view "podcast_analytics"."public"."dim_users__dbt_tmp"
    
    
  as (
    -- dim_users.sql : dimension table for users (one row per user)
select * from "podcast_analytics"."public"."stg_users"
  );
[0m18:48:04.442049 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions

-- 1. Bring in all user events from the staging model
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

-- 2. For each event, get the timestamp of the previous event for the same user
events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

-- 3. Flag the start of a new session:
--    - If there is no previous event (first event for user)
--    - Or if the gap between events is more than 30 minutes
flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

-- 4. Assign a session number to each event for each user by cumulatively summing the new session flags
numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

-- 5. Aggregate events into sessions:
--    - Find session start/end timestamps
--    - Sum up listening duration for the session
agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end,
        sum(coalesce(duration, 0)) as total_listening_duration
    from numbered
    group by user_id, session_number
),

-- 6. Generate a surrogate session_id and select final session fields
final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        total_listening_duration as session_duration
    from agg
)

-- 7. Output the final sessionized data
select * from final
  );
[0m18:48:04.443005 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m18:48:04.444533 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:48:04.444715 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:48:04.444915 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:48:04.445083 [debug] [Thread-2 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */
alter table "podcast_analytics"."public"."dim_episodes__dbt_tmp" rename to "dim_episodes"
[0m18:48:04.446292 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:48:04.446455 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m18:48:04.447691 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:48:04.447901 [debug] [Thread-4 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */
alter table "podcast_analytics"."public"."dim_users__dbt_tmp" rename to "dim_users"
[0m18:48:04.449491 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:48:04.449660 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:48:04.449844 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m18:48:04.450049 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m18:48:04.450737 [debug] [Thread-2 (]: On model.podcast_analytics.dim_episodes: COMMIT
[0m18:48:04.450916 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:04.451134 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:48:04.451747 [debug] [Thread-4 (]: On model.podcast_analytics.dim_users: COMMIT
[0m18:48:04.451924 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:04.452096 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:04.452254 [debug] [Thread-2 (]: On model.podcast_analytics.dim_episodes: COMMIT
[0m18:48:04.452427 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:48:04.453027 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m18:48:04.453592 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m18:48:04.453779 [debug] [Thread-4 (]: On model.podcast_analytics.dim_users: COMMIT
[0m18:48:04.453949 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:48:04.454113 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:48:04.454281 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m18:48:04.454457 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m18:48:04.454619 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m18:48:04.454770 [debug] [Thread-4 (]: SQL status: COMMIT in 0.000 seconds
[0m18:48:04.455662 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."dim_episodes__dbt_backup"
[0m18:48:04.456747 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."dim_users__dbt_backup"
[0m18:48:04.457000 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:48:04.457166 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m18:48:04.457580 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:48:04.457949 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:48:04.458860 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m18:48:04.459714 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m18:48:04.459931 [debug] [Thread-2 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */
drop view if exists "podcast_analytics"."public"."dim_episodes__dbt_backup" cascade
[0m18:48:04.460128 [debug] [Thread-4 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */
drop view if exists "podcast_analytics"."public"."dim_users__dbt_backup" cascade
[0m18:48:04.460498 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:48:04.460842 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:48:04.461062 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m18:48:04.461248 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m18:48:04.461419 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m18:48:04.461588 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:48:04.462150 [debug] [Thread-4 (]: On model.podcast_analytics.dim_users: Close
[0m18:48:04.462316 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:48:04.462473 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:48:04.462973 [debug] [Thread-2 (]: On model.podcast_analytics.dim_episodes: Close
[0m18:48:04.463242 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ea6ab3-42a3-4b79-a300-26264fb7e402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112962750>]}
[0m18:48:04.463708 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: Close
[0m18:48:04.464166 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m18:48:04.464388 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ea6ab3-42a3-4b79-a300-26264fb7e402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f76270>]}
[0m18:48:04.464694 [info ] [Thread-4 (]: 8 of 9 OK created sql view model public.dim_users .............................. [[32mCREATE VIEW[0m in 0.08s]
[0m18:48:04.464948 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ea6ab3-42a3-4b79-a300-26264fb7e402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129c2cc0>]}
[0m18:48:04.465175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ea6ab3-42a3-4b79-a300-26264fb7e402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128aac30>]}
[0m18:48:04.465483 [info ] [Thread-2 (]: 7 of 9 OK created sql view model public.dim_episodes ........................... [[32mCREATE VIEW[0m in 0.08s]
[0m18:48:04.465807 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.dim_users
[0m18:48:04.466083 [info ] [Thread-3 (]: 5 of 9 OK created sql view model public.int_user_sessions ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m18:48:04.466357 [info ] [Thread-1 (]: 6 of 9 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.08s]
[0m18:48:04.466599 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.dim_episodes
[0m18:48:04.466873 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m18:48:04.467098 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m18:48:04.467400 [debug] [Thread-4 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m18:48:04.467600 [info ] [Thread-4 (]: 9 of 9 START sql view model public.mart_user_session_metrics ................... [RUN]
[0m18:48:04.467794 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.dim_users, now model.podcast_analytics.mart_user_session_metrics)
[0m18:48:04.467967 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m18:48:04.469117 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m18:48:04.469464 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m18:48:04.471145 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m18:48:04.471450 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:48:04.471615 [debug] [Thread-4 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m18:48:04.471770 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:48:04.477017 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m18:48:04.477322 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:48:04.477523 [debug] [Thread-4 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  create view "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
    
    
  as (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
[0m18:48:04.478802 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.001 seconds
[0m18:48:04.480132 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:48:04.480308 [debug] [Thread-4 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m18:48:04.480817 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:48:04.481489 [debug] [Thread-4 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m18:48:04.481705 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:48:04.481887 [debug] [Thread-4 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m18:48:04.482728 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m18:48:04.483780 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m18:48:04.484153 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:48:04.484322 [debug] [Thread-4 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop view if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m18:48:04.484801 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.000 seconds
[0m18:48:04.485372 [debug] [Thread-4 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m18:48:04.485647 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8ea6ab3-42a3-4b79-a300-26264fb7e402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129c72c0>]}
[0m18:48:04.485950 [info ] [Thread-4 (]: 9 of 9 OK created sql view model public.mart_user_session_metrics .............. [[32mCREATE VIEW[0m in 0.02s]
[0m18:48:04.486283 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m18:48:04.486952 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:04.487127 [debug] [MainThread]: On master: BEGIN
[0m18:48:04.487275 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:48:04.492779 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:48:04.493058 [debug] [MainThread]: On master: COMMIT
[0m18:48:04.493234 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:04.493382 [debug] [MainThread]: On master: COMMIT
[0m18:48:04.493658 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:04.493805 [debug] [MainThread]: On master: Close
[0m18:48:04.494025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:04.494165 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m18:48:04.494297 [debug] [MainThread]: Connection 'model.podcast_analytics.dim_episodes' was properly closed.
[0m18:48:04.494425 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m18:48:04.494550 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m18:48:04.494782 [info ] [MainThread]: 
[0m18:48:04.494998 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m18:48:04.495653 [debug] [MainThread]: Command end result
[0m18:48:04.507868 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:48:04.508970 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:48:04.511729 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m18:48:04.511921 [info ] [MainThread]: 
[0m18:48:04.512110 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:48:04.512260 [info ] [MainThread]: 
[0m18:48:04.512418 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m18:48:04.513712 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5884808, "process_in_blocks": "0", "process_kernel_time": 0.111141, "process_mem_max_rss": "131809280", "process_out_blocks": "0", "process_user_time": 1.02234}
[0m18:48:04.513928 [debug] [MainThread]: Command `dbt run` succeeded at 18:48:04.513892 after 0.59 seconds
[0m18:48:04.514109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104c7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114f9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11136ae70>]}
[0m18:48:04.514283 [debug] [MainThread]: Flushing usage events
[0m18:48:04.933717 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:05.639495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c0fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ed970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ed550>]}


============================== 18:48:05.641162 | cc6511c5-acb5-4325-a811-6476ef1b97eb ==============================
[0m18:48:05.641162 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:48:05.641458 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/samydoreau/global-assignment', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --profiles-dir /Users/samydoreau/global-assignment', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:48:05.706519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc6511c5-acb5-4325-a811-6476ef1b97eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078e4920>]}
[0m18:48:05.728060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc6511c5-acb5-4325-a811-6476ef1b97eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de3800>]}
[0m18:48:05.728422 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:48:05.770224 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m18:48:05.822103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:48:05.822321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:48:05.843180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc6511c5-acb5-4325-a811-6476ef1b97eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108401310>]}
[0m18:48:05.879306 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:48:05.880147 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:48:05.890477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc6511c5-acb5-4325-a811-6476ef1b97eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f5d90>]}
[0m18:48:05.890699 [info ] [MainThread]: Found 9 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m18:48:05.890863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc6511c5-acb5-4325-a811-6476ef1b97eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ff14c0>]}
[0m18:48:05.891713 [info ] [MainThread]: 
[0m18:48:05.891889 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:48:05.892032 [info ] [MainThread]: 
[0m18:48:05.892261 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:48:05.893832 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m18:48:05.911449 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:48:05.911699 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m18:48:05.911852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:05.928423 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m18:48:05.928635 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:48:05.928791 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:48:05.931922 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m18:48:05.932544 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m18:48:05.933001 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m18:48:05.935501 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:05.935658 [debug] [MainThread]: On master: BEGIN
[0m18:48:05.935779 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:05.942362 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m18:48:05.942528 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:05.942721 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:48:05.948624 [debug] [MainThread]: SQL status: SELECT 9 in 0.006 seconds
[0m18:48:05.949662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc6511c5-acb5-4325-a811-6476ef1b97eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089f35c0>]}
[0m18:48:05.949860 [debug] [MainThread]: On master: ROLLBACK
[0m18:48:05.950330 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:05.950461 [debug] [MainThread]: On master: BEGIN
[0m18:48:05.951241 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:48:05.951371 [debug] [MainThread]: On master: COMMIT
[0m18:48:05.951498 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:05.951623 [debug] [MainThread]: On master: COMMIT
[0m18:48:05.952056 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:05.952187 [debug] [MainThread]: On master: Close
[0m18:48:05.953134 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m18:48:05.953324 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m18:48:05.953660 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m18:48:05.953507 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m18:48:05.953913 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m18:48:05.954091 [info ] [Thread-2 (]: 2 of 8 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [RUN]
[0m18:48:05.954275 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_episodes_episode_id ............................. [RUN]
[0m18:48:05.954467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m18:48:05.954632 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_user_events_event_id ............................ [RUN]
[0m18:48:05.954868 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7'
[0m18:48:05.955067 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422'
[0m18:48:05.955235 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m18:48:05.955421 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7'
[0m18:48:05.955585 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m18:48:05.955742 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m18:48:05.963770 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m18:48:05.964108 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m18:48:05.967356 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m18:48:05.971995 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m18:48:05.973684 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m18:48:05.974085 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m18:48:05.974398 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m18:48:05.974600 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m18:48:05.981368 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m18:48:05.981552 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m18:48:05.982458 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m18:48:05.983308 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m18:48:05.984208 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m18:48:05.984819 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m18:48:05.985026 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m18:48:05.985233 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m18:48:05.985404 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m18:48:05.985579 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m18:48:05.985761 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m18:48:05.985943 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m18:48:05.986108 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:05.986282 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: BEGIN
[0m18:48:05.986449 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:48:05.986612 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:48:05.986830 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:48:05.996305 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m18:48:05.996492 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m18:48:05.996692 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','missing_timestamp','malformed_timestamp','missing_user_id','missing_episode_id','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m18:48:05.996883 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m18:48:05.997059 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m18:48:05.997280 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m18:48:05.997430 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m18:48:05.997598 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m18:48:05.997770 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m18:48:05.997948 [debug] [Thread-3 (]: SQL status: BEGIN in 0.012 seconds
[0m18:48:05.998115 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m18:48:05.998277 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m18:48:05.999752 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:48:06.001345 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m18:48:06.001935 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m18:48:06.002175 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_episodes_episode_id ................................... [[32mPASS[0m in 0.05s]
[0m18:48:06.002429 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m18:48:06.002592 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m18:48:06.002778 [info ] [Thread-3 (]: 5 of 8 START test not_null_stg_users_user_id ................................... [RUN]
[0m18:48:06.002970 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m18:48:06.003124 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m18:48:06.004566 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m18:48:06.004807 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m18:48:06.005633 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m18:48:06.005870 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m18:48:06.006023 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m18:48:06.006166 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:48:06.017665 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m18:48:06.017912 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m18:48:06.018085 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m18:48:06.019412 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.021 seconds
[0m18:48:06.019642 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.022 seconds
[0m18:48:06.019974 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:48:06.020986 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m18:48:06.021666 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: ROLLBACK
[0m18:48:06.022190 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m18:48:06.022830 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m18:48:06.023023 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: Close
[0m18:48:06.023208 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m18:48:06.023834 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.07s]
[0m18:48:06.024404 [info ] [Thread-2 (]: 2 of 8 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [[32mPASS[0m in 0.07s]
[0m18:48:06.024658 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.027 seconds
[0m18:48:06.025042 [info ] [Thread-3 (]: 5 of 8 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.02s]
[0m18:48:06.025424 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m18:48:06.025695 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m18:48:06.026517 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m18:48:06.026756 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m18:48:06.026957 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m18:48:06.027171 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m18:48:06.027387 [debug] [Thread-3 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m18:48:06.027576 [info ] [Thread-1 (]: 6 of 8 START test unique_stg_episodes_episode_id ............................... [RUN]
[0m18:48:06.027773 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m18:48:06.027928 [info ] [Thread-2 (]: 7 of 8 START test unique_stg_user_events_event_id .............................. [RUN]
[0m18:48:06.028098 [info ] [Thread-3 (]: 8 of 8 START test unique_stg_users_user_id ..................................... [RUN]
[0m18:48:06.028559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m18:48:06.028840 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m18:48:06.029064 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_user_events_event_id .................................. [[32mPASS[0m in 0.07s]
[0m18:48:06.029246 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m18:48:06.029428 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m18:48:06.029624 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m18:48:06.029864 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m18:48:06.030026 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m18:48:06.032781 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m18:48:06.035028 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m18:48:06.036798 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m18:48:06.037181 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m18:48:06.037387 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m18:48:06.038300 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m18:48:06.039199 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m18:48:06.039372 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m18:48:06.040515 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m18:48:06.040950 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m18:48:06.041135 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m18:48:06.041393 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m18:48:06.041587 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: BEGIN
[0m18:48:06.041764 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: BEGIN
[0m18:48:06.041927 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m18:48:06.042105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:06.042280 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:48:06.042438 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:48:06.048505 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m18:48:06.048695 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m18:48:06.048861 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:48:06.049034 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m18:48:06.049202 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m18:48:06.049390 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m18:48:06.049607 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:48:06.049820 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_user_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:48:06.050018 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:48:06.050982 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:48:06.051149 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:48:06.051822 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: ROLLBACK
[0m18:48:06.052339 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m18:48:06.052712 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m18:48:06.052871 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: Close
[0m18:48:06.053154 [info ] [Thread-3 (]: 8 of 8 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.02s]
[0m18:48:06.053519 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m18:48:06.053781 [info ] [Thread-1 (]: 6 of 8 PASS unique_stg_episodes_episode_id ..................................... [[32mPASS[0m in 0.03s]
[0m18:48:06.054095 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m18:48:06.085555 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.035 seconds
[0m18:48:06.086340 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: ROLLBACK
[0m18:48:06.086797 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: Close
[0m18:48:06.087090 [error] [Thread-2 (]: 7 of 8 FAIL 4860 unique_stg_user_events_event_id ............................... [[31mFAIL 4860[0m in 0.06s]
[0m18:48:06.087356 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m18:48:06.087999 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:06.088168 [debug] [MainThread]: On master: BEGIN
[0m18:48:06.088309 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:48:06.093192 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:48:06.093429 [debug] [MainThread]: On master: COMMIT
[0m18:48:06.093778 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:06.094004 [debug] [MainThread]: On master: COMMIT
[0m18:48:06.094322 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:06.094484 [debug] [MainThread]: On master: Close
[0m18:48:06.094689 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:06.094825 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16' was properly closed.
[0m18:48:06.094954 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m18:48:06.095082 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m18:48:06.095207 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7' was properly closed.
[0m18:48:06.095372 [info ] [MainThread]: 
[0m18:48:06.095537 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m18:48:06.096131 [debug] [MainThread]: Command end result
[0m18:48:06.133762 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:48:06.134586 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:48:06.137234 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m18:48:06.137395 [info ] [MainThread]: 
[0m18:48:06.137569 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:48:06.137714 [info ] [MainThread]: 
[0m18:48:06.137887 [error] [MainThread]: [31mFailure in test unique_stg_user_events_event_id (models/schema.yml)[0m
[0m18:48:06.138053 [error] [MainThread]:   Got 4860 results, configured to fail if != 0
[0m18:48:06.138195 [info ] [MainThread]: 
[0m18:48:06.138361 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/schema.yml/unique_stg_user_events_event_id.sql
[0m18:48:06.138501 [info ] [MainThread]: 
[0m18:48:06.138652 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=8
[0m18:48:06.139954 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.52603465, "process_in_blocks": "0", "process_kernel_time": 0.101715, "process_mem_max_rss": "132775936", "process_out_blocks": "0", "process_user_time": 0.912194}
[0m18:48:06.140172 [debug] [MainThread]: Command `dbt test` failed at 18:48:06.140140 after 0.53 seconds
[0m18:48:06.140345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d50350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103113140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e51880>]}
[0m18:48:06.140508 [debug] [MainThread]: Flushing usage events
[0m18:48:06.477432 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:19.047993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ec4e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f9a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f9670>]}


============================== 18:48:19.050291 | 7cdc22bb-4d0b-420e-9ef9-b0625c569889 ==============================
[0m18:48:19.050291 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:48:19.050587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt seed --profiles-dir ..', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:48:19.117646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cdc22bb-4d0b-420e-9ef9-b0625c569889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073f9640>]}
[0m18:48:19.139352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cdc22bb-4d0b-420e-9ef9-b0625c569889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f901a0>]}
[0m18:48:19.139769 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:48:19.184160 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m18:48:19.248025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:48:19.248258 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:48:19.269254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cdc22bb-4d0b-420e-9ef9-b0625c569889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105624d10>]}
[0m18:48:19.305467 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:48:19.306609 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:48:19.317260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cdc22bb-4d0b-420e-9ef9-b0625c569889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109301a0>]}
[0m18:48:19.317485 [info ] [MainThread]: Found 9 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m18:48:19.317656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cdc22bb-4d0b-420e-9ef9-b0625c569889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074278c0>]}
[0m18:48:19.318465 [info ] [MainThread]: 
[0m18:48:19.318634 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:48:19.318774 [info ] [MainThread]: 
[0m18:48:19.318999 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:48:19.320355 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m18:48:19.344125 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m18:48:19.344367 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:48:19.344520 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:19.362257 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.018 seconds
[0m18:48:19.362872 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m18:48:19.363570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m18:48:19.365842 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:48:19.365992 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m18:48:19.366116 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:19.372326 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m18:48:19.372494 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:48:19.372644 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:48:19.375678 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m18:48:19.376229 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m18:48:19.376676 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m18:48:19.378887 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:19.379025 [debug] [MainThread]: On master: BEGIN
[0m18:48:19.379144 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:19.385306 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:48:19.385492 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:19.385685 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:48:19.391276 [debug] [MainThread]: SQL status: SELECT 9 in 0.005 seconds
[0m18:48:19.392720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7cdc22bb-4d0b-420e-9ef9-b0625c569889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b99580>]}
[0m18:48:19.393002 [debug] [MainThread]: On master: ROLLBACK
[0m18:48:19.393498 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:19.393641 [debug] [MainThread]: On master: BEGIN
[0m18:48:19.394339 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:48:19.394472 [debug] [MainThread]: On master: COMMIT
[0m18:48:19.394598 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:19.394720 [debug] [MainThread]: On master: COMMIT
[0m18:48:19.395103 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:19.395233 [debug] [MainThread]: On master: Close
[0m18:48:19.397033 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m18:48:19.397251 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m18:48:19.397493 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m18:48:19.397699 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m18:48:19.397982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m18:48:19.398184 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m18:48:19.398345 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m18:48:19.398497 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m18:48:19.398650 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m18:48:19.398802 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m18:48:19.412017 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m18:48:19.413536 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m18:48:19.413737 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m18:48:19.413897 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m18:48:19.414047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:19.414191 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:48:19.421703 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m18:48:19.421885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m18:48:19.422057 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m18:48:19.422214 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m18:48:19.422371 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m18:48:19.422530 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m18:48:19.425373 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m18:48:19.433624 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.011 seconds
[0m18:48:19.461092 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m18:48:19.467587 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m18:48:19.475502 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m18:48:19.475688 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.003 seconds
[0m18:48:19.475862 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m18:48:19.478028 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m18:48:19.483725 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m18:48:19.483919 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.006 seconds
[0m18:48:19.484082 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m18:48:19.484386 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m18:48:19.484544 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m18:48:19.485256 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m18:48:19.485410 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m18:48:19.485559 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m18:48:19.486439 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m18:48:19.487125 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m18:48:19.487292 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:48:19.509310 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m18:48:19.509800 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cdc22bb-4d0b-420e-9ef9-b0625c569889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055ccda0>]}
[0m18:48:19.509971 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7cdc22bb-4d0b-420e-9ef9-b0625c569889', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ebfb90>]}
[0m18:48:19.510207 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.09s]
[0m18:48:19.510458 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.11s]
[0m18:48:19.510728 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m18:48:19.510935 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m18:48:19.511519 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:19.511661 [debug] [MainThread]: On master: BEGIN
[0m18:48:19.511781 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:48:19.519338 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m18:48:19.519539 [debug] [MainThread]: On master: COMMIT
[0m18:48:19.519683 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:19.519818 [debug] [MainThread]: On master: COMMIT
[0m18:48:19.520282 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:19.520413 [debug] [MainThread]: On master: Close
[0m18:48:19.520609 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:19.520735 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m18:48:19.520851 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m18:48:19.520991 [info ] [MainThread]: 
[0m18:48:19.521149 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m18:48:19.521481 [debug] [MainThread]: Command end result
[0m18:48:19.531972 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:48:19.532924 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:48:19.535177 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m18:48:19.535325 [info ] [MainThread]: 
[0m18:48:19.535502 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:48:19.535643 [info ] [MainThread]: 
[0m18:48:19.535800 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:48:19.537778 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.51684594, "process_in_blocks": "0", "process_kernel_time": 0.117632, "process_mem_max_rss": "130203648", "process_out_blocks": "0", "process_user_time": 0.893746}
[0m18:48:19.537971 [debug] [MainThread]: Command `dbt seed` succeeded at 18:48:19.537941 after 0.52 seconds
[0m18:48:19.538130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055cec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d7fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d7d760>]}
[0m18:48:19.538291 [debug] [MainThread]: Flushing usage events
[0m18:48:19.873494 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:20.722297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047cfd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105481610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054811c0>]}


============================== 18:48:20.723949 | 4c3704d9-cdad-48bb-851b-ec6c555f5eeb ==============================
[0m18:48:20.723949 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:48:20.724239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'profiles_dir': '..', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir ..', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:48:20.768429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c3704d9-cdad-48bb-851b-ec6c555f5eeb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054c6ae0>]}
[0m18:48:20.787996 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-dn7jh2z9'
[0m18:48:20.788227 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:48:20.814421 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:48:20.814727 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:48:20.837739 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:48:20.839484 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:48:20.995620 [info ] [MainThread]: Installed from version 1.3.0
[0m18:48:20.995935 [info ] [MainThread]: Up to date!
[0m18:48:20.996167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '4c3704d9-cdad-48bb-851b-ec6c555f5eeb', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f9700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10553b590>]}
[0m18:48:20.997798 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.30109224, "process_in_blocks": "0", "process_kernel_time": 0.107455, "process_mem_max_rss": "112246784", "process_out_blocks": "0", "process_user_time": 0.592097}
[0m18:48:20.998085 [debug] [MainThread]: Command `dbt deps` succeeded at 18:48:20.998037 after 0.30 seconds
[0m18:48:20.998295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054814c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ec6240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052daae0>]}
[0m18:48:20.998488 [debug] [MainThread]: Flushing usage events
[0m18:48:21.340568 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:22.055525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10404da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d599d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d59580>]}


============================== 18:48:22.057299 | f14ebb29-2c86-4fea-89aa-9bfe6bb806ce ==============================
[0m18:48:22.057299 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:48:22.057588 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '..', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir ..', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:48:22.122467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f14ebb29-2c86-4fea-89aa-9bfe6bb806ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e32b10>]}
[0m18:48:22.144385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f14ebb29-2c86-4fea-89aa-9bfe6bb806ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc8d70>]}
[0m18:48:22.144752 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:48:22.185670 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m18:48:22.238986 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:48:22.239202 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:48:22.261246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f14ebb29-2c86-4fea-89aa-9bfe6bb806ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059718e0>]}
[0m18:48:22.298768 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:48:22.299650 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:48:22.305655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f14ebb29-2c86-4fea-89aa-9bfe6bb806ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c4c350>]}
[0m18:48:22.305892 [info ] [MainThread]: Found 9 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m18:48:22.306077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14ebb29-2c86-4fea-89aa-9bfe6bb806ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047207a0>]}
[0m18:48:22.306945 [info ] [MainThread]: 
[0m18:48:22.307134 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:48:22.307283 [info ] [MainThread]: 
[0m18:48:22.307517 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:48:22.309144 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m18:48:22.330318 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m18:48:22.330576 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:48:22.330736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:22.348287 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.018 seconds
[0m18:48:22.348900 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m18:48:22.349607 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m18:48:22.351912 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:48:22.352067 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m18:48:22.352192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:22.358947 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:48:22.359104 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:48:22.359268 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:48:22.361983 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m18:48:22.362540 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m18:48:22.363020 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m18:48:22.365189 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:22.365330 [debug] [MainThread]: On master: BEGIN
[0m18:48:22.365460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:22.371435 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:48:22.371568 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:22.371749 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:48:22.377368 [debug] [MainThread]: SQL status: SELECT 9 in 0.005 seconds
[0m18:48:22.378343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f14ebb29-2c86-4fea-89aa-9bfe6bb806ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100777260>]}
[0m18:48:22.378537 [debug] [MainThread]: On master: ROLLBACK
[0m18:48:22.379060 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:22.379189 [debug] [MainThread]: On master: BEGIN
[0m18:48:22.379954 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:48:22.380083 [debug] [MainThread]: On master: COMMIT
[0m18:48:22.380213 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:22.380389 [debug] [MainThread]: On master: COMMIT
[0m18:48:22.381038 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:22.381225 [debug] [MainThread]: On master: Close
[0m18:48:22.382404 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m18:48:22.382625 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m18:48:22.383111 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m18:48:22.382961 [info ] [Thread-1 (]: 1 of 9 START sql view model public.stg_episodes ................................ [RUN]
[0m18:48:22.383356 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m18:48:22.383604 [info ] [Thread-2 (]: 2 of 9 START sql view model public.stg_user_events ............................. [RUN]
[0m18:48:22.383835 [info ] [Thread-3 (]: 3 of 9 START sql view model public.stg_user_events_invalid ..................... [RUN]
[0m18:48:22.384050 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m18:48:22.384256 [info ] [Thread-4 (]: 4 of 9 START sql view model public.stg_users ................................... [RUN]
[0m18:48:22.384479 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m18:48:22.384685 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m18:48:22.384858 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m18:48:22.385054 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m18:48:22.385223 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m18:48:22.385388 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m18:48:22.388765 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m18:48:22.388964 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m18:48:22.395912 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m18:48:22.397077 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m18:48:22.398085 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m18:48:22.398407 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m18:48:22.398607 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m18:48:22.410986 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m18:48:22.412399 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m18:48:22.413812 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m18:48:22.413998 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m18:48:22.415397 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events_invalid"
[0m18:48:22.416840 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m18:48:22.417163 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:48:22.417345 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:48:22.417545 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m18:48:22.417712 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:48:22.417899 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m18:48:22.418087 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:48:22.418256 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:48:22.418429 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: BEGIN
[0m18:48:22.418602 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:22.418834 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: BEGIN
[0m18:48:22.419003 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:48:22.419216 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:48:22.428532 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m18:48:22.428725 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m18:48:22.428892 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:48:22.429055 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m18:48:22.429223 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m18:48:22.429396 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:48:22.429616 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
-- Note: Invalid events are captured in stg_user_events_invalid.sql for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

valid_events as (
    select * from source
    where data ->> 'event_type' is not null
      and data ->> 'event_type' in ('play', 'pause', 'seek', 'complete')
      and data ->> 'timestamp' is not null
      and data ->> 'timestamp' != ''
      and data ->> 'user_id' is not null
      and data ->> 'episode_id' is not null
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'timestamp' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'event_type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        case 
            when (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}' then (data ->> 'timestamp')::timestamp
            else null
        end as event_ts,
        data ->> 'event_type'         as event_type,
        (data ->> 'duration')::integer as duration
    from valid_events
    where (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}'
)
select * from typed
  );
[0m18:48:22.429824 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:48:22.429999 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:48:22.430183 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m18:48:22.430400 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m18:48:22.430629 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */

  create view "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp"
    
    
  as (
    -- stg_user_events_invalid.sql : capture invalid event records for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

invalid_events as (
    select 
        data,
        data ->> 'user_id' as user_id,
        data ->> 'episode_id' as episode_id,
        data ->> 'timestamp' as timestamp,
        data ->> 'event_type' as event_type,
        data ->> 'duration' as duration,
        case 
            when data ->> 'event_type' is null then 'missing_event_type'
            when data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete') then 'invalid_event_type'
            when data ->> 'timestamp' is null or data ->> 'timestamp' = '' then 'missing_timestamp'
            when not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}') then 'malformed_timestamp'
            when data ->> 'user_id' is null then 'missing_user_id'
            when data ->> 'episode_id' is null then 'missing_episode_id'
            else 'other_issue'
        end as issue_type
    from source
    where data ->> 'event_type' is null 
       or data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete')
       or data ->> 'timestamp' is null 
       or data ->> 'timestamp' = ''
       or not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}')
       or data ->> 'user_id' is null
       or data ->> 'episode_id' is null
)

select * from invalid_events
  );
[0m18:48:22.433204 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:48:22.435707 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:48:22.435883 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:48:22.436028 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:48:22.436174 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:48:22.436325 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m18:48:22.437446 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:48:22.438509 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:48:22.439532 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:48:22.439739 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m18:48:22.439922 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m18:48:22.440096 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid" rename to "stg_user_events_invalid__dbt_backup"
[0m18:48:22.440302 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:22.441389 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:48:22.441558 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:22.441712 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:22.441866 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m18:48:22.442009 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:48:22.443407 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:48:22.444371 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:48:22.445384 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:48:22.445538 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:22.445708 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m18:48:22.445865 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m18:48:22.446030 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp" rename to "stg_user_events_invalid"
[0m18:48:22.452102 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m18:48:22.452366 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:48:22.452524 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m18:48:22.453346 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:22.454006 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m18:48:22.454192 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:48:22.454351 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:48:22.454500 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:48:22.454664 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:48:22.455345 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m18:48:22.455503 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m18:48:22.456094 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m18:48:22.458270 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m18:48:22.458443 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:48:22.458622 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:48:22.460388 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:48:22.460545 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m18:48:22.460698 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m18:48:22.460848 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m18:48:22.461002 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m18:48:22.461854 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m18:48:22.462238 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:48:22.462388 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m18:48:22.463214 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m18:48:22.463985 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup"
[0m18:48:22.464143 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m18:48:22.464455 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:48:22.465298 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m18:48:22.465480 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m18:48:22.465678 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m18:48:22.465851 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
drop view if exists "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup" cascade
[0m18:48:22.466225 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:48:22.467591 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: Close
[0m18:48:22.468178 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m18:48:22.468421 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m18:48:22.469540 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14ebb29-2c86-4fea-89aa-9bfe6bb806ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060b8a70>]}
[0m18:48:22.469275 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14ebb29-2c86-4fea-89aa-9bfe6bb806ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102806510>]}
[0m18:48:22.470122 [info ] [Thread-4 (]: 4 of 9 OK created sql view model public.stg_users .............................. [[32mCREATE VIEW[0m in 0.08s]
[0m18:48:22.470375 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m18:48:22.469844 [info ] [Thread-1 (]: 1 of 9 OK created sql view model public.stg_episodes ........................... [[32mCREATE VIEW[0m in 0.09s]
[0m18:48:22.470651 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m18:48:22.470868 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:48:22.471516 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: Close
[0m18:48:22.471853 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14ebb29-2c86-4fea-89aa-9bfe6bb806ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff2900>]}
[0m18:48:22.472120 [info ] [Thread-3 (]: 3 of 9 OK created sql view model public.stg_user_events_invalid ................ [[32mCREATE VIEW[0m in 0.09s]
[0m18:48:22.472510 [debug] [Thread-4 (]: Began running node model.podcast_analytics.dim_episodes
[0m18:48:22.472779 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m18:48:22.472962 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m18:48:22.473144 [debug] [Thread-1 (]: Began running node model.podcast_analytics.dim_users
[0m18:48:22.473505 [info ] [Thread-4 (]: 5 of 9 START sql view model public.dim_episodes ................................ [RUN]
[0m18:48:22.474436 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m18:48:22.474920 [info ] [Thread-1 (]: 6 of 9 START sql view model public.dim_users ................................... [RUN]
[0m18:48:22.475169 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_users, now model.podcast_analytics.dim_episodes)
[0m18:48:22.475588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.dim_users)
[0m18:48:22.475947 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14ebb29-2c86-4fea-89aa-9bfe6bb806ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f97950>]}
[0m18:48:22.476115 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.dim_episodes
[0m18:48:22.476301 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.dim_users
[0m18:48:22.476678 [info ] [Thread-2 (]: 2 of 9 OK created sql view model public.stg_user_events ........................ [[32mCREATE VIEW[0m in 0.09s]
[0m18:48:22.478196 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.dim_episodes"
[0m18:48:22.479448 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.dim_users"
[0m18:48:22.479798 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m18:48:22.480225 [debug] [Thread-3 (]: Began running node model.podcast_analytics.int_user_sessions
[0m18:48:22.480410 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m18:48:22.480790 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.dim_episodes
[0m18:48:22.480948 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.dim_users
[0m18:48:22.480646 [info ] [Thread-3 (]: 7 of 9 START sql view model public.int_user_sessions ........................... [RUN]
[0m18:48:22.481216 [info ] [Thread-2 (]: 8 of 9 START sql view model public.mart_top_episodes ........................... [RUN]
[0m18:48:22.483686 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.dim_episodes"
[0m18:48:22.510804 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.dim_users"
[0m18:48:22.511069 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now model.podcast_analytics.int_user_sessions)
[0m18:48:22.511238 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now model.podcast_analytics.mart_top_episodes)
[0m18:48:22.511519 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m18:48:22.511739 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m18:48:22.511948 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:48:22.513670 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m18:48:22.513868 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:48:22.515758 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m18:48:22.515943 [debug] [Thread-4 (]: On model.podcast_analytics.dim_episodes: BEGIN
[0m18:48:22.516144 [debug] [Thread-1 (]: On model.podcast_analytics.dim_users: BEGIN
[0m18:48:22.516357 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:48:22.516556 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m18:48:22.516716 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:22.516882 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m18:48:22.518353 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m18:48:22.519697 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m18:48:22.519995 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:48:22.520181 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m18:48:22.520352 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:48:22.520516 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:48:22.520668 [debug] [Thread-2 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m18:48:22.520892 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:48:22.525223 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m18:48:22.525394 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:48:22.525566 [debug] [Thread-4 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */

  create view "podcast_analytics"."public"."dim_episodes__dbt_tmp"
    
    
  as (
    -- dim_episodes.sql : dimension table for episodes (one row per episode)
select * from "podcast_analytics"."public"."stg_episodes"
  );
[0m18:48:22.525750 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m18:48:22.525940 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:48:22.526113 [debug] [Thread-1 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */

  create view "podcast_analytics"."public"."dim_users__dbt_tmp"
    
    
  as (
    -- dim_users.sql : dimension table for users (one row per user)
select * from "podcast_analytics"."public"."stg_users"
  );
[0m18:48:22.527684 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m18:48:22.527849 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m18:48:22.528019 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:48:22.528178 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:48:22.528336 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:48:22.528509 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:48:22.528734 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions

-- 1. Bring in all user events from the staging model
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

-- 2. For each event, get the timestamp of the previous event for the same user
events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

-- 3. Flag the start of a new session:
--    - If there is no previous event (first event for user)
--    - Or if the gap between events is more than 30 minutes
flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

-- 4. Assign a session number to each event for each user by cumulatively summing the new session flags
numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

-- 5. Aggregate events into sessions:
--    - Find session start/end timestamps
--    - Sum up listening duration for the session
agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end,
        sum(coalesce(duration, 0)) as total_listening_duration
    from numbered
    group by user_id, session_number
),

-- 6. Generate a surrogate session_id and select final session fields
final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        total_listening_duration as session_duration
    from agg
)

-- 7. Output the final sessionized data
select * from final
  );
[0m18:48:22.529927 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:48:22.530959 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:48:22.531149 [debug] [Thread-2 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  create view "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
    
    
  as (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
[0m18:48:22.531366 [debug] [Thread-4 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */
alter table "podcast_analytics"."public"."dim_episodes__dbt_tmp" rename to "dim_episodes"
[0m18:48:22.531589 [debug] [Thread-1 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */
alter table "podcast_analytics"."public"."dim_users__dbt_tmp" rename to "dim_users"
[0m18:48:22.532482 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:22.532626 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:22.533368 [debug] [Thread-4 (]: On model.podcast_analytics.dim_episodes: COMMIT
[0m18:48:22.533936 [debug] [Thread-1 (]: On model.podcast_analytics.dim_users: COMMIT
[0m18:48:22.534105 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:48:22.534282 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:48:22.534457 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:48:22.534613 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:48:22.535596 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:48:22.535750 [debug] [Thread-4 (]: On model.podcast_analytics.dim_episodes: COMMIT
[0m18:48:22.535909 [debug] [Thread-1 (]: On model.podcast_analytics.dim_users: COMMIT
[0m18:48:22.537424 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:48:22.537583 [debug] [Thread-2 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m18:48:22.537799 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m18:48:22.538584 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:22.538739 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:22.539327 [debug] [Thread-2 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m18:48:22.539477 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m18:48:22.539636 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:48:22.540205 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m18:48:22.540365 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:48:22.541199 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."dim_episodes__dbt_backup"
[0m18:48:22.542017 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."dim_users__dbt_backup"
[0m18:48:22.542181 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:48:22.542331 [debug] [Thread-2 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m18:48:22.542651 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:48:22.542974 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:48:22.543129 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m18:48:22.543323 [debug] [Thread-4 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */
drop view if exists "podcast_analytics"."public"."dim_episodes__dbt_backup" cascade
[0m18:48:22.543496 [debug] [Thread-1 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */
drop view if exists "podcast_analytics"."public"."dim_users__dbt_backup" cascade
[0m18:48:22.543843 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m18:48:22.544612 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m18:48:22.544776 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m18:48:22.544938 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:48:22.545275 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:48:22.545422 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:48:22.546185 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m18:48:22.546653 [debug] [Thread-1 (]: On model.podcast_analytics.dim_users: Close
[0m18:48:22.546815 [debug] [Thread-2 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop view if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m18:48:22.547239 [debug] [Thread-4 (]: On model.podcast_analytics.dim_episodes: Close
[0m18:48:22.547557 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:48:22.547787 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14ebb29-2c86-4fea-89aa-9bfe6bb806ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106130890>]}
[0m18:48:22.548015 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14ebb29-2c86-4fea-89aa-9bfe6bb806ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10619a7b0>]}
[0m18:48:22.548186 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m18:48:22.548445 [info ] [Thread-1 (]: 6 of 9 OK created sql view model public.dim_users .............................. [[32mCREATE VIEW[0m in 0.07s]
[0m18:48:22.548716 [info ] [Thread-4 (]: 5 of 9 OK created sql view model public.dim_episodes ........................... [[32mCREATE VIEW[0m in 0.07s]
[0m18:48:22.548884 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:48:22.549112 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.dim_users
[0m18:48:22.549316 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.dim_episodes
[0m18:48:22.549745 [debug] [Thread-2 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m18:48:22.549900 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:48:22.550176 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14ebb29-2c86-4fea-89aa-9bfe6bb806ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ceb620>]}
[0m18:48:22.550694 [debug] [Thread-3 (]: On model.podcast_analytics.int_user_sessions: Close
[0m18:48:22.550966 [info ] [Thread-2 (]: 8 of 9 OK created sql view model public.mart_top_episodes ...................... [[32mCREATE VIEW[0m in 0.04s]
[0m18:48:22.551246 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14ebb29-2c86-4fea-89aa-9bfe6bb806ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052dda30>]}
[0m18:48:22.551478 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m18:48:22.551699 [info ] [Thread-3 (]: 7 of 9 OK created sql view model public.int_user_sessions ...................... [[32mCREATE VIEW[0m in 0.04s]
[0m18:48:22.551973 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m18:48:22.552284 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m18:48:22.552515 [info ] [Thread-1 (]: 9 of 9 START sql view model public.mart_user_session_metrics ................... [RUN]
[0m18:48:22.552713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.dim_users, now model.podcast_analytics.mart_user_session_metrics)
[0m18:48:22.552873 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m18:48:22.553910 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m18:48:22.554527 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m18:48:22.555826 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m18:48:22.556095 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:48:22.556246 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m18:48:22.556452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:22.563510 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:48:22.563729 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:48:22.563897 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  create view "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
    
    
  as (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
[0m18:48:22.567396 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:48:22.568601 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:48:22.568764 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m18:48:22.569619 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:48:22.570205 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m18:48:22.570360 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:48:22.570505 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m18:48:22.571701 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:48:22.572503 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m18:48:22.572830 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:48:22.572987 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop view if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m18:48:22.573706 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:48:22.574272 [debug] [Thread-1 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m18:48:22.574559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f14ebb29-2c86-4fea-89aa-9bfe6bb806ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061031a0>]}
[0m18:48:22.574855 [info ] [Thread-1 (]: 9 of 9 OK created sql view model public.mart_user_session_metrics .............. [[32mCREATE VIEW[0m in 0.02s]
[0m18:48:22.575124 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m18:48:22.575721 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:22.575868 [debug] [MainThread]: On master: BEGIN
[0m18:48:22.575995 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:48:22.583799 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m18:48:22.583961 [debug] [MainThread]: On master: COMMIT
[0m18:48:22.584099 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:22.584231 [debug] [MainThread]: On master: COMMIT
[0m18:48:22.584701 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:22.584832 [debug] [MainThread]: On master: Close
[0m18:48:22.584996 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:22.585122 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m18:48:22.585240 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m18:48:22.585354 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m18:48:22.585468 [debug] [MainThread]: Connection 'model.podcast_analytics.dim_episodes' was properly closed.
[0m18:48:22.585632 [info ] [MainThread]: 
[0m18:48:22.585791 [info ] [MainThread]: Finished running 9 view models in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m18:48:22.586431 [debug] [MainThread]: Command end result
[0m18:48:22.597791 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:48:22.598712 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:48:22.601103 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m18:48:22.601273 [info ] [MainThread]: 
[0m18:48:22.601457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:48:22.601604 [info ] [MainThread]: 
[0m18:48:22.601760 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=9
[0m18:48:22.603068 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.57347465, "process_in_blocks": "0", "process_kernel_time": 0.117318, "process_mem_max_rss": "131416064", "process_out_blocks": "0", "process_user_time": 0.972071}
[0m18:48:22.603289 [debug] [MainThread]: Command `dbt run` succeeded at 18:48:22.603254 after 0.57 seconds
[0m18:48:22.603471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bac110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10404da90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061a6900>]}
[0m18:48:22.603646 [debug] [MainThread]: Flushing usage events
[0m18:48:23.084965 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:23.789857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c40fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10693d430>]}


============================== 18:48:23.791553 | 12121f3d-5657-4855-9ff3-39aebc1d9c70 ==============================
[0m18:48:23.791553 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:48:23.791838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '..', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --profiles-dir ..', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:48:23.889013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12121f3d-5657-4855-9ff3-39aebc1d9c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ee56a0>]}
[0m18:48:23.911581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12121f3d-5657-4855-9ff3-39aebc1d9c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e97260>]}
[0m18:48:23.912050 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:48:23.953547 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m18:48:24.006938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:48:24.007172 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:48:24.028119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12121f3d-5657-4855-9ff3-39aebc1d9c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107556c00>]}
[0m18:48:24.064449 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:48:24.065389 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:48:24.075263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12121f3d-5657-4855-9ff3-39aebc1d9c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075544d0>]}
[0m18:48:24.075497 [info ] [MainThread]: Found 9 models, 2 seeds, 8 data tests, 3 sources, 549 macros
[0m18:48:24.075678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12121f3d-5657-4855-9ff3-39aebc1d9c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f83650>]}
[0m18:48:24.076492 [info ] [MainThread]: 
[0m18:48:24.076674 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:48:24.076817 [info ] [MainThread]: 
[0m18:48:24.077041 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:48:24.078625 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m18:48:24.096325 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:48:24.096572 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m18:48:24.096729 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:24.113914 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m18:48:24.114126 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:48:24.114284 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:48:24.119107 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.005 seconds
[0m18:48:24.119722 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m18:48:24.120204 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m18:48:24.122740 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:24.122917 [debug] [MainThread]: On master: BEGIN
[0m18:48:24.123062 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:24.129200 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:48:24.129340 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:24.129523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:48:24.135141 [debug] [MainThread]: SQL status: SELECT 9 in 0.005 seconds
[0m18:48:24.136190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12121f3d-5657-4855-9ff3-39aebc1d9c70', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078d4290>]}
[0m18:48:24.136399 [debug] [MainThread]: On master: ROLLBACK
[0m18:48:24.136852 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:24.136988 [debug] [MainThread]: On master: BEGIN
[0m18:48:24.137711 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:48:24.137845 [debug] [MainThread]: On master: COMMIT
[0m18:48:24.137973 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:24.138100 [debug] [MainThread]: On master: COMMIT
[0m18:48:24.138508 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:24.138641 [debug] [MainThread]: On master: Close
[0m18:48:24.139631 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m18:48:24.139856 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m18:48:24.140057 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m18:48:24.140401 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m18:48:24.140253 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m18:48:24.140663 [info ] [Thread-2 (]: 2 of 8 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [RUN]
[0m18:48:24.140856 [info ] [Thread-3 (]: 3 of 8 START test not_null_stg_episodes_episode_id ............................. [RUN]
[0m18:48:24.141036 [info ] [Thread-4 (]: 4 of 8 START test not_null_stg_user_events_event_id ............................ [RUN]
[0m18:48:24.141237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8)
[0m18:48:24.141474 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7'
[0m18:48:24.141668 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422'
[0m18:48:24.141854 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7'
[0m18:48:24.142021 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m18:48:24.142187 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m18:48:24.142345 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m18:48:24.142496 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m18:48:24.150801 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m18:48:24.154502 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m18:48:24.158552 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m18:48:24.160140 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m18:48:24.160616 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m18:48:24.160816 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m18:48:24.166632 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m18:48:24.166803 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m18:48:24.167610 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m18:48:24.168597 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m18:48:24.169576 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m18:48:24.170496 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m18:48:24.170957 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m18:48:24.171229 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m18:48:24.171428 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: BEGIN
[0m18:48:24.171665 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m18:48:24.171841 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m18:48:24.171995 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m18:48:24.172173 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:48:24.172344 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m18:48:24.172509 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m18:48:24.172673 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:48:24.172912 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:24.173154 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:48:24.179560 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m18:48:24.179787 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m18:48:24.180013 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','missing_timestamp','malformed_timestamp','missing_user_id','missing_episode_id','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m18:48:24.182459 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m18:48:24.182625 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m18:48:24.182803 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m18:48:24.182987 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m18:48:24.183170 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m18:48:24.183361 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m18:48:24.183569 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m18:48:24.183757 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m18:48:24.183989 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m18:48:24.187834 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:48:24.189738 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m18:48:24.190351 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m18:48:24.190628 [info ] [Thread-3 (]: 3 of 8 PASS not_null_stg_episodes_episode_id ................................... [[32mPASS[0m in 0.05s]
[0m18:48:24.190880 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m18:48:24.191064 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m18:48:24.191261 [info ] [Thread-3 (]: 5 of 8 START test not_null_stg_users_user_id ................................... [RUN]
[0m18:48:24.191464 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m18:48:24.191620 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m18:48:24.193306 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m18:48:24.193508 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.013 seconds
[0m18:48:24.194170 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: ROLLBACK
[0m18:48:24.194455 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m18:48:24.194679 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: Close
[0m18:48:24.195633 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m18:48:24.195794 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.012 seconds
[0m18:48:24.196067 [info ] [Thread-2 (]: 2 of 8 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [[32mPASS[0m in 0.05s]
[0m18:48:24.197196 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m18:48:24.197474 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m18:48:24.197677 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m18:48:24.197873 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m18:48:24.198112 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.014 seconds
[0m18:48:24.198276 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m18:48:24.198438 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m18:48:24.198622 [info ] [Thread-2 (]: 6 of 8 START test unique_stg_episodes_episode_id ............................... [RUN]
[0m18:48:24.199163 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m18:48:24.199540 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:48:24.199416 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.06s]
[0m18:48:24.199777 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m18:48:24.200119 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m18:48:24.200277 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m18:48:24.200452 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m18:48:24.200654 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m18:48:24.203540 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m18:48:24.200920 [info ] [Thread-4 (]: 4 of 8 PASS not_null_stg_user_events_event_id .................................. [[32mPASS[0m in 0.06s]
[0m18:48:24.204054 [info ] [Thread-1 (]: 7 of 8 START test unique_stg_user_events_event_id .............................. [RUN]
[0m18:48:24.204372 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m18:48:24.204636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m18:48:24.204870 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m18:48:24.205049 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m18:48:24.205228 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m18:48:24.205399 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m18:48:24.205580 [info ] [Thread-4 (]: 8 of 8 START test unique_stg_users_user_id ..................................... [RUN]
[0m18:48:24.207441 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m18:48:24.207650 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m18:48:24.209328 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m18:48:24.209568 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m18:48:24.209822 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m18:48:24.210089 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m18:48:24.210293 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m18:48:24.212200 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m18:48:24.212392 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m18:48:24.212584 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:48:24.212748 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: BEGIN
[0m18:48:24.213796 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m18:48:24.214491 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m18:48:24.214667 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:48:24.214830 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m18:48:24.215954 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m18:48:24.216147 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m18:48:24.216317 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m18:48:24.216566 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: BEGIN
[0m18:48:24.216852 [info ] [Thread-3 (]: 5 of 8 PASS not_null_stg_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m18:48:24.217105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:48:24.217320 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m18:48:24.217563 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m18:48:24.217809 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m18:48:24.218036 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:48:24.219795 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m18:48:24.219979 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m18:48:24.220156 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:48:24.220922 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:48:24.221875 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: ROLLBACK
[0m18:48:24.222265 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: Close
[0m18:48:24.222545 [info ] [Thread-2 (]: 6 of 8 PASS unique_stg_episodes_episode_id ..................................... [[32mPASS[0m in 0.02s]
[0m18:48:24.222800 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m18:48:24.222977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:48:24.223293 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m18:48:24.223632 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m18:48:24.223850 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m18:48:24.224133 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:48:24.224342 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_user_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:48:24.225362 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:48:24.226046 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m18:48:24.226399 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m18:48:24.226702 [info ] [Thread-4 (]: 8 of 8 PASS unique_stg_users_user_id ........................................... [[32mPASS[0m in 0.02s]
[0m18:48:24.226959 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m18:48:24.244132 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.020 seconds
[0m18:48:24.244906 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: ROLLBACK
[0m18:48:24.245336 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: Close
[0m18:48:24.245612 [info ] [Thread-1 (]: 7 of 8 PASS unique_stg_user_events_event_id .................................... [[32mPASS[0m in 0.04s]
[0m18:48:24.245862 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m18:48:24.246553 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:24.246715 [debug] [MainThread]: On master: BEGIN
[0m18:48:24.246855 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:48:24.251688 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:48:24.251875 [debug] [MainThread]: On master: COMMIT
[0m18:48:24.252019 [debug] [MainThread]: Using postgres connection "master"
[0m18:48:24.252152 [debug] [MainThread]: On master: COMMIT
[0m18:48:24.252492 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:48:24.252657 [debug] [MainThread]: On master: Close
[0m18:48:24.252867 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:24.253008 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m18:48:24.253147 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16' was properly closed.
[0m18:48:24.253281 [debug] [MainThread]: Connection 'test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77' was properly closed.
[0m18:48:24.253405 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m18:48:24.253561 [info ] [MainThread]: 
[0m18:48:24.253728 [info ] [MainThread]: Finished running 8 data tests in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m18:48:24.254340 [debug] [MainThread]: Command end result
[0m18:48:24.294599 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:48:24.295509 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:48:24.298268 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m18:48:24.298435 [info ] [MainThread]: 
[0m18:48:24.298620 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:48:24.298772 [info ] [MainThread]: 
[0m18:48:24.298943 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=8
[0m18:48:24.300211 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.536202, "process_in_blocks": "0", "process_kernel_time": 0.103346, "process_mem_max_rss": "132087808", "process_out_blocks": "0", "process_user_time": 0.918434}
[0m18:48:24.300424 [debug] [MainThread]: Command `dbt test` succeeded at 18:48:24.300388 after 0.54 seconds
[0m18:48:24.300602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0ea20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ca4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106055580>]}
[0m18:48:24.300783 [debug] [MainThread]: Flushing usage events
[0m18:48:24.673691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:24.509530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e92ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f5610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f51f0>]}


============================== 18:55:24.511803 | 672872b8-b6e4-4ac4-a46e-3d64fd8f6a90 ==============================
[0m18:55:24.511803 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:55:24.512113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/samydoreau/global-assignment', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt deps --profiles-dir /Users/samydoreau/global-assignment', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:55:24.561952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '672872b8-b6e4-4ac4-a46e-3d64fd8f6a90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066b7ef0>]}
[0m18:55:24.590059 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-4zyxmouz'
[0m18:55:24.590320 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:55:24.654456 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:55:24.654902 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:55:24.677775 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:55:24.679435 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:55:24.854869 [info ] [MainThread]: Installed from version 1.3.0
[0m18:55:24.855155 [info ] [MainThread]: Up to date!
[0m18:55:24.855380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '672872b8-b6e4-4ac4-a46e-3d64fd8f6a90', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10656f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107046c00>]}
[0m18:55:24.857417 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.37632313, "process_in_blocks": "0", "process_kernel_time": 0.132679, "process_mem_max_rss": "112295936", "process_out_blocks": "0", "process_user_time": 0.587266}
[0m18:55:24.857700 [debug] [MainThread]: Command `dbt deps` succeeded at 18:55:24.857652 after 0.38 seconds
[0m18:55:24.857904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066f5490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8ba40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070a3f50>]}
[0m18:55:24.858094 [debug] [MainThread]: Flushing usage events
[0m18:55:25.226489 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:25.924040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107604d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107721730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107721340>]}


============================== 18:55:25.925745 | e139c5cb-af76-4443-bb6e-68025d3c27b9 ==============================
[0m18:55:25.925745 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:55:25.926035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/samydoreau/global-assignment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed --profiles-dir /Users/samydoreau/global-assignment', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:55:26.000559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e139c5cb-af76-4443-bb6e-68025d3c27b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d6d50>]}
[0m18:55:26.022176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e139c5cb-af76-4443-bb6e-68025d3c27b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d4200>]}
[0m18:55:26.023259 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:55:26.067482 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m18:55:26.130940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:26.131170 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:26.151699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e139c5cb-af76-4443-bb6e-68025d3c27b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c03dd0>]}
[0m18:55:26.188348 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:55:26.189358 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:55:26.196388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e139c5cb-af76-4443-bb6e-68025d3c27b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10853cb90>]}
[0m18:55:26.196620 [info ] [MainThread]: Found 10 models, 2 seeds, 19 data tests, 3 sources, 549 macros
[0m18:55:26.196789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e139c5cb-af76-4443-bb6e-68025d3c27b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108346270>]}
[0m18:55:26.197622 [info ] [MainThread]: 
[0m18:55:26.197792 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:55:26.197931 [info ] [MainThread]: 
[0m18:55:26.198160 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:55:26.199514 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m18:55:26.222693 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m18:55:26.222963 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:55:26.223117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:26.252646 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.029 seconds
[0m18:55:26.253354 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m18:55:26.254241 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m18:55:26.256941 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:55:26.257182 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m18:55:26.257326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:26.264237 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:55:26.264552 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:55:26.264792 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:55:26.269463 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.004 seconds
[0m18:55:26.270265 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m18:55:26.270747 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m18:55:26.274310 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:26.274672 [debug] [MainThread]: On master: BEGIN
[0m18:55:26.274809 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:26.279650 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:55:26.279884 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:26.280083 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:55:26.284629 [debug] [MainThread]: SQL status: SELECT 9 in 0.004 seconds
[0m18:55:26.285636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e139c5cb-af76-4443-bb6e-68025d3c27b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078016d0>]}
[0m18:55:26.285841 [debug] [MainThread]: On master: ROLLBACK
[0m18:55:26.286182 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:26.286311 [debug] [MainThread]: On master: BEGIN
[0m18:55:26.286828 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:55:26.286994 [debug] [MainThread]: On master: COMMIT
[0m18:55:26.287134 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:26.287264 [debug] [MainThread]: On master: COMMIT
[0m18:55:26.287556 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:55:26.287701 [debug] [MainThread]: On master: Close
[0m18:55:26.289297 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m18:55:26.289478 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m18:55:26.289726 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m18:55:26.289995 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m18:55:26.290238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m18:55:26.290469 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m18:55:26.290643 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m18:55:26.290796 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m18:55:26.290962 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m18:55:26.291126 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m18:55:26.305327 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m18:55:26.306819 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m18:55:26.307026 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m18:55:26.307192 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m18:55:26.307345 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:55:26.307491 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:26.313900 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:55:26.314147 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m18:55:26.314330 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m18:55:26.314486 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m18:55:26.314645 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m18:55:26.314804 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m18:55:26.318475 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.004 seconds
[0m18:55:26.324918 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.010 seconds
[0m18:55:26.356183 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m18:55:26.387362 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m18:55:26.387589 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m18:55:26.387790 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m18:55:26.390531 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.003 seconds
[0m18:55:26.390708 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.003 seconds
[0m18:55:26.392879 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m18:55:26.393181 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m18:55:26.398830 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m18:55:26.399440 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m18:55:26.399608 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m18:55:26.399765 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m18:55:26.399926 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m18:55:26.400085 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m18:55:26.403533 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m18:55:26.403699 [debug] [Thread-2 (]: SQL status: COMMIT in 0.003 seconds
[0m18:55:26.404376 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m18:55:26.404653 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m18:55:26.405571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e139c5cb-af76-4443-bb6e-68025d3c27b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083c9010>]}
[0m18:55:26.405733 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e139c5cb-af76-4443-bb6e-68025d3c27b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050361b0>]}
[0m18:55:26.405976 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.11s]
[0m18:55:26.406231 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.11s]
[0m18:55:26.406485 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m18:55:26.406689 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m18:55:26.407245 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:26.407384 [debug] [MainThread]: On master: BEGIN
[0m18:55:26.407508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:26.415726 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m18:55:26.415980 [debug] [MainThread]: On master: COMMIT
[0m18:55:26.416122 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:26.416246 [debug] [MainThread]: On master: COMMIT
[0m18:55:26.416727 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:55:26.416856 [debug] [MainThread]: On master: Close
[0m18:55:26.417040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:26.417163 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m18:55:26.417279 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m18:55:26.417427 [info ] [MainThread]: 
[0m18:55:26.417587 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m18:55:26.417927 [debug] [MainThread]: Command end result
[0m18:55:26.431365 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:55:26.432689 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:55:26.435067 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m18:55:26.435228 [info ] [MainThread]: 
[0m18:55:26.435416 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:26.435573 [info ] [MainThread]: 
[0m18:55:26.435737 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:55:26.437108 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.5385048, "process_in_blocks": "0", "process_kernel_time": 0.113887, "process_mem_max_rss": "131072000", "process_out_blocks": "0", "process_user_time": 0.891365}
[0m18:55:26.437718 [debug] [MainThread]: Command `dbt seed` succeeded at 18:55:26.437654 after 0.54 seconds
[0m18:55:26.437979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107721700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108509a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107708ce0>]}
[0m18:55:26.438216 [debug] [MainThread]: Flushing usage events
[0m18:55:26.775131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:27.496794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d5bec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f57c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126f5370>]}


============================== 18:55:27.498661 | 40d6527c-e65f-489d-97d2-3c308791cf38 ==============================
[0m18:55:27.498661 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:55:27.498944 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'profiles_dir': '/Users/samydoreau/global-assignment', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --profiles-dir /Users/samydoreau/global-assignment', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:55:27.562905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40d6527c-e65f-489d-97d2-3c308791cf38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d80530>]}
[0m18:55:27.584090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40d6527c-e65f-489d-97d2-3c308791cf38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121fade0>]}
[0m18:55:27.584473 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:55:27.624914 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m18:55:27.678979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:27.679210 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:27.699655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40d6527c-e65f-489d-97d2-3c308791cf38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cbe9c0>]}
[0m18:55:27.737346 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:55:27.738235 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:55:27.744232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40d6527c-e65f-489d-97d2-3c308791cf38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113844050>]}
[0m18:55:27.744472 [info ] [MainThread]: Found 10 models, 2 seeds, 19 data tests, 3 sources, 549 macros
[0m18:55:27.744641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40d6527c-e65f-489d-97d2-3c308791cf38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137e5f70>]}
[0m18:55:27.745531 [info ] [MainThread]: 
[0m18:55:27.745706 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:55:27.745847 [info ] [MainThread]: 
[0m18:55:27.746079 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:55:27.747672 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m18:55:27.768465 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m18:55:27.768709 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:55:27.768865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:27.786690 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.018 seconds
[0m18:55:27.787303 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m18:55:27.788036 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m18:55:27.790370 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:55:27.790528 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m18:55:27.790657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:27.798126 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m18:55:27.798283 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:55:27.798428 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:55:27.801479 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.003 seconds
[0m18:55:27.802020 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m18:55:27.802474 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m18:55:27.804699 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:27.804839 [debug] [MainThread]: On master: BEGIN
[0m18:55:27.804959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:27.811351 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:55:27.811484 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:27.811668 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:55:27.817138 [debug] [MainThread]: SQL status: SELECT 9 in 0.005 seconds
[0m18:55:27.818120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40d6527c-e65f-489d-97d2-3c308791cf38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c8d520>]}
[0m18:55:27.818321 [debug] [MainThread]: On master: ROLLBACK
[0m18:55:27.818866 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:27.819016 [debug] [MainThread]: On master: BEGIN
[0m18:55:27.819727 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:55:27.819880 [debug] [MainThread]: On master: COMMIT
[0m18:55:27.820036 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:27.820165 [debug] [MainThread]: On master: COMMIT
[0m18:55:27.820554 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:55:27.820693 [debug] [MainThread]: On master: Close
[0m18:55:27.821758 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m18:55:27.822037 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m18:55:27.822240 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m18:55:27.822396 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m18:55:27.822622 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_episodes ............................... [RUN]
[0m18:55:27.822848 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_user_events ............................ [RUN]
[0m18:55:27.823093 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_user_events_invalid .................... [RUN]
[0m18:55:27.823324 [info ] [Thread-4 (]: 4 of 10 START sql view model public.stg_users .................................. [RUN]
[0m18:55:27.823531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m18:55:27.823737 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m18:55:27.823931 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m18:55:27.824120 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m18:55:27.824284 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m18:55:27.824445 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m18:55:27.824944 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m18:55:27.825128 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m18:55:27.828235 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m18:55:27.835351 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m18:55:27.836637 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m18:55:27.837837 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m18:55:27.838576 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m18:55:27.838753 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m18:55:27.838927 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m18:55:27.839094 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m18:55:27.851762 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m18:55:27.853231 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m18:55:27.854583 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m18:55:27.855846 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events_invalid"
[0m18:55:27.856239 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:55:27.856433 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m18:55:27.856625 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:27.856812 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:55:27.857056 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: BEGIN
[0m18:55:27.857235 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:55:27.857404 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:55:27.857554 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:55:27.857729 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m18:55:27.857921 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: BEGIN
[0m18:55:27.858169 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:55:27.858344 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:55:27.864544 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m18:55:27.864707 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:55:27.864873 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m18:55:27.866260 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m18:55:27.866442 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:55:27.866632 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */

  create view "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp"
    
    
  as (
    -- stg_user_events_invalid.sql : capture invalid event records for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

invalid_events as (
    select 
        data,
        data ->> 'user_id' as user_id,
        data ->> 'episode_id' as episode_id,
        data ->> 'timestamp' as timestamp,
        data ->> 'event_type' as event_type,
        data ->> 'duration' as duration,
        case 
            when data ->> 'event_type' is null then 'missing_event_type'
            when data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete') then 'invalid_event_type'
            when data ->> 'timestamp' is null or data ->> 'timestamp' = '' then 'missing_timestamp'
            when not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}') then 'malformed_timestamp'
            when data ->> 'user_id' is null then 'missing_user_id'
            when data ->> 'episode_id' is null then 'missing_episode_id'
            else 'other_issue'
        end as issue_type
    from source
    where data ->> 'event_type' is null 
       or data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete')
       or data ->> 'timestamp' is null 
       or data ->> 'timestamp' = ''
       or not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}')
       or data ->> 'user_id' is null
       or data ->> 'episode_id' is null
)

select * from invalid_events
  );
[0m18:55:27.866830 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m18:55:27.867014 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:55:27.867183 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m18:55:27.867359 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m18:55:27.867515 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:55:27.867696 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:55:27.867897 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
-- Note: Invalid events are captured in stg_user_events_invalid.sql for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

valid_events as (
    select * from source
    where data ->> 'event_type' is not null
      and data ->> 'event_type' in ('play', 'pause', 'seek', 'complete')
      and data ->> 'timestamp' is not null
      and data ->> 'timestamp' != ''
      and data ->> 'user_id' is not null
      and data ->> 'episode_id' is not null
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'timestamp' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'event_type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        case 
            when (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}' then (data ->> 'timestamp')::timestamp
            else null
        end as event_ts,
        data ->> 'event_type'         as event_type,
        (data ->> 'duration')::integer as duration
    from valid_events
    where (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}'
)
select * from typed
  );
[0m18:55:27.870362 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:55:27.870528 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:55:27.870679 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m18:55:27.870877 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m18:55:27.872454 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:55:27.873550 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:55:27.873704 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m18:55:27.873878 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m18:55:27.874046 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid" rename to "stg_user_events_invalid__dbt_backup"
[0m18:55:27.875078 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:55:27.875232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:27.875427 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m18:55:27.876480 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:55:27.876646 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:27.876784 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:27.876950 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m18:55:27.877904 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:55:27.878054 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:27.879149 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:55:27.879475 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp" rename to "stg_user_events_invalid"
[0m18:55:27.880560 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:55:27.880724 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:27.880891 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m18:55:27.881089 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m18:55:27.887134 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m18:55:27.887310 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.006 seconds
[0m18:55:27.887533 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:55:27.888165 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m18:55:27.888347 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m18:55:27.888558 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:27.888728 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:27.888879 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:55:27.889528 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m18:55:27.890139 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m18:55:27.890293 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:55:27.890456 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m18:55:27.890630 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:55:27.890785 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:55:27.892955 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m18:55:27.893151 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m18:55:27.893301 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m18:55:27.895098 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:55:27.895269 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m18:55:27.895466 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m18:55:27.896319 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup"
[0m18:55:27.896482 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m18:55:27.896613 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m18:55:27.896951 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:55:27.898349 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m18:55:27.919930 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.023 seconds
[0m18:55:27.920578 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m18:55:27.920809 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
drop view if exists "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup" cascade
[0m18:55:27.921164 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:55:27.922101 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m18:55:27.922446 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:55:27.922651 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m18:55:27.923327 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m18:55:27.923606 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d6527c-e65f-489d-97d2-3c308791cf38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11508fd70>]}
[0m18:55:27.923878 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_episodes .......................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:55:27.924150 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m18:55:27.924390 [debug] [Thread-1 (]: Began running node model.podcast_analytics.dim_episodes
[0m18:55:27.924583 [info ] [Thread-1 (]: 5 of 10 START sql table model public.dim_episodes .............................. [RUN]
[0m18:55:27.924772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.dim_episodes)
[0m18:55:27.924922 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.dim_episodes
[0m18:55:27.925904 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.dim_episodes"
[0m18:55:27.926070 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m18:55:27.926603 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: Close
[0m18:55:27.926816 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.003 seconds
[0m18:55:27.927040 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d6527c-e65f-489d-97d2-3c308791cf38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f823f0>]}
[0m18:55:27.927190 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.dim_episodes
[0m18:55:27.927632 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: Close
[0m18:55:27.927795 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.004 seconds
[0m18:55:27.928022 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_user_events_invalid ............... [[32mCREATE VIEW[0m in 0.10s]
[0m18:55:27.937045 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.dim_episodes"
[0m18:55:27.937724 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m18:55:27.937986 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d6527c-e65f-489d-97d2-3c308791cf38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11509ef60>]}
[0m18:55:27.938244 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m18:55:27.938687 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public.stg_users ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m18:55:27.938969 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d6527c-e65f-489d-97d2-3c308791cf38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c29490>]}
[0m18:55:27.939286 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m18:55:27.939551 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_user_events ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m18:55:27.939762 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:55:27.940003 [debug] [Thread-3 (]: Began running node model.podcast_analytics.dim_users
[0m18:55:27.940223 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m18:55:27.940385 [debug] [Thread-1 (]: On model.podcast_analytics.dim_episodes: BEGIN
[0m18:55:27.940580 [info ] [Thread-3 (]: 6 of 10 START sql table model public.dim_users ................................. [RUN]
[0m18:55:27.940832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:27.941003 [debug] [Thread-4 (]: Began running node model.podcast_analytics.fact_user_events
[0m18:55:27.941168 [debug] [Thread-2 (]: Began running node model.podcast_analytics.int_user_sessions
[0m18:55:27.941341 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now model.podcast_analytics.dim_users)
[0m18:55:27.941601 [info ] [Thread-4 (]: 7 of 10 START sql table model public.fact_user_events .......................... [RUN]
[0m18:55:27.941981 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.dim_users
[0m18:55:27.941837 [info ] [Thread-2 (]: 8 of 10 START sql view model public.int_user_sessions .......................... [RUN]
[0m18:55:27.942214 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_users, now model.podcast_analytics.fact_user_events)
[0m18:55:27.943356 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.dim_users"
[0m18:55:27.943529 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now model.podcast_analytics.int_user_sessions)
[0m18:55:27.943689 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.fact_user_events
[0m18:55:27.943877 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m18:55:27.945215 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.fact_user_events"
[0m18:55:27.946794 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m18:55:27.946966 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.dim_users
[0m18:55:27.948517 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.dim_users"
[0m18:55:27.948704 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m18:55:27.948938 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.fact_user_events
[0m18:55:27.949116 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m18:55:27.949289 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:55:27.950656 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.fact_user_events"
[0m18:55:27.950860 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:55:27.952734 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m18:55:27.952911 [debug] [Thread-1 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */

  
    

  create  table "podcast_analytics"."public"."dim_episodes__dbt_tmp"
  
  
    as
  
  (
    -- dim_episodes.sql : dimension table for episodes (one row per episode)
select * from "podcast_analytics"."public"."stg_episodes"
  );
  
[0m18:55:27.953130 [debug] [Thread-3 (]: On model.podcast_analytics.dim_users: BEGIN
[0m18:55:27.953375 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m18:55:27.953580 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:55:27.953755 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:55:27.953926 [debug] [Thread-4 (]: On model.podcast_analytics.fact_user_events: BEGIN
[0m18:55:27.954273 [debug] [Thread-2 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m18:55:27.954445 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:55:27.954660 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:55:27.958806 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.005 seconds
[0m18:55:27.961672 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:55:27.961905 [debug] [Thread-1 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */
alter table "podcast_analytics"."public"."dim_episodes__dbt_tmp" rename to "dim_episodes"
[0m18:55:27.962615 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:27.962779 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m18:55:27.962950 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m18:55:27.963108 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m18:55:27.963703 [debug] [Thread-1 (]: On model.podcast_analytics.dim_episodes: COMMIT
[0m18:55:27.963868 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:55:27.964037 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:55:27.964207 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m18:55:27.964372 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:55:27.964589 [debug] [Thread-2 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions

-- 1. Bring in all user events from the staging model
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

-- 2. For each event, get the timestamp of the previous event for the same user
events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

-- 3. Flag the start of a new session:
--    - If there is no previous event (first event for user)
--    - Or if the gap between events is more than 30 minutes
flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

-- 4. Assign a session number to each event for each user by cumulatively summing the new session flags
numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

-- 5. Aggregate events into sessions:
--    - Find session start/end timestamps
--    - Sum up listening duration for the session
agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end,
        sum(coalesce(duration, 0)) as total_listening_duration
    from numbered
    group by user_id, session_number
),

-- 6. Generate a surrogate session_id and select final session fields
final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        total_listening_duration as session_duration
    from agg
)

-- 7. Output the final sessionized data
select * from final
  );
[0m18:55:27.964812 [debug] [Thread-3 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */

  
    

  create  table "podcast_analytics"."public"."dim_users__dbt_tmp"
  
  
    as
  
  (
    -- dim_users.sql : dimension table for users (one row per user)
select * from "podcast_analytics"."public"."stg_users"
  );
  
[0m18:55:27.964989 [debug] [Thread-4 (]: On model.podcast_analytics.fact_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.fact_user_events"} */

  
    

  create  table "podcast_analytics"."public"."fact_user_events__dbt_tmp"
  
  
    as
  
  (
    
-- fact_user_events.sql : central fact table of cleaned user events
select * from "podcast_analytics"."public"."stg_user_events"
  );
  
[0m18:55:27.965166 [debug] [Thread-1 (]: On model.podcast_analytics.dim_episodes: COMMIT
[0m18:55:27.967114 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:55:27.967948 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."dim_episodes__dbt_backup"
[0m18:55:27.969094 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:55:27.969270 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m18:55:27.969426 [debug] [Thread-1 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */
drop table if exists "podcast_analytics"."public"."dim_episodes__dbt_backup" cascade
[0m18:55:27.969574 [debug] [Thread-3 (]: SQL status: SELECT 100 in 0.004 seconds
[0m18:55:27.970709 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:55:27.971950 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:55:27.972124 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:55:27.972297 [debug] [Thread-2 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m18:55:27.972463 [debug] [Thread-3 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */
alter table "podcast_analytics"."public"."dim_users__dbt_tmp" rename to "dim_users"
[0m18:55:27.972969 [debug] [Thread-1 (]: On model.podcast_analytics.dim_episodes: Close
[0m18:55:27.973272 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d6527c-e65f-489d-97d2-3c308791cf38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150010d0>]}
[0m18:55:27.973544 [info ] [Thread-1 (]: 5 of 10 OK created sql table model public.dim_episodes ......................... [[32mSELECT 50[0m in 0.05s]
[0m18:55:27.973805 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.dim_episodes
[0m18:55:27.973988 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:27.974160 [debug] [Thread-1 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m18:55:27.974312 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:27.974872 [debug] [Thread-3 (]: On model.podcast_analytics.dim_users: COMMIT
[0m18:55:27.975081 [info ] [Thread-1 (]: 9 of 10 START sql table model public.mart_top_episodes ......................... [RUN]
[0m18:55:27.975723 [debug] [Thread-2 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m18:55:27.975914 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:55:27.976100 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.dim_episodes, now model.podcast_analytics.mart_top_episodes)
[0m18:55:27.976271 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:55:27.976431 [debug] [Thread-3 (]: On model.podcast_analytics.dim_users: COMMIT
[0m18:55:27.976592 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m18:55:27.976755 [debug] [Thread-2 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m18:55:27.978862 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m18:55:27.979033 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m18:55:27.980421 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."dim_users__dbt_backup"
[0m18:55:27.980616 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m18:55:27.981096 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:55:27.981949 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m18:55:27.982142 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m18:55:27.982327 [debug] [Thread-3 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */
drop table if exists "podcast_analytics"."public"."dim_users__dbt_backup" cascade
[0m18:55:27.982703 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:55:27.984083 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m18:55:27.984284 [debug] [Thread-2 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m18:55:27.984594 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:55:27.984791 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:55:27.984983 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.000 seconds
[0m18:55:27.985508 [debug] [Thread-3 (]: On model.podcast_analytics.dim_users: Close
[0m18:55:27.985674 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m18:55:27.986182 [debug] [Thread-2 (]: On model.podcast_analytics.int_user_sessions: Close
[0m18:55:27.986378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:27.986640 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d6527c-e65f-489d-97d2-3c308791cf38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115030a70>]}
[0m18:55:27.987261 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d6527c-e65f-489d-97d2-3c308791cf38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115008cb0>]}
[0m18:55:27.988294 [info ] [Thread-3 (]: 6 of 10 OK created sql table model public.dim_users ............................ [[32mSELECT 100[0m in 0.05s]
[0m18:55:27.988845 [info ] [Thread-2 (]: 8 of 10 OK created sql view model public.int_user_sessions ..................... [[32mCREATE VIEW[0m in 0.04s]
[0m18:55:27.989239 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.dim_users
[0m18:55:27.989529 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m18:55:27.989916 [debug] [Thread-3 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m18:55:27.990160 [info ] [Thread-3 (]: 10 of 10 START sql table model public.mart_user_session_metrics ................ [RUN]
[0m18:55:27.990397 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.dim_users, now model.podcast_analytics.mart_user_session_metrics)
[0m18:55:27.990581 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m18:55:27.992602 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m18:55:27.992787 [debug] [Thread-4 (]: SQL status: SELECT 4860 in 0.027 seconds
[0m18:55:27.994074 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m18:55:27.994668 [debug] [Thread-4 (]: On model.podcast_analytics.fact_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.fact_user_events"} */
alter table "podcast_analytics"."public"."fact_user_events__dbt_tmp" rename to "fact_user_events"
[0m18:55:27.994982 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m18:55:27.995168 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m18:55:27.995336 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:55:27.995508 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:55:27.996915 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m18:55:27.997555 [debug] [Thread-4 (]: On model.podcast_analytics.fact_user_events: COMMIT
[0m18:55:27.997737 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  
    

  create  table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
  
  
    as
  
  (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
  
[0m18:55:27.997967 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m18:55:27.998195 [debug] [Thread-4 (]: On model.podcast_analytics.fact_user_events: COMMIT
[0m18:55:27.998381 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:55:27.998572 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m18:55:27.998737 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:55:27.999451 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m18:55:28.000660 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."fact_user_events__dbt_backup"
[0m18:55:28.001053 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m18:55:28.001224 [debug] [Thread-4 (]: On model.podcast_analytics.fact_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.fact_user_events"} */
drop table if exists "podcast_analytics"."public"."fact_user_events__dbt_backup" cascade
[0m18:55:28.001593 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:55:28.002134 [debug] [Thread-4 (]: On model.podcast_analytics.fact_user_events: Close
[0m18:55:28.002433 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d6527c-e65f-489d-97d2-3c308791cf38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150bcb00>]}
[0m18:55:28.002758 [info ] [Thread-4 (]: 7 of 10 OK created sql table model public.fact_user_events ..................... [[32mSELECT 4860[0m in 0.06s]
[0m18:55:28.003023 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.fact_user_events
[0m18:55:28.003875 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m18:55:28.004171 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:55:28.004426 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  
    

  create  table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
  
  
    as
  
  (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
  
[0m18:55:28.020704 [debug] [Thread-1 (]: SQL status: SELECT 50 in 0.022 seconds
[0m18:55:28.022851 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:55:28.023107 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m18:55:28.023838 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:28.024539 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m18:55:28.024713 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:55:28.024871 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m18:55:28.025523 [debug] [Thread-1 (]: SQL status: COMMIT in 0.000 seconds
[0m18:55:28.026465 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m18:55:28.026819 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:55:28.026987 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop table if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m18:55:28.027387 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:55:28.027939 [debug] [Thread-1 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m18:55:28.028208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d6527c-e65f-489d-97d2-3c308791cf38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f78b30>]}
[0m18:55:28.028500 [info ] [Thread-1 (]: 9 of 10 OK created sql table model public.mart_top_episodes .................... [[32mSELECT 50[0m in 0.05s]
[0m18:55:28.028753 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m18:55:28.029123 [debug] [Thread-3 (]: SQL status: SELECT 100 in 0.024 seconds
[0m18:55:28.030374 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:55:28.030549 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m18:55:28.031018 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:55:28.031645 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m18:55:28.031808 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:55:28.031956 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m18:55:28.032455 [debug] [Thread-3 (]: SQL status: COMMIT in 0.000 seconds
[0m18:55:28.033581 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m18:55:28.033964 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:55:28.034135 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop table if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m18:55:28.034517 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.000 seconds
[0m18:55:28.035071 [debug] [Thread-3 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m18:55:28.035322 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '40d6527c-e65f-489d-97d2-3c308791cf38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fe4a70>]}
[0m18:55:28.035605 [info ] [Thread-3 (]: 10 of 10 OK created sql table model public.mart_user_session_metrics ........... [[32mSELECT 100[0m in 0.04s]
[0m18:55:28.035858 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m18:55:28.036490 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:28.036647 [debug] [MainThread]: On master: BEGIN
[0m18:55:28.036829 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:28.041901 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:55:28.042122 [debug] [MainThread]: On master: COMMIT
[0m18:55:28.042257 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:28.042382 [debug] [MainThread]: On master: COMMIT
[0m18:55:28.042665 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:55:28.042808 [debug] [MainThread]: On master: Close
[0m18:55:28.043013 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:28.043148 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m18:55:28.043273 [debug] [MainThread]: Connection 'model.podcast_analytics.int_user_sessions' was properly closed.
[0m18:55:28.043388 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m18:55:28.043503 [debug] [MainThread]: Connection 'model.podcast_analytics.fact_user_events' was properly closed.
[0m18:55:28.043696 [info ] [MainThread]: 
[0m18:55:28.043860 [info ] [MainThread]: Finished running 5 table models, 5 view models in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m18:55:28.044520 [debug] [MainThread]: Command end result
[0m18:55:28.056865 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:55:28.057871 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:55:28.060390 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m18:55:28.060556 [info ] [MainThread]: 
[0m18:55:28.060731 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:28.060875 [info ] [MainThread]: 
[0m18:55:28.061034 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m18:55:28.062352 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.59209687, "process_in_blocks": "0", "process_kernel_time": 0.11723, "process_mem_max_rss": "132497408", "process_out_blocks": "0", "process_user_time": 0.9835}
[0m18:55:28.062579 [debug] [MainThread]: Command `dbt run` succeeded at 18:55:28.062545 after 0.59 seconds
[0m18:55:28.062745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c13500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113663560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150261e0>]}
[0m18:55:28.062902 [debug] [MainThread]: Flushing usage events
[0m18:55:28.484147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:29.191091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070fd880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070fd460>]}


============================== 18:55:29.192807 | 4ac0430e-e27e-433b-a6a0-02fbbe15a556 ==============================
[0m18:55:29.192807 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:55:29.193099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'profiles_dir': '/Users/samydoreau/global-assignment', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --profiles-dir /Users/samydoreau/global-assignment', 'send_anonymous_usage_stats': 'True'}
[0m18:55:29.258128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ac0430e-e27e-433b-a6a0-02fbbe15a556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602ca70>]}
[0m18:55:29.280210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ac0430e-e27e-433b-a6a0-02fbbe15a556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070e1880>]}
[0m18:55:29.280575 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:55:29.322069 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m18:55:29.374853 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:29.375072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:29.395991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ac0430e-e27e-433b-a6a0-02fbbe15a556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e15c40>]}
[0m18:55:29.432377 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:55:29.433273 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:55:29.443477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ac0430e-e27e-433b-a6a0-02fbbe15a556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cf0410>]}
[0m18:55:29.443709 [info ] [MainThread]: Found 10 models, 2 seeds, 19 data tests, 3 sources, 549 macros
[0m18:55:29.443885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ac0430e-e27e-433b-a6a0-02fbbe15a556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cca150>]}
[0m18:55:29.444850 [info ] [MainThread]: 
[0m18:55:29.445024 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:55:29.445167 [info ] [MainThread]: 
[0m18:55:29.445395 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:55:29.447018 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m18:55:29.464422 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:55:29.465625 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m18:55:29.465803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:29.482449 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m18:55:29.482665 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:55:29.482819 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:55:29.485624 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.003 seconds
[0m18:55:29.486258 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m18:55:29.486756 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m18:55:29.490042 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:29.490204 [debug] [MainThread]: On master: BEGIN
[0m18:55:29.490326 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:29.498005 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m18:55:29.498241 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:29.498446 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:55:29.505173 [debug] [MainThread]: SQL status: SELECT 5 in 0.007 seconds
[0m18:55:29.506039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ac0430e-e27e-433b-a6a0-02fbbe15a556', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071d5640>]}
[0m18:55:29.506253 [debug] [MainThread]: On master: ROLLBACK
[0m18:55:29.506759 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:29.506891 [debug] [MainThread]: On master: BEGIN
[0m18:55:29.507620 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:55:29.507750 [debug] [MainThread]: On master: COMMIT
[0m18:55:29.507874 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:29.507997 [debug] [MainThread]: On master: COMMIT
[0m18:55:29.508406 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:55:29.508539 [debug] [MainThread]: On master: Close
[0m18:55:29.509614 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4
[0m18:55:29.509808 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m18:55:29.510141 [debug] [Thread-3 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m18:55:29.510364 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8
[0m18:55:29.509988 [info ] [Thread-1 (]: 1 of 19 START test accepted_values_fact_user_events_event_type__play__pause__seek__complete  [RUN]
[0m18:55:29.510616 [info ] [Thread-2 (]: 2 of 19 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m18:55:29.510825 [info ] [Thread-3 (]: 3 of 19 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [RUN]
[0m18:55:29.511009 [info ] [Thread-4 (]: 4 of 19 START test not_null_dim_episodes_episode_id ............................ [RUN]
[0m18:55:29.511221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4)
[0m18:55:29.511431 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8'
[0m18:55:29.511631 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7'
[0m18:55:29.511821 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8'
[0m18:55:29.511984 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4
[0m18:55:29.512143 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m18:55:29.512302 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m18:55:29.512457 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8
[0m18:55:29.521581 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4"
[0m18:55:29.523404 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m18:55:29.526069 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m18:55:29.529138 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8"
[0m18:55:29.530380 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8
[0m18:55:29.530574 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m18:55:29.530743 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4
[0m18:55:29.537424 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8"
[0m18:55:29.537594 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m18:55:29.538552 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m18:55:29.539437 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4"
[0m18:55:29.540833 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m18:55:29.541090 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8"
[0m18:55:29.541340 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8: BEGIN
[0m18:55:29.541566 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:55:29.541768 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m18:55:29.541996 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4"
[0m18:55:29.542190 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m18:55:29.542432 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: BEGIN
[0m18:55:29.542620 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4: BEGIN
[0m18:55:29.542802 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m18:55:29.542979 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:55:29.543155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:29.543329 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:55:29.551144 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m18:55:29.551304 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8"
[0m18:55:29.551501 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."dim_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m18:55:29.551919 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m18:55:29.552124 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4"
[0m18:55:29.552308 [debug] [Thread-3 (]: SQL status: BEGIN in 0.009 seconds
[0m18:55:29.552501 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m18:55:29.552691 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:29.552857 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m18:55:29.553030 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m18:55:29.554889 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8: ROLLBACK
[0m18:55:29.555105 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','missing_timestamp','malformed_timestamp','missing_user_id','missing_episode_id','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m18:55:29.555305 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:55:29.555460 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m18:55:29.556030 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4: ROLLBACK
[0m18:55:29.556207 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8: Close
[0m18:55:29.556382 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m18:55:29.556671 [info ] [Thread-4 (]: 4 of 19 PASS not_null_dim_episodes_episode_id .................................. [[32mPASS[0m in 0.04s]
[0m18:55:29.556956 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8
[0m18:55:29.557107 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4: Close
[0m18:55:29.557275 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_dim_episodes_title.388fd88fff
[0m18:55:29.557522 [info ] [Thread-1 (]: 1 of 19 PASS accepted_values_fact_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.05s]
[0m18:55:29.557712 [info ] [Thread-4 (]: 5 of 19 START test not_null_dim_episodes_title ................................. [RUN]
[0m18:55:29.557934 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4
[0m18:55:29.558095 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8, now test.podcast_analytics.not_null_dim_episodes_title.388fd88fff)
[0m18:55:29.558260 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_dim_users_email.f41c7984c2
[0m18:55:29.558438 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes_title.388fd88fff
[0m18:55:29.558600 [info ] [Thread-1 (]: 6 of 19 START test not_null_dim_users_email .................................... [RUN]
[0m18:55:29.560163 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes_title.388fd88fff"
[0m18:55:29.560347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4, now test.podcast_analytics.not_null_dim_users_email.f41c7984c2)
[0m18:55:29.560531 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_dim_users_email.f41c7984c2
[0m18:55:29.561886 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_users_email.f41c7984c2"
[0m18:55:29.562104 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_dim_episodes_title.388fd88fff
[0m18:55:29.563261 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes_title.388fd88fff"
[0m18:55:29.563479 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_dim_users_email.f41c7984c2
[0m18:55:29.564360 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_users_email.f41c7984c2"
[0m18:55:29.564567 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes_title.388fd88fff"
[0m18:55:29.564755 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes_title.388fd88fff: BEGIN
[0m18:55:29.564924 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_dim_users_email.f41c7984c2"
[0m18:55:29.565074 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:55:29.565227 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_users_email.f41c7984c2: BEGIN
[0m18:55:29.565414 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:29.569081 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.013 seconds
[0m18:55:29.569723 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: ROLLBACK
[0m18:55:29.570213 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.013 seconds
[0m18:55:29.570443 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: Close
[0m18:55:29.571187 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m18:55:29.571659 [info ] [Thread-3 (]: 3 of 19 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [[32mPASS[0m in 0.06s]
[0m18:55:29.572276 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m18:55:29.572486 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m18:55:29.572672 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m18:55:29.572858 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m18:55:29.573081 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_dim_users_user_id.e754bb5812
[0m18:55:29.573534 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_dim_users_email.f41c7984c2"
[0m18:55:29.573397 [info ] [Thread-2 (]: 2 of 19 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.06s]
[0m18:55:29.573766 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes_title.388fd88fff"
[0m18:55:29.573950 [info ] [Thread-3 (]: 7 of 19 START test not_null_dim_users_user_id .................................. [RUN]
[0m18:55:29.574157 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_users_email.f41c7984c2: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_users_email.f41c7984c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select email
from "podcast_analytics"."public"."dim_users"
where email is null



  
  
      
    ) dbt_internal_test
[0m18:55:29.574404 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m18:55:29.574579 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes_title.388fd88fff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes_title.388fd88fff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select title
from "podcast_analytics"."public"."dim_episodes"
where title is null



  
  
      
    ) dbt_internal_test
[0m18:55:29.574783 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.not_null_dim_users_user_id.e754bb5812)
[0m18:55:29.574998 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b
[0m18:55:29.575228 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_dim_users_user_id.e754bb5812
[0m18:55:29.575419 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "email" does not exist
LINE 16: select email
                ^

[0m18:55:29.575598 [info ] [Thread-2 (]: 8 of 19 START test not_null_fact_user_events_episode_id ........................ [RUN]
[0m18:55:29.575782 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:29.577856 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_users_user_id.e754bb5812"
[0m18:55:29.578047 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_users_email.f41c7984c2: ROLLBACK
[0m18:55:29.578220 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b)
[0m18:55:29.578836 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes_title.388fd88fff: ROLLBACK
[0m18:55:29.579089 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b
[0m18:55:29.580704 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b"
[0m18:55:29.580876 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes_title.388fd88fff: Close
[0m18:55:29.581103 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_users_email.f41c7984c2: Close
[0m18:55:29.581289 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_dim_users_user_id.e754bb5812
[0m18:55:29.581529 [info ] [Thread-4 (]: 5 of 19 PASS not_null_dim_episodes_title ....................................... [[32mPASS[0m in 0.02s]
[0m18:55:29.581734 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b
[0m18:55:29.583380 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_users_user_id.e754bb5812"
[0m18:55:29.583642 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_dim_episodes_title.388fd88fff
[0m18:55:29.584644 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b"
[0m18:55:29.584914 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583
[0m18:55:29.585243 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_dim_users_user_id.e754bb5812"
[0m18:55:29.585418 [info ] [Thread-4 (]: 9 of 19 START test not_null_fact_user_events_user_id ........................... [RUN]
[0m18:55:29.585645 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_users_user_id.e754bb5812: BEGIN
[0m18:55:29.585822 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b"
[0m18:55:29.586013 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes_title.388fd88fff, now test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583)
[0m18:55:29.586221 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:55:29.586394 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b: BEGIN
[0m18:55:29.586578 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583
[0m18:55:29.586841 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:55:29.589450 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583"
[0m18:55:29.590011 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583
[0m18:55:29.592010 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583"
[0m18:55:29.592411 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583"
[0m18:55:29.592598 [debug] [Thread-3 (]: SQL status: BEGIN in 0.006 seconds
[0m18:55:29.592810 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583: BEGIN
[0m18:55:29.593020 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_dim_users_user_id.e754bb5812"
[0m18:55:29.593205 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:55:29.593438 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_users_user_id.e754bb5812: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_users_user_id.e754bb5812"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."dim_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m18:55:29.594335 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:29.594529 [debug] [Thread-2 (]: SQL status: BEGIN in 0.008 seconds
[0m18:55:29.595236 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_users_user_id.e754bb5812: ROLLBACK
[0m18:55:29.595449 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b"
[0m18:55:29.595706 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."fact_user_events"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m18:55:29.595882 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_dim_users_user_id.e754bb5812: Close
[0m18:55:29.596210 [info ] [Thread-3 (]: 7 of 19 PASS not_null_dim_users_user_id ........................................ [[32mPASS[0m in 0.02s]
[0m18:55:29.596569 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_dim_users_user_id.e754bb5812
[0m18:55:29.596772 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:29.597030 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m18:55:29.597772 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b: ROLLBACK
[0m18:55:29.598440 [debug] [Thread-1 (]: Database Error in test not_null_dim_users_email (models/schema.yml)
  column "email" does not exist
  LINE 16: select email
                  ^
  compiled code at target/run/podcast_analytics/models/schema.yml/not_null_dim_users_email.sql
[0m18:55:29.598648 [info ] [Thread-3 (]: 10 of 19 START test not_null_stg_episodes_episode_id ........................... [RUN]
[0m18:55:29.598916 [error] [Thread-1 (]: 6 of 19 ERROR not_null_dim_users_email ......................................... [[31mERROR[0m in 0.04s]
[0m18:55:29.599123 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b: Close
[0m18:55:29.599288 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m18:55:29.599491 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_users_user_id.e754bb5812, now test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422)
[0m18:55:29.599727 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_dim_users_email.f41c7984c2
[0m18:55:29.600099 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583"
[0m18:55:29.599969 [info ] [Thread-2 (]: 8 of 19 PASS not_null_fact_user_events_episode_id .............................. [[32mPASS[0m in 0.02s]
[0m18:55:29.600318 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m18:55:29.600506 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m18:55:29.600709 [debug] [Thread-7 (]: Marking all children of 'test.podcast_analytics.not_null_dim_users_email.f41c7984c2' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_users_email (models/schema.yml)
  column "email" does not exist
  LINE 16: select email
                  ^
  compiled code at target/run/podcast_analytics/models/schema.yml/not_null_dim_users_email.sql.
[0m18:55:29.600904 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."fact_user_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m18:55:29.601160 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b
[0m18:55:29.630137 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m18:55:29.630371 [info ] [Thread-1 (]: 11 of 19 START test not_null_stg_user_events_event_id .......................... [RUN]
[0m18:55:29.630926 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m18:55:29.631236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_users_email.f41c7984c2, now test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7)
[0m18:55:29.631443 [info ] [Thread-2 (]: 12 of 19 START test not_null_stg_users_user_id ................................. [RUN]
[0m18:55:29.631725 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m18:55:29.631955 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m18:55:29.632141 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m18:55:29.633650 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m18:55:29.633847 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:55:29.634012 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m18:55:29.634923 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m18:55:29.635578 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583: ROLLBACK
[0m18:55:29.637667 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m18:55:29.637904 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m18:55:29.638889 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m18:55:29.639069 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583: Close
[0m18:55:29.639526 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m18:55:29.639717 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m18:55:29.639370 [info ] [Thread-4 (]: 9 of 19 PASS not_null_fact_user_events_user_id ................................. [[32mPASS[0m in 0.05s]
[0m18:55:29.639937 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m18:55:29.640109 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m18:55:29.641023 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m18:55:29.641247 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583
[0m18:55:29.641413 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:55:29.641569 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m18:55:29.641776 [debug] [Thread-4 (]: Began running node test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25
[0m18:55:29.642041 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m18:55:29.642205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:29.642397 [info ] [Thread-4 (]: 13 of 19 START test relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_  [RUN]
[0m18:55:29.642582 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m18:55:29.642818 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583, now test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25)
[0m18:55:29.642989 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:55:29.643166 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25
[0m18:55:29.646839 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25"
[0m18:55:29.647203 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25
[0m18:55:29.648178 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25"
[0m18:55:29.648480 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25"
[0m18:55:29.648654 [debug] [Thread-4 (]: On test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25: BEGIN
[0m18:55:29.648805 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:55:29.649038 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m18:55:29.649215 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m18:55:29.649398 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m18:55:29.649718 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m18:55:29.649886 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m18:55:29.650060 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m18:55:29.650224 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m18:55:29.650387 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m18:55:29.650561 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:29.650738 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m18:55:29.651453 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m18:55:29.651929 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m18:55:29.652175 [info ] [Thread-3 (]: 10 of 19 PASS not_null_stg_episodes_episode_id ................................. [[32mPASS[0m in 0.05s]
[0m18:55:29.652424 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m18:55:29.652598 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:29.652775 [debug] [Thread-3 (]: Began running node test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222
[0m18:55:29.653375 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m18:55:29.653577 [info ] [Thread-3 (]: 14 of 19 START test relationships_fact_user_events_user_id__user_id__ref_dim_users_  [RUN]
[0m18:55:29.653800 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222)
[0m18:55:29.653979 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222
[0m18:55:29.654203 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m18:55:29.656384 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222"
[0m18:55:29.656595 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m18:55:29.657042 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25"
[0m18:55:29.657402 [debug] [Thread-4 (]: On test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select episode_id as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where episode_id is not null
),

parent as (
    select episode_id as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:55:29.656888 [info ] [Thread-2 (]: 12 of 19 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.02s]
[0m18:55:29.657786 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m18:55:29.657964 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222
[0m18:55:29.658156 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f
[0m18:55:29.660124 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222"
[0m18:55:29.660305 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:55:29.660493 [info ] [Thread-2 (]: 15 of 19 START test unique_dim_episodes_episode_id ............................. [RUN]
[0m18:55:29.661174 [debug] [Thread-4 (]: On test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25: ROLLBACK
[0m18:55:29.661379 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77, now test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f)
[0m18:55:29.661592 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222"
[0m18:55:29.661775 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f
[0m18:55:29.661932 [debug] [Thread-4 (]: On test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25: Close
[0m18:55:29.662108 [debug] [Thread-3 (]: On test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222: BEGIN
[0m18:55:29.664711 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f"
[0m18:55:29.664880 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.014 seconds
[0m18:55:29.665269 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:55:29.665142 [info ] [Thread-4 (]: 13 of 19 PASS relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_  [[32mPASS[0m in 0.02s]
[0m18:55:29.666282 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m18:55:29.666618 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25
[0m18:55:29.666795 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f
[0m18:55:29.667038 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9
[0m18:55:29.667223 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m18:55:29.668346 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f"
[0m18:55:29.668537 [info ] [Thread-4 (]: 16 of 19 START test unique_dim_users_user_id ................................... [RUN]
[0m18:55:29.668817 [info ] [Thread-1 (]: 11 of 19 PASS not_null_stg_user_events_event_id ................................ [[32mPASS[0m in 0.04s]
[0m18:55:29.669109 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25, now test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9)
[0m18:55:29.669361 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m18:55:29.669530 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9
[0m18:55:29.669712 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f"
[0m18:55:29.669893 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m18:55:29.671879 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9"
[0m18:55:29.672139 [debug] [Thread-2 (]: On test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f: BEGIN
[0m18:55:29.672356 [info ] [Thread-1 (]: 17 of 19 START test unique_stg_episodes_episode_id ............................. [RUN]
[0m18:55:29.672645 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:55:29.672830 [debug] [Thread-3 (]: SQL status: BEGIN in 0.008 seconds
[0m18:55:29.673063 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m18:55:29.673323 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9
[0m18:55:29.673517 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222"
[0m18:55:29.673689 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m18:55:29.675159 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9"
[0m18:55:29.675403 [debug] [Thread-3 (]: On test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:55:29.677010 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m18:55:29.677527 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9"
[0m18:55:29.677704 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9: BEGIN
[0m18:55:29.677890 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m18:55:29.678070 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:55:29.679082 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m18:55:29.679278 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m18:55:29.679483 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:55:29.679681 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f"
[0m18:55:29.680510 [debug] [Thread-3 (]: On test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222: ROLLBACK
[0m18:55:29.680723 [debug] [Thread-2 (]: On test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:55:29.680933 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m18:55:29.681150 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: BEGIN
[0m18:55:29.681339 [debug] [Thread-3 (]: On test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222: Close
[0m18:55:29.681507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:29.681694 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:29.681969 [info ] [Thread-3 (]: 14 of 19 PASS relationships_fact_user_events_user_id__user_id__ref_dim_users_ .. [[32mPASS[0m in 0.03s]
[0m18:55:29.682678 [debug] [Thread-2 (]: On test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f: ROLLBACK
[0m18:55:29.682952 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222
[0m18:55:29.683173 [debug] [Thread-3 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m18:55:29.683470 [debug] [Thread-2 (]: On test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f: Close
[0m18:55:29.683347 [info ] [Thread-3 (]: 18 of 19 START test unique_stg_user_events_event_id ............................ [RUN]
[0m18:55:29.683794 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m18:55:29.684017 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m18:55:29.684303 [info ] [Thread-2 (]: 15 of 19 PASS unique_dim_episodes_episode_id ................................... [[32mPASS[0m in 0.02s]
[0m18:55:29.684489 [debug] [Thread-4 (]: SQL status: BEGIN in 0.006 seconds
[0m18:55:29.686244 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m18:55:29.686520 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f
[0m18:55:29.686706 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9"
[0m18:55:29.686877 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m18:55:29.687133 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m18:55:29.687327 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:55:29.687578 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m18:55:29.687977 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m18:55:29.688752 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:55:29.687776 [info ] [Thread-2 (]: 19 of 19 START test unique_stg_users_user_id ................................... [RUN]
[0m18:55:29.690112 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m18:55:29.690306 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:55:29.690546 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m18:55:29.691242 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9: ROLLBACK
[0m18:55:29.691439 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:29.691600 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m18:55:29.692237 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: ROLLBACK
[0m18:55:29.692455 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m18:55:29.692615 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9: Close
[0m18:55:29.694291 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m18:55:29.694510 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: BEGIN
[0m18:55:29.694930 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: Close
[0m18:55:29.694785 [info ] [Thread-4 (]: 16 of 19 PASS unique_dim_users_user_id ......................................... [[32mPASS[0m in 0.03s]
[0m18:55:29.695159 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:55:29.695433 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9
[0m18:55:29.695822 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m18:55:29.695665 [info ] [Thread-1 (]: 17 of 19 PASS unique_stg_episodes_episode_id ................................... [[32mPASS[0m in 0.02s]
[0m18:55:29.698039 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m18:55:29.698343 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m18:55:29.698715 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m18:55:29.698900 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m18:55:29.699069 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:55:29.700625 [debug] [Thread-3 (]: SQL status: BEGIN in 0.005 seconds
[0m18:55:29.700820 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m18:55:29.701001 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_user_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:55:29.704235 [debug] [Thread-2 (]: SQL status: BEGIN in 0.005 seconds
[0m18:55:29.704482 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m18:55:29.704684 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:55:29.705663 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:29.706451 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m18:55:29.706838 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m18:55:29.707131 [info ] [Thread-2 (]: 19 of 19 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.02s]
[0m18:55:29.707384 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m18:55:29.718842 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.018 seconds
[0m18:55:29.719497 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: ROLLBACK
[0m18:55:29.719957 [debug] [Thread-3 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: Close
[0m18:55:29.720298 [info ] [Thread-3 (]: 18 of 19 PASS unique_stg_user_events_event_id .................................. [[32mPASS[0m in 0.04s]
[0m18:55:29.720720 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m18:55:29.721556 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:29.721727 [debug] [MainThread]: On master: BEGIN
[0m18:55:29.721872 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:29.726811 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:55:29.727011 [debug] [MainThread]: On master: COMMIT
[0m18:55:29.727154 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:29.727282 [debug] [MainThread]: On master: COMMIT
[0m18:55:29.727600 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:55:29.727734 [debug] [MainThread]: On master: Close
[0m18:55:29.727938 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:29.728074 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16' was properly closed.
[0m18:55:29.728194 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m18:55:29.728323 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m18:55:29.728448 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9' was properly closed.
[0m18:55:29.728614 [info ] [MainThread]: 
[0m18:55:29.728779 [info ] [MainThread]: Finished running 19 data tests in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m18:55:29.729775 [debug] [MainThread]: Command end result
[0m18:55:29.741659 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:55:29.742562 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:55:29.745463 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m18:55:29.745632 [info ] [MainThread]: 
[0m18:55:29.745802 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:55:29.745947 [info ] [MainThread]: 
[0m18:55:29.746117 [error] [MainThread]: [31mFailure in test not_null_dim_users_email (models/schema.yml)[0m
[0m18:55:29.746284 [error] [MainThread]:   Database Error in test not_null_dim_users_email (models/schema.yml)
  column "email" does not exist
  LINE 16: select email
                  ^
  compiled code at target/run/podcast_analytics/models/schema.yml/not_null_dim_users_email.sql
[0m18:55:29.746419 [info ] [MainThread]: 
[0m18:55:29.746573 [info ] [MainThread]:   compiled code at target/compiled/podcast_analytics/models/schema.yml/not_null_dim_users_email.sql
[0m18:55:29.746715 [info ] [MainThread]: 
[0m18:55:29.746868 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=19
[0m18:55:29.748212 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 0.58332837, "process_in_blocks": "0", "process_kernel_time": 0.113114, "process_mem_max_rss": "134070272", "process_out_blocks": "0", "process_user_time": 1.010453}
[0m18:55:29.748419 [debug] [MainThread]: Command `dbt test` failed at 18:55:29.748386 after 0.58 seconds
[0m18:55:29.748603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d401970>]}
[0m18:55:29.748774 [debug] [MainThread]: Flushing usage events
[0m18:55:30.111347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:48.542731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a8f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f5670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f5280>]}


============================== 18:55:48.545716 | 3f49ee8c-c6ec-4e96-8943-af998876eee5 ==============================
[0m18:55:48.545716 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:55:48.546074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/samydoreau/global-assignment', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt deps --profiles-dir /Users/samydoreau/global-assignment', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:55:48.594747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f49ee8c-c6ec-4e96-8943-af998876eee5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10350b260>]}
[0m18:55:48.618040 [debug] [MainThread]: Set downloads directory='/var/folders/5k/t5t262f5239fl9vz4lyvw8l00000gn/T/dbt-downloads-7t6uzu6x'
[0m18:55:48.618292 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:55:48.647699 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:55:48.648204 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:55:48.667314 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:55:48.669008 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:55:48.830706 [info ] [MainThread]: Installed from version 1.3.0
[0m18:55:48.831032 [info ] [MainThread]: Up to date!
[0m18:55:48.831249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '3f49ee8c-c6ec-4e96-8943-af998876eee5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d11190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104def8c0>]}
[0m18:55:48.833484 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.32380614, "process_in_blocks": "0", "process_kernel_time": 0.119189, "process_mem_max_rss": "111837184", "process_out_blocks": "0", "process_user_time": 0.593766}
[0m18:55:48.833768 [debug] [MainThread]: Command `dbt deps` succeeded at 18:55:48.833722 after 0.32 seconds
[0m18:55:48.833966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081f5550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a8f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108356ae0>]}
[0m18:55:48.834123 [debug] [MainThread]: Flushing usage events
[0m18:55:49.170342 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:49.881524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645af60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb9490>]}


============================== 18:55:49.883214 | 6455c0de-fe0a-42a7-976b-472d427c88b8 ==============================
[0m18:55:49.883214 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:55:49.883507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/samydoreau/global-assignment', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed --profiles-dir /Users/samydoreau/global-assignment', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:55:49.950995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6455c0de-fe0a-42a7-976b-472d427c88b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ab290>]}
[0m18:55:49.972672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6455c0de-fe0a-42a7-976b-472d427c88b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eea5a0>]}
[0m18:55:49.973830 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:55:50.016705 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m18:55:50.070442 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:50.070649 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:50.090791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6455c0de-fe0a-42a7-976b-472d427c88b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093e6690>]}
[0m18:55:50.127003 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:55:50.128095 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:55:50.135383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6455c0de-fe0a-42a7-976b-472d427c88b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cca090>]}
[0m18:55:50.135599 [info ] [MainThread]: Found 10 models, 2 seeds, 18 data tests, 3 sources, 549 macros
[0m18:55:50.135774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6455c0de-fe0a-42a7-976b-472d427c88b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cb0b00>]}
[0m18:55:50.136620 [info ] [MainThread]: 
[0m18:55:50.136798 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:55:50.136940 [info ] [MainThread]: 
[0m18:55:50.137162 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:55:50.138501 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m18:55:50.161119 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m18:55:50.161337 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:55:50.161475 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:50.181652 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.020 seconds
[0m18:55:50.182293 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m18:55:50.183025 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m18:55:50.185334 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:55:50.185489 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m18:55:50.185615 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:50.191546 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m18:55:50.191679 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:55:50.191819 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:55:50.194466 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.002 seconds
[0m18:55:50.194976 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m18:55:50.195404 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m18:55:50.197623 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:50.197760 [debug] [MainThread]: On master: BEGIN
[0m18:55:50.197879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:50.203895 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:55:50.204033 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:50.204214 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:55:50.209830 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m18:55:50.210786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6455c0de-fe0a-42a7-976b-472d427c88b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ebb2f0>]}
[0m18:55:50.210995 [debug] [MainThread]: On master: ROLLBACK
[0m18:55:50.211397 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:50.211536 [debug] [MainThread]: On master: BEGIN
[0m18:55:50.212226 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:55:50.212364 [debug] [MainThread]: On master: COMMIT
[0m18:55:50.212494 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:50.212624 [debug] [MainThread]: On master: COMMIT
[0m18:55:50.213028 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:55:50.213166 [debug] [MainThread]: On master: Close
[0m18:55:50.214971 [debug] [Thread-1 (]: Began running node seed.podcast_analytics.raw_episodes
[0m18:55:50.215202 [debug] [Thread-2 (]: Began running node seed.podcast_analytics.raw_users
[0m18:55:50.215495 [info ] [Thread-1 (]: 1 of 2 START seed file public.raw_episodes ..................................... [RUN]
[0m18:55:50.215747 [info ] [Thread-2 (]: 2 of 2 START seed file public.raw_users ........................................ [RUN]
[0m18:55:50.215954 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now seed.podcast_analytics.raw_episodes)
[0m18:55:50.216149 [debug] [Thread-2 (]: Acquiring new postgres connection 'seed.podcast_analytics.raw_users'
[0m18:55:50.216305 [debug] [Thread-1 (]: Began compiling node seed.podcast_analytics.raw_episodes
[0m18:55:50.216450 [debug] [Thread-2 (]: Began compiling node seed.podcast_analytics.raw_users
[0m18:55:50.216602 [debug] [Thread-1 (]: Began executing node seed.podcast_analytics.raw_episodes
[0m18:55:50.216749 [debug] [Thread-2 (]: Began executing node seed.podcast_analytics.raw_users
[0m18:55:50.229404 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m18:55:50.230534 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: BEGIN
[0m18:55:50.231979 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m18:55:50.232164 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:50.232326 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: BEGIN
[0m18:55:50.232539 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:55:50.241410 [debug] [Thread-2 (]: SQL status: BEGIN in 0.009 seconds
[0m18:55:50.241593 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m18:55:50.241771 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m18:55:50.241926 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m18:55:50.242086 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_users"} */
truncate table "podcast_analytics"."public"."raw_users"
[0m18:55:50.242245 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "seed.podcast_analytics.raw_episodes"} */
truncate table "podcast_analytics"."public"."raw_episodes"
[0m18:55:50.245291 [debug] [Thread-2 (]: SQL status: TRUNCATE TABLE in 0.003 seconds
[0m18:55:50.252631 [debug] [Thread-1 (]: SQL status: TRUNCATE TABLE in 0.010 seconds
[0m18:55:50.309436 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m18:55:50.314034 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m18:55:50.314239 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: 
          insert into "podcast_analytics"."public"."raw_users" ("user_id", "signup_date", "country") values
          (%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%s),(%s,%s,%...
[0m18:55:50.314427 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: 
          insert into "podcast_analytics"."public"."raw_episodes" ("episode_id", "podcast_id", "title", "release_date", "duration_seconds") values
          (%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%s),(%s,%s,%s,%s,%...
[0m18:55:50.317008 [debug] [Thread-1 (]: SQL status: INSERT 0 50 in 0.002 seconds
[0m18:55:50.317179 [debug] [Thread-2 (]: SQL status: INSERT 0 100 in 0.003 seconds
[0m18:55:50.319234 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_episodes"
[0m18:55:50.319524 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.podcast_analytics.raw_users"
[0m18:55:50.325102 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m18:55:50.325715 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m18:55:50.325889 [debug] [Thread-2 (]: Using postgres connection "seed.podcast_analytics.raw_users"
[0m18:55:50.326071 [debug] [Thread-1 (]: Using postgres connection "seed.podcast_analytics.raw_episodes"
[0m18:55:50.326249 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: COMMIT
[0m18:55:50.326399 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: COMMIT
[0m18:55:50.328833 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m18:55:50.329498 [debug] [Thread-2 (]: On seed.podcast_analytics.raw_users: Close
[0m18:55:50.329673 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m18:55:50.330164 [debug] [Thread-1 (]: On seed.podcast_analytics.raw_episodes: Close
[0m18:55:50.330749 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6455c0de-fe0a-42a7-976b-472d427c88b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b50aa0>]}
[0m18:55:50.330901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6455c0de-fe0a-42a7-976b-472d427c88b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10818cb00>]}
[0m18:55:50.331125 [info ] [Thread-2 (]: 2 of 2 OK loaded seed file public.raw_users .................................... [[32mINSERT 100[0m in 0.11s]
[0m18:55:50.331396 [info ] [Thread-1 (]: 1 of 2 OK loaded seed file public.raw_episodes ................................. [[32mINSERT 50[0m in 0.11s]
[0m18:55:50.331669 [debug] [Thread-2 (]: Finished running node seed.podcast_analytics.raw_users
[0m18:55:50.331900 [debug] [Thread-1 (]: Finished running node seed.podcast_analytics.raw_episodes
[0m18:55:50.332463 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:50.332629 [debug] [MainThread]: On master: BEGIN
[0m18:55:50.332758 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:50.339212 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:55:50.339449 [debug] [MainThread]: On master: COMMIT
[0m18:55:50.339599 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:50.339726 [debug] [MainThread]: On master: COMMIT
[0m18:55:50.340159 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:55:50.340288 [debug] [MainThread]: On master: Close
[0m18:55:50.340476 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:50.340598 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_episodes' was properly closed.
[0m18:55:50.340713 [debug] [MainThread]: Connection 'seed.podcast_analytics.raw_users' was properly closed.
[0m18:55:50.340862 [info ] [MainThread]: 
[0m18:55:50.341020 [info ] [MainThread]: Finished running 2 seeds in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m18:55:50.341351 [debug] [MainThread]: Command end result
[0m18:55:50.352363 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:55:50.353126 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:55:50.355849 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m18:55:50.356059 [info ] [MainThread]: 
[0m18:55:50.356252 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:50.356397 [info ] [MainThread]: 
[0m18:55:50.356557 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m18:55:50.357880 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 0.50246435, "process_in_blocks": "0", "process_kernel_time": 0.108519, "process_mem_max_rss": "130056192", "process_out_blocks": "0", "process_user_time": 0.885798}
[0m18:55:50.358110 [debug] [MainThread]: Command `dbt seed` succeeded at 18:55:50.358077 after 0.50 seconds
[0m18:55:50.358280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b09ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10467f140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109cee660>]}
[0m18:55:50.358440 [debug] [MainThread]: Flushing usage events
[0m18:55:50.700725 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:51.397884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ab590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f5850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f5460>]}


============================== 18:55:51.399574 | 306b6219-592d-4d20-8fb9-1b38ac65a135 ==============================
[0m18:55:51.399574 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:55:51.399873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/samydoreau/global-assignment', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run --profiles-dir /Users/samydoreau/global-assignment', 'send_anonymous_usage_stats': 'True'}
[0m18:55:51.464280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '306b6219-592d-4d20-8fb9-1b38ac65a135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10748ae70>]}
[0m18:55:51.485403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '306b6219-592d-4d20-8fb9-1b38ac65a135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cb9400>]}
[0m18:55:51.485771 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:55:51.526194 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m18:55:51.578837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:51.579072 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:51.599472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '306b6219-592d-4d20-8fb9-1b38ac65a135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082ad130>]}
[0m18:55:51.635971 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:55:51.636841 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:55:51.642409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '306b6219-592d-4d20-8fb9-1b38ac65a135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b27e90>]}
[0m18:55:51.642657 [info ] [MainThread]: Found 10 models, 2 seeds, 18 data tests, 3 sources, 549 macros
[0m18:55:51.642841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '306b6219-592d-4d20-8fb9-1b38ac65a135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ac5010>]}
[0m18:55:51.643763 [info ] [MainThread]: 
[0m18:55:51.643948 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:55:51.644094 [info ] [MainThread]: 
[0m18:55:51.644323 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:55:51.645953 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics'
[0m18:55:51.662827 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics"
[0m18:55:51.663057 [debug] [ThreadPool]: On list_podcast_analytics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics"} */

    select distinct nspname from pg_namespace
  
[0m18:55:51.663206 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:51.680432 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.017 seconds
[0m18:55:51.681036 [debug] [ThreadPool]: On list_podcast_analytics: Close
[0m18:55:51.681779 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_podcast_analytics, now list_podcast_analytics_public)
[0m18:55:51.684126 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:55:51.684279 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m18:55:51.684402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:51.690675 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m18:55:51.690820 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:55:51.690970 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:55:51.693758 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.003 seconds
[0m18:55:51.694291 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m18:55:51.694765 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m18:55:51.697012 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:51.697152 [debug] [MainThread]: On master: BEGIN
[0m18:55:51.697270 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:51.703285 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:55:51.703429 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:51.703607 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:55:51.709450 [debug] [MainThread]: SQL status: SELECT 5 in 0.006 seconds
[0m18:55:51.710239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '306b6219-592d-4d20-8fb9-1b38ac65a135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10893d6a0>]}
[0m18:55:51.710436 [debug] [MainThread]: On master: ROLLBACK
[0m18:55:51.710898 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:51.711028 [debug] [MainThread]: On master: BEGIN
[0m18:55:51.711675 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:55:51.711805 [debug] [MainThread]: On master: COMMIT
[0m18:55:51.711930 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:51.712053 [debug] [MainThread]: On master: COMMIT
[0m18:55:51.712465 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:55:51.712596 [debug] [MainThread]: On master: Close
[0m18:55:51.713528 [debug] [Thread-1 (]: Began running node model.podcast_analytics.stg_episodes
[0m18:55:51.713727 [debug] [Thread-2 (]: Began running node model.podcast_analytics.stg_user_events
[0m18:55:51.713936 [debug] [Thread-3 (]: Began running node model.podcast_analytics.stg_user_events_invalid
[0m18:55:51.714279 [debug] [Thread-4 (]: Began running node model.podcast_analytics.stg_users
[0m18:55:51.714142 [info ] [Thread-1 (]: 1 of 10 START sql view model public.stg_episodes ............................... [RUN]
[0m18:55:51.714567 [info ] [Thread-2 (]: 2 of 10 START sql view model public.stg_user_events ............................ [RUN]
[0m18:55:51.714806 [info ] [Thread-3 (]: 3 of 10 START sql view model public.stg_user_events_invalid .................... [RUN]
[0m18:55:51.715020 [info ] [Thread-4 (]: 4 of 10 START sql view model public.stg_users .................................. [RUN]
[0m18:55:51.715226 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now model.podcast_analytics.stg_episodes)
[0m18:55:51.715434 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events'
[0m18:55:51.715624 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_user_events_invalid'
[0m18:55:51.715814 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.podcast_analytics.stg_users'
[0m18:55:51.715976 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.stg_episodes
[0m18:55:51.716131 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.stg_user_events
[0m18:55:51.716288 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.stg_user_events_invalid
[0m18:55:51.716439 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.stg_users
[0m18:55:51.719452 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.stg_episodes"
[0m18:55:51.727690 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events"
[0m18:55:51.728835 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.stg_user_events_invalid"
[0m18:55:51.729732 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.stg_users"
[0m18:55:51.730180 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.stg_user_events
[0m18:55:51.730360 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.stg_episodes
[0m18:55:51.730543 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.stg_user_events_invalid
[0m18:55:51.742599 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.stg_users
[0m18:55:51.743784 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events"
[0m18:55:51.745239 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.stg_episodes"
[0m18:55:51.746536 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.stg_user_events_invalid"
[0m18:55:51.747769 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.stg_users"
[0m18:55:51.748152 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:55:51.748401 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:55:51.748625 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:55:51.748841 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:55:51.749007 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: BEGIN
[0m18:55:51.749181 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: BEGIN
[0m18:55:51.749364 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: BEGIN
[0m18:55:51.749540 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: BEGIN
[0m18:55:51.749700 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:55:51.749862 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:51.750024 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:55:51.750182 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:55:51.760639 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m18:55:51.760816 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m18:55:51.760996 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m18:55:51.761164 [debug] [Thread-4 (]: SQL status: BEGIN in 0.011 seconds
[0m18:55:51.761322 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:55:51.761482 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:55:51.761632 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:55:51.761781 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:55:51.761967 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */

  create view "podcast_analytics"."public"."stg_user_events__dbt_tmp"
    
    
  as (
    -- stg_user_events.sql : typed raw event records from JSONB
-- Note: Invalid events are captured in stg_user_events_invalid.sql for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

valid_events as (
    select * from source
    where data ->> 'event_type' is not null
      and data ->> 'event_type' in ('play', 'pause', 'seek', 'complete')
      and data ->> 'timestamp' is not null
      and data ->> 'timestamp' != ''
      and data ->> 'user_id' is not null
      and data ->> 'episode_id' is not null
),

typed as (
    select
        md5(cast(coalesce(cast(data ->> 'user_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'episode_id' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'timestamp' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(data ->> 'event_type' as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as event_id,
        data ->> 'user_id'      as user_id,
        data ->> 'episode_id'   as episode_id,
        case 
            when (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}' then (data ->> 'timestamp')::timestamp
            else null
        end as event_ts,
        data ->> 'event_type'         as event_type,
        (data ->> 'duration')::integer as duration
    from valid_events
    where (data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}'
)
select * from typed
  );
[0m18:55:51.762170 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */

  create view "podcast_analytics"."public"."stg_episodes__dbt_tmp"
    
    
  as (
    -- stg_episodes.sql : clean episode reference data
with source as (
    select * from "podcast_analytics"."public"."raw_episodes"
)
select
    cast(episode_id as text) as episode_id,
    cast(podcast_id as text) as podcast_id,
    title,
    cast(release_date as date) as release_date,
    cast(duration_seconds as integer) as duration_seconds
from source
  );
[0m18:55:51.762368 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */

  create view "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp"
    
    
  as (
    -- stg_user_events_invalid.sql : capture invalid event records for investigation
with source as (
    select data
    from "podcast_analytics"."public"."raw_event_files"
),

invalid_events as (
    select 
        data,
        data ->> 'user_id' as user_id,
        data ->> 'episode_id' as episode_id,
        data ->> 'timestamp' as timestamp,
        data ->> 'event_type' as event_type,
        data ->> 'duration' as duration,
        case 
            when data ->> 'event_type' is null then 'missing_event_type'
            when data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete') then 'invalid_event_type'
            when data ->> 'timestamp' is null or data ->> 'timestamp' = '' then 'missing_timestamp'
            when not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}') then 'malformed_timestamp'
            when data ->> 'user_id' is null then 'missing_user_id'
            when data ->> 'episode_id' is null then 'missing_episode_id'
            else 'other_issue'
        end as issue_type
    from source
    where data ->> 'event_type' is null 
       or data ->> 'event_type' not in ('play', 'pause', 'seek', 'complete')
       or data ->> 'timestamp' is null 
       or data ->> 'timestamp' = ''
       or not ((data ->> 'timestamp') ~ '^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}')
       or data ->> 'user_id' is null
       or data ->> 'episode_id' is null
)

select * from invalid_events
  );
[0m18:55:51.762560 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */

  create view "podcast_analytics"."public"."stg_users__dbt_tmp"
    
    
  as (
    -- stg_users.sql : clean user reference data
with source as (
    select * from "podcast_analytics"."public"."raw_users"
)
select
    cast(user_id as text) as user_id,
    cast(signup_date as date) as signup_date,
    country
from source
  );
[0m18:55:51.765099 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m18:55:51.767459 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:55:51.767632 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:55:51.767779 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:55:51.767932 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users" rename to "stg_users__dbt_backup"
[0m18:55:51.768068 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:55:51.769686 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:55:51.770816 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:55:51.771922 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:55:51.772088 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:51.772243 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid" rename to "stg_user_events_invalid__dbt_backup"
[0m18:55:51.772402 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events" rename to "stg_user_events__dbt_backup"
[0m18:55:51.772560 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes" rename to "stg_episodes__dbt_backup"
[0m18:55:51.773543 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:55:51.773759 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
alter table "podcast_analytics"."public"."stg_users__dbt_tmp" rename to "stg_users"
[0m18:55:51.774325 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:51.774500 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:51.774644 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:51.774801 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:51.775885 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:55:51.776885 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:55:51.782974 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m18:55:51.784046 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:55:51.784229 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
alter table "podcast_analytics"."public"."stg_user_events_invalid__dbt_tmp" rename to "stg_user_events_invalid"
[0m18:55:51.784410 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
alter table "podcast_analytics"."public"."stg_user_events__dbt_tmp" rename to "stg_user_events"
[0m18:55:51.784577 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:55:51.784744 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
alter table "podcast_analytics"."public"."stg_episodes__dbt_tmp" rename to "stg_episodes"
[0m18:55:51.784953 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: COMMIT
[0m18:55:51.786122 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:51.786281 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:51.786448 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m18:55:51.787118 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m18:55:51.787285 [debug] [Thread-4 (]: SQL status: COMMIT in 0.002 seconds
[0m18:55:51.787953 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m18:55:51.788552 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m18:55:51.788712 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:55:51.790915 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."stg_users__dbt_backup"
[0m18:55:51.791093 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:55:51.791257 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:55:51.791418 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: COMMIT
[0m18:55:51.793248 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.stg_users"
[0m18:55:51.793430 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: COMMIT
[0m18:55:51.793588 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: COMMIT
[0m18:55:51.793774 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_users"} */
drop view if exists "podcast_analytics"."public"."stg_users__dbt_backup" cascade
[0m18:55:51.795018 [debug] [Thread-3 (]: SQL status: COMMIT in 0.001 seconds
[0m18:55:51.795852 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup"
[0m18:55:51.796020 [debug] [Thread-2 (]: SQL status: COMMIT in 0.002 seconds
[0m18:55:51.796178 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:55:51.796314 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:55:51.796668 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.stg_user_events_invalid"
[0m18:55:51.798037 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."stg_user_events__dbt_backup"
[0m18:55:51.820238 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."stg_episodes__dbt_backup"
[0m18:55:51.821222 [debug] [Thread-4 (]: On model.podcast_analytics.stg_users: Close
[0m18:55:51.821412 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events_invalid"} */
drop view if exists "podcast_analytics"."public"."stg_user_events_invalid__dbt_backup" cascade
[0m18:55:51.821769 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.stg_user_events"
[0m18:55:51.822094 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.stg_episodes"
[0m18:55:51.822800 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_user_events"} */
drop view if exists "podcast_analytics"."public"."stg_user_events__dbt_backup" cascade
[0m18:55:51.822992 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.stg_episodes"} */
drop view if exists "podcast_analytics"."public"."stg_episodes__dbt_backup" cascade
[0m18:55:51.823190 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306b6219-592d-4d20-8fb9-1b38ac65a135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056d0bf0>]}
[0m18:55:51.823479 [info ] [Thread-4 (]: 4 of 10 OK created sql view model public.stg_users ............................. [[32mCREATE VIEW[0m in 0.11s]
[0m18:55:51.823746 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.stg_users
[0m18:55:51.823973 [debug] [Thread-4 (]: Began running node model.podcast_analytics.dim_users
[0m18:55:51.824160 [info ] [Thread-4 (]: 5 of 10 START sql table model public.dim_users ................................. [RUN]
[0m18:55:51.824360 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_users, now model.podcast_analytics.dim_users)
[0m18:55:51.824508 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.dim_users
[0m18:55:51.825485 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.dim_users"
[0m18:55:51.825654 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.003 seconds
[0m18:55:51.826184 [debug] [Thread-3 (]: On model.podcast_analytics.stg_user_events_invalid: Close
[0m18:55:51.826345 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m18:55:51.826546 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m18:55:51.826786 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306b6219-592d-4d20-8fb9-1b38ac65a135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb70e0>]}
[0m18:55:51.827252 [debug] [Thread-1 (]: On model.podcast_analytics.stg_episodes: Close
[0m18:55:51.827435 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.dim_users
[0m18:55:51.827960 [debug] [Thread-2 (]: On model.podcast_analytics.stg_user_events: Close
[0m18:55:51.828226 [info ] [Thread-3 (]: 3 of 10 OK created sql view model public.stg_user_events_invalid ............... [[32mCREATE VIEW[0m in 0.11s]
[0m18:55:51.828622 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306b6219-592d-4d20-8fb9-1b38ac65a135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb70b0>]}
[0m18:55:51.837508 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.dim_users"
[0m18:55:51.837877 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.stg_user_events_invalid
[0m18:55:51.838167 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306b6219-592d-4d20-8fb9-1b38ac65a135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109931790>]}
[0m18:55:51.838466 [info ] [Thread-1 (]: 1 of 10 OK created sql view model public.stg_episodes .......................... [[32mCREATE VIEW[0m in 0.11s]
[0m18:55:51.838900 [info ] [Thread-2 (]: 2 of 10 OK created sql view model public.stg_user_events ....................... [[32mCREATE VIEW[0m in 0.12s]
[0m18:55:51.839171 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.stg_episodes
[0m18:55:51.839410 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.stg_user_events
[0m18:55:51.839614 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:55:51.839853 [debug] [Thread-3 (]: Began running node model.podcast_analytics.dim_episodes
[0m18:55:51.840104 [debug] [Thread-1 (]: Began running node model.podcast_analytics.fact_user_events
[0m18:55:51.840254 [debug] [Thread-4 (]: On model.podcast_analytics.dim_users: BEGIN
[0m18:55:51.840394 [debug] [Thread-2 (]: Began running node model.podcast_analytics.int_user_sessions
[0m18:55:51.840573 [info ] [Thread-3 (]: 6 of 10 START sql table model public.dim_episodes .............................. [RUN]
[0m18:55:51.840776 [info ] [Thread-1 (]: 7 of 10 START sql table model public.fact_user_events .......................... [RUN]
[0m18:55:51.840945 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:55:51.841117 [info ] [Thread-2 (]: 8 of 10 START sql view model public.int_user_sessions .......................... [RUN]
[0m18:55:51.841303 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events_invalid, now model.podcast_analytics.dim_episodes)
[0m18:55:51.841456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_episodes, now model.podcast_analytics.fact_user_events)
[0m18:55:51.841680 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.stg_user_events, now model.podcast_analytics.int_user_sessions)
[0m18:55:51.841847 [debug] [Thread-3 (]: Began compiling node model.podcast_analytics.dim_episodes
[0m18:55:51.841998 [debug] [Thread-1 (]: Began compiling node model.podcast_analytics.fact_user_events
[0m18:55:51.842159 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.int_user_sessions
[0m18:55:51.843301 [debug] [Thread-3 (]: Writing injected SQL for node "model.podcast_analytics.dim_episodes"
[0m18:55:51.844522 [debug] [Thread-1 (]: Writing injected SQL for node "model.podcast_analytics.fact_user_events"
[0m18:55:51.846216 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.int_user_sessions"
[0m18:55:51.846576 [debug] [Thread-1 (]: Began executing node model.podcast_analytics.fact_user_events
[0m18:55:51.846748 [debug] [Thread-3 (]: Began executing node model.podcast_analytics.dim_episodes
[0m18:55:51.846913 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.int_user_sessions
[0m18:55:51.848342 [debug] [Thread-1 (]: Writing runtime sql for node "model.podcast_analytics.fact_user_events"
[0m18:55:51.849710 [debug] [Thread-3 (]: Writing runtime sql for node "model.podcast_analytics.dim_episodes"
[0m18:55:51.849886 [debug] [Thread-4 (]: SQL status: BEGIN in 0.009 seconds
[0m18:55:51.851222 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.int_user_sessions"
[0m18:55:51.851474 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:55:51.851700 [debug] [Thread-4 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */

  
    

  create  table "podcast_analytics"."public"."dim_users__dbt_tmp"
  
  
    as
  
  (
    -- dim_users.sql : dimension table for users (one row per user)
select * from "podcast_analytics"."public"."stg_users"
  );
  
[0m18:55:51.851886 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m18:55:51.852120 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:55:51.852305 [debug] [Thread-1 (]: On model.podcast_analytics.fact_user_events: BEGIN
[0m18:55:51.853166 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:55:51.853354 [debug] [Thread-3 (]: On model.podcast_analytics.dim_episodes: BEGIN
[0m18:55:51.853525 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:51.853691 [debug] [Thread-2 (]: On model.podcast_analytics.int_user_sessions: BEGIN
[0m18:55:51.853872 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:55:51.854119 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:55:51.857301 [debug] [Thread-4 (]: SQL status: SELECT 100 in 0.005 seconds
[0m18:55:51.860168 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:55:51.860342 [debug] [Thread-4 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */
alter table "podcast_analytics"."public"."dim_users" rename to "dim_users__dbt_backup"
[0m18:55:51.861210 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:51.862209 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:55:51.862363 [debug] [Thread-4 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */
alter table "podcast_analytics"."public"."dim_users__dbt_tmp" rename to "dim_users"
[0m18:55:51.863301 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:51.863972 [debug] [Thread-4 (]: On model.podcast_analytics.dim_users: COMMIT
[0m18:55:51.864150 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m18:55:51.864329 [debug] [Thread-3 (]: SQL status: BEGIN in 0.010 seconds
[0m18:55:51.864490 [debug] [Thread-2 (]: SQL status: BEGIN in 0.010 seconds
[0m18:55:51.864647 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:55:51.864815 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m18:55:51.864981 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:55:51.865142 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:55:51.865303 [debug] [Thread-4 (]: On model.podcast_analytics.dim_users: COMMIT
[0m18:55:51.865478 [debug] [Thread-1 (]: On model.podcast_analytics.fact_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.fact_user_events"} */

  
    

  create  table "podcast_analytics"."public"."fact_user_events__dbt_tmp"
  
  
    as
  
  (
    
-- fact_user_events.sql : central fact table of cleaned user events
select * from "podcast_analytics"."public"."stg_user_events"
  );
  
[0m18:55:51.865659 [debug] [Thread-3 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */

  
    

  create  table "podcast_analytics"."public"."dim_episodes__dbt_tmp"
  
  
    as
  
  (
    -- dim_episodes.sql : dimension table for episodes (one row per episode)
select * from "podcast_analytics"."public"."stg_episodes"
  );
  
[0m18:55:51.865888 [debug] [Thread-2 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */

  create view "podcast_analytics"."public"."int_user_sessions__dbt_tmp"
    
    
  as (
    -- int_user_sessions.sql : derive user listening sessions

-- 1. Bring in all user events from the staging model
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

-- 2. For each event, get the timestamp of the previous event for the same user
events_with_lag as (
    select
        *,
        lag(event_ts) over (partition by user_id order by event_ts) as previous_event_ts
    from events
),

-- 3. Flag the start of a new session:
--    - If there is no previous event (first event for user)
--    - Or if the gap between events is more than 30 minutes
flagged as (
    select
        *,
        case
            when previous_event_ts is null
              or extract(epoch from (event_ts - previous_event_ts))/60 > 30
            then 1 else 0 end as new_session_flag
    from events_with_lag
),

-- 4. Assign a session number to each event for each user by cumulatively summing the new session flags
numbered as (
    select
        *,
        sum(new_session_flag) over (partition by user_id order by event_ts) as session_number
    from flagged
),

-- 5. Aggregate events into sessions:
--    - Find session start/end timestamps
--    - Sum up listening duration for the session
agg as (
    select
        user_id,
        session_number,
        min(event_ts) as session_start,
        max(event_ts) as session_end,
        sum(coalesce(duration, 0)) as total_listening_duration
    from numbered
    group by user_id, session_number
),

-- 6. Generate a surrogate session_id and select final session fields
final as (
    select
        md5(cast(coalesce(cast(user_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(session_number as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as session_id,
        user_id,
        session_start,
        session_end,
        total_listening_duration as session_duration
    from agg
)

-- 7. Output the final sessionized data
select * from final
  );
[0m18:55:51.867484 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m18:55:51.868310 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."dim_users__dbt_backup"
[0m18:55:51.869437 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.dim_users"
[0m18:55:51.869597 [debug] [Thread-4 (]: On model.podcast_analytics.dim_users: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_users"} */
drop table if exists "podcast_analytics"."public"."dim_users__dbt_backup" cascade
[0m18:55:51.869828 [debug] [Thread-3 (]: SQL status: SELECT 50 in 0.004 seconds
[0m18:55:51.871251 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:55:51.871436 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:55:51.871615 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:55:51.871833 [debug] [Thread-3 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */
alter table "podcast_analytics"."public"."dim_episodes" rename to "dim_episodes__dbt_backup"
[0m18:55:51.872902 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:55:51.873385 [debug] [Thread-4 (]: On model.podcast_analytics.dim_users: Close
[0m18:55:51.873580 [debug] [Thread-2 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
alter table "podcast_analytics"."public"."int_user_sessions__dbt_tmp" rename to "int_user_sessions"
[0m18:55:51.873831 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306b6219-592d-4d20-8fb9-1b38ac65a135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa6f30>]}
[0m18:55:51.874253 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:51.874115 [info ] [Thread-4 (]: 5 of 10 OK created sql table model public.dim_users ............................ [[32mSELECT 100[0m in 0.05s]
[0m18:55:51.875316 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:55:51.875485 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:51.875692 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.dim_users
[0m18:55:51.875854 [debug] [Thread-3 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */
alter table "podcast_analytics"."public"."dim_episodes__dbt_tmp" rename to "dim_episodes"
[0m18:55:51.876440 [debug] [Thread-2 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m18:55:51.876620 [debug] [Thread-4 (]: Began running node model.podcast_analytics.mart_top_episodes
[0m18:55:51.876830 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:55:51.877026 [info ] [Thread-4 (]: 9 of 10 START sql table model public.mart_top_episodes ......................... [RUN]
[0m18:55:51.877206 [debug] [Thread-2 (]: On model.podcast_analytics.int_user_sessions: COMMIT
[0m18:55:51.877364 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:55:51.877534 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.dim_users, now model.podcast_analytics.mart_top_episodes)
[0m18:55:51.878180 [debug] [Thread-3 (]: On model.podcast_analytics.dim_episodes: COMMIT
[0m18:55:51.878353 [debug] [Thread-4 (]: Began compiling node model.podcast_analytics.mart_top_episodes
[0m18:55:51.878587 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:55:51.881263 [debug] [Thread-4 (]: Writing injected SQL for node "model.podcast_analytics.mart_top_episodes"
[0m18:55:51.881470 [debug] [Thread-2 (]: SQL status: COMMIT in 0.004 seconds
[0m18:55:51.881650 [debug] [Thread-3 (]: On model.podcast_analytics.dim_episodes: COMMIT
[0m18:55:51.882597 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."int_user_sessions__dbt_backup"
[0m18:55:51.883013 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.int_user_sessions"
[0m18:55:51.883210 [debug] [Thread-4 (]: Began executing node model.podcast_analytics.mart_top_episodes
[0m18:55:51.883387 [debug] [Thread-2 (]: On model.podcast_analytics.int_user_sessions: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.int_user_sessions"} */
drop view if exists "podcast_analytics"."public"."int_user_sessions__dbt_backup" cascade
[0m18:55:51.884886 [debug] [Thread-4 (]: Writing runtime sql for node "model.podcast_analytics.mart_top_episodes"
[0m18:55:51.885072 [debug] [Thread-3 (]: SQL status: COMMIT in 0.002 seconds
[0m18:55:51.887482 [debug] [Thread-3 (]: Applying DROP to: "podcast_analytics"."public"."dim_episodes__dbt_backup"
[0m18:55:51.888144 [debug] [Thread-3 (]: Using postgres connection "model.podcast_analytics.dim_episodes"
[0m18:55:51.888342 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.003 seconds
[0m18:55:51.888565 [debug] [Thread-3 (]: On model.podcast_analytics.dim_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.dim_episodes"} */
drop table if exists "podcast_analytics"."public"."dim_episodes__dbt_backup" cascade
[0m18:55:51.889203 [debug] [Thread-2 (]: On model.podcast_analytics.int_user_sessions: Close
[0m18:55:51.889383 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:55:51.889683 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306b6219-592d-4d20-8fb9-1b38ac65a135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109939e50>]}
[0m18:55:51.889858 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: BEGIN
[0m18:55:51.890157 [info ] [Thread-2 (]: 8 of 10 OK created sql view model public.int_user_sessions ..................... [[32mCREATE VIEW[0m in 0.05s]
[0m18:55:51.890362 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:55:51.890602 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.int_user_sessions
[0m18:55:51.891278 [debug] [Thread-2 (]: Began running node model.podcast_analytics.mart_user_session_metrics
[0m18:55:51.891499 [info ] [Thread-2 (]: 10 of 10 START sql table model public.mart_user_session_metrics ................ [RUN]
[0m18:55:51.892025 [debug] [Thread-3 (]: SQL status: DROP TABLE in 0.002 seconds
[0m18:55:51.892243 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.podcast_analytics.int_user_sessions, now model.podcast_analytics.mart_user_session_metrics)
[0m18:55:51.892845 [debug] [Thread-3 (]: On model.podcast_analytics.dim_episodes: Close
[0m18:55:51.893015 [debug] [Thread-1 (]: SQL status: SELECT 4860 in 0.027 seconds
[0m18:55:51.893200 [debug] [Thread-2 (]: Began compiling node model.podcast_analytics.mart_user_session_metrics
[0m18:55:51.893459 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306b6219-592d-4d20-8fb9-1b38ac65a135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10993a450>]}
[0m18:55:51.894878 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m18:55:51.896282 [debug] [Thread-2 (]: Writing injected SQL for node "model.podcast_analytics.mart_user_session_metrics"
[0m18:55:51.896765 [debug] [Thread-1 (]: On model.podcast_analytics.fact_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.fact_user_events"} */
alter table "podcast_analytics"."public"."fact_user_events" rename to "fact_user_events__dbt_backup"
[0m18:55:51.896615 [info ] [Thread-3 (]: 6 of 10 OK created sql table model public.dim_episodes ......................... [[32mSELECT 50[0m in 0.05s]
[0m18:55:51.897003 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m18:55:51.897324 [debug] [Thread-3 (]: Finished running node model.podcast_analytics.dim_episodes
[0m18:55:51.897528 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:55:51.897701 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:55:51.897870 [debug] [Thread-2 (]: Began executing node model.podcast_analytics.mart_user_session_metrics
[0m18:55:51.898108 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */

  
    

  create  table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp"
  
  
    as
  
  (
    -- mart_top_episodes.sql : engagement per episode
with events as (
    select * from "podcast_analytics"."public"."stg_user_events"
),

plays as (
    select episode_id, count(*) as plays
    from events
    where event_type = 'play'
    group by episode_id
),

completions as (
    select episode_id, count(*) as completions
    from events
    where event_type = 'complete'
    group by episode_id
),

joined as (
    select coalesce(p.episode_id, c.episode_id) as episode_id,
           coalesce(p.plays, 0) as plays,
           coalesce(c.completions, 0) as completions
    from plays p
    full outer join completions c using(episode_id)
)
select
    episode_id,
    plays,
    completions,
    
    ( completions ) / nullif( ( plays ), 0)
 as completion_rate
from joined
order by completion_rate desc
  );
  
[0m18:55:51.899318 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m18:55:51.900702 [debug] [Thread-2 (]: Writing runtime sql for node "model.podcast_analytics.mart_user_session_metrics"
[0m18:55:51.900904 [debug] [Thread-1 (]: On model.podcast_analytics.fact_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.fact_user_events"} */
alter table "podcast_analytics"."public"."fact_user_events__dbt_tmp" rename to "fact_user_events"
[0m18:55:51.901227 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:55:51.901397 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: BEGIN
[0m18:55:51.901570 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:55:51.901752 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:55:51.902699 [debug] [Thread-1 (]: On model.podcast_analytics.fact_user_events: COMMIT
[0m18:55:51.902985 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m18:55:51.903218 [debug] [Thread-1 (]: On model.podcast_analytics.fact_user_events: COMMIT
[0m18:55:51.904520 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:55:51.905709 [debug] [Thread-1 (]: Applying DROP to: "podcast_analytics"."public"."fact_user_events__dbt_backup"
[0m18:55:51.906104 [debug] [Thread-1 (]: Using postgres connection "model.podcast_analytics.fact_user_events"
[0m18:55:51.906275 [debug] [Thread-1 (]: On model.podcast_analytics.fact_user_events: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.fact_user_events"} */
drop table if exists "podcast_analytics"."public"."fact_user_events__dbt_backup" cascade
[0m18:55:51.907344 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:55:51.908039 [debug] [Thread-1 (]: On model.podcast_analytics.fact_user_events: Close
[0m18:55:51.908334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306b6219-592d-4d20-8fb9-1b38ac65a135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109933b90>]}
[0m18:55:51.908868 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m18:55:51.908724 [info ] [Thread-1 (]: 7 of 10 OK created sql table model public.fact_user_events ..................... [[32mSELECT 4860[0m in 0.07s]
[0m18:55:51.909145 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:55:51.909376 [debug] [Thread-1 (]: Finished running node model.podcast_analytics.fact_user_events
[0m18:55:51.909563 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */

  
    

  create  table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp"
  
  
    as
  
  (
    -- mart_user_session_metrics.sql : user level session KPIs
with sessions as (
    select * from "podcast_analytics"."public"."int_user_sessions"
),

metrics as (
    select
        user_id,
        avg(session_duration) as avg_session_duration,
        count(*) as sessions,
        cast(min(session_start) as date) as first_session_date,
        cast(max(session_end) as date) as last_session_date
    from sessions
    group by user_id
)
select * from metrics
  );
  
[0m18:55:51.922288 [debug] [Thread-4 (]: SQL status: SELECT 50 in 0.021 seconds
[0m18:55:51.924017 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:55:51.924195 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes" rename to "mart_top_episodes__dbt_backup"
[0m18:55:51.924688 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:55:51.925869 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:55:51.926041 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
alter table "podcast_analytics"."public"."mart_top_episodes__dbt_tmp" rename to "mart_top_episodes"
[0m18:55:51.926471 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:55:51.927236 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m18:55:51.927410 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:55:51.927558 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: COMMIT
[0m18:55:51.928449 [debug] [Thread-4 (]: SQL status: COMMIT in 0.001 seconds
[0m18:55:51.929362 [debug] [Thread-4 (]: Applying DROP to: "podcast_analytics"."public"."mart_top_episodes__dbt_backup"
[0m18:55:51.929687 [debug] [Thread-4 (]: Using postgres connection "model.podcast_analytics.mart_top_episodes"
[0m18:55:51.929843 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_top_episodes"} */
drop table if exists "podcast_analytics"."public"."mart_top_episodes__dbt_backup" cascade
[0m18:55:51.930650 [debug] [Thread-4 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:55:51.931173 [debug] [Thread-4 (]: On model.podcast_analytics.mart_top_episodes: Close
[0m18:55:51.931458 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306b6219-592d-4d20-8fb9-1b38ac65a135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108eb1a00>]}
[0m18:55:51.931770 [info ] [Thread-4 (]: 9 of 10 OK created sql table model public.mart_top_episodes .................... [[32mSELECT 50[0m in 0.05s]
[0m18:55:51.932027 [debug] [Thread-4 (]: Finished running node model.podcast_analytics.mart_top_episodes
[0m18:55:51.932432 [debug] [Thread-2 (]: SQL status: SELECT 100 in 0.023 seconds
[0m18:55:51.933737 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:55:51.933906 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics" rename to "mart_user_session_metrics__dbt_backup"
[0m18:55:51.934314 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:55:51.936147 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:55:51.936318 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
alter table "podcast_analytics"."public"."mart_user_session_metrics__dbt_tmp" rename to "mart_user_session_metrics"
[0m18:55:51.936670 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:55:51.937717 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m18:55:51.937919 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:55:51.938089 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: COMMIT
[0m18:55:51.938883 [debug] [Thread-2 (]: SQL status: COMMIT in 0.001 seconds
[0m18:55:51.939881 [debug] [Thread-2 (]: Applying DROP to: "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup"
[0m18:55:51.940251 [debug] [Thread-2 (]: Using postgres connection "model.podcast_analytics.mart_user_session_metrics"
[0m18:55:51.940410 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "model.podcast_analytics.mart_user_session_metrics"} */
drop table if exists "podcast_analytics"."public"."mart_user_session_metrics__dbt_backup" cascade
[0m18:55:51.941318 [debug] [Thread-2 (]: SQL status: DROP TABLE in 0.001 seconds
[0m18:55:51.941840 [debug] [Thread-2 (]: On model.podcast_analytics.mart_user_session_metrics: Close
[0m18:55:51.942095 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306b6219-592d-4d20-8fb9-1b38ac65a135', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991ad80>]}
[0m18:55:51.942378 [info ] [Thread-2 (]: 10 of 10 OK created sql table model public.mart_user_session_metrics ........... [[32mSELECT 100[0m in 0.05s]
[0m18:55:51.942624 [debug] [Thread-2 (]: Finished running node model.podcast_analytics.mart_user_session_metrics
[0m18:55:51.943240 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:51.943402 [debug] [MainThread]: On master: BEGIN
[0m18:55:51.943533 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:51.948242 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:55:51.948456 [debug] [MainThread]: On master: COMMIT
[0m18:55:51.948601 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:51.948727 [debug] [MainThread]: On master: COMMIT
[0m18:55:51.948994 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:55:51.949137 [debug] [MainThread]: On master: Close
[0m18:55:51.949335 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:51.949474 [debug] [MainThread]: Connection 'model.podcast_analytics.fact_user_events' was properly closed.
[0m18:55:51.949606 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_user_session_metrics' was properly closed.
[0m18:55:51.949736 [debug] [MainThread]: Connection 'model.podcast_analytics.dim_episodes' was properly closed.
[0m18:55:51.949864 [debug] [MainThread]: Connection 'model.podcast_analytics.mart_top_episodes' was properly closed.
[0m18:55:51.950064 [info ] [MainThread]: 
[0m18:55:51.950233 [info ] [MainThread]: Finished running 5 table models, 5 view models in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m18:55:51.950923 [debug] [MainThread]: Command end result
[0m18:55:51.962997 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:55:51.963851 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:55:51.966288 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m18:55:51.966444 [info ] [MainThread]: 
[0m18:55:51.966618 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:51.966762 [info ] [MainThread]: 
[0m18:55:51.966913 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m18:55:51.968173 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.59643275, "process_in_blocks": "0", "process_kernel_time": 0.102746, "process_mem_max_rss": "133431296", "process_out_blocks": "0", "process_user_time": 1.004498}
[0m18:55:51.968392 [debug] [MainThread]: Command `dbt run` succeeded at 18:55:51.968355 after 0.60 seconds
[0m18:55:51.968573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e34560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f8a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ab590>]}
[0m18:55:51.968730 [debug] [MainThread]: Flushing usage events
[0m18:55:52.389109 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:53.097725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708f560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078f9520>]}


============================== 18:55:53.099373 | bd8402df-b344-4655-991c-cf9ab018ff53 ==============================
[0m18:55:53.099373 [info ] [MainThread]: Running with dbt=1.10.3
[0m18:55:53.099677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/samydoreau/global-assignment', 'log_path': '/Users/samydoreau/global-assignment/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test --profiles-dir /Users/samydoreau/global-assignment', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:55:53.163346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd8402df-b344-4655-991c-cf9ab018ff53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078fb5c0>]}
[0m18:55:53.184744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd8402df-b344-4655-991c-cf9ab018ff53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b75b20>]}
[0m18:55:53.185092 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:55:53.225382 [debug] [MainThread]: checksum: 1bfacb87e6914c9942cfa2c4badfc1df19d859fe8ec086286ef238a7d920f97b, vars: {}, profile: , target: , version: 1.10.3
[0m18:55:53.278825 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:53.279050 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:53.300052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd8402df-b344-4655-991c-cf9ab018ff53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083f22d0>]}
[0m18:55:53.337659 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:55:53.338501 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:55:53.348583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd8402df-b344-4655-991c-cf9ab018ff53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f2fc0>]}
[0m18:55:53.348814 [info ] [MainThread]: Found 10 models, 2 seeds, 18 data tests, 3 sources, 549 macros
[0m18:55:53.348988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd8402df-b344-4655-991c-cf9ab018ff53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10880ecc0>]}
[0m18:55:53.349929 [info ] [MainThread]: 
[0m18:55:53.350103 [info ] [MainThread]: Concurrency: 4 threads (target='local')
[0m18:55:53.350247 [info ] [MainThread]: 
[0m18:55:53.350474 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:55:53.352073 [debug] [ThreadPool]: Acquiring new postgres connection 'list_podcast_analytics_public'
[0m18:55:53.368400 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:55:53.368637 [debug] [ThreadPool]: On list_podcast_analytics_public: BEGIN
[0m18:55:53.368785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:53.385384 [debug] [ThreadPool]: SQL status: BEGIN in 0.017 seconds
[0m18:55:53.385683 [debug] [ThreadPool]: Using postgres connection "list_podcast_analytics_public"
[0m18:55:53.385871 [debug] [ThreadPool]: On list_podcast_analytics_public: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "list_podcast_analytics_public"} */
select
      'podcast_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'podcast_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:55:53.391880 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.006 seconds
[0m18:55:53.392655 [debug] [ThreadPool]: On list_podcast_analytics_public: ROLLBACK
[0m18:55:53.395641 [debug] [ThreadPool]: On list_podcast_analytics_public: Close
[0m18:55:53.398815 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:53.398964 [debug] [MainThread]: On master: BEGIN
[0m18:55:53.399086 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:53.405268 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m18:55:53.405477 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:53.405684 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:55:53.410525 [debug] [MainThread]: SQL status: SELECT 5 in 0.005 seconds
[0m18:55:53.411400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd8402df-b344-4655-991c-cf9ab018ff53', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b78b00>]}
[0m18:55:53.411617 [debug] [MainThread]: On master: ROLLBACK
[0m18:55:53.412101 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:53.412251 [debug] [MainThread]: On master: BEGIN
[0m18:55:53.412923 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m18:55:53.413054 [debug] [MainThread]: On master: COMMIT
[0m18:55:53.413182 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:53.413304 [debug] [MainThread]: On master: COMMIT
[0m18:55:53.413658 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:55:53.413796 [debug] [MainThread]: On master: Close
[0m18:55:53.414885 [debug] [Thread-1 (]: Began running node test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4
[0m18:55:53.415092 [debug] [Thread-2 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m18:55:53.415278 [debug] [Thread-3 (]: Began running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m18:55:53.415604 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8
[0m18:55:53.415466 [info ] [Thread-1 (]: 1 of 18 START test accepted_values_fact_user_events_event_type__play__pause__seek__complete  [RUN]
[0m18:55:53.415856 [info ] [Thread-2 (]: 2 of 18 START test accepted_values_stg_user_events_event_type__play__pause__seek__complete  [RUN]
[0m18:55:53.416055 [info ] [Thread-3 (]: 3 of 18 START test accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [RUN]
[0m18:55:53.416253 [info ] [Thread-4 (]: 4 of 18 START test not_null_dim_episodes_episode_id ............................ [RUN]
[0m18:55:53.416474 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_podcast_analytics_public, now test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4)
[0m18:55:53.416683 [debug] [Thread-2 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8'
[0m18:55:53.416884 [debug] [Thread-3 (]: Acquiring new postgres connection 'test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7'
[0m18:55:53.417075 [debug] [Thread-4 (]: Acquiring new postgres connection 'test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8'
[0m18:55:53.417241 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4
[0m18:55:53.417407 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m18:55:53.417571 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m18:55:53.417730 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8
[0m18:55:53.427239 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4"
[0m18:55:53.429044 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m18:55:53.431935 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m18:55:53.435119 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8"
[0m18:55:53.435650 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m18:55:53.435857 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m18:55:53.436008 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8
[0m18:55:53.436161 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4
[0m18:55:53.443035 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m18:55:53.444030 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m18:55:53.444912 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8"
[0m18:55:53.446230 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4"
[0m18:55:53.446668 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m18:55:53.446863 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m18:55:53.447078 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: BEGIN
[0m18:55:53.447278 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: BEGIN
[0m18:55:53.447435 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8"
[0m18:55:53.447613 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:55:53.447783 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4"
[0m18:55:53.447934 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:55:53.448106 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8: BEGIN
[0m18:55:53.448347 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4: BEGIN
[0m18:55:53.448576 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:55:53.448740 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:53.458631 [debug] [Thread-4 (]: SQL status: BEGIN in 0.010 seconds
[0m18:55:53.458821 [debug] [Thread-2 (]: SQL status: BEGIN in 0.011 seconds
[0m18:55:53.459008 [debug] [Thread-3 (]: SQL status: BEGIN in 0.011 seconds
[0m18:55:53.459174 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m18:55:53.459335 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8"
[0m18:55:53.459494 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"
[0m18:55:53.459653 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"
[0m18:55:53.459805 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4"
[0m18:55:53.459959 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."dim_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m18:55:53.460136 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m18:55:53.460325 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        issue_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."stg_user_events_invalid"
    group by issue_type

)

select *
from all_values
where value_field not in (
    'missing_event_type','invalid_event_type','missing_timestamp','malformed_timestamp','missing_user_id','missing_episode_id','other_issue'
)



  
  
      
    ) dbt_internal_test
[0m18:55:53.460512 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        event_type as value_field,
        count(*) as n_records

    from "podcast_analytics"."public"."fact_user_events"
    group by event_type

)

select *
from all_values
where value_field not in (
    'play','pause','seek','complete'
)



  
  
      
    ) dbt_internal_test
[0m18:55:53.461755 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:53.463332 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8: ROLLBACK
[0m18:55:53.463510 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:55:53.464036 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4: ROLLBACK
[0m18:55:53.464192 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8: Close
[0m18:55:53.464465 [info ] [Thread-4 (]: 4 of 18 PASS not_null_dim_episodes_episode_id .................................. [[32mPASS[0m in 0.05s]
[0m18:55:53.464735 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8
[0m18:55:53.464885 [debug] [Thread-1 (]: On test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4: Close
[0m18:55:53.465064 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_dim_episodes_title.388fd88fff
[0m18:55:53.465329 [info ] [Thread-1 (]: 1 of 18 PASS accepted_values_fact_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.05s]
[0m18:55:53.465513 [info ] [Thread-4 (]: 5 of 18 START test not_null_dim_episodes_title ................................. [RUN]
[0m18:55:53.465732 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4
[0m18:55:53.465890 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes_episode_id.9d7afaf3c8, now test.podcast_analytics.not_null_dim_episodes_title.388fd88fff)
[0m18:55:53.466056 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_dim_users_user_id.e754bb5812
[0m18:55:53.466230 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_dim_episodes_title.388fd88fff
[0m18:55:53.466384 [info ] [Thread-1 (]: 6 of 18 START test not_null_dim_users_user_id .................................. [RUN]
[0m18:55:53.467886 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_episodes_title.388fd88fff"
[0m18:55:53.468052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_fact_user_events_event_type__play__pause__seek__complete.1169c959e4, now test.podcast_analytics.not_null_dim_users_user_id.e754bb5812)
[0m18:55:53.468242 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_dim_users_user_id.e754bb5812
[0m18:55:53.469536 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_dim_users_user_id.e754bb5812"
[0m18:55:53.469755 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_dim_episodes_title.388fd88fff
[0m18:55:53.470949 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_episodes_title.388fd88fff"
[0m18:55:53.471163 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_dim_users_user_id.e754bb5812
[0m18:55:53.472061 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_dim_users_user_id.e754bb5812"
[0m18:55:53.472256 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes_title.388fd88fff"
[0m18:55:53.472424 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes_title.388fd88fff: BEGIN
[0m18:55:53.472591 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:55:53.472787 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_dim_users_user_id.e754bb5812"
[0m18:55:53.472926 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_users_user_id.e754bb5812: BEGIN
[0m18:55:53.473063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:53.475869 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.015 seconds
[0m18:55:53.476511 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: ROLLBACK
[0m18:55:53.476941 [debug] [Thread-3 (]: On test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7: Close
[0m18:55:53.477120 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.016 seconds
[0m18:55:53.477917 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: ROLLBACK
[0m18:55:53.477387 [info ] [Thread-3 (]: 3 of 18 PASS accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue  [[32mPASS[0m in 0.06s]
[0m18:55:53.478278 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7
[0m18:55:53.478502 [debug] [Thread-2 (]: On test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8: Close
[0m18:55:53.478706 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b
[0m18:55:53.478987 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:55:53.479162 [debug] [Thread-4 (]: SQL status: BEGIN in 0.007 seconds
[0m18:55:53.479377 [info ] [Thread-2 (]: 2 of 18 PASS accepted_values_stg_user_events_event_type__play__pause__seek__complete  [[32mPASS[0m in 0.06s]
[0m18:55:53.479573 [info ] [Thread-3 (]: 7 of 18 START test not_null_fact_user_events_episode_id ........................ [RUN]
[0m18:55:53.479778 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_dim_users_user_id.e754bb5812"
[0m18:55:53.479963 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_dim_episodes_title.388fd88fff"
[0m18:55:53.480198 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8
[0m18:55:53.480384 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_invalid_issue_type__missing_event_type__invalid_event_type__missing_timestamp__malformed_timestamp__missing_user_id__missing_episode_id__other_issue.09ad3b2fc7, now test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b)
[0m18:55:53.480578 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_users_user_id.e754bb5812: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_users_user_id.e754bb5812"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."dim_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m18:55:53.480767 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes_title.388fd88fff: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_dim_episodes_title.388fd88fff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select title
from "podcast_analytics"."public"."dim_episodes"
where title is null



  
  
      
    ) dbt_internal_test
[0m18:55:53.480960 [debug] [Thread-2 (]: Began running node test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583
[0m18:55:53.481142 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b
[0m18:55:53.483173 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b"
[0m18:55:53.481353 [info ] [Thread-2 (]: 8 of 18 START test not_null_fact_user_events_user_id ........................... [RUN]
[0m18:55:53.483415 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:55:53.483590 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:55:53.483814 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.accepted_values_stg_user_events_event_type__play__pause__seek__complete.47468a40f8, now test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583)
[0m18:55:53.484439 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_users_user_id.e754bb5812: ROLLBACK
[0m18:55:53.485026 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes_title.388fd88fff: ROLLBACK
[0m18:55:53.485202 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583
[0m18:55:53.485364 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b
[0m18:55:53.486983 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583"
[0m18:55:53.487175 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_dim_users_user_id.e754bb5812: Close
[0m18:55:53.487353 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_dim_episodes_title.388fd88fff: Close
[0m18:55:53.488351 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b"
[0m18:55:53.488721 [info ] [Thread-1 (]: 6 of 18 PASS not_null_dim_users_user_id ........................................ [[32mPASS[0m in 0.02s]
[0m18:55:53.488978 [info ] [Thread-4 (]: 5 of 18 PASS not_null_dim_episodes_title ....................................... [[32mPASS[0m in 0.02s]
[0m18:55:53.489318 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_dim_users_user_id.e754bb5812
[0m18:55:53.489575 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_dim_episodes_title.388fd88fff
[0m18:55:53.489740 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583
[0m18:55:53.489937 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b"
[0m18:55:53.490127 [debug] [Thread-1 (]: Began running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m18:55:53.490339 [debug] [Thread-4 (]: Began running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m18:55:53.491315 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583"
[0m18:55:53.491479 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b: BEGIN
[0m18:55:53.491658 [info ] [Thread-1 (]: 9 of 18 START test not_null_stg_episodes_episode_id ............................ [RUN]
[0m18:55:53.491851 [info ] [Thread-4 (]: 10 of 18 START test not_null_stg_user_events_event_id .......................... [RUN]
[0m18:55:53.492071 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:55:53.492262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_users_user_id.e754bb5812, now test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422)
[0m18:55:53.492458 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_dim_episodes_title.388fd88fff, now test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7)
[0m18:55:53.492637 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583"
[0m18:55:53.492859 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m18:55:53.493024 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m18:55:53.493184 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583: BEGIN
[0m18:55:53.495252 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m18:55:53.533825 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m18:55:53.534155 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:55:53.534664 [debug] [Thread-3 (]: SQL status: BEGIN in 0.043 seconds
[0m18:55:53.534899 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m18:55:53.535182 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b"
[0m18:55:53.535410 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m18:55:53.566181 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m18:55:53.566476 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."fact_user_events"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m18:55:53.567585 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m18:55:53.567791 [debug] [Thread-2 (]: SQL status: BEGIN in 0.034 seconds
[0m18:55:53.568232 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583"
[0m18:55:53.568476 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m18:55:53.568669 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m18:55:53.568862 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."fact_user_events"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m18:55:53.569088 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:53.569242 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: BEGIN
[0m18:55:53.569393 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: BEGIN
[0m18:55:53.570045 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b: ROLLBACK
[0m18:55:53.570212 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:53.570379 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:55:53.570541 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:53.571057 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583: ROLLBACK
[0m18:55:53.571222 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b: Close
[0m18:55:53.571751 [debug] [Thread-2 (]: On test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583: Close
[0m18:55:53.571615 [info ] [Thread-3 (]: 7 of 18 PASS not_null_fact_user_events_episode_id .............................. [[32mPASS[0m in 0.09s]
[0m18:55:53.572051 [info ] [Thread-2 (]: 8 of 18 PASS not_null_fact_user_events_user_id ................................. [[32mPASS[0m in 0.09s]
[0m18:55:53.572294 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b
[0m18:55:53.572515 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583
[0m18:55:53.572700 [debug] [Thread-3 (]: Began running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m18:55:53.572946 [debug] [Thread-2 (]: Began running node test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25
[0m18:55:53.573154 [info ] [Thread-3 (]: 11 of 18 START test not_null_stg_users_user_id ................................. [RUN]
[0m18:55:53.573479 [info ] [Thread-2 (]: 12 of 18 START test relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_  [RUN]
[0m18:55:53.573704 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events_episode_id.d4ea3f442b, now test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77)
[0m18:55:53.573920 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_fact_user_events_user_id.d63f8f4583, now test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25)
[0m18:55:53.574107 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m18:55:53.574288 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25
[0m18:55:53.576088 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m18:55:53.579455 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25"
[0m18:55:53.580111 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25
[0m18:55:53.580349 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m18:55:53.581668 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25"
[0m18:55:53.581868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m18:55:53.582036 [debug] [Thread-4 (]: SQL status: BEGIN in 0.012 seconds
[0m18:55:53.582958 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m18:55:53.583187 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"
[0m18:55:53.583385 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"
[0m18:55:53.583623 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25"
[0m18:55:53.583795 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select episode_id
from "podcast_analytics"."public"."stg_episodes"
where episode_id is null



  
  
      
    ) dbt_internal_test
[0m18:55:53.583999 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select event_id
from "podcast_analytics"."public"."stg_user_events"
where event_id is null



  
  
      
    ) dbt_internal_test
[0m18:55:53.584182 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m18:55:53.584350 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25: BEGIN
[0m18:55:53.584582 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: BEGIN
[0m18:55:53.584774 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:55:53.584932 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:55:53.585221 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:53.585892 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: ROLLBACK
[0m18:55:53.586345 [debug] [Thread-1 (]: On test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422: Close
[0m18:55:53.586656 [info ] [Thread-1 (]: 9 of 18 PASS not_null_stg_episodes_episode_id .................................. [[32mPASS[0m in 0.09s]
[0m18:55:53.587095 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422
[0m18:55:53.587340 [debug] [Thread-1 (]: Began running node test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222
[0m18:55:53.587654 [info ] [Thread-1 (]: 13 of 18 START test relationships_fact_user_events_user_id__user_id__ref_dim_users_  [RUN]
[0m18:55:53.587935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_episodes_episode_id.30984c0422, now test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222)
[0m18:55:53.588118 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222
[0m18:55:53.590563 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222"
[0m18:55:53.590927 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222
[0m18:55:53.591921 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222"
[0m18:55:53.592104 [debug] [Thread-2 (]: SQL status: BEGIN in 0.007 seconds
[0m18:55:53.592283 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m18:55:53.592507 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25"
[0m18:55:53.592694 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"
[0m18:55:53.593264 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select episode_id as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where episode_id is not null
),

parent as (
    select episode_id as to_field
    from "podcast_analytics"."public"."dim_episodes"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:55:53.593483 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222"
[0m18:55:53.593679 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select user_id
from "podcast_analytics"."public"."stg_users"
where user_id is null



  
  
      
    ) dbt_internal_test
[0m18:55:53.593901 [debug] [Thread-1 (]: On test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222: BEGIN
[0m18:55:53.594098 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:53.594391 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.010 seconds
[0m18:55:53.595056 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: ROLLBACK
[0m18:55:53.595237 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:53.595407 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:55:53.596027 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: ROLLBACK
[0m18:55:53.596193 [debug] [Thread-4 (]: On test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7: Close
[0m18:55:53.596789 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25: ROLLBACK
[0m18:55:53.597253 [debug] [Thread-3 (]: On test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77: Close
[0m18:55:53.597120 [info ] [Thread-4 (]: 10 of 18 PASS not_null_stg_user_events_event_id ................................ [[32mPASS[0m in 0.10s]
[0m18:55:53.597881 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7
[0m18:55:53.598056 [debug] [Thread-2 (]: On test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25: Close
[0m18:55:53.598262 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f
[0m18:55:53.597636 [info ] [Thread-3 (]: 11 of 18 PASS not_null_stg_users_user_id ....................................... [[32mPASS[0m in 0.02s]
[0m18:55:53.598623 [info ] [Thread-2 (]: 12 of 18 PASS relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_  [[32mPASS[0m in 0.02s]
[0m18:55:53.598922 [info ] [Thread-4 (]: 14 of 18 START test unique_dim_episodes_episode_id ............................. [RUN]
[0m18:55:53.599115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.005 seconds
[0m18:55:53.599348 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77
[0m18:55:53.599595 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25
[0m18:55:53.599787 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_user_events_event_id.3ab7415ad7, now test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f)
[0m18:55:53.599976 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222"
[0m18:55:53.600170 [debug] [Thread-3 (]: Began running node test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9
[0m18:55:53.600373 [debug] [Thread-2 (]: Began running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m18:55:53.600556 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f
[0m18:55:53.600754 [debug] [Thread-1 (]: On test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with child as (
    select user_id as from_field
    from "podcast_analytics"."public"."fact_user_events"
    where user_id is not null
),

parent as (
    select user_id as to_field
    from "podcast_analytics"."public"."dim_users"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



  
  
      
    ) dbt_internal_test
[0m18:55:53.600953 [info ] [Thread-3 (]: 15 of 18 START test unique_dim_users_user_id ................................... [RUN]
[0m18:55:53.601137 [info ] [Thread-2 (]: 16 of 18 START test unique_stg_episodes_episode_id ............................. [RUN]
[0m18:55:53.604287 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f"
[0m18:55:53.604606 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.not_null_stg_users_user_id.980dfc1b77, now test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9)
[0m18:55:53.604798 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.relationships_fact_user_events_episode_id__episode_id__ref_dim_episodes_.c7a91eaa25, now test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16)
[0m18:55:53.605037 [debug] [Thread-3 (]: Began compiling node test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9
[0m18:55:53.605237 [debug] [Thread-2 (]: Began compiling node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m18:55:53.607924 [debug] [Thread-3 (]: Writing injected SQL for node "test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9"
[0m18:55:53.608107 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f
[0m18:55:53.608280 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:55:53.609791 [debug] [Thread-2 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m18:55:53.610792 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f"
[0m18:55:53.611416 [debug] [Thread-1 (]: On test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222: ROLLBACK
[0m18:55:53.611638 [debug] [Thread-3 (]: Began executing node test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9
[0m18:55:53.612628 [debug] [Thread-3 (]: Writing runtime sql for node "test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9"
[0m18:55:53.612817 [debug] [Thread-1 (]: On test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222: Close
[0m18:55:53.613015 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f"
[0m18:55:53.613175 [debug] [Thread-2 (]: Began executing node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m18:55:53.613578 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f: BEGIN
[0m18:55:53.613443 [info ] [Thread-1 (]: 13 of 18 PASS relationships_fact_user_events_user_id__user_id__ref_dim_users_ .. [[32mPASS[0m in 0.03s]
[0m18:55:53.614594 [debug] [Thread-2 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m18:55:53.614778 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9"
[0m18:55:53.614952 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:55:53.615178 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222
[0m18:55:53.615368 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9: BEGIN
[0m18:55:53.615625 [debug] [Thread-1 (]: Began running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m18:55:53.615798 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m18:55:53.615982 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:55:53.616160 [info ] [Thread-1 (]: 17 of 18 START test unique_stg_user_events_event_id ............................ [RUN]
[0m18:55:53.616343 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: BEGIN
[0m18:55:53.616587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.relationships_fact_user_events_user_id__user_id__ref_dim_users_.b25d17b222, now test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7)
[0m18:55:53.616774 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:55:53.616976 [debug] [Thread-1 (]: Began compiling node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m18:55:53.618659 [debug] [Thread-1 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m18:55:53.618975 [debug] [Thread-1 (]: Began executing node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m18:55:53.621280 [debug] [Thread-1 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m18:55:53.621732 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m18:55:53.622087 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: BEGIN
[0m18:55:53.622388 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:55:53.622577 [debug] [Thread-4 (]: SQL status: BEGIN in 0.008 seconds
[0m18:55:53.622881 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f"
[0m18:55:53.623075 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:55:53.623256 [debug] [Thread-2 (]: SQL status: BEGIN in 0.006 seconds
[0m18:55:53.623450 [debug] [Thread-3 (]: SQL status: BEGIN in 0.007 seconds
[0m18:55:53.623684 [debug] [Thread-2 (]: Using postgres connection "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"
[0m18:55:53.623853 [debug] [Thread-3 (]: Using postgres connection "test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9"
[0m18:55:53.624036 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    episode_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_episodes"
where episode_id is not null
group by episode_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:55:53.624221 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:53.624395 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."dim_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:55:53.625106 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f: ROLLBACK
[0m18:55:53.625276 [debug] [Thread-2 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:53.626025 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: ROLLBACK
[0m18:55:53.626192 [debug] [Thread-4 (]: On test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f: Close
[0m18:55:53.626379 [debug] [Thread-3 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:53.627225 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9: ROLLBACK
[0m18:55:53.627393 [debug] [Thread-2 (]: On test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16: Close
[0m18:55:53.626693 [info ] [Thread-4 (]: 14 of 18 PASS unique_dim_episodes_episode_id ................................... [[32mPASS[0m in 0.03s]
[0m18:55:53.627815 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f
[0m18:55:53.628063 [info ] [Thread-2 (]: 16 of 18 PASS unique_stg_episodes_episode_id ................................... [[32mPASS[0m in 0.02s]
[0m18:55:53.628257 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m18:55:53.628421 [debug] [Thread-3 (]: On test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9: Close
[0m18:55:53.628613 [debug] [Thread-4 (]: Began running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m18:55:53.628881 [debug] [Thread-2 (]: Finished running node test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16
[0m18:55:53.629064 [debug] [Thread-1 (]: Using postgres connection "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"
[0m18:55:53.629310 [info ] [Thread-3 (]: 15 of 18 PASS unique_dim_users_user_id ......................................... [[32mPASS[0m in 0.02s]
[0m18:55:53.629453 [info ] [Thread-4 (]: 18 of 18 START test unique_stg_users_user_id ................................... [RUN]
[0m18:55:53.629743 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    event_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_user_events"
where event_id is not null
group by event_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:55:53.629990 [debug] [Thread-3 (]: Finished running node test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9
[0m18:55:53.630180 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.podcast_analytics.unique_dim_episodes_episode_id.cf91e42e2f, now test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b)
[0m18:55:53.630420 [debug] [Thread-4 (]: Began compiling node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m18:55:53.632191 [debug] [Thread-4 (]: Writing injected SQL for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m18:55:53.632561 [debug] [Thread-4 (]: Began executing node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m18:55:53.633507 [debug] [Thread-4 (]: Writing runtime sql for node "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m18:55:53.634055 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m18:55:53.634226 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: BEGIN
[0m18:55:53.634381 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:55:53.639470 [debug] [Thread-4 (]: SQL status: BEGIN in 0.005 seconds
[0m18:55:53.639745 [debug] [Thread-4 (]: Using postgres connection "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"
[0m18:55:53.639933 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: /* {"app": "dbt", "dbt_version": "1.10.3", "profile_name": "podcast_analytics", "target_name": "local", "node_id": "test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "podcast_analytics"."public"."stg_users"
where user_id is not null
group by user_id
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m18:55:53.640758 [debug] [Thread-4 (]: SQL status: SELECT 1 in 0.001 seconds
[0m18:55:53.641407 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: ROLLBACK
[0m18:55:53.641737 [debug] [Thread-4 (]: On test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b: Close
[0m18:55:53.642013 [info ] [Thread-4 (]: 18 of 18 PASS unique_stg_users_user_id ......................................... [[32mPASS[0m in 0.01s]
[0m18:55:53.642292 [debug] [Thread-4 (]: Finished running node test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b
[0m18:55:53.647390 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.017 seconds
[0m18:55:53.647954 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: ROLLBACK
[0m18:55:53.648621 [debug] [Thread-1 (]: On test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7: Close
[0m18:55:53.648897 [info ] [Thread-1 (]: 17 of 18 PASS unique_stg_user_events_event_id .................................. [[32mPASS[0m in 0.03s]
[0m18:55:53.649136 [debug] [Thread-1 (]: Finished running node test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7
[0m18:55:53.649725 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:53.649869 [debug] [MainThread]: On master: BEGIN
[0m18:55:53.650009 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:53.655194 [debug] [MainThread]: SQL status: BEGIN in 0.005 seconds
[0m18:55:53.655453 [debug] [MainThread]: On master: COMMIT
[0m18:55:53.655630 [debug] [MainThread]: Using postgres connection "master"
[0m18:55:53.655763 [debug] [MainThread]: On master: COMMIT
[0m18:55:53.656102 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:55:53.656266 [debug] [MainThread]: On master: Close
[0m18:55:53.656492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:53.656625 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_user_events_event_id.6926ae65d7' was properly closed.
[0m18:55:53.656761 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_episodes_episode_id.de98524a16' was properly closed.
[0m18:55:53.656881 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_dim_users_user_id.bcdc17b9f9' was properly closed.
[0m18:55:53.657008 [debug] [MainThread]: Connection 'test.podcast_analytics.unique_stg_users_user_id.c2ff477e6b' was properly closed.
[0m18:55:53.657170 [info ] [MainThread]: 
[0m18:55:53.657342 [info ] [MainThread]: Finished running 18 data tests in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m18:55:53.658358 [debug] [MainThread]: Command end result
[0m18:55:53.670728 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/samydoreau/global-assignment/dbt/target/manifest.json
[0m18:55:53.671827 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/samydoreau/global-assignment/dbt/target/semantic_manifest.json
[0m18:55:53.674748 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/samydoreau/global-assignment/dbt/target/run_results.json
[0m18:55:53.674921 [info ] [MainThread]: 
[0m18:55:53.675101 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:53.675245 [info ] [MainThread]: 
[0m18:55:53.675403 [info ] [MainThread]: Done. PASS=18 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=18
[0m18:55:53.676628 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.6046398, "process_in_blocks": "0", "process_kernel_time": 0.109786, "process_mem_max_rss": "133627904", "process_out_blocks": "0", "process_user_time": 1.003593}
[0m18:55:53.676823 [debug] [MainThread]: Command `dbt test` succeeded at 18:55:53.676791 after 0.60 seconds
[0m18:55:53.676983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d0fcb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107219d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109726ea0>]}
[0m18:55:53.677138 [debug] [MainThread]: Flushing usage events
[0m18:55:54.017970 [debug] [MainThread]: An error was encountered while trying to flush usage events
